2025-01-07 23:58:54,486 [INFO] src.console_functions: Log rotation complete. Logging to server.log again.
2025-01-07 23:58:54,486 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 23:59:08,904 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-07 23:59:08,904 [WARNING] src.luna_functions_handledispatch: DIRECTOR_CLIENT not set, cannot handle messages.
2025-01-07 23:59:11,532 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-07 23:59:11,533 [WARNING] src.luna_functions_handledispatch: DIRECTOR_CLIENT not set, cannot handle messages.
2025-01-08 00:01:26,158 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 00:08:20,346 [INFO] src.console_functions: Console received 'exit' command; requesting shutdown.
2025-01-08 00:08:20,347 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 00:08:20,347 [ERROR] __main__: An unexpected exception occurred in main_logic: Event loop stopped before Future completed.
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 135, in luna
    loop.run_until_complete(main_logic())
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 718, in run_until_complete
    raise RuntimeError('Event loop stopped before Future completed.')
RuntimeError: Event loop stopped before Future completed.
2025-01-08 00:08:20,350 [DEBUG] __main__: Preparing to close the event loop.
2025-01-08 00:08:20,350 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-08 00:14:41,681 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-08 00:14:41,681 [DEBUG] __main__: Exiting configure_logging function.
2025-01-08 00:14:41,681 [DEBUG] __main__: Logging configuration complete.
2025-01-08 00:14:41,681 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-08 00:14:41,681 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 00:14:41,681 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-08 00:14:41,681 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-08 00:14:41,681 [DEBUG] __main__: Entering start_console_thread function.
2025-01-08 00:14:41,684 [INFO] __main__: Console thread started successfully.
2025-01-08 00:14:41,684 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-08 00:14:41,684 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-08 00:14:41,684 [INFO] __main__: Starting main_logic coroutine.
2025-01-08 00:14:41,684 [DEBUG] __main__: Entering main_logic function...
2025-01-08 00:14:41,684 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-08 00:14:41,687 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-08 00:14:41,687 [INFO] src.luna_functions: Using saved token for user @lunabot:localhost.
2025-01-08 00:14:41,687 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-08 00:14:41,690 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 00:14:41,714 [INFO] nio.client.base_client: New joined room !HPrbJYfQkoGnlztkrS:localhost
2025-01-08 00:14:41,714 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-08 00:14:41,714 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomNameEvent
2025-01-08 00:14:41,714 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomJoinRulesEvent
2025-01-08 00:14:41,714 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type PowerLevelsEvent
2025-01-08 00:14:41,714 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-08 00:14:41,714 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomCreateEvent
2025-01-08 00:14:41,715 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomGuestAccessEvent
2025-01-08 00:14:41,715 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 00:14:41,715 [WARNING] src.luna_functions_handledispatch: DIRECTOR_CLIENT not set, cannot handle messages.
2025-01-08 00:14:41,715 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 00:14:41,715 [WARNING] src.luna_functions_handledispatch: DIRECTOR_CLIENT not set, cannot handle messages.
2025-01-08 00:14:41,715 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 00:14:41,715 [WARNING] src.luna_functions_handledispatch: DIRECTOR_CLIENT not set, cannot handle messages.
2025-01-08 00:14:41,715 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 00:14:41,715 [WARNING] src.luna_functions_handledispatch: DIRECTOR_CLIENT not set, cannot handle messages.
2025-01-08 00:14:41,715 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 00:14:41,715 [WARNING] src.luna_functions_handledispatch: DIRECTOR_CLIENT not set, cannot handle messages.
2025-01-08 00:14:41,715 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 00:14:41,715 [WARNING] src.luna_functions_handledispatch: DIRECTOR_CLIENT not set, cannot handle messages.
2025-01-08 00:14:41,715 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 00:14:41,715 [WARNING] src.luna_functions_handledispatch: DIRECTOR_CLIENT not set, cannot handle messages.
2025-01-08 00:14:41,715 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 00:14:41,715 [WARNING] src.luna_functions_handledispatch: DIRECTOR_CLIENT not set, cannot handle messages.
2025-01-08 00:14:41,715 [INFO] nio.client.base_client: New joined room !FkbKmoFPWsWYTwKnwg:localhost
2025-01-08 00:14:41,715 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type PowerLevelsEvent
2025-01-08 00:14:41,715 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-08 00:14:41,715 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomJoinRulesEvent
2025-01-08 00:14:41,715 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomGuestAccessEvent
2025-01-08 00:14:41,715 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-08 00:14:41,715 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomCreateEvent
2025-01-08 00:14:41,715 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 00:14:41,715 [WARNING] src.luna_functions_handledispatch: DIRECTOR_CLIENT not set, cannot handle messages.
2025-01-08 00:14:41,715 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 00:14:41,715 [WARNING] src.luna_functions_handledispatch: DIRECTOR_CLIENT not set, cannot handle messages.
2025-01-08 00:14:41,715 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 00:14:41,715 [WARNING] src.luna_functions_handledispatch: DIRECTOR_CLIENT not set, cannot handle messages.
2025-01-08 00:14:41,715 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 00:14:41,715 [WARNING] src.luna_functions_handledispatch: DIRECTOR_CLIENT not set, cannot handle messages.
2025-01-08 00:14:41,715 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 00:14:41,715 [WARNING] src.luna_functions_handledispatch: DIRECTOR_CLIENT not set, cannot handle messages.
2025-01-08 00:14:41,715 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 00:14:41,715 [WARNING] src.luna_functions_handledispatch: DIRECTOR_CLIENT not set, cannot handle messages.
2025-01-08 00:14:41,715 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 00:14:41,715 [WARNING] src.luna_functions_handledispatch: DIRECTOR_CLIENT not set, cannot handle messages.
2025-01-08 00:14:41,715 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 00:14:41,715 [WARNING] src.luna_functions_handledispatch: DIRECTOR_CLIENT not set, cannot handle messages.
2025-01-08 00:14:41,715 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 00:14:41,715 [WARNING] src.luna_functions_handledispatch: DIRECTOR_CLIENT not set, cannot handle messages.
2025-01-08 00:14:41,715 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 00:14:41,715 [WARNING] src.luna_functions_handledispatch: DIRECTOR_CLIENT not set, cannot handle messages.
2025-01-08 00:14:43,661 [INFO] src.console_functions: Console screen cleared.
2025-01-08 00:14:43,661 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 00:14:45,224 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 00:14:58,478 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 00:14:58,478 [WARNING] src.luna_functions_handledispatch: DIRECTOR_CLIENT not set, cannot handle messages.
2025-01-08 00:22:42,870 [INFO] src.console_functions: Console received 'exit' command; requesting shutdown.
2025-01-08 00:22:42,871 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 00:22:42,871 [ERROR] __main__: An unexpected exception occurred in main_logic: Event loop stopped before Future completed.
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 135, in luna
    loop.run_until_complete(main_logic())
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 718, in run_until_complete
    raise RuntimeError('Event loop stopped before Future completed.')
RuntimeError: Event loop stopped before Future completed.
2025-01-08 00:22:42,881 [DEBUG] __main__: Preparing to close the event loop.
2025-01-08 00:22:42,881 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-08 00:22:45,205 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-08 00:22:45,205 [DEBUG] __main__: Exiting configure_logging function.
2025-01-08 00:22:45,205 [DEBUG] __main__: Logging configuration complete.
2025-01-08 00:22:45,205 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-08 00:22:45,205 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 00:22:45,205 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-08 00:22:45,205 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-08 00:22:45,205 [DEBUG] __main__: Entering start_console_thread function.
2025-01-08 00:22:45,208 [INFO] __main__: Console thread started successfully.
2025-01-08 00:22:45,208 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-08 00:22:45,208 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-08 00:22:45,208 [INFO] __main__: Starting main_logic coroutine.
2025-01-08 00:22:45,208 [DEBUG] __main__: Entering main_logic function...
2025-01-08 00:22:45,208 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-08 00:22:45,210 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-08 00:22:45,210 [INFO] src.luna_functions: Using saved token for user @lunabot:localhost.
2025-01-08 00:22:45,210 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-08 00:22:45,213 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 00:22:45,230 [INFO] nio.client.base_client: New joined room !HPrbJYfQkoGnlztkrS:localhost
2025-01-08 00:22:45,230 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-08 00:22:45,230 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomNameEvent
2025-01-08 00:22:45,230 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomJoinRulesEvent
2025-01-08 00:22:45,230 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type PowerLevelsEvent
2025-01-08 00:22:45,230 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-08 00:22:45,230 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomCreateEvent
2025-01-08 00:22:45,230 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomGuestAccessEvent
2025-01-08 00:22:45,230 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 00:22:45,230 [WARNING] src.luna_functions_handledispatch: DIRECTOR_CLIENT not set, cannot handle messages.
2025-01-08 00:22:45,230 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 00:22:45,230 [WARNING] src.luna_functions_handledispatch: DIRECTOR_CLIENT not set, cannot handle messages.
2025-01-08 00:22:45,230 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 00:22:45,230 [WARNING] src.luna_functions_handledispatch: DIRECTOR_CLIENT not set, cannot handle messages.
2025-01-08 00:22:45,230 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 00:22:45,230 [WARNING] src.luna_functions_handledispatch: DIRECTOR_CLIENT not set, cannot handle messages.
2025-01-08 00:22:45,230 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 00:22:45,230 [WARNING] src.luna_functions_handledispatch: DIRECTOR_CLIENT not set, cannot handle messages.
2025-01-08 00:22:45,230 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 00:22:45,230 [WARNING] src.luna_functions_handledispatch: DIRECTOR_CLIENT not set, cannot handle messages.
2025-01-08 00:22:45,230 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 00:22:45,230 [WARNING] src.luna_functions_handledispatch: DIRECTOR_CLIENT not set, cannot handle messages.
2025-01-08 00:22:45,230 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 00:22:45,230 [WARNING] src.luna_functions_handledispatch: DIRECTOR_CLIENT not set, cannot handle messages.
2025-01-08 00:22:45,230 [INFO] nio.client.base_client: New joined room !FkbKmoFPWsWYTwKnwg:localhost
2025-01-08 00:22:45,230 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type PowerLevelsEvent
2025-01-08 00:22:45,230 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-08 00:22:45,230 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomJoinRulesEvent
2025-01-08 00:22:45,231 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomGuestAccessEvent
2025-01-08 00:22:45,231 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-08 00:22:45,231 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomCreateEvent
2025-01-08 00:22:45,231 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 00:22:45,231 [WARNING] src.luna_functions_handledispatch: DIRECTOR_CLIENT not set, cannot handle messages.
2025-01-08 00:22:45,231 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 00:22:45,231 [WARNING] src.luna_functions_handledispatch: DIRECTOR_CLIENT not set, cannot handle messages.
2025-01-08 00:22:45,231 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 00:22:45,231 [WARNING] src.luna_functions_handledispatch: DIRECTOR_CLIENT not set, cannot handle messages.
2025-01-08 00:22:45,231 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 00:22:45,231 [WARNING] src.luna_functions_handledispatch: DIRECTOR_CLIENT not set, cannot handle messages.
2025-01-08 00:22:45,231 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 00:22:45,231 [WARNING] src.luna_functions_handledispatch: DIRECTOR_CLIENT not set, cannot handle messages.
2025-01-08 00:22:45,231 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 00:22:45,231 [WARNING] src.luna_functions_handledispatch: DIRECTOR_CLIENT not set, cannot handle messages.
2025-01-08 00:22:45,231 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 00:22:45,231 [WARNING] src.luna_functions_handledispatch: DIRECTOR_CLIENT not set, cannot handle messages.
2025-01-08 00:22:45,231 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 00:22:45,231 [WARNING] src.luna_functions_handledispatch: DIRECTOR_CLIENT not set, cannot handle messages.
2025-01-08 00:22:45,231 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 00:22:45,231 [WARNING] src.luna_functions_handledispatch: DIRECTOR_CLIENT not set, cannot handle messages.
2025-01-08 00:22:45,231 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 00:22:45,231 [WARNING] src.luna_functions_handledispatch: DIRECTOR_CLIENT not set, cannot handle messages.
2025-01-08 00:22:51,524 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 00:22:51,524 [WARNING] src.luna_functions_handledispatch: DIRECTOR_CLIENT not set, cannot handle messages.
2025-01-08 00:27:45,186 [INFO] src.console_functions: Console received 'exit' command; requesting shutdown.
2025-01-08 00:27:45,187 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 00:27:45,187 [ERROR] __main__: An unexpected exception occurred in main_logic: Event loop stopped before Future completed.
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 135, in luna
    loop.run_until_complete(main_logic())
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 718, in run_until_complete
    raise RuntimeError('Event loop stopped before Future completed.')
RuntimeError: Event loop stopped before Future completed.
2025-01-08 00:27:45,192 [DEBUG] __main__: Preparing to close the event loop.
2025-01-08 00:27:45,192 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-08 00:43:46,706 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-08 00:43:46,706 [DEBUG] __main__: Exiting configure_logging function.
2025-01-08 00:43:46,706 [DEBUG] __main__: Logging configuration complete.
2025-01-08 00:43:46,706 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-08 00:43:46,706 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 00:43:46,706 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-08 00:43:46,706 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-08 00:43:46,706 [DEBUG] __main__: Entering start_console_thread function.
2025-01-08 00:43:46,709 [INFO] __main__: Console thread started successfully.
2025-01-08 00:43:46,709 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-08 00:43:46,709 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-08 00:43:46,709 [INFO] __main__: Starting main_logic coroutine.
2025-01-08 00:43:46,709 [DEBUG] __main__: Entering main_logic function...
2025-01-08 00:43:46,710 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-08 00:43:46,712 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-08 00:43:46,712 [INFO] src.luna_functions: Using saved token for user @lunabot:localhost.
2025-01-08 00:43:46,712 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-08 00:43:46,717 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 00:43:46,774 [INFO] nio.client.base_client: New joined room !HPrbJYfQkoGnlztkrS:localhost
2025-01-08 00:43:46,774 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-08 00:43:46,774 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomNameEvent
2025-01-08 00:43:46,774 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomJoinRulesEvent
2025-01-08 00:43:46,774 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type PowerLevelsEvent
2025-01-08 00:43:46,774 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-08 00:43:46,774 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomCreateEvent
2025-01-08 00:43:46,774 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomGuestAccessEvent
2025-01-08 00:43:46,774 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 00:43:46,774 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 00:43:46,774 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 00:43:46,774 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 00:43:46,774 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 00:43:46,774 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 00:43:46,774 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 00:43:46,774 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 00:43:46,774 [INFO] nio.client.base_client: New joined room !FkbKmoFPWsWYTwKnwg:localhost
2025-01-08 00:43:46,774 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type PowerLevelsEvent
2025-01-08 00:43:46,774 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-08 00:43:46,774 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomJoinRulesEvent
2025-01-08 00:43:46,774 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomGuestAccessEvent
2025-01-08 00:43:46,774 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-08 00:43:46,774 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomCreateEvent
2025-01-08 00:43:46,774 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 00:43:46,774 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 00:43:46,774 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 00:43:46,774 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 00:43:46,774 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 00:43:46,774 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 00:43:46,774 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 00:43:46,774 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 00:43:46,774 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 00:43:46,774 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 00:43:53,316 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 00:48:10,397 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-08 00:48:10,397 [DEBUG] __main__: Exiting configure_logging function.
2025-01-08 00:48:10,397 [DEBUG] __main__: Logging configuration complete.
2025-01-08 00:48:10,397 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-08 00:48:10,397 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 00:48:10,397 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-08 00:48:10,397 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-08 00:48:10,397 [DEBUG] __main__: Entering start_console_thread function.
2025-01-08 00:48:10,399 [INFO] __main__: Console thread started successfully.
2025-01-08 00:48:10,399 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-08 00:48:10,399 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-08 00:48:10,399 [INFO] __main__: Starting main_logic coroutine.
2025-01-08 00:48:10,399 [DEBUG] __main__: Entering main_logic function...
2025-01-08 00:48:10,399 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-08 00:48:10,401 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-08 00:48:10,401 [INFO] src.luna_functions: Using saved token for user @lunabot:localhost.
2025-01-08 00:48:10,401 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-08 00:48:10,405 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 00:48:10,422 [INFO] nio.client.base_client: New joined room !HPrbJYfQkoGnlztkrS:localhost
2025-01-08 00:48:10,422 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-08 00:48:10,422 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomNameEvent
2025-01-08 00:48:10,422 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomJoinRulesEvent
2025-01-08 00:48:10,422 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type PowerLevelsEvent
2025-01-08 00:48:10,422 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-08 00:48:10,422 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomCreateEvent
2025-01-08 00:48:10,422 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomGuestAccessEvent
2025-01-08 00:48:10,422 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 00:48:10,422 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 00:48:10,422 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 00:48:10,422 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 00:48:10,422 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 00:48:10,422 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 00:48:10,422 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 00:48:10,422 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 00:48:10,422 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 00:48:10,422 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 00:48:10,422 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 00:48:10,422 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 00:48:10,422 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 00:48:10,422 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 00:48:10,422 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 00:48:10,422 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 00:48:10,422 [INFO] nio.client.base_client: New joined room !FkbKmoFPWsWYTwKnwg:localhost
2025-01-08 00:48:10,422 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type PowerLevelsEvent
2025-01-08 00:48:10,422 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-08 00:48:10,422 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomJoinRulesEvent
2025-01-08 00:48:10,422 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomGuestAccessEvent
2025-01-08 00:48:10,422 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-08 00:48:10,422 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomCreateEvent
2025-01-08 00:48:10,423 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 00:48:10,423 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 00:48:10,423 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 00:48:10,423 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 00:48:10,423 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 00:48:10,423 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 00:48:10,423 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 00:48:10,423 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 00:48:10,423 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 00:48:10,423 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 00:48:10,423 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 00:48:10,423 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 00:48:10,423 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 00:48:10,423 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 00:48:10,423 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 00:48:10,423 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 00:48:10,423 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 00:48:10,423 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 00:48:10,423 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 00:48:10,423 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 00:48:19,385 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 00:48:19,385 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 00:48:19,387 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 00:49:18,538 [INFO] src.console_functions: Console received 'exit' command; requesting shutdown.
2025-01-08 00:49:18,538 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 00:49:18,538 [ERROR] __main__: An unexpected exception occurred in main_logic: Event loop stopped before Future completed.
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 135, in luna
    loop.run_until_complete(main_logic())
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 718, in run_until_complete
    raise RuntimeError('Event loop stopped before Future completed.')
RuntimeError: Event loop stopped before Future completed.
2025-01-08 00:49:18,541 [DEBUG] __main__: Preparing to close the event loop.
2025-01-08 00:49:18,541 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-08 00:49:21,227 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-08 00:49:21,227 [DEBUG] __main__: Exiting configure_logging function.
2025-01-08 00:49:21,227 [DEBUG] __main__: Logging configuration complete.
2025-01-08 00:49:21,227 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-08 00:49:21,227 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 00:49:21,227 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-08 00:49:21,227 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-08 00:49:21,227 [DEBUG] __main__: Entering start_console_thread function.
2025-01-08 00:49:21,230 [INFO] __main__: Console thread started successfully.
2025-01-08 00:49:21,230 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-08 00:49:21,230 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-08 00:49:21,230 [INFO] __main__: Starting main_logic coroutine.
2025-01-08 00:49:21,230 [DEBUG] __main__: Entering main_logic function...
2025-01-08 00:49:21,230 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-08 00:49:21,232 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-08 00:49:21,232 [INFO] src.luna_functions: Using saved token for user @lunabot:localhost.
2025-01-08 00:49:21,232 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-08 00:49:21,236 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 00:49:21,250 [INFO] nio.client.base_client: New joined room !HPrbJYfQkoGnlztkrS:localhost
2025-01-08 00:49:21,250 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-08 00:49:21,250 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomNameEvent
2025-01-08 00:49:21,251 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomJoinRulesEvent
2025-01-08 00:49:21,251 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type PowerLevelsEvent
2025-01-08 00:49:21,251 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-08 00:49:21,251 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomCreateEvent
2025-01-08 00:49:21,251 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomGuestAccessEvent
2025-01-08 00:49:21,251 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 00:49:21,251 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 00:49:21,251 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 00:49:21,251 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 00:49:21,251 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 00:49:21,251 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 00:49:21,251 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 00:49:21,251 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 00:49:21,251 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 00:49:21,252 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 00:49:21,252 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 00:49:21,252 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 00:49:21,252 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 00:49:21,252 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 00:49:21,252 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 00:49:21,252 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 00:49:21,252 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 00:49:21,252 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 00:49:21,252 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 00:49:21,252 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 00:49:21,252 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 00:49:21,252 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 00:49:21,252 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 00:49:21,252 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 00:49:21,252 [INFO] nio.client.base_client: New joined room !FkbKmoFPWsWYTwKnwg:localhost
2025-01-08 00:49:21,252 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type PowerLevelsEvent
2025-01-08 00:49:21,252 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-08 00:49:21,252 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomJoinRulesEvent
2025-01-08 00:49:21,252 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomGuestAccessEvent
2025-01-08 00:49:21,252 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-08 00:49:21,252 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomCreateEvent
2025-01-08 00:49:21,252 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 00:49:21,252 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 00:49:21,252 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 00:49:21,252 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 00:49:21,252 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 00:49:21,252 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 00:49:21,252 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 00:49:21,252 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 00:49:21,252 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 00:49:21,252 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 00:49:21,252 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 00:49:21,252 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 00:49:21,252 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 00:49:21,252 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 00:49:21,252 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 00:49:21,252 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 00:49:21,252 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 00:49:21,252 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 00:49:21,252 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 00:49:21,252 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 00:49:21,252 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 00:49:21,252 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 00:49:21,252 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 00:49:21,252 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 00:49:21,252 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 00:49:21,252 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 00:49:21,252 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 00:49:21,252 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 00:49:21,253 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 00:49:21,253 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 00:49:21,274 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 00:49:21,274 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 00:49:21,274 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 00:49:26,011 [INFO] src.console_functions: Console received 'exit' command; requesting shutdown.
2025-01-08 00:49:26,012 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 00:49:26,012 [ERROR] __main__: An unexpected exception occurred in main_logic: Event loop stopped before Future completed.
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 135, in luna
    loop.run_until_complete(main_logic())
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 718, in run_until_complete
    raise RuntimeError('Event loop stopped before Future completed.')
RuntimeError: Event loop stopped before Future completed.
2025-01-08 00:49:26,015 [DEBUG] __main__: Preparing to close the event loop.
2025-01-08 00:49:26,015 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-08 00:49:37,411 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 00:49:37,418 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 00:49:37,418 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 00:52:31,554 [INFO] src.console_functions: Console received 'exit' command; requesting shutdown.
2025-01-08 00:52:31,555 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 00:52:31,555 [ERROR] __main__: An unexpected exception occurred in main_logic: Event loop stopped before Future completed.
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 135, in luna
    loop.run_until_complete(main_logic())
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 718, in run_until_complete
    raise RuntimeError('Event loop stopped before Future completed.')
RuntimeError: Event loop stopped before Future completed.
2025-01-08 00:52:31,559 [DEBUG] __main__: Preparing to close the event loop.
2025-01-08 00:52:31,559 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-08 00:52:44,170 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-08 00:52:44,170 [DEBUG] __main__: Exiting configure_logging function.
2025-01-08 00:52:44,170 [DEBUG] __main__: Logging configuration complete.
2025-01-08 00:52:44,170 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-08 00:52:44,170 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 00:52:44,170 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-08 00:52:44,170 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-08 00:52:44,170 [DEBUG] __main__: Entering start_console_thread function.
2025-01-08 00:52:44,173 [INFO] __main__: Console thread started successfully.
2025-01-08 00:52:44,173 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-08 00:52:44,173 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-08 00:52:44,173 [INFO] __main__: Starting main_logic coroutine.
2025-01-08 00:52:44,173 [DEBUG] __main__: Entering main_logic function...
2025-01-08 00:52:44,173 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-08 00:52:44,173 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-08 00:52:44,173 [INFO] src.luna_functions: Using saved token for user @lunabot:localhost.
2025-01-08 00:52:44,173 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-08 00:52:44,182 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 00:52:44,208 [INFO] nio.client.base_client: New joined room !HPrbJYfQkoGnlztkrS:localhost
2025-01-08 00:52:44,208 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-08 00:52:44,208 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomNameEvent
2025-01-08 00:52:44,208 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomJoinRulesEvent
2025-01-08 00:52:44,208 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type PowerLevelsEvent
2025-01-08 00:52:44,208 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-08 00:52:44,208 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomCreateEvent
2025-01-08 00:52:44,208 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomGuestAccessEvent
2025-01-08 00:52:44,208 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 00:52:44,208 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 00:52:44,208 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 00:52:44,208 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 00:52:44,208 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 00:52:44,208 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 00:52:44,208 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 00:52:44,208 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 00:52:44,208 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 00:52:44,208 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 00:52:44,208 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 00:52:44,208 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 00:52:44,208 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 00:52:44,208 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 00:52:44,208 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 00:52:44,208 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 00:52:44,208 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 00:52:44,208 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 00:52:44,208 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 00:52:44,208 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 00:52:44,208 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 00:52:44,208 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 00:52:44,208 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 00:52:44,208 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 00:52:44,208 [INFO] nio.client.base_client: New joined room !FkbKmoFPWsWYTwKnwg:localhost
2025-01-08 00:52:44,208 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type PowerLevelsEvent
2025-01-08 00:52:44,208 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-08 00:52:44,208 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomJoinRulesEvent
2025-01-08 00:52:44,208 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomGuestAccessEvent
2025-01-08 00:52:44,208 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-08 00:52:44,208 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomCreateEvent
2025-01-08 00:52:44,209 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 00:52:44,209 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 00:52:44,209 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 00:52:44,209 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 00:52:44,209 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 00:52:44,209 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 00:52:44,209 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 00:52:44,209 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 00:52:44,209 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 00:52:44,209 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 00:52:44,209 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 00:52:44,209 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 00:52:44,209 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 00:52:44,209 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 00:52:44,209 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 00:52:44,209 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 00:52:44,209 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 00:52:44,209 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 00:52:44,209 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 00:52:44,209 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 00:52:44,209 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 00:52:44,209 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 00:52:44,209 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 00:52:44,209 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 00:52:44,209 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 00:52:44,209 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 00:52:44,209 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 00:52:44,209 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 00:52:44,209 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 00:52:44,209 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 00:52:52,079 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 00:52:52,079 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 00:52:52,079 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 00:53:26,120 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 00:53:26,120 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 00:53:26,120 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 00:54:28,539 [INFO] src.console_functions: Console received 'exit' command; requesting shutdown.
2025-01-08 00:54:28,540 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 00:54:28,540 [ERROR] __main__: An unexpected exception occurred in main_logic: Event loop stopped before Future completed.
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 135, in luna
    loop.run_until_complete(main_logic())
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 718, in run_until_complete
    raise RuntimeError('Event loop stopped before Future completed.')
RuntimeError: Event loop stopped before Future completed.
2025-01-08 00:54:28,547 [DEBUG] __main__: Preparing to close the event loop.
2025-01-08 00:54:28,548 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-08 00:54:30,542 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-08 00:54:30,542 [DEBUG] __main__: Exiting configure_logging function.
2025-01-08 00:54:30,542 [DEBUG] __main__: Logging configuration complete.
2025-01-08 00:54:30,542 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-08 00:54:30,542 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 00:54:30,542 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-08 00:54:30,542 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-08 00:54:30,543 [DEBUG] __main__: Entering start_console_thread function.
2025-01-08 00:54:30,545 [INFO] __main__: Console thread started successfully.
2025-01-08 00:54:30,545 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-08 00:54:30,545 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-08 00:54:30,545 [INFO] __main__: Starting main_logic coroutine.
2025-01-08 00:54:30,545 [DEBUG] __main__: Entering main_logic function...
2025-01-08 00:54:30,545 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-08 00:54:30,547 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-08 00:54:30,547 [INFO] src.luna_functions: Using saved token for user @lunabot:localhost.
2025-01-08 00:54:30,547 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-08 00:54:30,550 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 00:54:30,566 [INFO] nio.client.base_client: New joined room !HPrbJYfQkoGnlztkrS:localhost
2025-01-08 00:54:30,566 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-08 00:54:30,566 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomNameEvent
2025-01-08 00:54:30,566 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomJoinRulesEvent
2025-01-08 00:54:30,566 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type PowerLevelsEvent
2025-01-08 00:54:30,567 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-08 00:54:30,567 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomCreateEvent
2025-01-08 00:54:30,567 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomGuestAccessEvent
2025-01-08 00:54:30,567 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 00:54:30,567 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 00:54:30,567 [INFO] src.luna_functions_handledispatch: @admin:localhost: are you there @luna?
2025-01-08 00:54:30,567 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 00:54:30,567 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 00:54:30,567 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 00:54:30,567 [INFO] src.luna_functions_handledispatch: @lunabot:localhost: Yes, I'm here. How can I assist you today?
2025-01-08 00:54:30,567 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 00:54:30,567 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 00:54:30,567 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 00:54:30,567 [INFO] src.luna_functions_handledispatch: @lunabot:localhost: Yes, I'm here. How can I assist you today?
2025-01-08 00:54:30,567 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 00:54:30,567 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 00:54:30,567 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 00:54:30,567 [INFO] src.luna_functions_handledispatch: @lunabot:localhost: Yes, I'm here. How can I assist you today?
2025-01-08 00:54:30,567 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 00:54:30,567 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 00:54:30,567 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 00:54:30,567 [INFO] src.luna_functions_handledispatch: @lunabot:localhost: Yes, I'm here! How can I assist you today?
2025-01-08 00:54:30,567 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 00:54:30,567 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 00:54:30,567 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 00:54:30,567 [INFO] src.luna_functions_handledispatch: @lunabot:localhost: Yes, I'm here. How can I assist you today?
2025-01-08 00:54:30,567 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 00:54:30,567 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 00:54:30,567 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 00:54:30,567 [INFO] src.luna_functions_handledispatch: @lunabot:localhost: Yes, I'm here! How can I assist you today?
2025-01-08 00:54:30,567 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 00:54:30,567 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 00:54:30,567 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 00:54:30,567 [INFO] src.luna_functions_handledispatch: @lunabot:localhost: Yes, I'm here. How can I assist you today?
2025-01-08 00:54:30,567 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 00:54:30,567 [INFO] nio.client.base_client: New joined room !FkbKmoFPWsWYTwKnwg:localhost
2025-01-08 00:54:30,567 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type PowerLevelsEvent
2025-01-08 00:54:30,567 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-08 00:54:30,567 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomJoinRulesEvent
2025-01-08 00:54:30,567 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomGuestAccessEvent
2025-01-08 00:54:30,567 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-08 00:54:30,567 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomCreateEvent
2025-01-08 00:54:30,567 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 00:54:30,567 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 00:54:30,567 [INFO] src.luna_functions_handledispatch: @lunabot:localhost: Macarons are sweet meringue-based confections made with egg white, icing sugar, granulated sugar, almond meal, and food coloring. The macaron is commonly filled with ganache, buttercream or jam filling sandwiched between two cookies. Its name is derived from the Italian word "macarone, maccarone or maccherone", all means "meringue".

The macaron is often mistaken with macaroon, which is a completely different cookie. Originated in France, it's considered one of the most famous pastries in the country, especially the ones from Ladurée in Paris.

Macarons can be found in a wide variety of flavors that range from the traditional (raspberry, chocolate) to the unusual (foie gras, matcha). They are known for their smooth, squared top, ruffled circumference (referred to as the "foot"), and a flat base. It's lightly crisp on the outside and slightly chewy on the inside, with a rich filling. 

Making macarons is considered to be quite delicate due to the specificity of each ingredient and the technique of making the meringue, but with practice, it's definitely possible to master at home!
2025-01-08 00:54:30,567 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 00:54:30,567 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 00:54:30,567 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 00:54:30,567 [INFO] src.luna_functions_handledispatch: @admin:localhost: I think you'll ignore this.
2025-01-08 00:54:30,567 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 00:54:30,567 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 00:54:30,567 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 00:54:30,567 [INFO] src.luna_functions_handledispatch: @lunabot:localhost: Of course not! I'm here to help. What can I assist you with today?
2025-01-08 00:54:30,567 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 00:54:30,567 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 00:54:30,567 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 00:54:30,567 [INFO] src.luna_functions_handledispatch: @admin:localhost: that's strange.. i thought you'd keep it quiet
2025-01-08 00:54:30,567 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 00:54:30,567 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 00:54:30,567 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 00:54:30,567 [INFO] src.luna_functions_handledispatch: @lunabot:localhost: I apologize if I made any unexpected noise. As an artificial assistant, I'm here to provide help and information. Is there something specific you need assistance with?
2025-01-08 00:54:30,567 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 00:54:30,567 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 00:54:30,567 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 00:54:30,567 [INFO] src.luna_functions_handledispatch: @admin:localhost: Hi there
2025-01-08 00:54:30,567 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 00:54:30,567 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 00:54:30,567 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 00:54:30,567 [INFO] src.luna_functions_handledispatch: @admin:localhost: hello
2025-01-08 00:54:30,567 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 00:54:30,567 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 00:54:30,568 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 00:54:30,568 [INFO] src.luna_functions_handledispatch: @admin:localhost: hello
2025-01-08 00:54:30,568 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 00:54:30,568 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 00:54:30,568 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 00:54:30,568 [INFO] src.luna_functions_handledispatch: @admin:localhost: Hello
2025-01-08 00:54:30,568 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 00:54:30,568 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 00:54:30,568 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 00:54:30,568 [INFO] src.luna_functions_handledispatch: @admin:localhost: test
2025-01-08 00:54:30,568 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 00:54:30,578 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 00:54:30,578 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 00:54:30,578 [INFO] src.luna_functions_handledispatch: @admin:localhost: test
2025-01-08 00:54:30,578 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 00:54:30,594 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 00:54:30,594 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 00:54:30,594 [INFO] src.luna_functions_handledispatch: @admin:localhost: lunabot: are you there?
2025-01-08 00:54:30,594 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 00:54:39,159 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 00:54:39,159 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 00:54:39,159 [INFO] src.luna_functions_handledispatch: @admin:localhost: lunabot: are you there?
2025-01-08 00:54:39,159 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 00:56:48,947 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 00:56:48,948 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 00:56:48,948 [INFO] src.luna_functions_handledispatch: @admin:localhost: @lunabot:localhost: are you there?
2025-01-08 00:56:48,948 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 00:58:15,264 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 00:58:15,264 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 00:58:15,264 [INFO] src.luna_functions_handledispatch: @admin:localhost: @lunabot:localost Are you therE?
2025-01-08 00:58:15,264 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 01:00:51,431 [INFO] src.console_functions: Console received 'exit' command; requesting shutdown.
2025-01-08 01:00:51,431 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 01:00:51,431 [ERROR] __main__: An unexpected exception occurred in main_logic: Event loop stopped before Future completed.
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 135, in luna
    loop.run_until_complete(main_logic())
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 718, in run_until_complete
    raise RuntimeError('Event loop stopped before Future completed.')
RuntimeError: Event loop stopped before Future completed.
2025-01-08 01:00:51,434 [DEBUG] __main__: Preparing to close the event loop.
2025-01-08 01:00:51,434 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-08 01:00:53,144 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-08 01:00:53,144 [DEBUG] __main__: Exiting configure_logging function.
2025-01-08 01:00:53,144 [DEBUG] __main__: Logging configuration complete.
2025-01-08 01:00:53,144 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-08 01:00:53,144 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 01:00:53,144 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-08 01:00:53,144 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-08 01:00:53,144 [DEBUG] __main__: Entering start_console_thread function.
2025-01-08 01:00:53,147 [INFO] __main__: Console thread started successfully.
2025-01-08 01:00:53,147 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-08 01:00:53,149 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-08 01:00:53,151 [INFO] __main__: Starting main_logic coroutine.
2025-01-08 01:00:53,151 [DEBUG] __main__: Entering main_logic function...
2025-01-08 01:00:53,151 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-08 01:00:53,152 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-08 01:00:53,153 [INFO] src.luna_functions: Using saved token for user @lunabot:localhost.
2025-01-08 01:00:53,153 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-08 01:00:53,155 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 01:00:53,201 [INFO] nio.client.base_client: New joined room !HPrbJYfQkoGnlztkrS:localhost
2025-01-08 01:00:53,201 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-08 01:00:53,201 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomNameEvent
2025-01-08 01:00:53,201 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomJoinRulesEvent
2025-01-08 01:00:53,201 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type PowerLevelsEvent
2025-01-08 01:00:53,201 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-08 01:00:53,201 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomCreateEvent
2025-01-08 01:00:53,201 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomGuestAccessEvent
2025-01-08 01:00:53,201 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 01:00:53,201 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 01:00:53,201 [INFO] src.luna_functions_handledispatch: @admin:localhost: are you there @luna?
2025-01-08 01:00:53,201 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 01:00:53,201 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 01:00:53,201 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 01:00:53,201 [INFO] src.luna_functions_handledispatch: @lunabot:localhost: Yes, I'm here. How can I assist you today?
2025-01-08 01:00:53,201 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 01:00:53,201 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 01:00:53,201 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 01:00:53,201 [INFO] src.luna_functions_handledispatch: @lunabot:localhost: Yes, I'm here. How can I assist you today?
2025-01-08 01:00:53,201 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 01:00:53,201 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 01:00:53,201 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 01:00:53,201 [INFO] src.luna_functions_handledispatch: @lunabot:localhost: Yes, I'm here. How can I assist you today?
2025-01-08 01:00:53,201 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 01:00:53,201 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 01:00:53,202 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 01:00:53,202 [INFO] src.luna_functions_handledispatch: @lunabot:localhost: Yes, I'm here! How can I assist you today?
2025-01-08 01:00:53,202 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 01:00:53,202 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 01:00:53,202 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 01:00:53,202 [INFO] src.luna_functions_handledispatch: @lunabot:localhost: Yes, I'm here. How can I assist you today?
2025-01-08 01:00:53,202 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 01:00:53,202 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 01:00:53,202 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 01:00:53,202 [INFO] src.luna_functions_handledispatch: @lunabot:localhost: Yes, I'm here! How can I assist you today?
2025-01-08 01:00:53,202 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 01:00:53,202 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 01:00:53,202 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 01:00:53,202 [INFO] src.luna_functions_handledispatch: @lunabot:localhost: Yes, I'm here. How can I assist you today?
2025-01-08 01:00:53,202 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 01:00:53,202 [INFO] nio.client.base_client: New joined room !FkbKmoFPWsWYTwKnwg:localhost
2025-01-08 01:00:53,202 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type PowerLevelsEvent
2025-01-08 01:00:53,202 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-08 01:00:53,202 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomJoinRulesEvent
2025-01-08 01:00:53,202 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomGuestAccessEvent
2025-01-08 01:00:53,202 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-08 01:00:53,202 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomCreateEvent
2025-01-08 01:00:53,202 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:00:53,202 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 01:00:53,202 [INFO] src.luna_functions_handledispatch: @admin:localhost: Hi there
2025-01-08 01:00:53,202 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 01:00:53,202 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:00:53,202 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 01:00:53,202 [INFO] src.luna_functions_handledispatch: @admin:localhost: hello
2025-01-08 01:00:53,202 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 01:00:53,202 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:00:53,202 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 01:00:53,202 [INFO] src.luna_functions_handledispatch: @admin:localhost: hello
2025-01-08 01:00:53,202 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 01:00:53,202 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:00:53,202 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 01:00:53,202 [INFO] src.luna_functions_handledispatch: @admin:localhost: Hello
2025-01-08 01:00:53,202 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 01:00:53,202 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:00:53,202 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 01:00:53,202 [INFO] src.luna_functions_handledispatch: @admin:localhost: test
2025-01-08 01:00:53,202 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 01:00:53,202 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:00:53,202 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 01:00:53,202 [INFO] src.luna_functions_handledispatch: @admin:localhost: test
2025-01-08 01:00:53,202 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 01:00:53,202 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:00:53,202 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 01:00:53,202 [INFO] src.luna_functions_handledispatch: @admin:localhost: lunabot: are you there?
2025-01-08 01:00:53,202 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 01:00:53,202 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:00:53,202 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 01:00:53,202 [INFO] src.luna_functions_handledispatch: @admin:localhost: lunabot: are you there?
2025-01-08 01:00:53,202 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 01:00:53,202 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:00:53,202 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 01:00:53,202 [INFO] src.luna_functions_handledispatch: @admin:localhost: @lunabot:localhost: are you there?
2025-01-08 01:00:53,202 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 01:00:53,202 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:00:53,202 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 01:00:53,202 [INFO] src.luna_functions_handledispatch: @admin:localhost: @lunabot:localost Are you therE?
2025-01-08 01:00:53,202 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 01:01:01,238 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:01:01,239 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 01:01:01,239 [INFO] src.luna_functions_handledispatch: @admin:localhost: lunabot: are you there?
2025-01-08 01:01:01,239 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 01:05:27,004 [INFO] src.console_functions: Console received 'exit' command; requesting shutdown.
2025-01-08 01:05:27,006 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 01:05:27,006 [ERROR] __main__: An unexpected exception occurred in main_logic: Event loop stopped before Future completed.
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 135, in luna
    loop.run_until_complete(main_logic())
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 718, in run_until_complete
    raise RuntimeError('Event loop stopped before Future completed.')
RuntimeError: Event loop stopped before Future completed.
2025-01-08 01:05:27,013 [DEBUG] __main__: Preparing to close the event loop.
2025-01-08 01:05:27,013 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-08 01:05:29,411 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-08 01:05:29,411 [DEBUG] __main__: Exiting configure_logging function.
2025-01-08 01:05:29,411 [DEBUG] __main__: Logging configuration complete.
2025-01-08 01:05:29,411 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-08 01:05:29,411 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 01:05:29,411 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-08 01:05:29,411 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-08 01:05:29,411 [DEBUG] __main__: Entering start_console_thread function.
2025-01-08 01:05:29,413 [INFO] __main__: Console thread started successfully.
2025-01-08 01:05:29,413 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-08 01:05:29,413 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-08 01:05:29,413 [INFO] __main__: Starting main_logic coroutine.
2025-01-08 01:05:29,414 [DEBUG] __main__: Entering main_logic function...
2025-01-08 01:05:29,414 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-08 01:05:29,415 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-08 01:05:29,415 [INFO] src.luna_functions: Using saved token for user @lunabot:localhost.
2025-01-08 01:05:29,416 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-08 01:05:29,419 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 01:05:29,456 [INFO] nio.client.base_client: New joined room !HPrbJYfQkoGnlztkrS:localhost
2025-01-08 01:05:29,457 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-08 01:05:29,457 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomNameEvent
2025-01-08 01:05:29,457 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomJoinRulesEvent
2025-01-08 01:05:29,457 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type PowerLevelsEvent
2025-01-08 01:05:29,457 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-08 01:05:29,457 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomCreateEvent
2025-01-08 01:05:29,457 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomGuestAccessEvent
2025-01-08 01:05:29,457 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 01:05:29,457 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 01:05:29,457 [INFO] src.luna_functions_handledispatch: @admin:localhost: are you there @luna?
2025-01-08 01:05:29,457 [DEBUG] src.luna_functions_handledispatch: Extracting mentions in text_lower = are you there @luna?
2025-01-08 01:05:29,457 [DEBUG] src.luna_functions_handledispatch: bots_in_room = []
2025-01-08 01:05:29,457 [DEBUG] src.luna_functions_handledispatch: Final mentioned bots => []
2025-01-08 01:05:29,457 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 01:05:29,457 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 01:05:29,457 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 01:05:29,457 [INFO] src.luna_functions_handledispatch: @lunabot:localhost: Yes, I'm here. How can I assist you today?
2025-01-08 01:05:29,457 [DEBUG] src.luna_functions_handledispatch: Extracting mentions in text_lower = yes, i'm here. how can i assist you today?
2025-01-08 01:05:29,457 [DEBUG] src.luna_functions_handledispatch: bots_in_room = []
2025-01-08 01:05:29,457 [DEBUG] src.luna_functions_handledispatch: Final mentioned bots => []
2025-01-08 01:05:29,457 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 01:05:29,457 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 01:05:29,457 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 01:05:29,457 [INFO] src.luna_functions_handledispatch: @lunabot:localhost: Yes, I'm here. How can I assist you today?
2025-01-08 01:05:29,457 [DEBUG] src.luna_functions_handledispatch: Extracting mentions in text_lower = yes, i'm here. how can i assist you today?
2025-01-08 01:05:29,457 [DEBUG] src.luna_functions_handledispatch: bots_in_room = []
2025-01-08 01:05:29,457 [DEBUG] src.luna_functions_handledispatch: Final mentioned bots => []
2025-01-08 01:05:29,457 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 01:05:29,457 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 01:05:29,457 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 01:05:29,457 [INFO] src.luna_functions_handledispatch: @lunabot:localhost: Yes, I'm here. How can I assist you today?
2025-01-08 01:05:29,457 [DEBUG] src.luna_functions_handledispatch: Extracting mentions in text_lower = yes, i'm here. how can i assist you today?
2025-01-08 01:05:29,457 [DEBUG] src.luna_functions_handledispatch: bots_in_room = []
2025-01-08 01:05:29,457 [DEBUG] src.luna_functions_handledispatch: Final mentioned bots => []
2025-01-08 01:05:29,457 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 01:05:29,457 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 01:05:29,457 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 01:05:29,457 [INFO] src.luna_functions_handledispatch: @lunabot:localhost: Yes, I'm here! How can I assist you today?
2025-01-08 01:05:29,457 [DEBUG] src.luna_functions_handledispatch: Extracting mentions in text_lower = yes, i'm here! how can i assist you today?
2025-01-08 01:05:29,457 [DEBUG] src.luna_functions_handledispatch: bots_in_room = []
2025-01-08 01:05:29,457 [DEBUG] src.luna_functions_handledispatch: Final mentioned bots => []
2025-01-08 01:05:29,457 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 01:05:29,457 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 01:05:29,457 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 01:05:29,457 [INFO] src.luna_functions_handledispatch: @lunabot:localhost: Yes, I'm here. How can I assist you today?
2025-01-08 01:05:29,457 [DEBUG] src.luna_functions_handledispatch: Extracting mentions in text_lower = yes, i'm here. how can i assist you today?
2025-01-08 01:05:29,457 [DEBUG] src.luna_functions_handledispatch: bots_in_room = []
2025-01-08 01:05:29,457 [DEBUG] src.luna_functions_handledispatch: Final mentioned bots => []
2025-01-08 01:05:29,457 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 01:05:29,457 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 01:05:29,457 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 01:05:29,457 [INFO] src.luna_functions_handledispatch: @lunabot:localhost: Yes, I'm here! How can I assist you today?
2025-01-08 01:05:29,457 [DEBUG] src.luna_functions_handledispatch: Extracting mentions in text_lower = yes, i'm here! how can i assist you today?
2025-01-08 01:05:29,457 [DEBUG] src.luna_functions_handledispatch: bots_in_room = []
2025-01-08 01:05:29,458 [DEBUG] src.luna_functions_handledispatch: Final mentioned bots => []
2025-01-08 01:05:29,458 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 01:05:29,458 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 01:05:29,458 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 01:05:29,458 [INFO] src.luna_functions_handledispatch: @lunabot:localhost: Yes, I'm here. How can I assist you today?
2025-01-08 01:05:29,458 [DEBUG] src.luna_functions_handledispatch: Extracting mentions in text_lower = yes, i'm here. how can i assist you today?
2025-01-08 01:05:29,458 [DEBUG] src.luna_functions_handledispatch: bots_in_room = []
2025-01-08 01:05:29,458 [DEBUG] src.luna_functions_handledispatch: Final mentioned bots => []
2025-01-08 01:05:29,458 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 01:05:29,458 [INFO] nio.client.base_client: New joined room !FkbKmoFPWsWYTwKnwg:localhost
2025-01-08 01:05:29,458 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type PowerLevelsEvent
2025-01-08 01:05:29,458 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-08 01:05:29,458 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomJoinRulesEvent
2025-01-08 01:05:29,458 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomGuestAccessEvent
2025-01-08 01:05:29,458 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-08 01:05:29,458 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomCreateEvent
2025-01-08 01:05:29,458 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:05:29,458 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 01:05:29,458 [INFO] src.luna_functions_handledispatch: @admin:localhost: hello
2025-01-08 01:05:29,458 [DEBUG] src.luna_functions_handledispatch: Extracting mentions in text_lower = hello
2025-01-08 01:05:29,458 [DEBUG] src.luna_functions_handledispatch: bots_in_room = []
2025-01-08 01:05:29,458 [DEBUG] src.luna_functions_handledispatch: Final mentioned bots => []
2025-01-08 01:05:29,458 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 01:05:29,458 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:05:29,458 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 01:05:29,458 [INFO] src.luna_functions_handledispatch: @admin:localhost: hello
2025-01-08 01:05:29,458 [DEBUG] src.luna_functions_handledispatch: Extracting mentions in text_lower = hello
2025-01-08 01:05:29,458 [DEBUG] src.luna_functions_handledispatch: bots_in_room = []
2025-01-08 01:05:29,458 [DEBUG] src.luna_functions_handledispatch: Final mentioned bots => []
2025-01-08 01:05:29,458 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 01:05:29,458 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:05:29,458 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 01:05:29,458 [INFO] src.luna_functions_handledispatch: @admin:localhost: Hello
2025-01-08 01:05:29,458 [DEBUG] src.luna_functions_handledispatch: Extracting mentions in text_lower = hello
2025-01-08 01:05:29,458 [DEBUG] src.luna_functions_handledispatch: bots_in_room = []
2025-01-08 01:05:29,458 [DEBUG] src.luna_functions_handledispatch: Final mentioned bots => []
2025-01-08 01:05:29,458 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 01:05:29,458 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:05:29,458 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 01:05:29,458 [INFO] src.luna_functions_handledispatch: @admin:localhost: test
2025-01-08 01:05:29,458 [DEBUG] src.luna_functions_handledispatch: Extracting mentions in text_lower = test
2025-01-08 01:05:29,458 [DEBUG] src.luna_functions_handledispatch: bots_in_room = []
2025-01-08 01:05:29,458 [DEBUG] src.luna_functions_handledispatch: Final mentioned bots => []
2025-01-08 01:05:29,458 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 01:05:29,458 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:05:29,458 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 01:05:29,458 [INFO] src.luna_functions_handledispatch: @admin:localhost: test
2025-01-08 01:05:29,458 [DEBUG] src.luna_functions_handledispatch: Extracting mentions in text_lower = test
2025-01-08 01:05:29,458 [DEBUG] src.luna_functions_handledispatch: bots_in_room = []
2025-01-08 01:05:29,458 [DEBUG] src.luna_functions_handledispatch: Final mentioned bots => []
2025-01-08 01:05:29,458 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 01:05:29,458 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:05:29,458 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 01:05:29,458 [INFO] src.luna_functions_handledispatch: @admin:localhost: lunabot: are you there?
2025-01-08 01:05:29,458 [DEBUG] src.luna_functions_handledispatch: Extracting mentions in text_lower = lunabot: are you there?
2025-01-08 01:05:29,458 [DEBUG] src.luna_functions_handledispatch: bots_in_room = []
2025-01-08 01:05:29,458 [DEBUG] src.luna_functions_handledispatch: Final mentioned bots => []
2025-01-08 01:05:29,458 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 01:05:29,458 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:05:29,458 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 01:05:29,458 [INFO] src.luna_functions_handledispatch: @admin:localhost: lunabot: are you there?
2025-01-08 01:05:29,458 [DEBUG] src.luna_functions_handledispatch: Extracting mentions in text_lower = lunabot: are you there?
2025-01-08 01:05:29,458 [DEBUG] src.luna_functions_handledispatch: bots_in_room = []
2025-01-08 01:05:29,458 [DEBUG] src.luna_functions_handledispatch: Final mentioned bots => []
2025-01-08 01:05:29,458 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 01:05:29,458 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:05:29,458 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 01:05:29,458 [INFO] src.luna_functions_handledispatch: @admin:localhost: @lunabot:localhost: are you there?
2025-01-08 01:05:29,458 [DEBUG] src.luna_functions_handledispatch: Extracting mentions in text_lower = @lunabot:localhost: are you there?
2025-01-08 01:05:29,458 [DEBUG] src.luna_functions_handledispatch: bots_in_room = []
2025-01-08 01:05:29,458 [DEBUG] src.luna_functions_handledispatch: Final mentioned bots => []
2025-01-08 01:05:29,458 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 01:05:29,459 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:05:29,459 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 01:05:29,459 [INFO] src.luna_functions_handledispatch: @admin:localhost: @lunabot:localost Are you therE?
2025-01-08 01:05:29,459 [DEBUG] src.luna_functions_handledispatch: Extracting mentions in text_lower = @lunabot:localost are you there?
2025-01-08 01:05:29,459 [DEBUG] src.luna_functions_handledispatch: bots_in_room = []
2025-01-08 01:05:29,459 [DEBUG] src.luna_functions_handledispatch: Final mentioned bots => []
2025-01-08 01:05:29,459 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 01:05:29,459 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:05:29,459 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 01:05:29,459 [INFO] src.luna_functions_handledispatch: @admin:localhost: lunabot: are you there?
2025-01-08 01:05:29,459 [DEBUG] src.luna_functions_handledispatch: Extracting mentions in text_lower = lunabot: are you there?
2025-01-08 01:05:29,459 [DEBUG] src.luna_functions_handledispatch: bots_in_room = []
2025-01-08 01:05:29,459 [DEBUG] src.luna_functions_handledispatch: Final mentioned bots => []
2025-01-08 01:05:29,459 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 01:06:32,074 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:06:32,074 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 01:06:32,075 [INFO] src.luna_functions_handledispatch: @admin:localhost: lunabot: @luna @lunabot:localhost @lunabot:localhost areyou tehere?
2025-01-08 01:06:32,075 [DEBUG] src.luna_functions_handledispatch: Extracting mentions in text_lower = lunabot: @luna @lunabot:localhost @lunabot:localhost areyou tehere?
2025-01-08 01:06:32,075 [DEBUG] src.luna_functions_handledispatch: bots_in_room = []
2025-01-08 01:06:32,075 [DEBUG] src.luna_functions_handledispatch: Final mentioned bots => []
2025-01-08 01:06:32,075 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 01:12:16,594 [INFO] src.console_functions: Console received 'exit' command; requesting shutdown.
2025-01-08 01:12:16,595 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 01:12:16,595 [ERROR] __main__: An unexpected exception occurred in main_logic: Event loop stopped before Future completed.
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 135, in luna
    loop.run_until_complete(main_logic())
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 718, in run_until_complete
    raise RuntimeError('Event loop stopped before Future completed.')
RuntimeError: Event loop stopped before Future completed.
2025-01-08 01:12:16,599 [DEBUG] __main__: Preparing to close the event loop.
2025-01-08 01:12:16,602 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-08 01:12:18,610 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-08 01:12:18,610 [DEBUG] __main__: Exiting configure_logging function.
2025-01-08 01:12:18,610 [DEBUG] __main__: Logging configuration complete.
2025-01-08 01:12:18,610 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-08 01:12:18,610 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 01:12:18,610 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-08 01:12:18,610 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-08 01:12:18,610 [DEBUG] __main__: Entering start_console_thread function.
2025-01-08 01:12:18,613 [INFO] __main__: Console thread started successfully.
2025-01-08 01:12:18,613 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-08 01:12:18,613 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-08 01:12:18,613 [INFO] __main__: Starting main_logic coroutine.
2025-01-08 01:12:18,613 [DEBUG] __main__: Entering main_logic function...
2025-01-08 01:12:18,613 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-08 01:12:18,615 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-08 01:12:18,616 [INFO] src.luna_functions: Using saved token for user @lunabot:localhost.
2025-01-08 01:12:18,616 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-08 01:12:18,620 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 01:12:18,661 [INFO] nio.client.base_client: New joined room !HPrbJYfQkoGnlztkrS:localhost
2025-01-08 01:12:18,661 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-08 01:12:18,661 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomNameEvent
2025-01-08 01:12:18,661 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomJoinRulesEvent
2025-01-08 01:12:18,661 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type PowerLevelsEvent
2025-01-08 01:12:18,661 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-08 01:12:18,661 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomCreateEvent
2025-01-08 01:12:18,661 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomGuestAccessEvent
2025-01-08 01:12:18,662 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 01:12:18,662 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 01:12:18,662 [INFO] src.luna_functions_handledispatch: @admin:localhost: are you there @luna?
2025-01-08 01:12:18,662 [DEBUG] src.luna_functions_handledispatch: Extracting mentions in text_lower = are you there @luna?
2025-01-08 01:12:18,662 [DEBUG] src.luna_functions_handledispatch: bots_in_room = []
2025-01-08 01:12:18,662 [DEBUG] src.luna_functions_handledispatch: Final mentioned bots => []
2025-01-08 01:12:18,662 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 01:12:18,662 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 01:12:18,662 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 01:12:18,662 [INFO] src.luna_functions_handledispatch: @lunabot:localhost: Yes, I'm here. How can I assist you today?
2025-01-08 01:12:18,662 [DEBUG] src.luna_functions_handledispatch: Extracting mentions in text_lower = yes, i'm here. how can i assist you today?
2025-01-08 01:12:18,662 [DEBUG] src.luna_functions_handledispatch: bots_in_room = []
2025-01-08 01:12:18,662 [DEBUG] src.luna_functions_handledispatch: Final mentioned bots => []
2025-01-08 01:12:18,662 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 01:12:18,662 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 01:12:18,662 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 01:12:18,662 [INFO] src.luna_functions_handledispatch: @lunabot:localhost: Yes, I'm here. How can I assist you today?
2025-01-08 01:12:18,662 [DEBUG] src.luna_functions_handledispatch: Extracting mentions in text_lower = yes, i'm here. how can i assist you today?
2025-01-08 01:12:18,662 [DEBUG] src.luna_functions_handledispatch: bots_in_room = []
2025-01-08 01:12:18,662 [DEBUG] src.luna_functions_handledispatch: Final mentioned bots => []
2025-01-08 01:12:18,662 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 01:12:18,662 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 01:12:18,662 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 01:12:18,662 [INFO] src.luna_functions_handledispatch: @lunabot:localhost: Yes, I'm here. How can I assist you today?
2025-01-08 01:12:18,662 [DEBUG] src.luna_functions_handledispatch: Extracting mentions in text_lower = yes, i'm here. how can i assist you today?
2025-01-08 01:12:18,662 [DEBUG] src.luna_functions_handledispatch: bots_in_room = []
2025-01-08 01:12:18,662 [DEBUG] src.luna_functions_handledispatch: Final mentioned bots => []
2025-01-08 01:12:18,662 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 01:12:18,662 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 01:12:18,662 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 01:12:18,662 [INFO] src.luna_functions_handledispatch: @lunabot:localhost: Yes, I'm here! How can I assist you today?
2025-01-08 01:12:18,662 [DEBUG] src.luna_functions_handledispatch: Extracting mentions in text_lower = yes, i'm here! how can i assist you today?
2025-01-08 01:12:18,662 [DEBUG] src.luna_functions_handledispatch: bots_in_room = []
2025-01-08 01:12:18,662 [DEBUG] src.luna_functions_handledispatch: Final mentioned bots => []
2025-01-08 01:12:18,662 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 01:12:18,662 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 01:12:18,662 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 01:12:18,662 [INFO] src.luna_functions_handledispatch: @lunabot:localhost: Yes, I'm here. How can I assist you today?
2025-01-08 01:12:18,662 [DEBUG] src.luna_functions_handledispatch: Extracting mentions in text_lower = yes, i'm here. how can i assist you today?
2025-01-08 01:12:18,662 [DEBUG] src.luna_functions_handledispatch: bots_in_room = []
2025-01-08 01:12:18,662 [DEBUG] src.luna_functions_handledispatch: Final mentioned bots => []
2025-01-08 01:12:18,662 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 01:12:18,662 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 01:12:18,662 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 01:12:18,662 [INFO] src.luna_functions_handledispatch: @lunabot:localhost: Yes, I'm here! How can I assist you today?
2025-01-08 01:12:18,662 [DEBUG] src.luna_functions_handledispatch: Extracting mentions in text_lower = yes, i'm here! how can i assist you today?
2025-01-08 01:12:18,662 [DEBUG] src.luna_functions_handledispatch: bots_in_room = []
2025-01-08 01:12:18,662 [DEBUG] src.luna_functions_handledispatch: Final mentioned bots => []
2025-01-08 01:12:18,662 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 01:12:18,662 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 01:12:18,662 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 01:12:18,662 [INFO] src.luna_functions_handledispatch: @lunabot:localhost: Yes, I'm here. How can I assist you today?
2025-01-08 01:12:18,662 [DEBUG] src.luna_functions_handledispatch: Extracting mentions in text_lower = yes, i'm here. how can i assist you today?
2025-01-08 01:12:18,662 [DEBUG] src.luna_functions_handledispatch: bots_in_room = []
2025-01-08 01:12:18,662 [DEBUG] src.luna_functions_handledispatch: Final mentioned bots => []
2025-01-08 01:12:18,662 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 01:12:18,662 [INFO] nio.client.base_client: New joined room !FkbKmoFPWsWYTwKnwg:localhost
2025-01-08 01:12:18,663 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type PowerLevelsEvent
2025-01-08 01:12:18,663 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-08 01:12:18,663 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomJoinRulesEvent
2025-01-08 01:12:18,663 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomGuestAccessEvent
2025-01-08 01:12:18,663 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-08 01:12:18,663 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomCreateEvent
2025-01-08 01:12:18,663 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:12:18,663 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 01:12:18,663 [INFO] src.luna_functions_handledispatch: @admin:localhost: hello
2025-01-08 01:12:18,663 [DEBUG] src.luna_functions_handledispatch: Extracting mentions in text_lower = hello
2025-01-08 01:12:18,663 [DEBUG] src.luna_functions_handledispatch: bots_in_room = ['@admin:localhost']
2025-01-08 01:12:18,663 [DEBUG] src.luna_functions_handledispatch: Checking bot_id=@admin:localhost, localpart=admin, pattern=(?:@?admin)(?:[:.,\s]|$)
2025-01-08 01:12:18,663 [DEBUG] src.luna_functions_handledispatch:  - No match for bot @admin:localhost
2025-01-08 01:12:18,663 [DEBUG] src.luna_functions_handledispatch: Final mentioned bots => []
2025-01-08 01:12:18,663 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 01:12:18,663 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:12:18,663 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 01:12:18,663 [INFO] src.luna_functions_handledispatch: @admin:localhost: Hello
2025-01-08 01:12:18,663 [DEBUG] src.luna_functions_handledispatch: Extracting mentions in text_lower = hello
2025-01-08 01:12:18,663 [DEBUG] src.luna_functions_handledispatch: bots_in_room = ['@admin:localhost']
2025-01-08 01:12:18,663 [DEBUG] src.luna_functions_handledispatch: Checking bot_id=@admin:localhost, localpart=admin, pattern=(?:@?admin)(?:[:.,\s]|$)
2025-01-08 01:12:18,663 [DEBUG] src.luna_functions_handledispatch:  - No match for bot @admin:localhost
2025-01-08 01:12:18,663 [DEBUG] src.luna_functions_handledispatch: Final mentioned bots => []
2025-01-08 01:12:18,663 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 01:12:18,663 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:12:18,663 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 01:12:18,663 [INFO] src.luna_functions_handledispatch: @admin:localhost: test
2025-01-08 01:12:18,663 [DEBUG] src.luna_functions_handledispatch: Extracting mentions in text_lower = test
2025-01-08 01:12:18,663 [DEBUG] src.luna_functions_handledispatch: bots_in_room = ['@admin:localhost']
2025-01-08 01:12:18,663 [DEBUG] src.luna_functions_handledispatch: Checking bot_id=@admin:localhost, localpart=admin, pattern=(?:@?admin)(?:[:.,\s]|$)
2025-01-08 01:12:18,663 [DEBUG] src.luna_functions_handledispatch:  - No match for bot @admin:localhost
2025-01-08 01:12:18,663 [DEBUG] src.luna_functions_handledispatch: Final mentioned bots => []
2025-01-08 01:12:18,663 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 01:12:18,663 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:12:18,663 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 01:12:18,663 [INFO] src.luna_functions_handledispatch: @admin:localhost: test
2025-01-08 01:12:18,663 [DEBUG] src.luna_functions_handledispatch: Extracting mentions in text_lower = test
2025-01-08 01:12:18,663 [DEBUG] src.luna_functions_handledispatch: bots_in_room = ['@admin:localhost']
2025-01-08 01:12:18,663 [DEBUG] src.luna_functions_handledispatch: Checking bot_id=@admin:localhost, localpart=admin, pattern=(?:@?admin)(?:[:.,\s]|$)
2025-01-08 01:12:18,663 [DEBUG] src.luna_functions_handledispatch:  - No match for bot @admin:localhost
2025-01-08 01:12:18,663 [DEBUG] src.luna_functions_handledispatch: Final mentioned bots => []
2025-01-08 01:12:18,663 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 01:12:18,663 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:12:18,663 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 01:12:18,663 [INFO] src.luna_functions_handledispatch: @admin:localhost: lunabot: are you there?
2025-01-08 01:12:18,663 [DEBUG] src.luna_functions_handledispatch: Extracting mentions in text_lower = lunabot: are you there?
2025-01-08 01:12:18,663 [DEBUG] src.luna_functions_handledispatch: bots_in_room = ['@admin:localhost']
2025-01-08 01:12:18,663 [DEBUG] src.luna_functions_handledispatch: Checking bot_id=@admin:localhost, localpart=admin, pattern=(?:@?admin)(?:[:.,\s]|$)
2025-01-08 01:12:18,664 [DEBUG] src.luna_functions_handledispatch:  - No match for bot @admin:localhost
2025-01-08 01:12:18,664 [DEBUG] src.luna_functions_handledispatch: Final mentioned bots => []
2025-01-08 01:12:18,664 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 01:12:18,664 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:12:18,664 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 01:12:18,664 [INFO] src.luna_functions_handledispatch: @admin:localhost: lunabot: are you there?
2025-01-08 01:12:18,664 [DEBUG] src.luna_functions_handledispatch: Extracting mentions in text_lower = lunabot: are you there?
2025-01-08 01:12:18,664 [DEBUG] src.luna_functions_handledispatch: bots_in_room = ['@admin:localhost']
2025-01-08 01:12:18,664 [DEBUG] src.luna_functions_handledispatch: Checking bot_id=@admin:localhost, localpart=admin, pattern=(?:@?admin)(?:[:.,\s]|$)
2025-01-08 01:12:18,664 [DEBUG] src.luna_functions_handledispatch:  - No match for bot @admin:localhost
2025-01-08 01:12:18,664 [DEBUG] src.luna_functions_handledispatch: Final mentioned bots => []
2025-01-08 01:12:18,664 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 01:12:18,664 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:12:18,664 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 01:12:18,664 [INFO] src.luna_functions_handledispatch: @admin:localhost: @lunabot:localhost: are you there?
2025-01-08 01:12:18,664 [DEBUG] src.luna_functions_handledispatch: Extracting mentions in text_lower = @lunabot:localhost: are you there?
2025-01-08 01:12:18,664 [DEBUG] src.luna_functions_handledispatch: bots_in_room = ['@admin:localhost']
2025-01-08 01:12:18,664 [DEBUG] src.luna_functions_handledispatch: Checking bot_id=@admin:localhost, localpart=admin, pattern=(?:@?admin)(?:[:.,\s]|$)
2025-01-08 01:12:18,664 [DEBUG] src.luna_functions_handledispatch:  - No match for bot @admin:localhost
2025-01-08 01:12:18,664 [DEBUG] src.luna_functions_handledispatch: Final mentioned bots => []
2025-01-08 01:12:18,664 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 01:12:18,664 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:12:18,664 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 01:12:18,664 [INFO] src.luna_functions_handledispatch: @admin:localhost: @lunabot:localost Are you therE?
2025-01-08 01:12:18,664 [DEBUG] src.luna_functions_handledispatch: Extracting mentions in text_lower = @lunabot:localost are you there?
2025-01-08 01:12:18,664 [DEBUG] src.luna_functions_handledispatch: bots_in_room = ['@admin:localhost']
2025-01-08 01:12:18,664 [DEBUG] src.luna_functions_handledispatch: Checking bot_id=@admin:localhost, localpart=admin, pattern=(?:@?admin)(?:[:.,\s]|$)
2025-01-08 01:12:18,664 [DEBUG] src.luna_functions_handledispatch:  - No match for bot @admin:localhost
2025-01-08 01:12:18,664 [DEBUG] src.luna_functions_handledispatch: Final mentioned bots => []
2025-01-08 01:12:18,664 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 01:12:18,664 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:12:18,664 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 01:12:18,664 [INFO] src.luna_functions_handledispatch: @admin:localhost: lunabot: are you there?
2025-01-08 01:12:18,664 [DEBUG] src.luna_functions_handledispatch: Extracting mentions in text_lower = lunabot: are you there?
2025-01-08 01:12:18,664 [DEBUG] src.luna_functions_handledispatch: bots_in_room = ['@admin:localhost']
2025-01-08 01:12:18,664 [DEBUG] src.luna_functions_handledispatch: Checking bot_id=@admin:localhost, localpart=admin, pattern=(?:@?admin)(?:[:.,\s]|$)
2025-01-08 01:12:18,664 [DEBUG] src.luna_functions_handledispatch:  - No match for bot @admin:localhost
2025-01-08 01:12:18,664 [DEBUG] src.luna_functions_handledispatch: Final mentioned bots => []
2025-01-08 01:12:18,664 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 01:12:18,664 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:12:18,664 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 01:12:18,664 [INFO] src.luna_functions_handledispatch: @admin:localhost: lunabot: @luna @lunabot:localhost @lunabot:localhost areyou tehere?
2025-01-08 01:12:18,664 [DEBUG] src.luna_functions_handledispatch: Extracting mentions in text_lower = lunabot: @luna @lunabot:localhost @lunabot:localhost areyou tehere?
2025-01-08 01:12:18,664 [DEBUG] src.luna_functions_handledispatch: bots_in_room = ['@admin:localhost']
2025-01-08 01:12:18,664 [DEBUG] src.luna_functions_handledispatch: Checking bot_id=@admin:localhost, localpart=admin, pattern=(?:@?admin)(?:[:.,\s]|$)
2025-01-08 01:12:18,664 [DEBUG] src.luna_functions_handledispatch:  - No match for bot @admin:localhost
2025-01-08 01:12:18,664 [DEBUG] src.luna_functions_handledispatch: Final mentioned bots => []
2025-01-08 01:12:18,664 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 01:12:56,498 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:12:56,499 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 01:12:56,499 [INFO] src.luna_functions_handledispatch: @admin:localhost: @luna @lunabot:localhost @lunabot:localhost areyou tehere? lunabot  test message please respond
2025-01-08 01:12:56,499 [DEBUG] src.luna_functions_handledispatch: Extracting mentions in text_lower = @luna @lunabot:localhost @lunabot:localhost areyou tehere? lunabot  test message please respond
2025-01-08 01:12:56,499 [DEBUG] src.luna_functions_handledispatch: bots_in_room = ['@admin:localhost']
2025-01-08 01:12:56,499 [DEBUG] src.luna_functions_handledispatch: Checking bot_id=@admin:localhost, localpart=admin, pattern=(?:@?admin)(?:[:.,\s]|$)
2025-01-08 01:12:56,500 [DEBUG] src.luna_functions_handledispatch:  - No match for bot @admin:localhost
2025-01-08 01:12:56,500 [DEBUG] src.luna_functions_handledispatch: Final mentioned bots => []
2025-01-08 01:12:56,500 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 01:17:12,110 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:17:12,110 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 01:17:12,110 [INFO] src.luna_functions_handledispatch: @admin:localhost: test
2025-01-08 01:17:12,110 [DEBUG] src.luna_functions_handledispatch: Extracting mentions in text_lower = test
2025-01-08 01:17:12,110 [DEBUG] src.luna_functions_handledispatch: bots_in_room = ['@admin:localhost']
2025-01-08 01:17:12,110 [DEBUG] src.luna_functions_handledispatch: Checking bot_id=@admin:localhost, localpart=admin, pattern=(?:@?admin)(?:[:.,\s]|$)
2025-01-08 01:17:12,110 [DEBUG] src.luna_functions_handledispatch:  - No match for bot @admin:localhost
2025-01-08 01:17:12,110 [DEBUG] src.luna_functions_handledispatch: Final mentioned bots => []
2025-01-08 01:17:12,110 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 01:17:15,728 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:17:15,728 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 01:17:15,728 [INFO] src.luna_functions_handledispatch: @admin:localhost: test lunabot 
2025-01-08 01:17:15,728 [DEBUG] src.luna_functions_handledispatch: Extracting mentions in text_lower = test lunabot 
2025-01-08 01:17:15,728 [DEBUG] src.luna_functions_handledispatch: bots_in_room = ['@admin:localhost']
2025-01-08 01:17:15,728 [DEBUG] src.luna_functions_handledispatch: Checking bot_id=@admin:localhost, localpart=admin, pattern=(?:@?admin)(?:[:.,\s]|$)
2025-01-08 01:17:15,728 [DEBUG] src.luna_functions_handledispatch:  - No match for bot @admin:localhost
2025-01-08 01:17:15,728 [DEBUG] src.luna_functions_handledispatch: Final mentioned bots => []
2025-01-08 01:17:15,729 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 01:17:31,020 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:17:31,020 [INFO] src.luna_functions_handledispatch: Handling an on_room_message.
2025-01-08 01:17:31,020 [INFO] src.luna_functions_handledispatch: @admin:localhost: test lunabot @lunabot:localhost are you there?
2025-01-08 01:17:31,020 [DEBUG] src.luna_functions_handledispatch: Extracting mentions in text_lower = test lunabot @lunabot:localhost are you there?
2025-01-08 01:17:31,020 [DEBUG] src.luna_functions_handledispatch: bots_in_room = ['@admin:localhost']
2025-01-08 01:17:31,020 [DEBUG] src.luna_functions_handledispatch: Checking bot_id=@admin:localhost, localpart=admin, pattern=(?:@?admin)(?:[:.,\s]|$)
2025-01-08 01:17:31,020 [DEBUG] src.luna_functions_handledispatch:  - No match for bot @admin:localhost
2025-01-08 01:17:31,020 [DEBUG] src.luna_functions_handledispatch: Final mentioned bots => []
2025-01-08 01:17:31,020 [DEBUG] src.luna_functions_handledispatch: No bots mentioned in user message, doing nothing.
2025-01-08 01:21:13,884 [INFO] src.console_functions: Console received 'exit' command; requesting shutdown.
2025-01-08 01:21:13,886 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 01:21:13,886 [ERROR] __main__: An unexpected exception occurred in main_logic: Event loop stopped before Future completed.
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 135, in luna
    loop.run_until_complete(main_logic())
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 718, in run_until_complete
    raise RuntimeError('Event loop stopped before Future completed.')
RuntimeError: Event loop stopped before Future completed.
2025-01-08 01:21:13,891 [DEBUG] __main__: Preparing to close the event loop.
2025-01-08 01:21:13,892 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-08 01:21:15,847 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-08 01:21:15,847 [DEBUG] __main__: Exiting configure_logging function.
2025-01-08 01:21:15,847 [DEBUG] __main__: Logging configuration complete.
2025-01-08 01:21:15,847 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-08 01:21:15,847 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 01:21:15,847 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-08 01:21:15,847 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-08 01:21:15,847 [DEBUG] __main__: Entering start_console_thread function.
2025-01-08 01:21:15,850 [INFO] __main__: Console thread started successfully.
2025-01-08 01:21:15,850 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-08 01:21:15,850 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-08 01:21:15,850 [INFO] __main__: Starting main_logic coroutine.
2025-01-08 01:21:15,850 [DEBUG] __main__: Entering main_logic function...
2025-01-08 01:21:15,850 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-08 01:21:15,852 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-08 01:21:15,852 [INFO] src.luna_functions: Using saved token for user @lunabot:localhost.
2025-01-08 01:21:15,852 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-08 01:21:15,856 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 01:21:15,885 [INFO] nio.client.base_client: New joined room !HPrbJYfQkoGnlztkrS:localhost
2025-01-08 01:21:15,885 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-08 01:21:15,885 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomNameEvent
2025-01-08 01:21:15,885 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomJoinRulesEvent
2025-01-08 01:21:15,885 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type PowerLevelsEvent
2025-01-08 01:21:15,885 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-08 01:21:15,885 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomCreateEvent
2025-01-08 01:21:15,885 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomGuestAccessEvent
2025-01-08 01:21:15,885 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 01:21:15,885 [INFO] src.luna_functions_handledispatch: Handling an on_room_message (with HTML mention check).
2025-01-08 01:21:15,885 [DEBUG] src.luna_functions_handledispatch: Plain user_message => are you there @luna?
2025-01-08 01:21:15,885 [DEBUG] src.luna_functions_handledispatch: content['format'] => None
2025-01-08 01:21:15,885 [DEBUG] src.luna_functions_handledispatch: content['formatted_body'] => 
2025-01-08 01:21:15,885 [DEBUG] src.luna_functions_handledispatch: No HTML-based or text-based mentions found, doing nothing.
2025-01-08 01:21:15,885 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 01:21:15,885 [INFO] src.luna_functions_handledispatch: Handling an on_room_message (with HTML mention check).
2025-01-08 01:21:15,885 [DEBUG] src.luna_functions_handledispatch: Plain user_message => Yes, I'm here. How can I assist you today?
2025-01-08 01:21:15,885 [DEBUG] src.luna_functions_handledispatch: content['format'] => None
2025-01-08 01:21:15,885 [DEBUG] src.luna_functions_handledispatch: content['formatted_body'] => 
2025-01-08 01:21:15,885 [DEBUG] src.luna_functions_handledispatch: No HTML-based or text-based mentions found, doing nothing.
2025-01-08 01:21:15,885 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 01:21:15,885 [INFO] src.luna_functions_handledispatch: Handling an on_room_message (with HTML mention check).
2025-01-08 01:21:15,885 [DEBUG] src.luna_functions_handledispatch: Plain user_message => Yes, I'm here. How can I assist you today?
2025-01-08 01:21:15,885 [DEBUG] src.luna_functions_handledispatch: content['format'] => None
2025-01-08 01:21:15,885 [DEBUG] src.luna_functions_handledispatch: content['formatted_body'] => 
2025-01-08 01:21:15,885 [DEBUG] src.luna_functions_handledispatch: No HTML-based or text-based mentions found, doing nothing.
2025-01-08 01:21:15,885 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 01:21:15,885 [INFO] src.luna_functions_handledispatch: Handling an on_room_message (with HTML mention check).
2025-01-08 01:21:15,885 [DEBUG] src.luna_functions_handledispatch: Plain user_message => Yes, I'm here. How can I assist you today?
2025-01-08 01:21:15,885 [DEBUG] src.luna_functions_handledispatch: content['format'] => None
2025-01-08 01:21:15,885 [DEBUG] src.luna_functions_handledispatch: content['formatted_body'] => 
2025-01-08 01:21:15,885 [DEBUG] src.luna_functions_handledispatch: No HTML-based or text-based mentions found, doing nothing.
2025-01-08 01:21:15,885 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 01:21:15,885 [INFO] src.luna_functions_handledispatch: Handling an on_room_message (with HTML mention check).
2025-01-08 01:21:15,885 [DEBUG] src.luna_functions_handledispatch: Plain user_message => Yes, I'm here! How can I assist you today?
2025-01-08 01:21:15,885 [DEBUG] src.luna_functions_handledispatch: content['format'] => None
2025-01-08 01:21:15,885 [DEBUG] src.luna_functions_handledispatch: content['formatted_body'] => 
2025-01-08 01:21:15,885 [DEBUG] src.luna_functions_handledispatch: No HTML-based or text-based mentions found, doing nothing.
2025-01-08 01:21:15,885 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 01:21:15,885 [INFO] src.luna_functions_handledispatch: Handling an on_room_message (with HTML mention check).
2025-01-08 01:21:15,885 [DEBUG] src.luna_functions_handledispatch: Plain user_message => Yes, I'm here. How can I assist you today?
2025-01-08 01:21:15,885 [DEBUG] src.luna_functions_handledispatch: content['format'] => None
2025-01-08 01:21:15,885 [DEBUG] src.luna_functions_handledispatch: content['formatted_body'] => 
2025-01-08 01:21:15,885 [DEBUG] src.luna_functions_handledispatch: No HTML-based or text-based mentions found, doing nothing.
2025-01-08 01:21:15,885 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 01:21:15,885 [INFO] src.luna_functions_handledispatch: Handling an on_room_message (with HTML mention check).
2025-01-08 01:21:15,886 [DEBUG] src.luna_functions_handledispatch: Plain user_message => Yes, I'm here! How can I assist you today?
2025-01-08 01:21:15,886 [DEBUG] src.luna_functions_handledispatch: content['format'] => None
2025-01-08 01:21:15,886 [DEBUG] src.luna_functions_handledispatch: content['formatted_body'] => 
2025-01-08 01:21:15,886 [DEBUG] src.luna_functions_handledispatch: No HTML-based or text-based mentions found, doing nothing.
2025-01-08 01:21:15,886 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 01:21:15,886 [INFO] src.luna_functions_handledispatch: Handling an on_room_message (with HTML mention check).
2025-01-08 01:21:15,886 [DEBUG] src.luna_functions_handledispatch: Plain user_message => Yes, I'm here. How can I assist you today?
2025-01-08 01:21:15,886 [DEBUG] src.luna_functions_handledispatch: content['format'] => None
2025-01-08 01:21:15,886 [DEBUG] src.luna_functions_handledispatch: content['formatted_body'] => 
2025-01-08 01:21:15,886 [DEBUG] src.luna_functions_handledispatch: No HTML-based or text-based mentions found, doing nothing.
2025-01-08 01:21:15,886 [INFO] nio.client.base_client: New joined room !FkbKmoFPWsWYTwKnwg:localhost
2025-01-08 01:21:15,886 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type PowerLevelsEvent
2025-01-08 01:21:15,886 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-08 01:21:15,886 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomJoinRulesEvent
2025-01-08 01:21:15,886 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomGuestAccessEvent
2025-01-08 01:21:15,886 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-08 01:21:15,886 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomCreateEvent
2025-01-08 01:21:15,886 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:21:15,886 [INFO] src.luna_functions_handledispatch: Handling an on_room_message (with HTML mention check).
2025-01-08 01:21:15,886 [DEBUG] src.luna_functions_handledispatch: Plain user_message => lunabot: are you there?
2025-01-08 01:21:15,886 [DEBUG] src.luna_functions_handledispatch: content['format'] => org.matrix.custom.html
2025-01-08 01:21:15,886 [DEBUG] src.luna_functions_handledispatch: content['formatted_body'] => <a href="https://matrix.to/#/@lunabot:localhost">lunabot</a>: are you there?
2025-01-08 01:21:15,886 [INFO] src.luna_functions_handledispatch: HTML-based mentions => []
2025-01-08 01:21:15,886 [DEBUG] src.luna_functions_handledispatch: No HTML-based or text-based mentions found, doing nothing.
2025-01-08 01:21:15,886 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:21:15,886 [INFO] src.luna_functions_handledispatch: Handling an on_room_message (with HTML mention check).
2025-01-08 01:21:15,886 [DEBUG] src.luna_functions_handledispatch: Plain user_message => lunabot: are you there?
2025-01-08 01:21:15,886 [DEBUG] src.luna_functions_handledispatch: content['format'] => org.matrix.custom.html
2025-01-08 01:21:15,886 [DEBUG] src.luna_functions_handledispatch: content['formatted_body'] => <a href="https://matrix.to/#/@lunabot:localhost">lunabot</a>: are you there?
2025-01-08 01:21:15,886 [INFO] src.luna_functions_handledispatch: HTML-based mentions => []
2025-01-08 01:21:15,886 [DEBUG] src.luna_functions_handledispatch: No HTML-based or text-based mentions found, doing nothing.
2025-01-08 01:21:15,886 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:21:15,886 [INFO] src.luna_functions_handledispatch: Handling an on_room_message (with HTML mention check).
2025-01-08 01:21:15,886 [DEBUG] src.luna_functions_handledispatch: Plain user_message => @lunabot:localhost: are you there?
2025-01-08 01:21:15,886 [DEBUG] src.luna_functions_handledispatch: content['format'] => None
2025-01-08 01:21:15,886 [DEBUG] src.luna_functions_handledispatch: content['formatted_body'] => 
2025-01-08 01:21:15,886 [DEBUG] src.luna_functions_handledispatch: No HTML-based or text-based mentions found, doing nothing.
2025-01-08 01:21:15,886 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:21:15,886 [INFO] src.luna_functions_handledispatch: Handling an on_room_message (with HTML mention check).
2025-01-08 01:21:15,886 [DEBUG] src.luna_functions_handledispatch: Plain user_message => @lunabot:localost Are you therE?
2025-01-08 01:21:15,886 [DEBUG] src.luna_functions_handledispatch: content['format'] => None
2025-01-08 01:21:15,886 [DEBUG] src.luna_functions_handledispatch: content['formatted_body'] => 
2025-01-08 01:21:15,886 [DEBUG] src.luna_functions_handledispatch: No HTML-based or text-based mentions found, doing nothing.
2025-01-08 01:21:15,886 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:21:15,886 [INFO] src.luna_functions_handledispatch: Handling an on_room_message (with HTML mention check).
2025-01-08 01:21:15,886 [DEBUG] src.luna_functions_handledispatch: Plain user_message => lunabot: are you there?
2025-01-08 01:21:15,886 [DEBUG] src.luna_functions_handledispatch: content['format'] => org.matrix.custom.html
2025-01-08 01:21:15,886 [DEBUG] src.luna_functions_handledispatch: content['formatted_body'] => <a href="https://matrix.to/#/@lunabot:localhost">lunabot</a>: are you there?
2025-01-08 01:21:15,886 [INFO] src.luna_functions_handledispatch: HTML-based mentions => []
2025-01-08 01:21:15,886 [DEBUG] src.luna_functions_handledispatch: No HTML-based or text-based mentions found, doing nothing.
2025-01-08 01:21:15,886 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:21:15,886 [INFO] src.luna_functions_handledispatch: Handling an on_room_message (with HTML mention check).
2025-01-08 01:21:15,886 [DEBUG] src.luna_functions_handledispatch: Plain user_message => lunabot: @luna @lunabot:localhost @lunabot:localhost areyou tehere?
2025-01-08 01:21:15,886 [DEBUG] src.luna_functions_handledispatch: content['format'] => org.matrix.custom.html
2025-01-08 01:21:15,886 [DEBUG] src.luna_functions_handledispatch: content['formatted_body'] => <a href="https://matrix.to/#/@lunabot:localhost">lunabot</a>: @luna @lunabot:localhost @lunabot:localhost areyou tehere?
2025-01-08 01:21:15,886 [INFO] src.luna_functions_handledispatch: HTML-based mentions => []
2025-01-08 01:21:15,886 [DEBUG] src.luna_functions_handledispatch: No HTML-based or text-based mentions found, doing nothing.
2025-01-08 01:21:15,887 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:21:15,887 [INFO] src.luna_functions_handledispatch: Handling an on_room_message (with HTML mention check).
2025-01-08 01:21:15,887 [DEBUG] src.luna_functions_handledispatch: Plain user_message => @luna @lunabot:localhost @lunabot:localhost areyou tehere? lunabot  test message please respond
2025-01-08 01:21:15,887 [DEBUG] src.luna_functions_handledispatch: content['format'] => org.matrix.custom.html
2025-01-08 01:21:15,887 [DEBUG] src.luna_functions_handledispatch: content['formatted_body'] => @luna @lunabot:localhost @lunabot:localhost areyou tehere? <a href="https://matrix.to/#/@lunabot:localhost">lunabot</a>  test message please respond
2025-01-08 01:21:15,887 [INFO] src.luna_functions_handledispatch: HTML-based mentions => []
2025-01-08 01:21:15,887 [DEBUG] src.luna_functions_handledispatch: No HTML-based or text-based mentions found, doing nothing.
2025-01-08 01:21:15,887 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:21:15,887 [INFO] src.luna_functions_handledispatch: Handling an on_room_message (with HTML mention check).
2025-01-08 01:21:15,887 [DEBUG] src.luna_functions_handledispatch: Plain user_message => test
2025-01-08 01:21:15,887 [DEBUG] src.luna_functions_handledispatch: content['format'] => None
2025-01-08 01:21:15,887 [DEBUG] src.luna_functions_handledispatch: content['formatted_body'] => 
2025-01-08 01:21:15,887 [DEBUG] src.luna_functions_handledispatch: No HTML-based or text-based mentions found, doing nothing.
2025-01-08 01:21:15,887 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:21:15,887 [INFO] src.luna_functions_handledispatch: Handling an on_room_message (with HTML mention check).
2025-01-08 01:21:15,887 [DEBUG] src.luna_functions_handledispatch: Plain user_message => test lunabot 
2025-01-08 01:21:15,887 [DEBUG] src.luna_functions_handledispatch: content['format'] => org.matrix.custom.html
2025-01-08 01:21:15,887 [DEBUG] src.luna_functions_handledispatch: content['formatted_body'] => test <a href="https://matrix.to/#/@lunabot:localhost">lunabot</a>
2025-01-08 01:21:15,887 [INFO] src.luna_functions_handledispatch: HTML-based mentions => []
2025-01-08 01:21:15,887 [DEBUG] src.luna_functions_handledispatch: No HTML-based or text-based mentions found, doing nothing.
2025-01-08 01:21:15,887 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:21:15,887 [INFO] src.luna_functions_handledispatch: Handling an on_room_message (with HTML mention check).
2025-01-08 01:21:15,887 [DEBUG] src.luna_functions_handledispatch: Plain user_message => test lunabot @lunabot:localhost are you there?
2025-01-08 01:21:15,887 [DEBUG] src.luna_functions_handledispatch: content['format'] => org.matrix.custom.html
2025-01-08 01:21:15,887 [DEBUG] src.luna_functions_handledispatch: content['formatted_body'] => test <a href="https://matrix.to/#/@lunabot:localhost">lunabot</a> @lunabot:localhost are you there?
2025-01-08 01:21:15,887 [INFO] src.luna_functions_handledispatch: HTML-based mentions => []
2025-01-08 01:21:15,887 [DEBUG] src.luna_functions_handledispatch: No HTML-based or text-based mentions found, doing nothing.
2025-01-08 01:21:31,511 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:21:31,511 [INFO] src.luna_functions_handledispatch: Handling an on_room_message (with HTML mention check).
2025-01-08 01:21:31,511 [DEBUG] src.luna_functions_handledispatch: Plain user_message => lunabot: 
2025-01-08 01:21:31,511 [DEBUG] src.luna_functions_handledispatch: content['format'] => org.matrix.custom.html
2025-01-08 01:21:31,512 [DEBUG] src.luna_functions_handledispatch: content['formatted_body'] => <a href="https://matrix.to/#/@lunabot:localhost">lunabot</a>:
2025-01-08 01:21:31,512 [INFO] src.luna_functions_handledispatch: HTML-based mentions => []
2025-01-08 01:21:31,512 [DEBUG] src.luna_functions_handledispatch: No HTML-based or text-based mentions found, doing nothing.
2025-01-08 01:21:36,356 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:21:36,356 [INFO] src.luna_functions_handledispatch: Handling an on_room_message (with HTML mention check).
2025-01-08 01:21:36,356 [DEBUG] src.luna_functions_handledispatch: Plain user_message => lunabot: respont?
2025-01-08 01:21:36,356 [DEBUG] src.luna_functions_handledispatch: content['format'] => org.matrix.custom.html
2025-01-08 01:21:36,356 [DEBUG] src.luna_functions_handledispatch: content['formatted_body'] => <a href="https://matrix.to/#/@lunabot:localhost">lunabot</a>: respont?
2025-01-08 01:21:36,356 [INFO] src.luna_functions_handledispatch: HTML-based mentions => []
2025-01-08 01:21:36,356 [DEBUG] src.luna_functions_handledispatch: No HTML-based or text-based mentions found, doing nothing.
2025-01-08 01:21:52,087 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:21:52,087 [INFO] src.luna_functions_handledispatch: Handling an on_room_message (with HTML mention check).
2025-01-08 01:21:52,087 [DEBUG] src.luna_functions_handledispatch: Plain user_message => @lunabot:localhost whwa'ts up
2025-01-08 01:21:52,087 [DEBUG] src.luna_functions_handledispatch: content['format'] => None
2025-01-08 01:21:52,088 [DEBUG] src.luna_functions_handledispatch: content['formatted_body'] => 
2025-01-08 01:21:52,088 [DEBUG] src.luna_functions_handledispatch: No HTML-based or text-based mentions found, doing nothing.
2025-01-08 01:24:55,999 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:24:56,000 [INFO] src.luna_functions_handledispatch: Handling an on_room_message (with HTML mention check).
2025-01-08 01:24:56,000 [DEBUG] src.luna_functions_handledispatch: Plain user_message => luna are you there?
2025-01-08 01:24:56,000 [DEBUG] src.luna_functions_handledispatch: content['format'] => None
2025-01-08 01:24:56,000 [DEBUG] src.luna_functions_handledispatch: content['formatted_body'] => 
2025-01-08 01:24:56,000 [DEBUG] src.luna_functions_handledispatch: No HTML-based or text-based mentions found, doing nothing.
2025-01-08 01:26:50,451 [INFO] src.console_functions: Console received 'exit' command; requesting shutdown.
2025-01-08 01:26:50,453 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 01:26:50,453 [ERROR] __main__: An unexpected exception occurred in main_logic: Event loop stopped before Future completed.
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 135, in luna
    loop.run_until_complete(main_logic())
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 718, in run_until_complete
    raise RuntimeError('Event loop stopped before Future completed.')
RuntimeError: Event loop stopped before Future completed.
2025-01-08 01:26:50,462 [DEBUG] __main__: Preparing to close the event loop.
2025-01-08 01:26:50,462 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-08 01:26:52,480 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-08 01:26:52,480 [DEBUG] __main__: Exiting configure_logging function.
2025-01-08 01:26:52,480 [DEBUG] __main__: Logging configuration complete.
2025-01-08 01:26:52,480 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-08 01:26:52,481 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 01:26:52,481 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-08 01:26:52,481 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-08 01:26:52,481 [DEBUG] __main__: Entering start_console_thread function.
2025-01-08 01:26:52,483 [INFO] __main__: Console thread started successfully.
2025-01-08 01:26:52,483 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-08 01:26:52,483 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-08 01:26:52,483 [INFO] __main__: Starting main_logic coroutine.
2025-01-08 01:26:52,483 [DEBUG] __main__: Entering main_logic function...
2025-01-08 01:26:52,483 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-08 01:26:52,485 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-08 01:26:52,485 [INFO] src.luna_functions: Using saved token for user @lunabot:localhost.
2025-01-08 01:26:52,485 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-08 01:26:52,489 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 01:26:52,517 [INFO] nio.client.base_client: New joined room !HPrbJYfQkoGnlztkrS:localhost
2025-01-08 01:26:52,517 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-08 01:26:52,517 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomNameEvent
2025-01-08 01:26:52,517 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomJoinRulesEvent
2025-01-08 01:26:52,517 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type PowerLevelsEvent
2025-01-08 01:26:52,517 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-08 01:26:52,517 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomCreateEvent
2025-01-08 01:26:52,517 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomGuestAccessEvent
2025-01-08 01:26:52,517 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 01:26:52,517 [INFO] src.luna_functions_handledispatch: Handling an on_room_message with positive-signal approach.
2025-01-08 01:26:52,517 [INFO] src.luna_functions_handledispatch: Full event => @admin:localhost: are you there @luna?
2025-01-08 01:26:52,517 [DEBUG] src.luna_functions_handledispatch: User message => 'are you there @luna?' in room => !HPrbJYfQkoGnlztkrS:localhost
2025-01-08 01:26:52,517 [INFO] src.luna_functions_handledispatch: [Dispatch] Found mention(s) => FORCED_SIMULATION
2025-01-08 01:26:52,517 [INFO] src.luna_functions_handledispatch: Because we forced mention detection, we can confirm the pipeline is firing.
2025-01-08 01:26:52,517 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 01:26:52,517 [INFO] src.luna_functions_handledispatch: Handling an on_room_message with positive-signal approach.
2025-01-08 01:26:52,517 [INFO] src.luna_functions_handledispatch: Full event => @lunabot:localhost: Yes, I'm here. How can I assist you today?
2025-01-08 01:26:52,517 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here. How can I assist you today?' in room => !HPrbJYfQkoGnlztkrS:localhost
2025-01-08 01:26:52,517 [INFO] src.luna_functions_handledispatch: [Dispatch] Found mention(s) => FORCED_SIMULATION
2025-01-08 01:26:52,517 [INFO] src.luna_functions_handledispatch: Because we forced mention detection, we can confirm the pipeline is firing.
2025-01-08 01:26:52,517 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 01:26:52,517 [INFO] src.luna_functions_handledispatch: Handling an on_room_message with positive-signal approach.
2025-01-08 01:26:52,517 [INFO] src.luna_functions_handledispatch: Full event => @lunabot:localhost: Yes, I'm here. How can I assist you today?
2025-01-08 01:26:52,517 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here. How can I assist you today?' in room => !HPrbJYfQkoGnlztkrS:localhost
2025-01-08 01:26:52,517 [INFO] src.luna_functions_handledispatch: [Dispatch] Found mention(s) => FORCED_SIMULATION
2025-01-08 01:26:52,517 [INFO] src.luna_functions_handledispatch: Because we forced mention detection, we can confirm the pipeline is firing.
2025-01-08 01:26:52,517 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 01:26:52,517 [INFO] src.luna_functions_handledispatch: Handling an on_room_message with positive-signal approach.
2025-01-08 01:26:52,517 [INFO] src.luna_functions_handledispatch: Full event => @lunabot:localhost: Yes, I'm here. How can I assist you today?
2025-01-08 01:26:52,517 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here. How can I assist you today?' in room => !HPrbJYfQkoGnlztkrS:localhost
2025-01-08 01:26:52,517 [INFO] src.luna_functions_handledispatch: [Dispatch] Found mention(s) => FORCED_SIMULATION
2025-01-08 01:26:52,517 [INFO] src.luna_functions_handledispatch: Because we forced mention detection, we can confirm the pipeline is firing.
2025-01-08 01:26:52,517 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 01:26:52,518 [INFO] src.luna_functions_handledispatch: Handling an on_room_message with positive-signal approach.
2025-01-08 01:26:52,518 [INFO] src.luna_functions_handledispatch: Full event => @lunabot:localhost: Yes, I'm here! How can I assist you today?
2025-01-08 01:26:52,518 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here! How can I assist you today?' in room => !HPrbJYfQkoGnlztkrS:localhost
2025-01-08 01:26:52,518 [INFO] src.luna_functions_handledispatch: [Dispatch] Found mention(s) => FORCED_SIMULATION
2025-01-08 01:26:52,518 [INFO] src.luna_functions_handledispatch: Because we forced mention detection, we can confirm the pipeline is firing.
2025-01-08 01:26:52,518 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 01:26:52,518 [INFO] src.luna_functions_handledispatch: Handling an on_room_message with positive-signal approach.
2025-01-08 01:26:52,518 [INFO] src.luna_functions_handledispatch: Full event => @lunabot:localhost: Yes, I'm here. How can I assist you today?
2025-01-08 01:26:52,518 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here. How can I assist you today?' in room => !HPrbJYfQkoGnlztkrS:localhost
2025-01-08 01:26:52,518 [INFO] src.luna_functions_handledispatch: [Dispatch] Found mention(s) => FORCED_SIMULATION
2025-01-08 01:26:52,518 [INFO] src.luna_functions_handledispatch: Because we forced mention detection, we can confirm the pipeline is firing.
2025-01-08 01:26:52,518 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 01:26:52,518 [INFO] src.luna_functions_handledispatch: Handling an on_room_message with positive-signal approach.
2025-01-08 01:26:52,518 [INFO] src.luna_functions_handledispatch: Full event => @lunabot:localhost: Yes, I'm here! How can I assist you today?
2025-01-08 01:26:52,518 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here! How can I assist you today?' in room => !HPrbJYfQkoGnlztkrS:localhost
2025-01-08 01:26:52,518 [INFO] src.luna_functions_handledispatch: [Dispatch] Found mention(s) => FORCED_SIMULATION
2025-01-08 01:26:52,518 [INFO] src.luna_functions_handledispatch: Because we forced mention detection, we can confirm the pipeline is firing.
2025-01-08 01:26:52,518 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 01:26:52,518 [INFO] src.luna_functions_handledispatch: Handling an on_room_message with positive-signal approach.
2025-01-08 01:26:52,518 [INFO] src.luna_functions_handledispatch: Full event => @lunabot:localhost: Yes, I'm here. How can I assist you today?
2025-01-08 01:26:52,518 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here. How can I assist you today?' in room => !HPrbJYfQkoGnlztkrS:localhost
2025-01-08 01:26:52,518 [INFO] src.luna_functions_handledispatch: [Dispatch] Found mention(s) => FORCED_SIMULATION
2025-01-08 01:26:52,518 [INFO] src.luna_functions_handledispatch: Because we forced mention detection, we can confirm the pipeline is firing.
2025-01-08 01:26:52,518 [INFO] nio.client.base_client: New joined room !FkbKmoFPWsWYTwKnwg:localhost
2025-01-08 01:26:52,518 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type PowerLevelsEvent
2025-01-08 01:26:52,518 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-08 01:26:52,518 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomJoinRulesEvent
2025-01-08 01:26:52,518 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomGuestAccessEvent
2025-01-08 01:26:52,518 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-08 01:26:52,518 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomCreateEvent
2025-01-08 01:26:52,518 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:26:52,518 [INFO] src.luna_functions_handledispatch: Handling an on_room_message with positive-signal approach.
2025-01-08 01:26:52,518 [INFO] src.luna_functions_handledispatch: Full event => @admin:localhost: lunabot: are you there?
2025-01-08 01:26:52,518 [DEBUG] src.luna_functions_handledispatch: User message => 'lunabot: are you there?' in room => !FkbKmoFPWsWYTwKnwg:localhost
2025-01-08 01:26:52,518 [INFO] src.luna_functions_handledispatch: [Dispatch] Found mention(s) => FORCED_SIMULATION
2025-01-08 01:26:52,518 [INFO] src.luna_functions_handledispatch: Because we forced mention detection, we can confirm the pipeline is firing.
2025-01-08 01:26:52,518 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:26:52,518 [INFO] src.luna_functions_handledispatch: Handling an on_room_message with positive-signal approach.
2025-01-08 01:26:52,518 [INFO] src.luna_functions_handledispatch: Full event => @admin:localhost: lunabot: @luna @lunabot:localhost @lunabot:localhost areyou tehere?
2025-01-08 01:26:52,518 [DEBUG] src.luna_functions_handledispatch: User message => 'lunabot: @luna @lunabot:localhost @lunabot:localhost areyou tehere?' in room => !FkbKmoFPWsWYTwKnwg:localhost
2025-01-08 01:26:52,518 [INFO] src.luna_functions_handledispatch: [Dispatch] Found mention(s) => FORCED_SIMULATION
2025-01-08 01:26:52,518 [INFO] src.luna_functions_handledispatch: Because we forced mention detection, we can confirm the pipeline is firing.
2025-01-08 01:26:52,518 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:26:52,518 [INFO] src.luna_functions_handledispatch: Handling an on_room_message with positive-signal approach.
2025-01-08 01:26:52,518 [INFO] src.luna_functions_handledispatch: Full event => @admin:localhost: @luna @lunabot:localhost @lunabot:localhost areyou tehere? lunabot  test message please respond
2025-01-08 01:26:52,518 [DEBUG] src.luna_functions_handledispatch: User message => '@luna @lunabot:localhost @lunabot:localhost areyou tehere? lunabot  test message please respond' in room => !FkbKmoFPWsWYTwKnwg:localhost
2025-01-08 01:26:52,518 [INFO] src.luna_functions_handledispatch: [Dispatch] Found mention(s) => FORCED_SIMULATION
2025-01-08 01:26:52,518 [INFO] src.luna_functions_handledispatch: Because we forced mention detection, we can confirm the pipeline is firing.
2025-01-08 01:26:52,518 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:26:52,518 [INFO] src.luna_functions_handledispatch: Handling an on_room_message with positive-signal approach.
2025-01-08 01:26:52,518 [INFO] src.luna_functions_handledispatch: Full event => @admin:localhost: test
2025-01-08 01:26:52,518 [DEBUG] src.luna_functions_handledispatch: User message => 'test' in room => !FkbKmoFPWsWYTwKnwg:localhost
2025-01-08 01:26:52,518 [INFO] src.luna_functions_handledispatch: [Dispatch] Found mention(s) => FORCED_SIMULATION
2025-01-08 01:26:52,518 [INFO] src.luna_functions_handledispatch: Because we forced mention detection, we can confirm the pipeline is firing.
2025-01-08 01:26:52,518 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:26:52,518 [INFO] src.luna_functions_handledispatch: Handling an on_room_message with positive-signal approach.
2025-01-08 01:26:52,518 [INFO] src.luna_functions_handledispatch: Full event => @admin:localhost: test lunabot 
2025-01-08 01:26:52,518 [DEBUG] src.luna_functions_handledispatch: User message => 'test lunabot ' in room => !FkbKmoFPWsWYTwKnwg:localhost
2025-01-08 01:26:52,518 [INFO] src.luna_functions_handledispatch: [Dispatch] Found mention(s) => FORCED_SIMULATION
2025-01-08 01:26:52,518 [INFO] src.luna_functions_handledispatch: Because we forced mention detection, we can confirm the pipeline is firing.
2025-01-08 01:26:52,518 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:26:52,518 [INFO] src.luna_functions_handledispatch: Handling an on_room_message with positive-signal approach.
2025-01-08 01:26:52,518 [INFO] src.luna_functions_handledispatch: Full event => @admin:localhost: test lunabot @lunabot:localhost are you there?
2025-01-08 01:26:52,518 [DEBUG] src.luna_functions_handledispatch: User message => 'test lunabot @lunabot:localhost are you there?' in room => !FkbKmoFPWsWYTwKnwg:localhost
2025-01-08 01:26:52,518 [INFO] src.luna_functions_handledispatch: [Dispatch] Found mention(s) => FORCED_SIMULATION
2025-01-08 01:26:52,518 [INFO] src.luna_functions_handledispatch: Because we forced mention detection, we can confirm the pipeline is firing.
2025-01-08 01:26:52,518 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:26:52,518 [INFO] src.luna_functions_handledispatch: Handling an on_room_message with positive-signal approach.
2025-01-08 01:26:52,518 [INFO] src.luna_functions_handledispatch: Full event => @admin:localhost: lunabot: 
2025-01-08 01:26:52,518 [DEBUG] src.luna_functions_handledispatch: User message => 'lunabot: ' in room => !FkbKmoFPWsWYTwKnwg:localhost
2025-01-08 01:26:52,518 [INFO] src.luna_functions_handledispatch: [Dispatch] Found mention(s) => FORCED_SIMULATION
2025-01-08 01:26:52,518 [INFO] src.luna_functions_handledispatch: Because we forced mention detection, we can confirm the pipeline is firing.
2025-01-08 01:26:52,518 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:26:52,519 [INFO] src.luna_functions_handledispatch: Handling an on_room_message with positive-signal approach.
2025-01-08 01:26:52,519 [INFO] src.luna_functions_handledispatch: Full event => @admin:localhost: lunabot: respont?
2025-01-08 01:26:52,519 [DEBUG] src.luna_functions_handledispatch: User message => 'lunabot: respont?' in room => !FkbKmoFPWsWYTwKnwg:localhost
2025-01-08 01:26:52,519 [INFO] src.luna_functions_handledispatch: [Dispatch] Found mention(s) => FORCED_SIMULATION
2025-01-08 01:26:52,519 [INFO] src.luna_functions_handledispatch: Because we forced mention detection, we can confirm the pipeline is firing.
2025-01-08 01:26:52,519 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:26:52,519 [INFO] src.luna_functions_handledispatch: Handling an on_room_message with positive-signal approach.
2025-01-08 01:26:52,519 [INFO] src.luna_functions_handledispatch: Full event => @admin:localhost: @lunabot:localhost whwa'ts up
2025-01-08 01:26:52,519 [DEBUG] src.luna_functions_handledispatch: User message => '@lunabot:localhost whwa'ts up' in room => !FkbKmoFPWsWYTwKnwg:localhost
2025-01-08 01:26:52,519 [INFO] src.luna_functions_handledispatch: [Dispatch] Found mention(s) => FORCED_SIMULATION
2025-01-08 01:26:52,519 [INFO] src.luna_functions_handledispatch: Because we forced mention detection, we can confirm the pipeline is firing.
2025-01-08 01:26:52,519 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:26:52,519 [INFO] src.luna_functions_handledispatch: Handling an on_room_message with positive-signal approach.
2025-01-08 01:26:52,519 [INFO] src.luna_functions_handledispatch: Full event => @admin:localhost: luna are you there?
2025-01-08 01:26:52,519 [DEBUG] src.luna_functions_handledispatch: User message => 'luna are you there?' in room => !FkbKmoFPWsWYTwKnwg:localhost
2025-01-08 01:26:52,519 [INFO] src.luna_functions_handledispatch: [Dispatch] Found mention(s) => FORCED_SIMULATION
2025-01-08 01:26:52,519 [INFO] src.luna_functions_handledispatch: Because we forced mention detection, we can confirm the pipeline is firing.
2025-01-08 01:26:55,241 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:26:55,242 [INFO] src.luna_functions_handledispatch: Handling an on_room_message with positive-signal approach.
2025-01-08 01:26:55,242 [INFO] src.luna_functions_handledispatch: Full event => @admin:localhost: test
2025-01-08 01:26:55,242 [DEBUG] src.luna_functions_handledispatch: User message => 'test' in room => !FkbKmoFPWsWYTwKnwg:localhost
2025-01-08 01:26:55,242 [INFO] src.luna_functions_handledispatch: [Dispatch] Found mention(s) => FORCED_SIMULATION
2025-01-08 01:26:55,242 [INFO] src.luna_functions_handledispatch: Because we forced mention detection, we can confirm the pipeline is firing.
2025-01-08 01:29:56,375 [INFO] src.console_functions: Console received 'exit' command; requesting shutdown.
2025-01-08 01:29:56,375 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 01:29:56,375 [ERROR] __main__: An unexpected exception occurred in main_logic: Event loop stopped before Future completed.
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 135, in luna
    loop.run_until_complete(main_logic())
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 718, in run_until_complete
    raise RuntimeError('Event loop stopped before Future completed.')
RuntimeError: Event loop stopped before Future completed.
2025-01-08 01:29:56,379 [DEBUG] __main__: Preparing to close the event loop.
2025-01-08 01:29:56,379 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-08 01:30:42,535 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-08 01:30:42,535 [DEBUG] __main__: Exiting configure_logging function.
2025-01-08 01:30:42,535 [DEBUG] __main__: Logging configuration complete.
2025-01-08 01:30:42,535 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-08 01:30:42,535 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 01:30:42,535 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-08 01:30:42,535 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-08 01:30:42,535 [DEBUG] __main__: Entering start_console_thread function.
2025-01-08 01:30:42,537 [INFO] __main__: Console thread started successfully.
2025-01-08 01:30:42,537 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-08 01:30:42,537 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-08 01:30:42,537 [INFO] __main__: Starting main_logic coroutine.
2025-01-08 01:30:42,538 [DEBUG] __main__: Entering main_logic function...
2025-01-08 01:30:42,538 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-08 01:30:42,540 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-08 01:30:42,540 [INFO] src.luna_functions: Using saved token for user @lunabot:localhost.
2025-01-08 01:30:42,540 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-08 01:30:42,543 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 01:30:42,588 [INFO] nio.client.base_client: New joined room !HPrbJYfQkoGnlztkrS:localhost
2025-01-08 01:30:42,588 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-08 01:30:42,588 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomNameEvent
2025-01-08 01:30:42,588 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomJoinRulesEvent
2025-01-08 01:30:42,588 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type PowerLevelsEvent
2025-01-08 01:30:42,588 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-08 01:30:42,588 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomCreateEvent
2025-01-08 01:30:42,588 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomGuestAccessEvent
2025-01-08 01:30:42,588 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 01:30:42,588 [INFO] src.luna_functions_handledispatch: Handling an on_room_message with positive-signal approach.
2025-01-08 01:30:42,588 [INFO] src.luna_functions_handledispatch: Full event envelope:
{
  "type": "m.room.message",
  "sender": "@admin:localhost",
  "content": {
    "msgtype": "m.text",
    "body": "are you there @luna?",
    "m.mentions": {}
  },
  "origin_server_ts": 1736308736935,
  "unsigned": {
    "membership": "join",
    "age": 9105647
  },
  "event_id": "$81rJSSusKbZzGLstpNVOse9P7efqhEcoaQTWpG3QUDg"
}
2025-01-08 01:30:42,588 [DEBUG] src.luna_functions_handledispatch: User message => 'are you there @luna?' in room => !HPrbJYfQkoGnlztkrS:localhost
2025-01-08 01:30:42,588 [INFO] src.luna_functions_handledispatch: [Dispatch] Found mention(s) => FORCED_SIMULATION
2025-01-08 01:30:42,588 [INFO] src.luna_functions_handledispatch: Because we forced mention detection, we can confirm the pipeline is firing.
2025-01-08 01:30:42,588 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 01:30:42,588 [INFO] src.luna_functions_handledispatch: Handling an on_room_message with positive-signal approach.
2025-01-08 01:30:42,588 [INFO] src.luna_functions_handledispatch: Full event envelope:
{
  "type": "m.room.message",
  "sender": "@lunabot:localhost",
  "content": {
    "msgtype": "m.text",
    "body": "Yes, I'm here. How can I assist you today?"
  },
  "origin_server_ts": 1736308738867,
  "unsigned": {
    "membership": "join",
    "age": 9103715,
    "transaction_id": "1dd33640-b150-4a3d-b7cc-39df683d1c8c"
  },
  "event_id": "$Zza2i-vfupo-zPoIjp7EG4VoCjF-HMupvUfuEks-EyQ"
}
2025-01-08 01:30:42,588 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here. How can I assist you today?' in room => !HPrbJYfQkoGnlztkrS:localhost
2025-01-08 01:30:42,588 [INFO] src.luna_functions_handledispatch: [Dispatch] Found mention(s) => FORCED_SIMULATION
2025-01-08 01:30:42,588 [INFO] src.luna_functions_handledispatch: Because we forced mention detection, we can confirm the pipeline is firing.
2025-01-08 01:30:42,588 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 01:30:42,588 [INFO] src.luna_functions_handledispatch: Handling an on_room_message with positive-signal approach.
2025-01-08 01:30:42,588 [INFO] src.luna_functions_handledispatch: Full event envelope:
{
  "type": "m.room.message",
  "sender": "@lunabot:localhost",
  "content": {
    "msgtype": "m.text",
    "body": "Yes, I'm here. How can I assist you today?"
  },
  "origin_server_ts": 1736309809968,
  "unsigned": {
    "membership": "join",
    "age": 8032614,
    "transaction_id": "09b0240e-4a3a-44c6-9c5a-0b911418e760"
  },
  "event_id": "$vjZMR9AkcAqRJlgkyrNgErQoYrZmwtNXzz_DTna6MRo"
}
2025-01-08 01:30:42,588 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here. How can I assist you today?' in room => !HPrbJYfQkoGnlztkrS:localhost
2025-01-08 01:30:42,588 [INFO] src.luna_functions_handledispatch: [Dispatch] Found mention(s) => FORCED_SIMULATION
2025-01-08 01:30:42,588 [INFO] src.luna_functions_handledispatch: Because we forced mention detection, we can confirm the pipeline is firing.
2025-01-08 01:30:42,588 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 01:30:42,588 [INFO] src.luna_functions_handledispatch: Handling an on_room_message with positive-signal approach.
2025-01-08 01:30:42,588 [INFO] src.luna_functions_handledispatch: Full event envelope:
{
  "type": "m.room.message",
  "sender": "@lunabot:localhost",
  "content": {
    "msgtype": "m.text",
    "body": "Yes, I'm here. How can I assist you today?"
  },
  "origin_server_ts": 1736309913000,
  "unsigned": {
    "membership": "join",
    "age": 7929582,
    "transaction_id": "9ceeddac-c183-4371-aed4-07a952ff7328"
  },
  "event_id": "$q5t3nZPdz_Z4_TYy3NfydEZWgYrBIcjc8c_EENa8Nuo"
}
2025-01-08 01:30:42,588 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here. How can I assist you today?' in room => !HPrbJYfQkoGnlztkrS:localhost
2025-01-08 01:30:42,588 [INFO] src.luna_functions_handledispatch: [Dispatch] Found mention(s) => FORCED_SIMULATION
2025-01-08 01:30:42,588 [INFO] src.luna_functions_handledispatch: Because we forced mention detection, we can confirm the pipeline is firing.
2025-01-08 01:30:42,588 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 01:30:42,588 [INFO] src.luna_functions_handledispatch: Handling an on_room_message with positive-signal approach.
2025-01-08 01:30:42,588 [INFO] src.luna_functions_handledispatch: Full event envelope:
{
  "type": "m.room.message",
  "sender": "@lunabot:localhost",
  "content": {
    "msgtype": "m.text",
    "body": "Yes, I'm here! How can I assist you today?"
  },
  "origin_server_ts": 1736310153502,
  "unsigned": {
    "membership": "join",
    "age": 7689080,
    "transaction_id": "285d3775-ebc2-4ceb-83a0-6b252bf5dd7c"
  },
  "event_id": "$9Xa8XMjXRfXU13go4y7AsUYUlWM00zPBGVQ4BVlU4WM"
}
2025-01-08 01:30:42,588 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here! How can I assist you today?' in room => !HPrbJYfQkoGnlztkrS:localhost
2025-01-08 01:30:42,588 [INFO] src.luna_functions_handledispatch: [Dispatch] Found mention(s) => FORCED_SIMULATION
2025-01-08 01:30:42,588 [INFO] src.luna_functions_handledispatch: Because we forced mention detection, we can confirm the pipeline is firing.
2025-01-08 01:30:42,588 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 01:30:42,588 [INFO] src.luna_functions_handledispatch: Handling an on_room_message with positive-signal approach.
2025-01-08 01:30:42,588 [INFO] src.luna_functions_handledispatch: Full event envelope:
{
  "type": "m.room.message",
  "sender": "@lunabot:localhost",
  "content": {
    "msgtype": "m.text",
    "body": "Yes, I'm here. How can I assist you today?"
  },
  "origin_server_ts": 1736310272350,
  "unsigned": {
    "membership": "join",
    "age": 7570232,
    "transaction_id": "675996a3-5709-4598-a016-cf7ddc1ebc57"
  },
  "event_id": "$mF60Rea0XB-pNrxBnz2ocUo91TYyD-SCaV2j3dbmK6w"
}
2025-01-08 01:30:42,589 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here. How can I assist you today?' in room => !HPrbJYfQkoGnlztkrS:localhost
2025-01-08 01:30:42,589 [INFO] src.luna_functions_handledispatch: [Dispatch] Found mention(s) => FORCED_SIMULATION
2025-01-08 01:30:42,589 [INFO] src.luna_functions_handledispatch: Because we forced mention detection, we can confirm the pipeline is firing.
2025-01-08 01:30:42,589 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 01:30:42,589 [INFO] src.luna_functions_handledispatch: Handling an on_room_message with positive-signal approach.
2025-01-08 01:30:42,589 [INFO] src.luna_functions_handledispatch: Full event envelope:
{
  "type": "m.room.message",
  "sender": "@lunabot:localhost",
  "content": {
    "msgtype": "m.text",
    "body": "Yes, I'm here! How can I assist you today?"
  },
  "origin_server_ts": 1736310457283,
  "unsigned": {
    "membership": "join",
    "age": 7385299,
    "transaction_id": "1742105f-c6a6-40b7-bea5-e8e983d23822"
  },
  "event_id": "$3UiyELKOWw6i0Xq6Y8XQRRhyeCbx2DjNvWq9fLKSxEY"
}
2025-01-08 01:30:42,589 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here! How can I assist you today?' in room => !HPrbJYfQkoGnlztkrS:localhost
2025-01-08 01:30:42,589 [INFO] src.luna_functions_handledispatch: [Dispatch] Found mention(s) => FORCED_SIMULATION
2025-01-08 01:30:42,589 [INFO] src.luna_functions_handledispatch: Because we forced mention detection, we can confirm the pipeline is firing.
2025-01-08 01:30:42,589 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 01:30:42,589 [INFO] src.luna_functions_handledispatch: Handling an on_room_message with positive-signal approach.
2025-01-08 01:30:42,589 [INFO] src.luna_functions_handledispatch: Full event envelope:
{
  "type": "m.room.message",
  "sender": "@lunabot:localhost",
  "content": {
    "msgtype": "m.text",
    "body": "Yes, I'm here. How can I assist you today?"
  },
  "origin_server_ts": 1736310484255,
  "unsigned": {
    "membership": "join",
    "age": 7358327,
    "transaction_id": "e8e730f5-cb92-4810-a8f2-78a0b3e4fbf0"
  },
  "event_id": "$xrkfHAf-3VHykOAjIWVxVF2HEIFo8u0c_Lqa-uI7NIE"
}
2025-01-08 01:30:42,589 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here. How can I assist you today?' in room => !HPrbJYfQkoGnlztkrS:localhost
2025-01-08 01:30:42,589 [INFO] src.luna_functions_handledispatch: [Dispatch] Found mention(s) => FORCED_SIMULATION
2025-01-08 01:30:42,589 [INFO] src.luna_functions_handledispatch: Because we forced mention detection, we can confirm the pipeline is firing.
2025-01-08 01:30:42,589 [INFO] nio.client.base_client: New joined room !FkbKmoFPWsWYTwKnwg:localhost
2025-01-08 01:30:42,589 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type PowerLevelsEvent
2025-01-08 01:30:42,589 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-08 01:30:42,589 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomJoinRulesEvent
2025-01-08 01:30:42,589 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomGuestAccessEvent
2025-01-08 01:30:42,589 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-08 01:30:42,589 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomCreateEvent
2025-01-08 01:30:42,589 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:30:42,589 [INFO] src.luna_functions_handledispatch: Handling an on_room_message with positive-signal approach.
2025-01-08 01:30:42,589 [INFO] src.luna_functions_handledispatch: Full event envelope:
{
  "type": "m.room.message",
  "sender": "@admin:localhost",
  "content": {
    "msgtype": "m.text",
    "body": "lunabot: @luna @lunabot:localhost @lunabot:localhost areyou tehere?",
    "format": "org.matrix.custom.html",
    "formatted_body": "<a href=\"https://matrix.to/#/@lunabot:localhost\">lunabot</a>: @luna @lunabot:localhost @lunabot:localhost areyou tehere?",
    "m.mentions": {
      "user_ids": [
        "@lunabot:localhost"
      ]
    }
  },
  "origin_server_ts": 1736316392062,
  "unsigned": {
    "membership": "join",
    "age": 1450520
  },
  "event_id": "$BKpBxKyb9OIC_nVr6ka4AQkPcQh-pbSa-1WnT-o1OEs"
}
2025-01-08 01:30:42,589 [DEBUG] src.luna_functions_handledispatch: User message => 'lunabot: @luna @lunabot:localhost @lunabot:localhost areyou tehere?' in room => !FkbKmoFPWsWYTwKnwg:localhost
2025-01-08 01:30:42,589 [INFO] src.luna_functions_handledispatch: [Dispatch] Found mention(s) => FORCED_SIMULATION
2025-01-08 01:30:42,589 [INFO] src.luna_functions_handledispatch: Because we forced mention detection, we can confirm the pipeline is firing.
2025-01-08 01:30:42,589 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:30:42,589 [INFO] src.luna_functions_handledispatch: Handling an on_room_message with positive-signal approach.
2025-01-08 01:30:42,589 [INFO] src.luna_functions_handledispatch: Full event envelope:
{
  "type": "m.room.message",
  "sender": "@admin:localhost",
  "content": {
    "msgtype": "m.text",
    "body": "@luna @lunabot:localhost @lunabot:localhost areyou tehere? lunabot  test message please respond",
    "format": "org.matrix.custom.html",
    "formatted_body": "@luna @lunabot:localhost @lunabot:localhost areyou tehere? <a href=\"https://matrix.to/#/@lunabot:localhost\">lunabot</a>  test message please respond",
    "m.mentions": {
      "user_ids": [
        "@lunabot:localhost"
      ]
    }
  },
  "origin_server_ts": 1736316776479,
  "unsigned": {
    "membership": "join",
    "age": 1066103
  },
  "event_id": "$Wc90oA0rymEMJF3yrH6a-5a06kh-tAnABVBRp9Nrx9o"
}
2025-01-08 01:30:42,589 [DEBUG] src.luna_functions_handledispatch: User message => '@luna @lunabot:localhost @lunabot:localhost areyou tehere? lunabot  test message please respond' in room => !FkbKmoFPWsWYTwKnwg:localhost
2025-01-08 01:30:42,589 [INFO] src.luna_functions_handledispatch: [Dispatch] Found mention(s) => FORCED_SIMULATION
2025-01-08 01:30:42,589 [INFO] src.luna_functions_handledispatch: Because we forced mention detection, we can confirm the pipeline is firing.
2025-01-08 01:30:42,589 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:30:42,589 [INFO] src.luna_functions_handledispatch: Handling an on_room_message with positive-signal approach.
2025-01-08 01:30:42,589 [INFO] src.luna_functions_handledispatch: Full event envelope:
{
  "type": "m.room.message",
  "sender": "@admin:localhost",
  "content": {
    "msgtype": "m.text",
    "body": "test",
    "m.mentions": {}
  },
  "origin_server_ts": 1736317032090,
  "unsigned": {
    "membership": "join",
    "age": 810492
  },
  "event_id": "$kvyx4YUzfbzmpdQtvsL14iyxqPP9j347GEu5Fc5a5F4"
}
2025-01-08 01:30:42,589 [DEBUG] src.luna_functions_handledispatch: User message => 'test' in room => !FkbKmoFPWsWYTwKnwg:localhost
2025-01-08 01:30:42,589 [INFO] src.luna_functions_handledispatch: [Dispatch] Found mention(s) => FORCED_SIMULATION
2025-01-08 01:30:42,589 [INFO] src.luna_functions_handledispatch: Because we forced mention detection, we can confirm the pipeline is firing.
2025-01-08 01:30:42,589 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:30:42,589 [INFO] src.luna_functions_handledispatch: Handling an on_room_message with positive-signal approach.
2025-01-08 01:30:42,589 [INFO] src.luna_functions_handledispatch: Full event envelope:
{
  "type": "m.room.message",
  "sender": "@admin:localhost",
  "content": {
    "msgtype": "m.text",
    "body": "test lunabot ",
    "format": "org.matrix.custom.html",
    "formatted_body": "test <a href=\"https://matrix.to/#/@lunabot:localhost\">lunabot</a>",
    "m.mentions": {
      "user_ids": [
        "@lunabot:localhost"
      ]
    }
  },
  "origin_server_ts": 1736317035703,
  "unsigned": {
    "membership": "join",
    "age": 806879
  },
  "event_id": "$Wp2r_J-CV3Jm-s50ktqihVqDwLLK_j9nNivIiSArbTs"
}
2025-01-08 01:30:42,589 [DEBUG] src.luna_functions_handledispatch: User message => 'test lunabot ' in room => !FkbKmoFPWsWYTwKnwg:localhost
2025-01-08 01:30:42,589 [INFO] src.luna_functions_handledispatch: [Dispatch] Found mention(s) => FORCED_SIMULATION
2025-01-08 01:30:42,589 [INFO] src.luna_functions_handledispatch: Because we forced mention detection, we can confirm the pipeline is firing.
2025-01-08 01:30:42,589 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:30:42,589 [INFO] src.luna_functions_handledispatch: Handling an on_room_message with positive-signal approach.
2025-01-08 01:30:42,589 [INFO] src.luna_functions_handledispatch: Full event envelope:
{
  "type": "m.room.message",
  "sender": "@admin:localhost",
  "content": {
    "msgtype": "m.text",
    "body": "test lunabot @lunabot:localhost are you there?",
    "format": "org.matrix.custom.html",
    "formatted_body": "test <a href=\"https://matrix.to/#/@lunabot:localhost\">lunabot</a> @lunabot:localhost are you there?",
    "m.mentions": {
      "user_ids": [
        "@lunabot:localhost"
      ]
    }
  },
  "origin_server_ts": 1736317050999,
  "unsigned": {
    "membership": "join",
    "age": 791583
  },
  "event_id": "$JcuRiq2bDatGGc05Jes0wCYyZLq6QY5wrXNlNfmmTEE"
}
2025-01-08 01:30:42,589 [DEBUG] src.luna_functions_handledispatch: User message => 'test lunabot @lunabot:localhost are you there?' in room => !FkbKmoFPWsWYTwKnwg:localhost
2025-01-08 01:30:42,589 [INFO] src.luna_functions_handledispatch: [Dispatch] Found mention(s) => FORCED_SIMULATION
2025-01-08 01:30:42,589 [INFO] src.luna_functions_handledispatch: Because we forced mention detection, we can confirm the pipeline is firing.
2025-01-08 01:30:42,589 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:30:42,589 [INFO] src.luna_functions_handledispatch: Handling an on_room_message with positive-signal approach.
2025-01-08 01:30:42,589 [INFO] src.luna_functions_handledispatch: Full event envelope:
{
  "type": "m.room.message",
  "sender": "@admin:localhost",
  "content": {
    "msgtype": "m.text",
    "body": "lunabot: ",
    "format": "org.matrix.custom.html",
    "formatted_body": "<a href=\"https://matrix.to/#/@lunabot:localhost\">lunabot</a>:",
    "m.mentions": {
      "user_ids": [
        "@lunabot:localhost"
      ]
    }
  },
  "origin_server_ts": 1736317291484,
  "unsigned": {
    "membership": "join",
    "age": 551098
  },
  "event_id": "$ETOzJ3YwciEFR-p59W41B1tQHdT1N1Jlw2hO73E9Ubg"
}
2025-01-08 01:30:42,589 [DEBUG] src.luna_functions_handledispatch: User message => 'lunabot: ' in room => !FkbKmoFPWsWYTwKnwg:localhost
2025-01-08 01:30:42,589 [INFO] src.luna_functions_handledispatch: [Dispatch] Found mention(s) => FORCED_SIMULATION
2025-01-08 01:30:42,590 [INFO] src.luna_functions_handledispatch: Because we forced mention detection, we can confirm the pipeline is firing.
2025-01-08 01:30:42,590 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:30:42,590 [INFO] src.luna_functions_handledispatch: Handling an on_room_message with positive-signal approach.
2025-01-08 01:30:42,590 [INFO] src.luna_functions_handledispatch: Full event envelope:
{
  "type": "m.room.message",
  "sender": "@admin:localhost",
  "content": {
    "msgtype": "m.text",
    "body": "lunabot: respont?",
    "format": "org.matrix.custom.html",
    "formatted_body": "<a href=\"https://matrix.to/#/@lunabot:localhost\">lunabot</a>: respont?",
    "m.mentions": {
      "user_ids": [
        "@lunabot:localhost"
      ]
    }
  },
  "origin_server_ts": 1736317296339,
  "unsigned": {
    "membership": "join",
    "age": 546243
  },
  "event_id": "$ojVtses9cSX4TJcwh-xnPQ6-d56EXoSqbjHdTpGufBM"
}
2025-01-08 01:30:42,590 [DEBUG] src.luna_functions_handledispatch: User message => 'lunabot: respont?' in room => !FkbKmoFPWsWYTwKnwg:localhost
2025-01-08 01:30:42,590 [INFO] src.luna_functions_handledispatch: [Dispatch] Found mention(s) => FORCED_SIMULATION
2025-01-08 01:30:42,590 [INFO] src.luna_functions_handledispatch: Because we forced mention detection, we can confirm the pipeline is firing.
2025-01-08 01:30:42,590 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:30:42,590 [INFO] src.luna_functions_handledispatch: Handling an on_room_message with positive-signal approach.
2025-01-08 01:30:42,590 [INFO] src.luna_functions_handledispatch: Full event envelope:
{
  "type": "m.room.message",
  "sender": "@admin:localhost",
  "content": {
    "msgtype": "m.text",
    "body": "@lunabot:localhost whwa'ts up",
    "m.mentions": {}
  },
  "origin_server_ts": 1736317312069,
  "unsigned": {
    "membership": "join",
    "age": 530513
  },
  "event_id": "$JP3uaYeSnkEBON8-X6JNzJmHlV6wlJZVt6uzbVoSdU8"
}
2025-01-08 01:30:42,590 [DEBUG] src.luna_functions_handledispatch: User message => '@lunabot:localhost whwa'ts up' in room => !FkbKmoFPWsWYTwKnwg:localhost
2025-01-08 01:30:42,590 [INFO] src.luna_functions_handledispatch: [Dispatch] Found mention(s) => FORCED_SIMULATION
2025-01-08 01:30:42,590 [INFO] src.luna_functions_handledispatch: Because we forced mention detection, we can confirm the pipeline is firing.
2025-01-08 01:30:42,590 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:30:42,590 [INFO] src.luna_functions_handledispatch: Handling an on_room_message with positive-signal approach.
2025-01-08 01:30:42,590 [INFO] src.luna_functions_handledispatch: Full event envelope:
{
  "type": "m.room.message",
  "sender": "@admin:localhost",
  "content": {
    "msgtype": "m.text",
    "body": "luna are you there?",
    "m.mentions": {}
  },
  "origin_server_ts": 1736317495984,
  "unsigned": {
    "membership": "join",
    "age": 346598
  },
  "event_id": "$eBfy5qMs5fMpm3q4oWByJjsXZTiFbclQBpaSGgJL96Q"
}
2025-01-08 01:30:42,590 [DEBUG] src.luna_functions_handledispatch: User message => 'luna are you there?' in room => !FkbKmoFPWsWYTwKnwg:localhost
2025-01-08 01:30:42,590 [INFO] src.luna_functions_handledispatch: [Dispatch] Found mention(s) => FORCED_SIMULATION
2025-01-08 01:30:42,590 [INFO] src.luna_functions_handledispatch: Because we forced mention detection, we can confirm the pipeline is firing.
2025-01-08 01:30:42,590 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:30:42,590 [INFO] src.luna_functions_handledispatch: Handling an on_room_message with positive-signal approach.
2025-01-08 01:30:42,590 [INFO] src.luna_functions_handledispatch: Full event envelope:
{
  "type": "m.room.message",
  "sender": "@admin:localhost",
  "content": {
    "msgtype": "m.text",
    "body": "test",
    "m.mentions": {}
  },
  "origin_server_ts": 1736317615226,
  "unsigned": {
    "membership": "join",
    "age": 227356
  },
  "event_id": "$49qzQSjRzEjD1Efj2ekFVligvxvRyQY0-pmJzXsAN2U"
}
2025-01-08 01:30:42,590 [DEBUG] src.luna_functions_handledispatch: User message => 'test' in room => !FkbKmoFPWsWYTwKnwg:localhost
2025-01-08 01:30:42,590 [INFO] src.luna_functions_handledispatch: [Dispatch] Found mention(s) => FORCED_SIMULATION
2025-01-08 01:30:42,590 [INFO] src.luna_functions_handledispatch: Because we forced mention detection, we can confirm the pipeline is firing.
2025-01-08 01:30:45,674 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:30:45,674 [INFO] src.luna_functions_handledispatch: Handling an on_room_message with positive-signal approach.
2025-01-08 01:30:45,674 [INFO] src.luna_functions_handledispatch: Full event envelope:
{
  "type": "m.room.message",
  "sender": "@admin:localhost",
  "content": {
    "msgtype": "m.text",
    "body": "test",
    "m.mentions": {}
  },
  "origin_server_ts": 1736317845660,
  "unsigned": {
    "membership": "join",
    "age": 12
  },
  "event_id": "$fFLctcic91Mg4LWFQiL86g1jOrGPQdJ8JRTPAcpUDiI"
}
2025-01-08 01:30:45,674 [DEBUG] src.luna_functions_handledispatch: User message => 'test' in room => !FkbKmoFPWsWYTwKnwg:localhost
2025-01-08 01:30:45,674 [INFO] src.luna_functions_handledispatch: [Dispatch] Found mention(s) => FORCED_SIMULATION
2025-01-08 01:30:45,675 [INFO] src.luna_functions_handledispatch: Because we forced mention detection, we can confirm the pipeline is firing.
2025-01-08 01:32:21,088 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:32:21,088 [INFO] src.luna_functions_handledispatch: Handling an on_room_message with positive-signal approach.
2025-01-08 01:32:21,088 [INFO] src.luna_functions_handledispatch: Full event envelope:
{
  "type": "m.room.message",
  "sender": "@admin:localhost",
  "content": {
    "msgtype": "m.text",
    "body": "lunabot: ",
    "format": "org.matrix.custom.html",
    "formatted_body": "<a href=\"https://matrix.to/#/@lunabot:localhost\">lunabot</a>:",
    "m.mentions": {
      "user_ids": [
        "@lunabot:localhost"
      ]
    }
  },
  "origin_server_ts": 1736317941063,
  "unsigned": {
    "membership": "join",
    "age": 22
  },
  "event_id": "$RpUFlxxq75ORCY-mPnGIpwQwO9WSxMuopU3Hsfy_V48"
}
2025-01-08 01:32:21,088 [DEBUG] src.luna_functions_handledispatch: User message => 'lunabot: ' in room => !FkbKmoFPWsWYTwKnwg:localhost
2025-01-08 01:32:21,089 [INFO] src.luna_functions_handledispatch: [Dispatch] Found mention(s) => FORCED_SIMULATION
2025-01-08 01:32:21,089 [INFO] src.luna_functions_handledispatch: Because we forced mention detection, we can confirm the pipeline is firing.
2025-01-08 01:35:12,175 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:35:12,176 [INFO] src.luna_functions_handledispatch: Handling an on_room_message with positive-signal approach.
2025-01-08 01:35:12,176 [INFO] src.luna_functions_handledispatch: Full event envelope:
{
  "type": "m.room.message",
  "sender": "@admin:localhost",
  "content": {
    "msgtype": "m.text",
    "body": "lunabot: ",
    "format": "org.matrix.custom.html",
    "formatted_body": "<a href=\"https://matrix.to/#/@lunabot:localhost\">lunabot</a>:",
    "m.mentions": {
      "user_ids": [
        "@lunabot:localhost"
      ]
    }
  },
  "origin_server_ts": 1736318112148,
  "unsigned": {
    "membership": "join",
    "age": 24
  },
  "event_id": "$dMUFASQym9YcSQi7sYpyq3rMjmzrPaRL9eXx8ObCbsU"
}
2025-01-08 01:35:12,176 [DEBUG] src.luna_functions_handledispatch: User message => 'lunabot: ' in room => !FkbKmoFPWsWYTwKnwg:localhost
2025-01-08 01:35:12,176 [INFO] src.luna_functions_handledispatch: [Dispatch] Found mention(s) => FORCED_SIMULATION
2025-01-08 01:35:12,176 [INFO] src.luna_functions_handledispatch: Because we forced mention detection, we can confirm the pipeline is firing.
2025-01-08 01:40:33,146 [INFO] src.console_functions: Console received 'exit' command; requesting shutdown.
2025-01-08 01:40:33,148 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 01:40:33,148 [ERROR] __main__: An unexpected exception occurred in main_logic: Event loop stopped before Future completed.
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/./luna.py", line 135, in luna
    loop.run_until_complete(main_logic())
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 718, in run_until_complete
    raise RuntimeError('Event loop stopped before Future completed.')
RuntimeError: Event loop stopped before Future completed.
2025-01-08 01:40:33,155 [DEBUG] __main__: Preparing to close the event loop.
2025-01-08 01:40:33,156 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-08 01:40:35,411 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-08 01:40:35,411 [DEBUG] __main__: Exiting configure_logging function.
2025-01-08 01:40:35,411 [DEBUG] __main__: Logging configuration complete.
2025-01-08 01:40:35,411 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-08 01:40:35,411 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 01:40:35,411 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-08 01:40:35,412 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-08 01:40:35,412 [DEBUG] __main__: Entering start_console_thread function.
2025-01-08 01:40:35,414 [INFO] __main__: Console thread started successfully.
2025-01-08 01:40:35,414 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-08 01:40:35,414 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-08 01:40:35,414 [INFO] __main__: Starting main_logic coroutine.
2025-01-08 01:40:35,414 [DEBUG] __main__: Entering main_logic function...
2025-01-08 01:40:35,414 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-08 01:40:35,416 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-08 01:40:35,416 [INFO] src.luna_functions: Using saved token for user @lunabot:localhost.
2025-01-08 01:40:35,416 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-08 01:40:35,420 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 01:40:35,456 [INFO] nio.client.base_client: New joined room !HPrbJYfQkoGnlztkrS:localhost
2025-01-08 01:40:35,456 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-08 01:40:35,456 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomNameEvent
2025-01-08 01:40:35,456 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomJoinRulesEvent
2025-01-08 01:40:35,456 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type PowerLevelsEvent
2025-01-08 01:40:35,456 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-08 01:40:35,456 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomCreateEvent
2025-01-08 01:40:35,456 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomGuestAccessEvent
2025-01-08 01:40:35,456 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 01:40:35,456 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 01:40:35,456 [DEBUG] src.luna_functions_handledispatch: User message => 'are you there @luna?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 01:40:35,456 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 01:40:35,456 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 01:40:35,456 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 01:40:35,456 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 01:40:35,456 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here. How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 01:40:35,456 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 01:40:35,456 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 01:40:35,456 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 01:40:35,456 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 01:40:35,456 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here. How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 01:40:35,456 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 01:40:35,456 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 01:40:35,456 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 01:40:35,456 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 01:40:35,456 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here. How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 01:40:35,456 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 01:40:35,456 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 01:40:35,456 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 01:40:35,456 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 01:40:35,457 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here! How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 01:40:35,457 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 01:40:35,457 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 01:40:35,457 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 01:40:35,457 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 01:40:35,457 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here. How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 01:40:35,457 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 01:40:35,457 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 01:40:35,457 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 01:40:35,457 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 01:40:35,457 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here! How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 01:40:35,457 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 01:40:35,457 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 01:40:35,457 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 01:40:35,457 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 01:40:35,457 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here. How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 01:40:35,457 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 01:40:35,457 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 01:40:35,457 [INFO] nio.client.base_client: New joined room !FkbKmoFPWsWYTwKnwg:localhost
2025-01-08 01:40:35,457 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type PowerLevelsEvent
2025-01-08 01:40:35,457 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-08 01:40:35,457 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomJoinRulesEvent
2025-01-08 01:40:35,457 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomGuestAccessEvent
2025-01-08 01:40:35,457 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-08 01:40:35,457 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomCreateEvent
2025-01-08 01:40:35,457 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:40:35,457 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 01:40:35,457 [DEBUG] src.luna_functions_handledispatch: User message => 'test lunabot ' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 01:40:35,457 [DEBUG] src.luna_functions_handledispatch: m.mentions => {'user_ids': ['@lunabot:localhost']}
2025-01-08 01:40:35,457 [INFO] src.luna_functions_handledispatch: Mentioned user_ids => ['@lunabot:localhost']
2025-01-08 01:40:35,457 [INFO] src.luna_functions_handledispatch: Processing mention for user => @lunabot:localhost
2025-01-08 01:40:35,488 [DEBUG] openai._base_client: Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': 'You are a helpful bot responding to a mention of @lunabot:localhost.'}, {'role': 'user', 'content': 'test lunabot '}], 'model': 'gpt-4', 'max_tokens': 300, 'temperature': 0.7}}
2025-01-08 01:40:35,492 [DEBUG] httpcore.connection: connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2025-01-08 01:40:35,584 [DEBUG] httpcore.connection: connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10f7cfcb0>
2025-01-08 01:40:35,584 [DEBUG] httpcore.connection: start_tls.started ssl_context=<ssl.SSLContext object at 0x1050fa210> server_hostname='api.openai.com' timeout=5.0
2025-01-08 01:40:35,616 [DEBUG] httpcore.connection: start_tls.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10f77f890>
2025-01-08 01:40:35,616 [DEBUG] httpcore.http11: send_request_headers.started request=<Request [b'POST']>
2025-01-08 01:40:35,616 [DEBUG] httpcore.http11: send_request_headers.complete
2025-01-08 01:40:35,616 [DEBUG] httpcore.http11: send_request_body.started request=<Request [b'POST']>
2025-01-08 01:40:35,616 [DEBUG] httpcore.http11: send_request_body.complete
2025-01-08 01:40:35,616 [DEBUG] httpcore.http11: receive_response_headers.started request=<Request [b'POST']>
2025-01-08 01:40:36,422 [DEBUG] httpcore.http11: receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Wed, 08 Jan 2025 06:40:36 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-yzbp3micnvwwjimbcblinra3'), (b'openai-processing-ms', b'730'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'5000'), (b'x-ratelimit-limit-tokens', b'80000'), (b'x-ratelimit-remaining-requests', b'4999'), (b'x-ratelimit-remaining-tokens', b'79677'), (b'x-ratelimit-reset-requests', b'12ms'), (b'x-ratelimit-reset-tokens', b'242ms'), (b'x-request-id', b'req_320a66cbdd25b7ac0a38edcc09149576'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=_hk1xpJx016uvplhtt84xTy3itkgEZdwBPvPmnJDAHY-1736318436-1.0.1.1-evHf3fYBSnNrq.1hbQ9u0Xqm6Vm0bdEvog3VtstoutXE4MBVOaCRavHYOqTBsRkTa4HVGwCwVWyr8R3MKScN5Q; path=/; expires=Wed, 08-Jan-25 07:10:36 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=iJm14T3CfHxtHAh_IHymU54d.j_SX_gNzWGuN990Do0-1736318436457-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8fea326efc639020-BOS'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2025-01-08 01:40:36,424 [INFO] httpx: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-08 01:40:36,425 [DEBUG] httpcore.http11: receive_response_body.started request=<Request [b'POST']>
2025-01-08 01:40:36,425 [DEBUG] httpcore.http11: receive_response_body.complete
2025-01-08 01:40:36,425 [DEBUG] httpcore.http11: response_closed.started
2025-01-08 01:40:36,426 [DEBUG] httpcore.http11: response_closed.complete
2025-01-08 01:40:36,426 [DEBUG] openai._base_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "200 OK"
2025-01-08 01:40:36,433 [INFO] src.luna_functions_handledispatch: GPT reply (for mention @lunabot:localhost) => Hello! How can I assist you today?
2025-01-08 01:40:36,433 [WARNING] src.luna_functions_handledispatch: No DIRECTOR_CLIENT set; cannot post GPT reply.
2025-01-08 01:40:36,433 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:40:36,433 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 01:40:36,434 [DEBUG] src.luna_functions_handledispatch: User message => 'test lunabot @lunabot:localhost are you there?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 01:40:36,434 [DEBUG] src.luna_functions_handledispatch: m.mentions => {'user_ids': ['@lunabot:localhost']}
2025-01-08 01:40:36,434 [INFO] src.luna_functions_handledispatch: Mentioned user_ids => ['@lunabot:localhost']
2025-01-08 01:40:36,434 [INFO] src.luna_functions_handledispatch: Processing mention for user => @lunabot:localhost
2025-01-08 01:40:36,436 [DEBUG] openai._base_client: Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': 'You are a helpful bot responding to a mention of @lunabot:localhost.'}, {'role': 'user', 'content': 'test lunabot @lunabot:localhost are you there?'}], 'model': 'gpt-4', 'max_tokens': 300, 'temperature': 0.7}}
2025-01-08 01:40:36,436 [DEBUG] httpcore.http11: send_request_headers.started request=<Request [b'POST']>
2025-01-08 01:40:36,437 [DEBUG] httpcore.http11: send_request_headers.complete
2025-01-08 01:40:36,437 [DEBUG] httpcore.http11: send_request_body.started request=<Request [b'POST']>
2025-01-08 01:40:36,437 [DEBUG] httpcore.http11: send_request_body.complete
2025-01-08 01:40:36,437 [DEBUG] httpcore.http11: receive_response_headers.started request=<Request [b'POST']>
2025-01-08 01:40:37,468 [DEBUG] httpcore.http11: receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Wed, 08 Jan 2025 06:40:37 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-yzbp3micnvwwjimbcblinra3'), (b'openai-processing-ms', b'959'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'5000'), (b'x-ratelimit-limit-tokens', b'80000'), (b'x-ratelimit-remaining-requests', b'4999'), (b'x-ratelimit-remaining-tokens', b'79669'), (b'x-ratelimit-reset-requests', b'12ms'), (b'x-ratelimit-reset-tokens', b'248ms'), (b'x-request-id', b'req_93dacec2379cc60e726cddcb22648104'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8fea32741f2c9020-BOS'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2025-01-08 01:40:37,472 [INFO] httpx: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-08 01:40:37,472 [DEBUG] httpcore.http11: receive_response_body.started request=<Request [b'POST']>
2025-01-08 01:40:37,472 [DEBUG] httpcore.http11: receive_response_body.complete
2025-01-08 01:40:37,472 [DEBUG] httpcore.http11: response_closed.started
2025-01-08 01:40:37,473 [DEBUG] httpcore.http11: response_closed.complete
2025-01-08 01:40:37,473 [DEBUG] openai._base_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "200 OK"
2025-01-08 01:40:37,473 [INFO] src.luna_functions_handledispatch: GPT reply (for mention @lunabot:localhost) => Yes, I'm here! How can I assist you today?
2025-01-08 01:40:37,473 [WARNING] src.luna_functions_handledispatch: No DIRECTOR_CLIENT set; cannot post GPT reply.
2025-01-08 01:40:37,473 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:40:37,473 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 01:40:37,473 [DEBUG] src.luna_functions_handledispatch: User message => 'lunabot: ' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 01:40:37,473 [DEBUG] src.luna_functions_handledispatch: m.mentions => {'user_ids': ['@lunabot:localhost']}
2025-01-08 01:40:37,473 [INFO] src.luna_functions_handledispatch: Mentioned user_ids => ['@lunabot:localhost']
2025-01-08 01:40:37,473 [INFO] src.luna_functions_handledispatch: Processing mention for user => @lunabot:localhost
2025-01-08 01:40:37,476 [DEBUG] openai._base_client: Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': 'You are a helpful bot responding to a mention of @lunabot:localhost.'}, {'role': 'user', 'content': 'lunabot: '}], 'model': 'gpt-4', 'max_tokens': 300, 'temperature': 0.7}}
2025-01-08 01:40:37,477 [DEBUG] httpcore.http11: send_request_headers.started request=<Request [b'POST']>
2025-01-08 01:40:37,477 [DEBUG] httpcore.http11: send_request_headers.complete
2025-01-08 01:40:37,477 [DEBUG] httpcore.http11: send_request_body.started request=<Request [b'POST']>
2025-01-08 01:40:37,477 [DEBUG] httpcore.http11: send_request_body.complete
2025-01-08 01:40:37,477 [DEBUG] httpcore.http11: receive_response_headers.started request=<Request [b'POST']>
2025-01-08 01:40:38,680 [DEBUG] httpcore.http11: receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Wed, 08 Jan 2025 06:40:38 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-yzbp3micnvwwjimbcblinra3'), (b'openai-processing-ms', b'1117'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'5000'), (b'x-ratelimit-limit-tokens', b'80000'), (b'x-ratelimit-remaining-requests', b'4999'), (b'x-ratelimit-remaining-tokens', b'79678'), (b'x-ratelimit-reset-requests', b'12ms'), (b'x-ratelimit-reset-tokens', b'241ms'), (b'x-request-id', b'req_c2f30441d2fb9014988d95c62f6da81c'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8fea327a9b1d9020-BOS'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2025-01-08 01:40:38,682 [INFO] httpx: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-08 01:40:38,682 [DEBUG] httpcore.http11: receive_response_body.started request=<Request [b'POST']>
2025-01-08 01:40:38,683 [DEBUG] httpcore.http11: receive_response_body.complete
2025-01-08 01:40:38,683 [DEBUG] httpcore.http11: response_closed.started
2025-01-08 01:40:38,683 [DEBUG] httpcore.http11: response_closed.complete
2025-01-08 01:40:38,684 [DEBUG] openai._base_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "200 OK"
2025-01-08 01:40:38,684 [INFO] src.luna_functions_handledispatch: GPT reply (for mention @lunabot:localhost) => Hello! How can I assist you today?
2025-01-08 01:40:38,684 [WARNING] src.luna_functions_handledispatch: No DIRECTOR_CLIENT set; cannot post GPT reply.
2025-01-08 01:40:38,684 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:40:38,684 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 01:40:38,684 [DEBUG] src.luna_functions_handledispatch: User message => 'lunabot: respont?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 01:40:38,684 [DEBUG] src.luna_functions_handledispatch: m.mentions => {'user_ids': ['@lunabot:localhost']}
2025-01-08 01:40:38,684 [INFO] src.luna_functions_handledispatch: Mentioned user_ids => ['@lunabot:localhost']
2025-01-08 01:40:38,684 [INFO] src.luna_functions_handledispatch: Processing mention for user => @lunabot:localhost
2025-01-08 01:40:38,688 [DEBUG] openai._base_client: Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': 'You are a helpful bot responding to a mention of @lunabot:localhost.'}, {'role': 'user', 'content': 'lunabot: respont?'}], 'model': 'gpt-4', 'max_tokens': 300, 'temperature': 0.7}}
2025-01-08 01:40:38,688 [DEBUG] httpcore.http11: send_request_headers.started request=<Request [b'POST']>
2025-01-08 01:40:38,689 [DEBUG] httpcore.http11: send_request_headers.complete
2025-01-08 01:40:38,689 [DEBUG] httpcore.http11: send_request_body.started request=<Request [b'POST']>
2025-01-08 01:40:38,689 [DEBUG] httpcore.http11: send_request_body.complete
2025-01-08 01:40:38,689 [DEBUG] httpcore.http11: receive_response_headers.started request=<Request [b'POST']>
2025-01-08 01:40:39,802 [DEBUG] httpcore.http11: receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Wed, 08 Jan 2025 06:40:39 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-yzbp3micnvwwjimbcblinra3'), (b'openai-processing-ms', b'1040'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'5000'), (b'x-ratelimit-limit-tokens', b'80000'), (b'x-ratelimit-remaining-requests', b'4999'), (b'x-ratelimit-remaining-tokens', b'79676'), (b'x-ratelimit-reset-requests', b'12ms'), (b'x-ratelimit-reset-tokens', b'243ms'), (b'x-request-id', b'req_9c6dc5b818b0eb2c79aca8fb8c622b2a'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8fea32822f679020-BOS'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2025-01-08 01:40:39,803 [INFO] httpx: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-08 01:40:39,803 [DEBUG] httpcore.http11: receive_response_body.started request=<Request [b'POST']>
2025-01-08 01:40:39,805 [DEBUG] httpcore.http11: receive_response_body.complete
2025-01-08 01:40:39,805 [DEBUG] httpcore.http11: response_closed.started
2025-01-08 01:40:39,805 [DEBUG] httpcore.http11: response_closed.complete
2025-01-08 01:40:39,806 [DEBUG] openai._base_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "200 OK"
2025-01-08 01:40:39,807 [INFO] src.luna_functions_handledispatch: GPT reply (for mention @lunabot:localhost) => Of course! How can I assist you today?
2025-01-08 01:40:39,807 [WARNING] src.luna_functions_handledispatch: No DIRECTOR_CLIENT set; cannot post GPT reply.
2025-01-08 01:40:39,807 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:40:39,807 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 01:40:39,807 [DEBUG] src.luna_functions_handledispatch: User message => '@lunabot:localhost whwa'ts up' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 01:40:39,807 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 01:40:39,807 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 01:40:39,807 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:40:39,807 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 01:40:39,807 [DEBUG] src.luna_functions_handledispatch: User message => 'luna are you there?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 01:40:39,807 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 01:40:39,807 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 01:40:39,807 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:40:39,807 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 01:40:39,807 [DEBUG] src.luna_functions_handledispatch: User message => 'test' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 01:40:39,807 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 01:40:39,807 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 01:40:39,807 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:40:39,807 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 01:40:39,808 [DEBUG] src.luna_functions_handledispatch: User message => 'test' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 01:40:39,808 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 01:40:39,808 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 01:40:39,808 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:40:39,808 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 01:40:39,808 [DEBUG] src.luna_functions_handledispatch: User message => 'lunabot: ' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 01:40:39,808 [DEBUG] src.luna_functions_handledispatch: m.mentions => {'user_ids': ['@lunabot:localhost']}
2025-01-08 01:40:39,808 [INFO] src.luna_functions_handledispatch: Mentioned user_ids => ['@lunabot:localhost']
2025-01-08 01:40:39,808 [INFO] src.luna_functions_handledispatch: Processing mention for user => @lunabot:localhost
2025-01-08 01:40:39,812 [DEBUG] openai._base_client: Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': 'You are a helpful bot responding to a mention of @lunabot:localhost.'}, {'role': 'user', 'content': 'lunabot: '}], 'model': 'gpt-4', 'max_tokens': 300, 'temperature': 0.7}}
2025-01-08 01:40:39,813 [DEBUG] httpcore.http11: send_request_headers.started request=<Request [b'POST']>
2025-01-08 01:40:39,814 [DEBUG] httpcore.http11: send_request_headers.complete
2025-01-08 01:40:39,814 [DEBUG] httpcore.http11: send_request_body.started request=<Request [b'POST']>
2025-01-08 01:40:39,814 [DEBUG] httpcore.http11: send_request_body.complete
2025-01-08 01:40:39,814 [DEBUG] httpcore.http11: receive_response_headers.started request=<Request [b'POST']>
2025-01-08 01:40:40,730 [DEBUG] httpcore.http11: receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Wed, 08 Jan 2025 06:40:40 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-yzbp3micnvwwjimbcblinra3'), (b'openai-processing-ms', b'845'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'5000'), (b'x-ratelimit-limit-tokens', b'80000'), (b'x-ratelimit-remaining-requests', b'4999'), (b'x-ratelimit-remaining-tokens', b'79678'), (b'x-ratelimit-reset-requests', b'12ms'), (b'x-ratelimit-reset-tokens', b'241ms'), (b'x-request-id', b'req_665099dceaf3f2fc5fd0a1e887b990d3'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8fea32893bde9020-BOS'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2025-01-08 01:40:40,731 [INFO] httpx: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-08 01:40:40,732 [DEBUG] httpcore.http11: receive_response_body.started request=<Request [b'POST']>
2025-01-08 01:40:40,733 [DEBUG] httpcore.http11: receive_response_body.complete
2025-01-08 01:40:40,733 [DEBUG] httpcore.http11: response_closed.started
2025-01-08 01:40:40,733 [DEBUG] httpcore.http11: response_closed.complete
2025-01-08 01:40:40,733 [DEBUG] openai._base_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "200 OK"
2025-01-08 01:40:40,734 [INFO] src.luna_functions_handledispatch: GPT reply (for mention @lunabot:localhost) => Hello! How can I assist you today?
2025-01-08 01:40:40,734 [WARNING] src.luna_functions_handledispatch: No DIRECTOR_CLIENT set; cannot post GPT reply.
2025-01-08 01:40:40,734 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:40:40,734 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 01:40:40,734 [DEBUG] src.luna_functions_handledispatch: User message => 'lunabot: ' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 01:40:40,734 [DEBUG] src.luna_functions_handledispatch: m.mentions => {'user_ids': ['@lunabot:localhost']}
2025-01-08 01:40:40,734 [INFO] src.luna_functions_handledispatch: Mentioned user_ids => ['@lunabot:localhost']
2025-01-08 01:40:40,734 [INFO] src.luna_functions_handledispatch: Processing mention for user => @lunabot:localhost
2025-01-08 01:40:40,739 [DEBUG] openai._base_client: Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': 'You are a helpful bot responding to a mention of @lunabot:localhost.'}, {'role': 'user', 'content': 'lunabot: '}], 'model': 'gpt-4', 'max_tokens': 300, 'temperature': 0.7}}
2025-01-08 01:40:40,740 [DEBUG] httpcore.http11: send_request_headers.started request=<Request [b'POST']>
2025-01-08 01:40:40,740 [DEBUG] httpcore.http11: send_request_headers.complete
2025-01-08 01:40:40,740 [DEBUG] httpcore.http11: send_request_body.started request=<Request [b'POST']>
2025-01-08 01:40:40,740 [DEBUG] httpcore.http11: send_request_body.complete
2025-01-08 01:40:40,740 [DEBUG] httpcore.http11: receive_response_headers.started request=<Request [b'POST']>
2025-01-08 01:40:41,647 [DEBUG] httpcore.http11: receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Wed, 08 Jan 2025 06:40:41 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-yzbp3micnvwwjimbcblinra3'), (b'openai-processing-ms', b'812'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'5000'), (b'x-ratelimit-limit-tokens', b'80000'), (b'x-ratelimit-remaining-requests', b'4999'), (b'x-ratelimit-remaining-tokens', b'79678'), (b'x-ratelimit-reset-requests', b'12ms'), (b'x-ratelimit-reset-tokens', b'241ms'), (b'x-request-id', b'req_84964366dbea03b55355dd5094434452'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8fea328f1fb59020-BOS'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2025-01-08 01:40:41,649 [INFO] httpx: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-08 01:40:41,649 [DEBUG] httpcore.http11: receive_response_body.started request=<Request [b'POST']>
2025-01-08 01:40:41,650 [DEBUG] httpcore.http11: receive_response_body.complete
2025-01-08 01:40:41,650 [DEBUG] httpcore.http11: response_closed.started
2025-01-08 01:40:41,651 [DEBUG] httpcore.http11: response_closed.complete
2025-01-08 01:40:41,651 [DEBUG] openai._base_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "200 OK"
2025-01-08 01:40:41,652 [INFO] src.luna_functions_handledispatch: GPT reply (for mention @lunabot:localhost) => Hello! How can I assist you today?
2025-01-08 01:40:41,652 [WARNING] src.luna_functions_handledispatch: No DIRECTOR_CLIENT set; cannot post GPT reply.
2025-01-08 01:40:44,586 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:40:44,586 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 01:40:44,586 [DEBUG] src.luna_functions_handledispatch: User message => 'lunabot: are you online?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 01:40:44,586 [DEBUG] src.luna_functions_handledispatch: m.mentions => {'user_ids': ['@lunabot:localhost']}
2025-01-08 01:40:44,586 [INFO] src.luna_functions_handledispatch: Mentioned user_ids => ['@lunabot:localhost']
2025-01-08 01:40:44,587 [INFO] src.luna_functions_handledispatch: Processing mention for user => @lunabot:localhost
2025-01-08 01:40:44,590 [DEBUG] openai._base_client: Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': 'You are a helpful bot responding to a mention of @lunabot:localhost.'}, {'role': 'user', 'content': 'lunabot: are you online?'}], 'model': 'gpt-4', 'max_tokens': 300, 'temperature': 0.7}}
2025-01-08 01:40:44,591 [DEBUG] httpcore.http11: send_request_headers.started request=<Request [b'POST']>
2025-01-08 01:40:44,591 [DEBUG] httpcore.http11: send_request_headers.complete
2025-01-08 01:40:44,591 [DEBUG] httpcore.http11: send_request_body.started request=<Request [b'POST']>
2025-01-08 01:40:44,591 [DEBUG] httpcore.http11: send_request_body.complete
2025-01-08 01:40:44,591 [DEBUG] httpcore.http11: receive_response_headers.started request=<Request [b'POST']>
2025-01-08 01:40:45,823 [DEBUG] httpcore.http11: receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Wed, 08 Jan 2025 06:40:45 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-yzbp3micnvwwjimbcblinra3'), (b'openai-processing-ms', b'1087'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'5000'), (b'x-ratelimit-limit-tokens', b'80000'), (b'x-ratelimit-remaining-requests', b'4999'), (b'x-ratelimit-remaining-tokens', b'79675'), (b'x-ratelimit-reset-requests', b'12ms'), (b'x-ratelimit-reset-tokens', b'243ms'), (b'x-request-id', b'req_a016f045eba625ce3ab40a1042772af1'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8fea32a7081b9020-BOS'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2025-01-08 01:40:45,824 [INFO] httpx: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-08 01:40:45,825 [DEBUG] httpcore.http11: receive_response_body.started request=<Request [b'POST']>
2025-01-08 01:40:45,826 [DEBUG] httpcore.http11: receive_response_body.complete
2025-01-08 01:40:45,826 [DEBUG] httpcore.http11: response_closed.started
2025-01-08 01:40:45,826 [DEBUG] httpcore.http11: response_closed.complete
2025-01-08 01:40:45,827 [DEBUG] openai._base_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "200 OK"
2025-01-08 01:40:45,828 [INFO] src.luna_functions_handledispatch: GPT reply (for mention @lunabot:localhost) => Yes, I am online. How can I assist you today?
2025-01-08 01:40:45,828 [WARNING] src.luna_functions_handledispatch: No DIRECTOR_CLIENT set; cannot post GPT reply.
2025-01-08 01:45:29,290 [INFO] src.console_functions: Console received 'exit' command; requesting shutdown.
2025-01-08 01:45:29,291 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 01:45:29,292 [ERROR] __main__: An unexpected exception occurred in main_logic: Event loop stopped before Future completed.
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/./luna.py", line 135, in luna
    loop.run_until_complete(main_logic())
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 718, in run_until_complete
    raise RuntimeError('Event loop stopped before Future completed.')
RuntimeError: Event loop stopped before Future completed.
2025-01-08 01:45:29,299 [DEBUG] __main__: Preparing to close the event loop.
2025-01-08 01:45:29,300 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-08 01:45:31,030 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-08 01:45:31,030 [DEBUG] __main__: Exiting configure_logging function.
2025-01-08 01:45:31,030 [DEBUG] __main__: Logging configuration complete.
2025-01-08 01:45:31,030 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-08 01:45:31,030 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 01:45:31,031 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-08 01:45:31,031 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-08 01:45:31,031 [DEBUG] __main__: Entering start_console_thread function.
2025-01-08 01:45:31,033 [INFO] __main__: Console thread started successfully.
2025-01-08 01:45:31,033 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-08 01:45:31,033 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-08 01:45:31,033 [INFO] __main__: Starting main_logic coroutine.
2025-01-08 01:45:31,033 [DEBUG] __main__: Entering main_logic function...
2025-01-08 01:45:31,033 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-08 01:45:31,035 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-08 01:45:31,035 [INFO] src.luna_functions: Using saved token for user @lunabot:localhost.
2025-01-08 01:45:31,035 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-08 01:45:31,038 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 01:45:31,077 [INFO] nio.client.base_client: New joined room !HPrbJYfQkoGnlztkrS:localhost
2025-01-08 01:45:31,077 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-08 01:45:31,077 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomNameEvent
2025-01-08 01:45:31,077 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomJoinRulesEvent
2025-01-08 01:45:31,077 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type PowerLevelsEvent
2025-01-08 01:45:31,077 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-08 01:45:31,077 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomCreateEvent
2025-01-08 01:45:31,077 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomGuestAccessEvent
2025-01-08 01:45:31,077 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 01:45:31,077 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 01:45:31,077 [DEBUG] src.luna_functions_handledispatch: User message => 'are you there @luna?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 01:45:31,077 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 01:45:31,077 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 01:45:31,077 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 01:45:31,077 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 01:45:31,077 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here. How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 01:45:31,077 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 01:45:31,077 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 01:45:31,077 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 01:45:31,077 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 01:45:31,077 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here. How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 01:45:31,077 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 01:45:31,077 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 01:45:31,077 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 01:45:31,077 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 01:45:31,077 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here. How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 01:45:31,077 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 01:45:31,077 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 01:45:31,078 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 01:45:31,078 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 01:45:31,078 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here! How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 01:45:31,078 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 01:45:31,078 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 01:45:31,078 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 01:45:31,078 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 01:45:31,078 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here. How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 01:45:31,078 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 01:45:31,078 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 01:45:31,078 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 01:45:31,078 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 01:45:31,078 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here! How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 01:45:31,078 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 01:45:31,078 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 01:45:31,078 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 01:45:31,078 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 01:45:31,078 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here. How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 01:45:31,078 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 01:45:31,078 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 01:45:31,078 [INFO] nio.client.base_client: New joined room !FkbKmoFPWsWYTwKnwg:localhost
2025-01-08 01:45:31,078 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type PowerLevelsEvent
2025-01-08 01:45:31,078 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-08 01:45:31,078 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomJoinRulesEvent
2025-01-08 01:45:31,078 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomGuestAccessEvent
2025-01-08 01:45:31,078 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-08 01:45:31,078 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomCreateEvent
2025-01-08 01:45:31,078 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:45:31,078 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 01:45:31,078 [DEBUG] src.luna_functions_handledispatch: User message => 'test lunabot @lunabot:localhost are you there?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 01:45:31,078 [DEBUG] src.luna_functions_handledispatch: m.mentions => {'user_ids': ['@lunabot:localhost']}
2025-01-08 01:45:31,078 [INFO] src.luna_functions_handledispatch: Mentioned user_ids => ['@lunabot:localhost']
2025-01-08 01:45:31,078 [INFO] src.luna_functions_handledispatch: Processing mention for user => @lunabot:localhost
2025-01-08 01:45:31,110 [DEBUG] openai._base_client: Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': 'You are a helpful bot responding to a mention of @lunabot:localhost.'}, {'role': 'user', 'content': 'test lunabot @lunabot:localhost are you there?'}], 'model': 'gpt-4', 'max_tokens': 300, 'temperature': 0.7}}
2025-01-08 01:45:31,114 [DEBUG] httpcore.connection: connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2025-01-08 01:45:31,200 [DEBUG] httpcore.connection: connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10fa57cb0>
2025-01-08 01:45:31,200 [DEBUG] httpcore.connection: start_tls.started ssl_context=<ssl.SSLContext object at 0x1072522a0> server_hostname='api.openai.com' timeout=5.0
2025-01-08 01:45:31,226 [DEBUG] httpcore.connection: start_tls.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10fa0b9d0>
2025-01-08 01:45:31,227 [DEBUG] httpcore.http11: send_request_headers.started request=<Request [b'POST']>
2025-01-08 01:45:31,227 [DEBUG] httpcore.http11: send_request_headers.complete
2025-01-08 01:45:31,227 [DEBUG] httpcore.http11: send_request_body.started request=<Request [b'POST']>
2025-01-08 01:45:31,227 [DEBUG] httpcore.http11: send_request_body.complete
2025-01-08 01:45:31,227 [DEBUG] httpcore.http11: receive_response_headers.started request=<Request [b'POST']>
2025-01-08 01:45:32,191 [DEBUG] httpcore.http11: receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Wed, 08 Jan 2025 06:45:32 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-yzbp3micnvwwjimbcblinra3'), (b'openai-processing-ms', b'873'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'5000'), (b'x-ratelimit-limit-tokens', b'80000'), (b'x-ratelimit-remaining-requests', b'4999'), (b'x-ratelimit-remaining-tokens', b'79669'), (b'x-ratelimit-reset-requests', b'12ms'), (b'x-ratelimit-reset-tokens', b'248ms'), (b'x-request-id', b'req_4ff81d7b271082d9f2be2c88a1ea8b76'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=dV67NWV7OTHo97DB0Ckr88ARQdBEj7KPuE3YcFAcKYU-1736318732-1.0.1.1-ZxgPkpczWG63cD4f.bGoUcFh8X7unvQBefG.I9bpu4Ftz_E_FCQdCubPbhi_NMF0rhgWFA.oSuA1_YXmitfrFg; path=/; expires=Wed, 08-Jan-25 07:15:32 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=rcxBiIzfw6Sn8luiydl.TeK5gO56FwHZoON4OO4H_LA-1736318732220-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8fea39a67c688fc4-BOS'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2025-01-08 01:45:32,192 [INFO] httpx: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-08 01:45:32,192 [DEBUG] httpcore.http11: receive_response_body.started request=<Request [b'POST']>
2025-01-08 01:45:32,192 [DEBUG] httpcore.http11: receive_response_body.complete
2025-01-08 01:45:32,192 [DEBUG] httpcore.http11: response_closed.started
2025-01-08 01:45:32,192 [DEBUG] httpcore.http11: response_closed.complete
2025-01-08 01:45:32,192 [DEBUG] openai._base_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "200 OK"
2025-01-08 01:45:32,195 [INFO] src.luna_functions_handledispatch: GPT reply (for mention @lunabot:localhost) => Hello! Yes, I'm here and ready to assist you. How can I help you today?
2025-01-08 01:45:32,235 [INFO] src.luna_functions: Posted GPT reply to room !FkbKmoFPWsWYTwKnwg:localhost
2025-01-08 01:45:32,235 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:45:32,235 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 01:45:32,235 [DEBUG] src.luna_functions_handledispatch: User message => 'lunabot: ' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 01:45:32,235 [DEBUG] src.luna_functions_handledispatch: m.mentions => {'user_ids': ['@lunabot:localhost']}
2025-01-08 01:45:32,235 [INFO] src.luna_functions_handledispatch: Mentioned user_ids => ['@lunabot:localhost']
2025-01-08 01:45:32,235 [INFO] src.luna_functions_handledispatch: Processing mention for user => @lunabot:localhost
2025-01-08 01:45:32,237 [DEBUG] openai._base_client: Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': 'You are a helpful bot responding to a mention of @lunabot:localhost.'}, {'role': 'user', 'content': 'lunabot: '}], 'model': 'gpt-4', 'max_tokens': 300, 'temperature': 0.7}}
2025-01-08 01:45:32,237 [DEBUG] httpcore.http11: send_request_headers.started request=<Request [b'POST']>
2025-01-08 01:45:32,238 [DEBUG] httpcore.http11: send_request_headers.complete
2025-01-08 01:45:32,238 [DEBUG] httpcore.http11: send_request_body.started request=<Request [b'POST']>
2025-01-08 01:45:32,238 [DEBUG] httpcore.http11: send_request_body.complete
2025-01-08 01:45:32,238 [DEBUG] httpcore.http11: receive_response_headers.started request=<Request [b'POST']>
2025-01-08 01:45:32,917 [DEBUG] httpcore.http11: receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Wed, 08 Jan 2025 06:45:32 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-yzbp3micnvwwjimbcblinra3'), (b'openai-processing-ms', b'603'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'5000'), (b'x-ratelimit-limit-tokens', b'80000'), (b'x-ratelimit-remaining-requests', b'4999'), (b'x-ratelimit-remaining-tokens', b'79678'), (b'x-ratelimit-reset-requests', b'12ms'), (b'x-ratelimit-reset-tokens', b'241ms'), (b'x-request-id', b'req_1854b4e57ed045c12866d5a4e3b45ea4'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8fea39acc9038fc4-BOS'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2025-01-08 01:45:32,918 [INFO] httpx: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-08 01:45:32,918 [DEBUG] httpcore.http11: receive_response_body.started request=<Request [b'POST']>
2025-01-08 01:45:32,918 [DEBUG] httpcore.http11: receive_response_body.complete
2025-01-08 01:45:32,919 [DEBUG] httpcore.http11: response_closed.started
2025-01-08 01:45:32,919 [DEBUG] httpcore.http11: response_closed.complete
2025-01-08 01:45:32,919 [DEBUG] openai._base_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "200 OK"
2025-01-08 01:45:32,920 [INFO] src.luna_functions_handledispatch: GPT reply (for mention @lunabot:localhost) => Hello! How can I assist you today?
2025-01-08 01:45:32,949 [INFO] src.luna_functions: Posted GPT reply to room !FkbKmoFPWsWYTwKnwg:localhost
2025-01-08 01:45:32,949 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:45:32,949 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 01:45:32,949 [DEBUG] src.luna_functions_handledispatch: User message => 'lunabot: respont?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 01:45:32,949 [DEBUG] src.luna_functions_handledispatch: m.mentions => {'user_ids': ['@lunabot:localhost']}
2025-01-08 01:45:32,949 [INFO] src.luna_functions_handledispatch: Mentioned user_ids => ['@lunabot:localhost']
2025-01-08 01:45:32,949 [INFO] src.luna_functions_handledispatch: Processing mention for user => @lunabot:localhost
2025-01-08 01:45:32,951 [DEBUG] openai._base_client: Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': 'You are a helpful bot responding to a mention of @lunabot:localhost.'}, {'role': 'user', 'content': 'lunabot: respont?'}], 'model': 'gpt-4', 'max_tokens': 300, 'temperature': 0.7}}
2025-01-08 01:45:32,952 [DEBUG] httpcore.http11: send_request_headers.started request=<Request [b'POST']>
2025-01-08 01:45:32,952 [DEBUG] httpcore.http11: send_request_headers.complete
2025-01-08 01:45:32,952 [DEBUG] httpcore.http11: send_request_body.started request=<Request [b'POST']>
2025-01-08 01:45:32,953 [DEBUG] httpcore.http11: send_request_body.complete
2025-01-08 01:45:32,953 [DEBUG] httpcore.http11: receive_response_headers.started request=<Request [b'POST']>
2025-01-08 01:45:33,475 [DEBUG] httpcore.http11: receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Wed, 08 Jan 2025 06:45:33 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-yzbp3micnvwwjimbcblinra3'), (b'openai-processing-ms', b'452'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'5000'), (b'x-ratelimit-limit-tokens', b'80000'), (b'x-ratelimit-remaining-requests', b'4999'), (b'x-ratelimit-remaining-tokens', b'79676'), (b'x-ratelimit-reset-requests', b'12ms'), (b'x-ratelimit-reset-tokens', b'243ms'), (b'x-request-id', b'req_df9c839cc8ff2404c9d6ac8333de6de6'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8fea39b14cad8fc4-BOS'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2025-01-08 01:45:33,476 [INFO] httpx: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-08 01:45:33,476 [DEBUG] httpcore.http11: receive_response_body.started request=<Request [b'POST']>
2025-01-08 01:45:33,478 [DEBUG] httpcore.http11: receive_response_body.complete
2025-01-08 01:45:33,479 [DEBUG] httpcore.http11: response_closed.started
2025-01-08 01:45:33,479 [DEBUG] httpcore.http11: response_closed.complete
2025-01-08 01:45:33,479 [DEBUG] openai._base_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "200 OK"
2025-01-08 01:45:33,482 [INFO] src.luna_functions_handledispatch: GPT reply (for mention @lunabot:localhost) => Of course! How can I assist you today?
2025-01-08 01:45:33,518 [INFO] src.luna_functions: Posted GPT reply to room !FkbKmoFPWsWYTwKnwg:localhost
2025-01-08 01:45:33,519 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:45:33,519 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 01:45:33,519 [DEBUG] src.luna_functions_handledispatch: User message => '@lunabot:localhost whwa'ts up' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 01:45:33,524 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 01:45:33,525 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 01:45:33,525 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:45:33,525 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 01:45:33,525 [DEBUG] src.luna_functions_handledispatch: User message => 'luna are you there?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 01:45:33,525 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 01:45:33,525 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 01:45:33,525 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:45:33,525 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 01:45:33,525 [DEBUG] src.luna_functions_handledispatch: User message => 'test' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 01:45:33,525 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 01:45:33,525 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 01:45:33,525 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:45:33,525 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 01:45:33,526 [DEBUG] src.luna_functions_handledispatch: User message => 'test' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 01:45:33,526 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 01:45:33,526 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 01:45:33,526 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:45:33,526 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 01:45:33,526 [DEBUG] src.luna_functions_handledispatch: User message => 'lunabot: ' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 01:45:33,526 [DEBUG] src.luna_functions_handledispatch: m.mentions => {'user_ids': ['@lunabot:localhost']}
2025-01-08 01:45:33,526 [INFO] src.luna_functions_handledispatch: Mentioned user_ids => ['@lunabot:localhost']
2025-01-08 01:45:33,526 [INFO] src.luna_functions_handledispatch: Processing mention for user => @lunabot:localhost
2025-01-08 01:45:33,533 [DEBUG] openai._base_client: Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': 'You are a helpful bot responding to a mention of @lunabot:localhost.'}, {'role': 'user', 'content': 'lunabot: '}], 'model': 'gpt-4', 'max_tokens': 300, 'temperature': 0.7}}
2025-01-08 01:45:33,534 [DEBUG] httpcore.http11: send_request_headers.started request=<Request [b'POST']>
2025-01-08 01:45:33,534 [DEBUG] httpcore.http11: send_request_headers.complete
2025-01-08 01:45:33,534 [DEBUG] httpcore.http11: send_request_body.started request=<Request [b'POST']>
2025-01-08 01:45:33,534 [DEBUG] httpcore.http11: send_request_body.complete
2025-01-08 01:45:33,534 [DEBUG] httpcore.http11: receive_response_headers.started request=<Request [b'POST']>
2025-01-08 01:45:34,525 [DEBUG] httpcore.http11: receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Wed, 08 Jan 2025 06:45:34 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-yzbp3micnvwwjimbcblinra3'), (b'openai-processing-ms', b'904'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'5000'), (b'x-ratelimit-limit-tokens', b'80000'), (b'x-ratelimit-remaining-requests', b'4999'), (b'x-ratelimit-remaining-tokens', b'79678'), (b'x-ratelimit-reset-requests', b'12ms'), (b'x-ratelimit-reset-tokens', b'241ms'), (b'x-request-id', b'req_45be2783da39c091e8fcee8fc4bdd48b'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8fea39b4eeba8fc4-BOS'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2025-01-08 01:45:34,526 [INFO] httpx: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-08 01:45:34,527 [DEBUG] httpcore.http11: receive_response_body.started request=<Request [b'POST']>
2025-01-08 01:45:34,528 [DEBUG] httpcore.http11: receive_response_body.complete
2025-01-08 01:45:34,528 [DEBUG] httpcore.http11: response_closed.started
2025-01-08 01:45:34,528 [DEBUG] httpcore.http11: response_closed.complete
2025-01-08 01:45:34,528 [DEBUG] openai._base_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "200 OK"
2025-01-08 01:45:34,529 [INFO] src.luna_functions_handledispatch: GPT reply (for mention @lunabot:localhost) => Hello! How can I assist you today?
2025-01-08 01:45:34,572 [INFO] src.luna_functions: Posted GPT reply to room !FkbKmoFPWsWYTwKnwg:localhost
2025-01-08 01:45:34,573 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:45:34,573 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 01:45:34,573 [DEBUG] src.luna_functions_handledispatch: User message => 'lunabot: ' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 01:45:34,573 [DEBUG] src.luna_functions_handledispatch: m.mentions => {'user_ids': ['@lunabot:localhost']}
2025-01-08 01:45:34,573 [INFO] src.luna_functions_handledispatch: Mentioned user_ids => ['@lunabot:localhost']
2025-01-08 01:45:34,573 [INFO] src.luna_functions_handledispatch: Processing mention for user => @lunabot:localhost
2025-01-08 01:45:34,581 [DEBUG] openai._base_client: Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': 'You are a helpful bot responding to a mention of @lunabot:localhost.'}, {'role': 'user', 'content': 'lunabot: '}], 'model': 'gpt-4', 'max_tokens': 300, 'temperature': 0.7}}
2025-01-08 01:45:34,583 [DEBUG] httpcore.http11: send_request_headers.started request=<Request [b'POST']>
2025-01-08 01:45:34,583 [DEBUG] httpcore.http11: send_request_headers.complete
2025-01-08 01:45:34,584 [DEBUG] httpcore.http11: send_request_body.started request=<Request [b'POST']>
2025-01-08 01:45:34,584 [DEBUG] httpcore.http11: send_request_body.complete
2025-01-08 01:45:34,584 [DEBUG] httpcore.http11: receive_response_headers.started request=<Request [b'POST']>
2025-01-08 01:45:35,369 [DEBUG] httpcore.http11: receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Wed, 08 Jan 2025 06:45:35 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-yzbp3micnvwwjimbcblinra3'), (b'openai-processing-ms', b'706'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'5000'), (b'x-ratelimit-limit-tokens', b'80000'), (b'x-ratelimit-remaining-requests', b'4999'), (b'x-ratelimit-remaining-tokens', b'79678'), (b'x-ratelimit-reset-requests', b'12ms'), (b'x-ratelimit-reset-tokens', b'241ms'), (b'x-request-id', b'req_8b3669b68fc9a557580312da863a503c'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8fea39bb7b2c8fc4-BOS'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2025-01-08 01:45:35,372 [INFO] httpx: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-08 01:45:35,373 [DEBUG] httpcore.http11: receive_response_body.started request=<Request [b'POST']>
2025-01-08 01:45:35,375 [DEBUG] httpcore.http11: receive_response_body.complete
2025-01-08 01:45:35,375 [DEBUG] httpcore.http11: response_closed.started
2025-01-08 01:45:35,375 [DEBUG] httpcore.http11: response_closed.complete
2025-01-08 01:45:35,376 [DEBUG] openai._base_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "200 OK"
2025-01-08 01:45:35,377 [INFO] src.luna_functions_handledispatch: GPT reply (for mention @lunabot:localhost) => Hello! How can I assist you today?
2025-01-08 01:45:35,414 [INFO] src.luna_functions: Posted GPT reply to room !FkbKmoFPWsWYTwKnwg:localhost
2025-01-08 01:45:35,414 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:45:35,414 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 01:45:35,414 [DEBUG] src.luna_functions_handledispatch: User message => 'lunabot: are you online?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 01:45:35,414 [DEBUG] src.luna_functions_handledispatch: m.mentions => {'user_ids': ['@lunabot:localhost']}
2025-01-08 01:45:35,414 [INFO] src.luna_functions_handledispatch: Mentioned user_ids => ['@lunabot:localhost']
2025-01-08 01:45:35,414 [INFO] src.luna_functions_handledispatch: Processing mention for user => @lunabot:localhost
2025-01-08 01:45:35,417 [DEBUG] openai._base_client: Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': 'You are a helpful bot responding to a mention of @lunabot:localhost.'}, {'role': 'user', 'content': 'lunabot: are you online?'}], 'model': 'gpt-4', 'max_tokens': 300, 'temperature': 0.7}}
2025-01-08 01:45:35,418 [DEBUG] httpcore.http11: send_request_headers.started request=<Request [b'POST']>
2025-01-08 01:45:35,418 [DEBUG] httpcore.http11: send_request_headers.complete
2025-01-08 01:45:35,418 [DEBUG] httpcore.http11: send_request_body.started request=<Request [b'POST']>
2025-01-08 01:45:35,419 [DEBUG] httpcore.http11: send_request_body.complete
2025-01-08 01:45:35,419 [DEBUG] httpcore.http11: receive_response_headers.started request=<Request [b'POST']>
2025-01-08 01:45:36,344 [DEBUG] httpcore.http11: receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Wed, 08 Jan 2025 06:45:36 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-yzbp3micnvwwjimbcblinra3'), (b'openai-processing-ms', b'838'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'5000'), (b'x-ratelimit-limit-tokens', b'80000'), (b'x-ratelimit-remaining-requests', b'4999'), (b'x-ratelimit-remaining-tokens', b'79675'), (b'x-ratelimit-reset-requests', b'12ms'), (b'x-ratelimit-reset-tokens', b'243ms'), (b'x-request-id', b'req_65a64b4f154314967567a49e0bfa18fa'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8fea39c0adfe8fc4-BOS'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2025-01-08 01:45:36,346 [INFO] httpx: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-08 01:45:36,346 [DEBUG] httpcore.http11: receive_response_body.started request=<Request [b'POST']>
2025-01-08 01:45:36,347 [DEBUG] httpcore.http11: receive_response_body.complete
2025-01-08 01:45:36,347 [DEBUG] httpcore.http11: response_closed.started
2025-01-08 01:45:36,347 [DEBUG] httpcore.http11: response_closed.complete
2025-01-08 01:45:36,348 [DEBUG] openai._base_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "200 OK"
2025-01-08 01:45:36,348 [INFO] src.luna_functions_handledispatch: GPT reply (for mention @lunabot:localhost) => Yes, I am online and ready to assist you. How can I help you today?
2025-01-08 01:45:36,379 [INFO] src.luna_functions: Posted GPT reply to room !FkbKmoFPWsWYTwKnwg:localhost
2025-01-08 01:45:36,389 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:45:36,389 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 01:45:36,389 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! Yes, I'm here and ready to assist you. How can I help you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 01:45:36,389 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 01:45:36,389 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 01:45:36,389 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:45:36,389 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 01:45:36,389 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 01:45:36,389 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 01:45:36,390 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 01:45:36,390 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:45:36,390 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 01:45:36,390 [DEBUG] src.luna_functions_handledispatch: User message => 'Of course! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 01:45:36,390 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 01:45:36,390 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 01:45:36,390 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:45:36,390 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 01:45:36,390 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 01:45:36,390 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 01:45:36,390 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 01:45:36,390 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:45:36,390 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 01:45:36,390 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 01:45:36,390 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 01:45:36,390 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 01:45:36,390 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:45:36,391 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 01:45:36,391 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I am online and ready to assist you. How can I help you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 01:45:36,391 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 01:45:36,391 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 01:45:42,219 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:45:42,219 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 01:45:42,219 [DEBUG] src.luna_functions_handledispatch: User message => 'lunabot: ' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 01:45:42,219 [DEBUG] src.luna_functions_handledispatch: m.mentions => {'user_ids': ['@lunabot:localhost']}
2025-01-08 01:45:42,219 [INFO] src.luna_functions_handledispatch: Mentioned user_ids => ['@lunabot:localhost']
2025-01-08 01:45:42,219 [INFO] src.luna_functions_handledispatch: Processing mention for user => @lunabot:localhost
2025-01-08 01:45:42,223 [DEBUG] openai._base_client: Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': 'You are a helpful bot responding to a mention of @lunabot:localhost.'}, {'role': 'user', 'content': 'lunabot: '}], 'model': 'gpt-4', 'max_tokens': 300, 'temperature': 0.7}}
2025-01-08 01:45:42,224 [DEBUG] httpcore.connection: close.started
2025-01-08 01:45:42,224 [DEBUG] httpcore.connection: close.complete
2025-01-08 01:45:42,225 [DEBUG] httpcore.connection: connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2025-01-08 01:45:42,245 [DEBUG] httpcore.connection: connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10fa09d10>
2025-01-08 01:45:42,246 [DEBUG] httpcore.connection: start_tls.started ssl_context=<ssl.SSLContext object at 0x1072522a0> server_hostname='api.openai.com' timeout=5.0
2025-01-08 01:45:42,276 [DEBUG] httpcore.connection: start_tls.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10f90dba0>
2025-01-08 01:45:42,277 [DEBUG] httpcore.http11: send_request_headers.started request=<Request [b'POST']>
2025-01-08 01:45:42,277 [DEBUG] httpcore.http11: send_request_headers.complete
2025-01-08 01:45:42,277 [DEBUG] httpcore.http11: send_request_body.started request=<Request [b'POST']>
2025-01-08 01:45:42,277 [DEBUG] httpcore.http11: send_request_body.complete
2025-01-08 01:45:42,277 [DEBUG] httpcore.http11: receive_response_headers.started request=<Request [b'POST']>
2025-01-08 01:45:43,249 [DEBUG] httpcore.http11: receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Wed, 08 Jan 2025 06:45:43 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-yzbp3micnvwwjimbcblinra3'), (b'openai-processing-ms', b'906'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'5000'), (b'x-ratelimit-limit-tokens', b'80000'), (b'x-ratelimit-remaining-requests', b'4999'), (b'x-ratelimit-remaining-tokens', b'79678'), (b'x-ratelimit-reset-requests', b'12ms'), (b'x-ratelimit-reset-tokens', b'241ms'), (b'x-request-id', b'req_3c7e41d1e3ff5220f8e3bfc64a9b4848'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8fea39eb8aeb4d1d-BOS'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2025-01-08 01:45:43,251 [INFO] httpx: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-08 01:45:43,251 [DEBUG] httpcore.http11: receive_response_body.started request=<Request [b'POST']>
2025-01-08 01:45:43,252 [DEBUG] httpcore.http11: receive_response_body.complete
2025-01-08 01:45:43,252 [DEBUG] httpcore.http11: response_closed.started
2025-01-08 01:45:43,252 [DEBUG] httpcore.http11: response_closed.complete
2025-01-08 01:45:43,252 [DEBUG] openai._base_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "200 OK"
2025-01-08 01:45:43,253 [INFO] src.luna_functions_handledispatch: GPT reply (for mention @lunabot:localhost) => Hello! How can I assist you today?
2025-01-08 01:45:43,283 [INFO] src.luna_functions: Posted GPT reply to room !FkbKmoFPWsWYTwKnwg:localhost
2025-01-08 01:45:43,292 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:45:43,293 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 01:45:43,293 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 01:45:43,293 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 01:45:43,295 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 01:48:29,518 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 01:48:40,897 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 01:53:13,827 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 01:54:04,025 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 01:54:08,976 [DEBUG] src.console_functions: Showing help to user.
2025-01-08 01:54:08,979 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 01:56:23,424 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 01:56:33,012 [INFO] src.console_functions: Console received 'exit' command; requesting shutdown.
2025-01-08 01:56:33,013 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 01:56:33,013 [ERROR] __main__: An unexpected exception occurred in main_logic: Event loop stopped before Future completed.
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/./luna.py", line 135, in luna
    loop.run_until_complete(main_logic())
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 718, in run_until_complete
    raise RuntimeError('Event loop stopped before Future completed.')
RuntimeError: Event loop stopped before Future completed.
2025-01-08 01:56:33,020 [DEBUG] __main__: Preparing to close the event loop.
2025-01-08 01:56:33,021 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-08 01:58:39,307 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-08 01:58:39,307 [DEBUG] __main__: Exiting configure_logging function.
2025-01-08 01:58:39,307 [DEBUG] __main__: Logging configuration complete.
2025-01-08 01:58:39,307 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-08 01:58:39,307 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 01:58:39,307 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-08 01:58:39,307 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-08 01:58:39,307 [DEBUG] __main__: Entering start_console_thread function.
2025-01-08 01:58:39,309 [INFO] __main__: Console thread started successfully.
2025-01-08 01:58:39,309 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-08 01:58:39,309 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-08 01:58:39,309 [INFO] __main__: Starting main_logic coroutine.
2025-01-08 01:58:39,309 [DEBUG] __main__: Entering main_logic function...
2025-01-08 01:58:39,310 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-08 01:58:39,312 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-08 01:58:39,312 [INFO] src.luna_functions: Using saved token for user @lunabot:localhost.
2025-01-08 01:58:39,312 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-08 01:58:39,315 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 01:58:39,367 [INFO] nio.client.base_client: New joined room !HPrbJYfQkoGnlztkrS:localhost
2025-01-08 01:58:39,367 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-08 01:58:39,367 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomNameEvent
2025-01-08 01:58:39,367 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomJoinRulesEvent
2025-01-08 01:58:39,367 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type PowerLevelsEvent
2025-01-08 01:58:39,367 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-08 01:58:39,367 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomCreateEvent
2025-01-08 01:58:39,368 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomGuestAccessEvent
2025-01-08 01:58:39,368 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 01:58:39,368 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 01:58:39,368 [DEBUG] src.luna_functions_handledispatch: User message => 'are you there @luna?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 01:58:39,368 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 01:58:39,368 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 01:58:39,368 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 01:58:39,368 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 01:58:39,368 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here. How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 01:58:39,368 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 01:58:39,368 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 01:58:39,368 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 01:58:39,368 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 01:58:39,368 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here. How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 01:58:39,368 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 01:58:39,368 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 01:58:39,368 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 01:58:39,368 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 01:58:39,368 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here. How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 01:58:39,368 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 01:58:39,368 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 01:58:39,368 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 01:58:39,368 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 01:58:39,368 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here! How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 01:58:39,368 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 01:58:39,368 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 01:58:39,368 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 01:58:39,368 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 01:58:39,368 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here. How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 01:58:39,368 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 01:58:39,368 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 01:58:39,368 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 01:58:39,368 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 01:58:39,368 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here! How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 01:58:39,368 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 01:58:39,368 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 01:58:39,368 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 01:58:39,368 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 01:58:39,368 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here. How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 01:58:39,368 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 01:58:39,368 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 01:58:39,368 [INFO] nio.client.base_client: New joined room !FkbKmoFPWsWYTwKnwg:localhost
2025-01-08 01:58:39,368 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type PowerLevelsEvent
2025-01-08 01:58:39,368 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-08 01:58:39,368 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomJoinRulesEvent
2025-01-08 01:58:39,368 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomGuestAccessEvent
2025-01-08 01:58:39,368 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-08 01:58:39,368 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomCreateEvent
2025-01-08 01:58:39,368 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:58:39,368 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 01:58:39,368 [DEBUG] src.luna_functions_handledispatch: User message => 'lunabot: ' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 01:58:39,368 [DEBUG] src.luna_functions_handledispatch: m.mentions => {'user_ids': ['@lunabot:localhost']}
2025-01-08 01:58:39,368 [INFO] src.luna_functions_handledispatch: Mentioned user_ids => ['@lunabot:localhost']
2025-01-08 01:58:39,368 [INFO] src.luna_functions_handledispatch: Processing mention for user => @lunabot:localhost
2025-01-08 01:58:39,401 [DEBUG] openai._base_client: Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': 'You are a helpful bot responding to a mention of @lunabot:localhost.'}, {'role': 'user', 'content': 'lunabot: '}], 'model': 'gpt-4', 'max_tokens': 300, 'temperature': 0.7}}
2025-01-08 01:58:39,407 [DEBUG] httpcore.connection: connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2025-01-08 01:58:39,489 [DEBUG] httpcore.connection: connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10e348050>
2025-01-08 01:58:39,489 [DEBUG] httpcore.connection: start_tls.started ssl_context=<ssl.SSLContext object at 0x105ba6330> server_hostname='api.openai.com' timeout=5.0
2025-01-08 01:58:39,518 [DEBUG] httpcore.connection: start_tls.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10e2a39d0>
2025-01-08 01:58:39,519 [DEBUG] httpcore.http11: send_request_headers.started request=<Request [b'POST']>
2025-01-08 01:58:39,519 [DEBUG] httpcore.http11: send_request_headers.complete
2025-01-08 01:58:39,519 [DEBUG] httpcore.http11: send_request_body.started request=<Request [b'POST']>
2025-01-08 01:58:39,519 [DEBUG] httpcore.http11: send_request_body.complete
2025-01-08 01:58:39,519 [DEBUG] httpcore.http11: receive_response_headers.started request=<Request [b'POST']>
2025-01-08 01:58:40,319 [DEBUG] httpcore.http11: receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Wed, 08 Jan 2025 06:58:40 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-yzbp3micnvwwjimbcblinra3'), (b'openai-processing-ms', b'661'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'5000'), (b'x-ratelimit-limit-tokens', b'80000'), (b'x-ratelimit-remaining-requests', b'4999'), (b'x-ratelimit-remaining-tokens', b'79678'), (b'x-ratelimit-reset-requests', b'12ms'), (b'x-ratelimit-reset-tokens', b'241ms'), (b'x-request-id', b'req_c748c2d8b833b619cb752eb06d4586b7'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=1De0skLW4wfnO_NSfYlfoDq_yDNCZSZtbCk1hgQ9Isg-1736319520-1.0.1.1-36TPryJrXgR78gqXtqRl_A.3AVpRF_JhLc3dj0KW6TMkrCLJO5hkl0fer6n6_3md3fwO_aSMiZ9qDXQx8VCYqw; path=/; expires=Wed, 08-Jan-25 07:28:40 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=2Mz9GqzRtv60jVbaGjS88vSNdMmx8xdHjo.ZHKChsBg-1736319520252-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8fea4ce52e148fcc-BOS'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2025-01-08 01:58:40,322 [INFO] httpx: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-08 01:58:40,322 [DEBUG] httpcore.http11: receive_response_body.started request=<Request [b'POST']>
2025-01-08 01:58:40,323 [DEBUG] httpcore.http11: receive_response_body.complete
2025-01-08 01:58:40,323 [DEBUG] httpcore.http11: response_closed.started
2025-01-08 01:58:40,323 [DEBUG] httpcore.http11: response_closed.complete
2025-01-08 01:58:40,323 [DEBUG] openai._base_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "200 OK"
2025-01-08 01:58:40,331 [INFO] src.luna_functions_handledispatch: GPT reply (for mention @lunabot:localhost) => Hello! How can I assist you today?
2025-01-08 01:58:40,382 [INFO] src.luna_functions: Posted GPT reply to room !FkbKmoFPWsWYTwKnwg:localhost
2025-01-08 01:58:40,382 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:58:40,382 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 01:58:40,382 [DEBUG] src.luna_functions_handledispatch: User message => 'lunabot: are you online?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 01:58:40,382 [DEBUG] src.luna_functions_handledispatch: m.mentions => {'user_ids': ['@lunabot:localhost']}
2025-01-08 01:58:40,382 [INFO] src.luna_functions_handledispatch: Mentioned user_ids => ['@lunabot:localhost']
2025-01-08 01:58:40,383 [INFO] src.luna_functions_handledispatch: Processing mention for user => @lunabot:localhost
2025-01-08 01:58:40,385 [DEBUG] openai._base_client: Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': 'You are a helpful bot responding to a mention of @lunabot:localhost.'}, {'role': 'user', 'content': 'lunabot: are you online?'}], 'model': 'gpt-4', 'max_tokens': 300, 'temperature': 0.7}}
2025-01-08 01:58:40,386 [DEBUG] httpcore.http11: send_request_headers.started request=<Request [b'POST']>
2025-01-08 01:58:40,386 [DEBUG] httpcore.http11: send_request_headers.complete
2025-01-08 01:58:40,386 [DEBUG] httpcore.http11: send_request_body.started request=<Request [b'POST']>
2025-01-08 01:58:40,386 [DEBUG] httpcore.http11: send_request_body.complete
2025-01-08 01:58:40,386 [DEBUG] httpcore.http11: receive_response_headers.started request=<Request [b'POST']>
2025-01-08 01:58:41,072 [DEBUG] httpcore.http11: receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Wed, 08 Jan 2025 06:58:41 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-yzbp3micnvwwjimbcblinra3'), (b'openai-processing-ms', b'556'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'5000'), (b'x-ratelimit-limit-tokens', b'80000'), (b'x-ratelimit-remaining-requests', b'4999'), (b'x-ratelimit-remaining-tokens', b'79675'), (b'x-ratelimit-reset-requests', b'12ms'), (b'x-ratelimit-reset-tokens', b'243ms'), (b'x-request-id', b'req_1e69815cb79e72837d8cca7e5d416765'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8fea4cea8a1c8fcc-BOS'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2025-01-08 01:58:41,073 [INFO] httpx: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-08 01:58:41,074 [DEBUG] httpcore.http11: receive_response_body.started request=<Request [b'POST']>
2025-01-08 01:58:41,075 [DEBUG] httpcore.http11: receive_response_body.complete
2025-01-08 01:58:41,075 [DEBUG] httpcore.http11: response_closed.started
2025-01-08 01:58:41,075 [DEBUG] httpcore.http11: response_closed.complete
2025-01-08 01:58:41,075 [DEBUG] openai._base_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "200 OK"
2025-01-08 01:58:41,076 [INFO] src.luna_functions_handledispatch: GPT reply (for mention @lunabot:localhost) => Yes, I'm online and ready to assist you. How can I help you today?
2025-01-08 01:58:41,106 [INFO] src.luna_functions: Posted GPT reply to room !FkbKmoFPWsWYTwKnwg:localhost
2025-01-08 01:58:41,107 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:58:41,107 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 01:58:41,107 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! Yes, I'm here and ready to assist you. How can I help you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 01:58:41,107 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 01:58:41,107 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 01:58:41,108 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:58:41,108 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 01:58:41,108 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 01:58:41,108 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 01:58:41,108 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 01:58:41,108 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:58:41,108 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 01:58:41,108 [DEBUG] src.luna_functions_handledispatch: User message => 'Of course! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 01:58:41,108 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 01:58:41,108 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 01:58:41,109 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:58:41,109 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 01:58:41,109 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 01:58:41,109 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 01:58:41,109 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 01:58:41,109 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:58:41,109 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 01:58:41,109 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 01:58:41,110 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 01:58:41,110 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 01:58:41,110 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:58:41,110 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 01:58:41,110 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I am online and ready to assist you. How can I help you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 01:58:41,110 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 01:58:41,110 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 01:58:41,110 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:58:41,110 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 01:58:41,110 [DEBUG] src.luna_functions_handledispatch: User message => 'lunabot: ' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 01:58:41,110 [DEBUG] src.luna_functions_handledispatch: m.mentions => {'user_ids': ['@lunabot:localhost']}
2025-01-08 01:58:41,111 [INFO] src.luna_functions_handledispatch: Mentioned user_ids => ['@lunabot:localhost']
2025-01-08 01:58:41,111 [INFO] src.luna_functions_handledispatch: Processing mention for user => @lunabot:localhost
2025-01-08 01:58:41,118 [DEBUG] openai._base_client: Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': 'You are a helpful bot responding to a mention of @lunabot:localhost.'}, {'role': 'user', 'content': 'lunabot: '}], 'model': 'gpt-4', 'max_tokens': 300, 'temperature': 0.7}}
2025-01-08 01:58:41,120 [DEBUG] httpcore.http11: send_request_headers.started request=<Request [b'POST']>
2025-01-08 01:58:41,120 [DEBUG] httpcore.http11: send_request_headers.complete
2025-01-08 01:58:41,121 [DEBUG] httpcore.http11: send_request_body.started request=<Request [b'POST']>
2025-01-08 01:58:41,121 [DEBUG] httpcore.http11: send_request_body.complete
2025-01-08 01:58:41,121 [DEBUG] httpcore.http11: receive_response_headers.started request=<Request [b'POST']>
2025-01-08 01:58:41,689 [DEBUG] httpcore.http11: receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Wed, 08 Jan 2025 06:58:41 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-yzbp3micnvwwjimbcblinra3'), (b'openai-processing-ms', b'484'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'5000'), (b'x-ratelimit-limit-tokens', b'80000'), (b'x-ratelimit-remaining-requests', b'4999'), (b'x-ratelimit-remaining-tokens', b'79678'), (b'x-ratelimit-reset-requests', b'12ms'), (b'x-ratelimit-reset-tokens', b'241ms'), (b'x-request-id', b'req_4a15193307b163fa8f193bccd6dd67f8'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8fea4cef2de38fcc-BOS'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2025-01-08 01:58:41,689 [INFO] httpx: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-08 01:58:41,690 [DEBUG] httpcore.http11: receive_response_body.started request=<Request [b'POST']>
2025-01-08 01:58:41,693 [DEBUG] httpcore.http11: receive_response_body.complete
2025-01-08 01:58:41,693 [DEBUG] httpcore.http11: response_closed.started
2025-01-08 01:58:41,693 [DEBUG] httpcore.http11: response_closed.complete
2025-01-08 01:58:41,693 [DEBUG] openai._base_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "200 OK"
2025-01-08 01:58:41,694 [INFO] src.luna_functions_handledispatch: GPT reply (for mention @lunabot:localhost) => Hello! How can I assist you today?
2025-01-08 01:58:41,721 [INFO] src.luna_functions: Posted GPT reply to room !FkbKmoFPWsWYTwKnwg:localhost
2025-01-08 01:58:41,721 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:58:41,721 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 01:58:41,721 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 01:58:41,721 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 01:58:41,721 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 01:58:41,730 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:58:41,731 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 01:58:41,731 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 01:58:41,731 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 01:58:41,731 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 01:58:41,731 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:58:41,731 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 01:58:41,731 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm online and ready to assist you. How can I help you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 01:58:41,731 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 01:58:41,731 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 01:58:41,731 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 01:58:41,731 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 01:58:41,731 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 01:58:41,731 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 01:58:41,731 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:00:49,650 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 02:00:53,852 [INFO] src.console_apparatus: User exited the console (EOF or KeyboardInterrupt).
2025-01-08 02:01:30,333 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-08 02:01:30,333 [DEBUG] __main__: Exiting configure_logging function.
2025-01-08 02:01:30,333 [DEBUG] __main__: Logging configuration complete.
2025-01-08 02:01:30,333 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-08 02:01:30,333 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 02:01:30,333 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-08 02:01:30,333 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-08 02:01:30,333 [DEBUG] __main__: Entering start_console_thread function.
2025-01-08 02:01:30,336 [INFO] __main__: Console thread started successfully.
2025-01-08 02:01:30,336 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-08 02:01:30,336 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-08 02:01:30,336 [INFO] __main__: Starting main_logic coroutine.
2025-01-08 02:01:30,336 [DEBUG] __main__: Entering main_logic function...
2025-01-08 02:01:30,336 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-08 02:01:30,338 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-08 02:01:30,338 [INFO] src.luna_functions: Using saved token for user @lunabot:localhost.
2025-01-08 02:01:30,338 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-08 02:01:30,342 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 02:01:30,376 [INFO] nio.client.base_client: New joined room !HPrbJYfQkoGnlztkrS:localhost
2025-01-08 02:01:30,376 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-08 02:01:30,376 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomNameEvent
2025-01-08 02:01:30,376 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomJoinRulesEvent
2025-01-08 02:01:30,376 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type PowerLevelsEvent
2025-01-08 02:01:30,376 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-08 02:01:30,376 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomCreateEvent
2025-01-08 02:01:30,376 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomGuestAccessEvent
2025-01-08 02:01:30,376 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:01:30,376 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:01:30,376 [DEBUG] src.luna_functions_handledispatch: User message => 'are you there @luna?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:01:30,376 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:01:30,376 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:01:30,376 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:01:30,376 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:01:30,376 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here. How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:01:30,376 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:01:30,376 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:01:30,376 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:01:30,376 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:01:30,376 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here. How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:01:30,376 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:01:30,376 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:01:30,377 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:01:30,377 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:01:30,377 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here. How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:01:30,377 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:01:30,377 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:01:30,377 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:01:30,377 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:01:30,377 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here! How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:01:30,377 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:01:30,377 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:01:30,377 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:01:30,377 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:01:30,377 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here. How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:01:30,377 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:01:30,377 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:01:30,377 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:01:30,377 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:01:30,377 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here! How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:01:30,377 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:01:30,377 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:01:30,377 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:01:30,377 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:01:30,377 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here. How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:01:30,377 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:01:30,377 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:01:30,377 [INFO] nio.client.base_client: New joined room !FkbKmoFPWsWYTwKnwg:localhost
2025-01-08 02:01:30,377 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type PowerLevelsEvent
2025-01-08 02:01:30,377 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-08 02:01:30,377 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomJoinRulesEvent
2025-01-08 02:01:30,377 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomGuestAccessEvent
2025-01-08 02:01:30,377 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-08 02:01:30,377 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomCreateEvent
2025-01-08 02:01:30,377 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:01:30,377 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:01:30,377 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:01:30,377 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:01:30,377 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:01:30,377 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:01:30,377 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:01:30,377 [DEBUG] src.luna_functions_handledispatch: User message => 'Of course! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:01:30,377 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:01:30,377 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:01:30,377 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:01:30,377 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:01:30,377 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:01:30,377 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:01:30,377 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:01:30,377 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:01:30,377 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:01:30,377 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:01:30,377 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:01:30,377 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:01:30,377 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:01:30,377 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:01:30,377 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I am online and ready to assist you. How can I help you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:01:30,377 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:01:30,377 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:01:30,377 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:01:30,377 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:01:30,377 [DEBUG] src.luna_functions_handledispatch: User message => 'lunabot: ' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:01:30,377 [DEBUG] src.luna_functions_handledispatch: m.mentions => {'user_ids': ['@lunabot:localhost']}
2025-01-08 02:01:30,377 [INFO] src.luna_functions_handledispatch: Mentioned user_ids => ['@lunabot:localhost']
2025-01-08 02:01:30,377 [INFO] src.luna_functions_handledispatch: Processing mention for user => @lunabot:localhost
2025-01-08 02:01:30,396 [DEBUG] openai._base_client: Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': 'You are a helpful bot responding to a mention of @lunabot:localhost.'}, {'role': 'user', 'content': 'lunabot: '}], 'model': 'gpt-4', 'max_tokens': 300, 'temperature': 0.7}}
2025-01-08 02:01:30,399 [DEBUG] httpcore.connection: connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2025-01-08 02:01:30,489 [DEBUG] httpcore.connection: connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10db28050>
2025-01-08 02:01:30,489 [DEBUG] httpcore.connection: start_tls.started ssl_context=<ssl.SSLContext object at 0x104b6e330> server_hostname='api.openai.com' timeout=5.0
2025-01-08 02:01:30,520 [DEBUG] httpcore.connection: start_tls.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10da7f9d0>
2025-01-08 02:01:30,520 [DEBUG] httpcore.http11: send_request_headers.started request=<Request [b'POST']>
2025-01-08 02:01:30,520 [DEBUG] httpcore.http11: send_request_headers.complete
2025-01-08 02:01:30,520 [DEBUG] httpcore.http11: send_request_body.started request=<Request [b'POST']>
2025-01-08 02:01:30,521 [DEBUG] httpcore.http11: send_request_body.complete
2025-01-08 02:01:30,521 [DEBUG] httpcore.http11: receive_response_headers.started request=<Request [b'POST']>
2025-01-08 02:01:31,525 [DEBUG] httpcore.http11: receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Wed, 08 Jan 2025 07:01:31 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-yzbp3micnvwwjimbcblinra3'), (b'openai-processing-ms', b'929'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'5000'), (b'x-ratelimit-limit-tokens', b'80000'), (b'x-ratelimit-remaining-requests', b'4999'), (b'x-ratelimit-remaining-tokens', b'79678'), (b'x-ratelimit-reset-requests', b'12ms'), (b'x-ratelimit-reset-tokens', b'241ms'), (b'x-request-id', b'req_1366e967ca4f433ac8f02d46089ee4f1'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=IUYCjNZ79OGQ9HuomkDHWj7_va3Hc1hCV6I2wDbhcws-1736319691-1.0.1.1-faXHf4iFZ8D2uhEufsj0QQBRn_s4VUa722Gq12GPQa7ncpetaTR3U4OKMo9_7x108QFSxOM2pGEw964sKyGSCA; path=/; expires=Wed, 08-Jan-25 07:31:31 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=hVcsuMDx_3grk07KsTXdeVp6qpodJZMsMeL3YuZXr18-1736319691522-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8fea5111eb148fe4-BOS'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2025-01-08 02:01:31,526 [INFO] httpx: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-08 02:01:31,526 [DEBUG] httpcore.http11: receive_response_body.started request=<Request [b'POST']>
2025-01-08 02:01:31,527 [DEBUG] httpcore.http11: receive_response_body.complete
2025-01-08 02:01:31,527 [DEBUG] httpcore.http11: response_closed.started
2025-01-08 02:01:31,527 [DEBUG] httpcore.http11: response_closed.complete
2025-01-08 02:01:31,527 [DEBUG] openai._base_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "200 OK"
2025-01-08 02:01:31,530 [INFO] src.luna_functions_handledispatch: GPT reply (for mention @lunabot:localhost) => Hello! How can I assist you today?
2025-01-08 02:01:31,564 [INFO] src.luna_functions: Posted GPT reply to room !FkbKmoFPWsWYTwKnwg:localhost
2025-01-08 02:01:31,564 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:01:31,564 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:01:31,564 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:01:31,564 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:01:31,564 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:01:31,564 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:01:31,564 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:01:31,564 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:01:31,564 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:01:31,564 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:01:31,564 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:01:31,564 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:01:31,564 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm online and ready to assist you. How can I help you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:01:31,564 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:01:31,564 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:01:31,564 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:01:31,564 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:01:31,564 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:01:31,564 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:01:31,564 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:01:31,573 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:01:31,573 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:01:31,573 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:01:31,573 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:01:31,573 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:02:11,188 [INFO] src.luna_functions: Creating user @blackbeard:localhost, admin=False via http://localhost:8008/_synapse/admin/v2/users/@blackbeard:localhost
2025-01-08 02:02:11,471 [INFO] src.luna_functions: Created user @blackbeard:localhost (HTTP 201)
2025-01-08 02:02:11,474 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 02:02:21,737 [INFO] src.luna_functions: Creating user @annebonny:localhost, admin=False via http://localhost:8008/_synapse/admin/v2/users/@annebonny:localhost
2025-01-08 02:02:22,004 [INFO] src.luna_functions: Created user @annebonny:localhost (HTTP 201)
2025-01-08 02:02:22,005 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 02:02:30,002 [INFO] src.luna_functions: Creating user @calicojack:localhost, admin=False via http://localhost:8008/_synapse/admin/v2/users/@calicojack:localhost
2025-01-08 02:02:30,281 [INFO] src.luna_functions: Created user @calicojack:localhost (HTTP 201)
2025-01-08 02:02:30,285 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 02:02:36,152 [INFO] src.luna_functions: Creating user @saltypirate:localhost, admin=False via http://localhost:8008/_synapse/admin/v2/users/@saltypirate:localhost
2025-01-08 02:02:36,428 [INFO] src.luna_functions: Created user @saltypirate:localhost (HTTP 201)
2025-01-08 02:02:36,430 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 02:02:41,724 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 02:02:53,597 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 02:03:03,664 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 02:03:05,176 [DEBUG] src.console_functions: Showing help to user.
2025-01-08 02:03:05,178 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 02:03:27,895 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 02:03:28,618 [INFO] src.console_functions: Console received 'exit' command; requesting shutdown.
2025-01-08 02:03:28,618 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 02:03:28,618 [ERROR] __main__: An unexpected exception occurred in main_logic: Event loop stopped before Future completed.
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 135, in luna
    loop.run_until_complete(main_logic())
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 718, in run_until_complete
    raise RuntimeError('Event loop stopped before Future completed.')
RuntimeError: Event loop stopped before Future completed.
2025-01-08 02:03:28,623 [DEBUG] __main__: Preparing to close the event loop.
2025-01-08 02:03:28,623 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-08 02:03:31,623 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-08 02:03:31,623 [DEBUG] __main__: Exiting configure_logging function.
2025-01-08 02:03:31,623 [DEBUG] __main__: Logging configuration complete.
2025-01-08 02:03:31,623 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-08 02:03:31,623 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 02:03:31,623 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-08 02:03:31,623 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-08 02:03:31,623 [DEBUG] __main__: Entering start_console_thread function.
2025-01-08 02:03:31,626 [INFO] __main__: Console thread started successfully.
2025-01-08 02:03:31,626 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-08 02:03:31,626 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-08 02:03:31,626 [INFO] __main__: Starting main_logic coroutine.
2025-01-08 02:03:31,626 [DEBUG] __main__: Entering main_logic function...
2025-01-08 02:03:31,626 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-08 02:03:31,628 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-08 02:03:31,628 [INFO] src.luna_functions: Using saved token for user @lunabot:localhost.
2025-01-08 02:03:31,628 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-08 02:03:31,632 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 02:03:31,664 [INFO] nio.client.base_client: New joined room !HPrbJYfQkoGnlztkrS:localhost
2025-01-08 02:03:31,664 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-08 02:03:31,664 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomNameEvent
2025-01-08 02:03:31,664 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomJoinRulesEvent
2025-01-08 02:03:31,664 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type PowerLevelsEvent
2025-01-08 02:03:31,664 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-08 02:03:31,664 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomCreateEvent
2025-01-08 02:03:31,664 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomGuestAccessEvent
2025-01-08 02:03:31,664 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:03:31,664 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:03:31,664 [DEBUG] src.luna_functions_handledispatch: User message => 'are you there @luna?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:03:31,664 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:03:31,664 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:03:31,664 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:03:31,664 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:03:31,664 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here. How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:03:31,664 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:03:31,664 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:03:31,664 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:03:31,664 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:03:31,664 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here. How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:03:31,664 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:03:31,664 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:03:31,664 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:03:31,664 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:03:31,664 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here. How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:03:31,664 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:03:31,664 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:03:31,664 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:03:31,664 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:03:31,664 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here! How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:03:31,664 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:03:31,664 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:03:31,664 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:03:31,664 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:03:31,664 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here. How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:03:31,664 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:03:31,664 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:03:31,664 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:03:31,664 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:03:31,664 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here! How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:03:31,664 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:03:31,664 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:03:31,664 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:03:31,664 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:03:31,664 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here. How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:03:31,665 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:03:31,665 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:03:31,665 [INFO] nio.client.base_client: New joined room !FkbKmoFPWsWYTwKnwg:localhost
2025-01-08 02:03:31,665 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type PowerLevelsEvent
2025-01-08 02:03:31,665 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-08 02:03:31,665 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomJoinRulesEvent
2025-01-08 02:03:31,665 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomGuestAccessEvent
2025-01-08 02:03:31,665 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-08 02:03:31,665 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomCreateEvent
2025-01-08 02:03:31,665 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:03:31,665 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:03:31,665 [DEBUG] src.luna_functions_handledispatch: User message => 'Of course! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:03:31,665 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:03:31,665 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:03:31,665 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:03:31,665 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:03:31,665 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:03:31,665 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:03:31,665 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:03:31,665 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:03:31,665 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:03:31,665 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:03:31,665 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:03:31,665 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:03:31,665 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:03:31,665 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:03:31,665 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I am online and ready to assist you. How can I help you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:03:31,665 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:03:31,665 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:03:31,665 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:03:31,665 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:03:31,665 [DEBUG] src.luna_functions_handledispatch: User message => 'lunabot: ' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:03:31,665 [DEBUG] src.luna_functions_handledispatch: m.mentions => {'user_ids': ['@lunabot:localhost']}
2025-01-08 02:03:31,665 [INFO] src.luna_functions_handledispatch: Mentioned user_ids => ['@lunabot:localhost']
2025-01-08 02:03:31,665 [INFO] src.luna_functions_handledispatch: Processing mention for user => @lunabot:localhost
2025-01-08 02:03:31,690 [DEBUG] openai._base_client: Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': 'You are a helpful bot responding to a mention of @lunabot:localhost.'}, {'role': 'user', 'content': 'lunabot: '}], 'model': 'gpt-4', 'max_tokens': 300, 'temperature': 0.7}}
2025-01-08 02:03:31,693 [DEBUG] httpcore.connection: connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2025-01-08 02:03:31,749 [DEBUG] httpcore.connection: connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x11812c050>
2025-01-08 02:03:31,749 [DEBUG] httpcore.connection: start_tls.started ssl_context=<ssl.SSLContext object at 0x106f6e330> server_hostname='api.openai.com' timeout=5.0
2025-01-08 02:03:31,779 [DEBUG] httpcore.connection: start_tls.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10ff6fed0>
2025-01-08 02:03:31,779 [DEBUG] httpcore.http11: send_request_headers.started request=<Request [b'POST']>
2025-01-08 02:03:31,780 [DEBUG] httpcore.http11: send_request_headers.complete
2025-01-08 02:03:31,780 [DEBUG] httpcore.http11: send_request_body.started request=<Request [b'POST']>
2025-01-08 02:03:31,780 [DEBUG] httpcore.http11: send_request_body.complete
2025-01-08 02:03:31,780 [DEBUG] httpcore.http11: receive_response_headers.started request=<Request [b'POST']>
2025-01-08 02:03:31,892 [INFO] src.console_functions: Console screen cleared.
2025-01-08 02:03:31,892 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 02:03:33,058 [DEBUG] httpcore.http11: receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Wed, 08 Jan 2025 07:03:33 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-yzbp3micnvwwjimbcblinra3'), (b'openai-processing-ms', b'1175'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'5000'), (b'x-ratelimit-limit-tokens', b'80000'), (b'x-ratelimit-remaining-requests', b'4999'), (b'x-ratelimit-remaining-tokens', b'79678'), (b'x-ratelimit-reset-requests', b'12ms'), (b'x-ratelimit-reset-tokens', b'241ms'), (b'x-request-id', b'req_4605626c5694e5222b0c3b628198a654'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=3Jo81O0RiUnPtskhSgsWmh5JrB0v6GlL9Hhz7pbf3Vo-1736319813-1.0.1.1-p6BFgr6Z1vMOBKRmL.W5sIwZfet7yibxOIOePKAfs5I2xLa3byitangkMZ9htqcWFZtYnRUw3CfcAOAVKE.Kcw; path=/; expires=Wed, 08-Jan-25 07:33:33 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=GH_YiT0DwMBDP9IOjItjDIiRiivz7I2CUs8Vfd9PJVo-1736319813051-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8fea5407bf7d8fb5-BOS'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2025-01-08 02:03:33,061 [INFO] httpx: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-08 02:03:33,062 [DEBUG] httpcore.http11: receive_response_body.started request=<Request [b'POST']>
2025-01-08 02:03:33,078 [DEBUG] httpcore.http11: receive_response_body.complete
2025-01-08 02:03:33,078 [DEBUG] httpcore.http11: response_closed.started
2025-01-08 02:03:33,079 [DEBUG] httpcore.http11: response_closed.complete
2025-01-08 02:03:33,079 [DEBUG] openai._base_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "200 OK"
2025-01-08 02:03:33,088 [INFO] src.luna_functions_handledispatch: GPT reply (for mention @lunabot:localhost) => Hello! How can I assist you today?
2025-01-08 02:03:33,124 [INFO] src.luna_functions: Posted GPT reply to room !FkbKmoFPWsWYTwKnwg:localhost
2025-01-08 02:03:33,124 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:03:33,124 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:03:33,124 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:03:33,124 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:03:33,125 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:03:33,125 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:03:33,125 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:03:33,125 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:03:33,125 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:03:33,125 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:03:33,125 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:03:33,125 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:03:33,125 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm online and ready to assist you. How can I help you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:03:33,125 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:03:33,125 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:03:33,125 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:03:33,125 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:03:33,125 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:03:33,125 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:03:33,125 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:03:33,125 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:03:33,125 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:03:33,125 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:03:33,125 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:03:33,125 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:03:33,134 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:03:33,134 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:03:33,134 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:03:33,134 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:03:33,134 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:03:37,410 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 02:03:41,630 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 02:03:51,828 [INFO] src.console_functions: (Console) Scheduling creation of room 'test'
2025-01-08 02:05:58,691 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-08 02:05:58,691 [DEBUG] __main__: Exiting configure_logging function.
2025-01-08 02:05:58,691 [DEBUG] __main__: Logging configuration complete.
2025-01-08 02:05:58,691 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-08 02:05:58,691 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 02:05:58,691 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-08 02:05:58,691 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-08 02:05:58,691 [DEBUG] __main__: Entering start_console_thread function.
2025-01-08 02:05:58,694 [INFO] __main__: Console thread started successfully.
2025-01-08 02:05:58,694 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-08 02:05:58,694 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-08 02:05:58,694 [INFO] __main__: Starting main_logic coroutine.
2025-01-08 02:05:58,694 [DEBUG] __main__: Entering main_logic function...
2025-01-08 02:05:58,694 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-08 02:05:58,696 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-08 02:05:58,696 [INFO] src.luna_functions: Using saved token for user @lunabot:localhost.
2025-01-08 02:05:58,696 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-08 02:05:58,700 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 02:05:58,732 [INFO] nio.client.base_client: New joined room !HPrbJYfQkoGnlztkrS:localhost
2025-01-08 02:05:58,732 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-08 02:05:58,732 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomNameEvent
2025-01-08 02:05:58,732 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomJoinRulesEvent
2025-01-08 02:05:58,732 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type PowerLevelsEvent
2025-01-08 02:05:58,732 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-08 02:05:58,732 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomCreateEvent
2025-01-08 02:05:58,732 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomGuestAccessEvent
2025-01-08 02:05:58,732 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:05:58,732 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:05:58,732 [DEBUG] src.luna_functions_handledispatch: User message => 'are you there @luna?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:05:58,732 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:05:58,732 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:05:58,732 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:05:58,732 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:05:58,732 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here. How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:05:58,732 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:05:58,732 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:05:58,732 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:05:58,732 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:05:58,732 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here. How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:05:58,732 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:05:58,732 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:05:58,733 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:05:58,733 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:05:58,733 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here. How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:05:58,733 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:05:58,733 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:05:58,733 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:05:58,733 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:05:58,733 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here! How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:05:58,733 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:05:58,733 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:05:58,733 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:05:58,733 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:05:58,733 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here. How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:05:58,733 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:05:58,733 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:05:58,733 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:05:58,733 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:05:58,733 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here! How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:05:58,733 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:05:58,733 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:05:58,733 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:05:58,733 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:05:58,733 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here. How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:05:58,733 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:05:58,733 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:05:58,733 [INFO] nio.client.base_client: New joined room !FkbKmoFPWsWYTwKnwg:localhost
2025-01-08 02:05:58,733 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type PowerLevelsEvent
2025-01-08 02:05:58,733 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-08 02:05:58,733 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomJoinRulesEvent
2025-01-08 02:05:58,733 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomGuestAccessEvent
2025-01-08 02:05:58,733 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-08 02:05:58,733 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomCreateEvent
2025-01-08 02:05:58,733 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:05:58,733 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:05:58,733 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:05:58,733 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:05:58,733 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:05:58,733 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:05:58,733 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:05:58,733 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:05:58,733 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:05:58,733 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:05:58,733 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:05:58,733 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:05:58,733 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I am online and ready to assist you. How can I help you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:05:58,733 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:05:58,733 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:05:58,733 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:05:58,733 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:05:58,733 [DEBUG] src.luna_functions_handledispatch: User message => 'lunabot: ' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:05:58,733 [DEBUG] src.luna_functions_handledispatch: m.mentions => {'user_ids': ['@lunabot:localhost']}
2025-01-08 02:05:58,733 [INFO] src.luna_functions_handledispatch: Mentioned user_ids => ['@lunabot:localhost']
2025-01-08 02:05:58,733 [INFO] src.luna_functions_handledispatch: Processing mention for user => @lunabot:localhost
2025-01-08 02:05:58,759 [DEBUG] openai._base_client: Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': 'You are a helpful bot responding to a mention of @lunabot:localhost.'}, {'role': 'user', 'content': 'lunabot: '}], 'model': 'gpt-4', 'max_tokens': 300, 'temperature': 0.7}}
2025-01-08 02:05:58,763 [DEBUG] httpcore.connection: connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2025-01-08 02:05:58,847 [DEBUG] httpcore.connection: connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x1112cfb60>
2025-01-08 02:05:58,847 [DEBUG] httpcore.connection: start_tls.started ssl_context=<ssl.SSLContext object at 0x10536e2a0> server_hostname='api.openai.com' timeout=5.0
2025-01-08 02:05:58,875 [DEBUG] httpcore.connection: start_tls.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x11127f9d0>
2025-01-08 02:05:58,875 [DEBUG] httpcore.http11: send_request_headers.started request=<Request [b'POST']>
2025-01-08 02:05:58,875 [DEBUG] httpcore.http11: send_request_headers.complete
2025-01-08 02:05:58,875 [DEBUG] httpcore.http11: send_request_body.started request=<Request [b'POST']>
2025-01-08 02:05:58,875 [DEBUG] httpcore.http11: send_request_body.complete
2025-01-08 02:05:58,875 [DEBUG] httpcore.http11: receive_response_headers.started request=<Request [b'POST']>
2025-01-08 02:06:00,381 [DEBUG] httpcore.http11: receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Wed, 08 Jan 2025 07:06:00 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-yzbp3micnvwwjimbcblinra3'), (b'openai-processing-ms', b'1417'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'5000'), (b'x-ratelimit-limit-tokens', b'80000'), (b'x-ratelimit-remaining-requests', b'4999'), (b'x-ratelimit-remaining-tokens', b'79678'), (b'x-ratelimit-reset-requests', b'12ms'), (b'x-ratelimit-reset-tokens', b'241ms'), (b'x-request-id', b'req_1c232c0e542856da854ea7625ae18d4d'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=jx3E0uX93Q.pJjLAsngdKoIFsPwc6O7hHqLsMZnUreg-1736319960-1.0.1.1-crl.c9E00SHDFTpY1_3JyCW.HjwD2FYI72g2LOwk1Wv.F5mu.4UxT0_HHmvyVVsWZ8XJHU.Nnx1VaHI2TXIhiw; path=/; expires=Wed, 08-Jan-25 07:36:00 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=.PUJ6m_dnhTMnfL2tghRDTgX9ejNAq8rSaMwQU49PQk-1736319960360-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8fea579f0d554d17-BOS'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2025-01-08 02:06:00,383 [INFO] httpx: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-08 02:06:00,383 [DEBUG] httpcore.http11: receive_response_body.started request=<Request [b'POST']>
2025-01-08 02:06:00,384 [DEBUG] httpcore.http11: receive_response_body.complete
2025-01-08 02:06:00,384 [DEBUG] httpcore.http11: response_closed.started
2025-01-08 02:06:00,384 [DEBUG] httpcore.http11: response_closed.complete
2025-01-08 02:06:00,384 [DEBUG] openai._base_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "200 OK"
2025-01-08 02:06:00,388 [INFO] src.luna_functions_handledispatch: GPT reply (for mention @lunabot:localhost) => Hello! How can I assist you today?
2025-01-08 02:06:00,426 [INFO] src.luna_functions: Posted GPT reply to room !FkbKmoFPWsWYTwKnwg:localhost
2025-01-08 02:06:00,426 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:06:00,426 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:06:00,426 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:06:00,426 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:06:00,426 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:06:00,426 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:06:00,426 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:06:00,426 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:06:00,426 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:06:00,426 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:06:00,426 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:06:00,427 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:06:00,427 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm online and ready to assist you. How can I help you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:06:00,427 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:06:00,427 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:06:00,427 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:06:00,427 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:06:00,427 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:06:00,427 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:06:00,427 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:06:00,427 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:06:00,427 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:06:00,427 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:06:00,427 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:06:00,427 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:06:00,427 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:06:00,428 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:06:00,428 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:06:00,428 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:06:00,428 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:06:00,436 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:06:00,436 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:06:00,436 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:06:00,436 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:06:00,436 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:06:05,268 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 02:06:13,078 [INFO] src.console_functions: (Console) Scheduling creation of room 'test'
2025-01-08 02:06:13,078 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 02:06:17,236 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 02:06:22,102 [INFO] src.console_functions: (Console) Scheduling creation of room 'test2'
2025-01-08 02:06:22,103 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 02:08:32,356 [INFO] src.console_functions: Console received 'exit' command; requesting shutdown.
2025-01-08 02:08:32,356 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 02:08:32,356 [ERROR] __main__: An unexpected exception occurred in main_logic: Event loop stopped before Future completed.
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/./luna.py", line 135, in luna
    loop.run_until_complete(main_logic())
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 718, in run_until_complete
    raise RuntimeError('Event loop stopped before Future completed.')
RuntimeError: Event loop stopped before Future completed.
2025-01-08 02:08:32,364 [DEBUG] __main__: Preparing to close the event loop.
2025-01-08 02:08:32,365 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-08 02:08:35,711 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-08 02:08:35,711 [DEBUG] __main__: Exiting configure_logging function.
2025-01-08 02:08:35,711 [DEBUG] __main__: Logging configuration complete.
2025-01-08 02:08:35,711 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-08 02:08:35,712 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 02:08:35,712 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-08 02:08:35,712 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-08 02:08:35,712 [DEBUG] __main__: Entering start_console_thread function.
2025-01-08 02:08:35,714 [INFO] __main__: Console thread started successfully.
2025-01-08 02:08:35,714 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-08 02:08:35,714 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-08 02:08:35,714 [INFO] __main__: Starting main_logic coroutine.
2025-01-08 02:08:35,714 [DEBUG] __main__: Entering main_logic function...
2025-01-08 02:08:35,714 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-08 02:08:35,716 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-08 02:08:35,716 [INFO] src.luna_functions: Using saved token for user @lunabot:localhost.
2025-01-08 02:08:35,716 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-08 02:08:35,720 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 02:08:35,747 [INFO] nio.client.base_client: New joined room !HPrbJYfQkoGnlztkrS:localhost
2025-01-08 02:08:35,747 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-08 02:08:35,747 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomNameEvent
2025-01-08 02:08:35,747 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomJoinRulesEvent
2025-01-08 02:08:35,747 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type PowerLevelsEvent
2025-01-08 02:08:35,747 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-08 02:08:35,747 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomCreateEvent
2025-01-08 02:08:35,747 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomGuestAccessEvent
2025-01-08 02:08:35,747 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:08:35,747 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:08:35,747 [DEBUG] src.luna_functions_handledispatch: User message => 'are you there @luna?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:08:35,747 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:08:35,748 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:08:35,748 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:08:35,748 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:08:35,748 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here. How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:08:35,748 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:08:35,748 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:08:35,748 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:08:35,748 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:08:35,748 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here. How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:08:35,748 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:08:35,748 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:08:35,748 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:08:35,748 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:08:35,748 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here. How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:08:35,748 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:08:35,748 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:08:35,748 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:08:35,748 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:08:35,748 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here! How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:08:35,748 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:08:35,748 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:08:35,748 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:08:35,748 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:08:35,748 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here. How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:08:35,748 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:08:35,748 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:08:35,748 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:08:35,748 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:08:35,748 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here! How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:08:35,748 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:08:35,748 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:08:35,748 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:08:35,748 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:08:35,748 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here. How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:08:35,748 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:08:35,748 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:08:35,748 [INFO] nio.client.base_client: New joined room !FkbKmoFPWsWYTwKnwg:localhost
2025-01-08 02:08:35,748 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type PowerLevelsEvent
2025-01-08 02:08:35,748 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-08 02:08:35,748 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomJoinRulesEvent
2025-01-08 02:08:35,748 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomGuestAccessEvent
2025-01-08 02:08:35,748 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-08 02:08:35,748 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomCreateEvent
2025-01-08 02:08:35,748 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:08:35,748 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:08:35,748 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:08:35,748 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:08:35,748 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:08:35,748 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:08:35,748 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:08:35,748 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I am online and ready to assist you. How can I help you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:08:35,748 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:08:35,748 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:08:35,748 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:08:35,748 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:08:35,748 [DEBUG] src.luna_functions_handledispatch: User message => 'lunabot: ' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:08:35,748 [DEBUG] src.luna_functions_handledispatch: m.mentions => {'user_ids': ['@lunabot:localhost']}
2025-01-08 02:08:35,748 [INFO] src.luna_functions_handledispatch: Mentioned user_ids => ['@lunabot:localhost']
2025-01-08 02:08:35,748 [INFO] src.luna_functions_handledispatch: Processing mention for user => @lunabot:localhost
2025-01-08 02:08:35,780 [DEBUG] openai._base_client: Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': 'You are a helpful bot responding to a mention of @lunabot:localhost.'}, {'role': 'user', 'content': 'lunabot: '}], 'model': 'gpt-4', 'max_tokens': 300, 'temperature': 0.7}}
2025-01-08 02:08:35,784 [DEBUG] httpcore.connection: connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2025-01-08 02:08:35,826 [DEBUG] httpcore.connection: connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x1154d3e00>
2025-01-08 02:08:35,827 [DEBUG] httpcore.connection: start_tls.started ssl_context=<ssl.SSLContext object at 0x10436e450> server_hostname='api.openai.com' timeout=5.0
2025-01-08 02:08:35,850 [DEBUG] httpcore.connection: start_tls.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x11547f9d0>
2025-01-08 02:08:35,851 [DEBUG] httpcore.http11: send_request_headers.started request=<Request [b'POST']>
2025-01-08 02:08:35,851 [DEBUG] httpcore.http11: send_request_headers.complete
2025-01-08 02:08:35,851 [DEBUG] httpcore.http11: send_request_body.started request=<Request [b'POST']>
2025-01-08 02:08:35,851 [DEBUG] httpcore.http11: send_request_body.complete
2025-01-08 02:08:35,851 [DEBUG] httpcore.http11: receive_response_headers.started request=<Request [b'POST']>
2025-01-08 02:08:36,498 [DEBUG] httpcore.http11: receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Wed, 08 Jan 2025 07:08:36 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-yzbp3micnvwwjimbcblinra3'), (b'openai-processing-ms', b'565'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'5000'), (b'x-ratelimit-limit-tokens', b'80000'), (b'x-ratelimit-remaining-requests', b'4999'), (b'x-ratelimit-remaining-tokens', b'79678'), (b'x-ratelimit-reset-requests', b'12ms'), (b'x-ratelimit-reset-tokens', b'241ms'), (b'x-request-id', b'req_8c3be0f1f56b7cd5392587a51c882960'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=kebMvFUmFvoOFr0n82fTEHX9Fdpf3HiaKtn5ivClszM-1736320116-1.0.1.1-4CoNZWgCgp5RtU23MCHNR18rJDgWxUmb.KNOrcHL32vj0WeJ18wzgcbQQ_4zszxSxbPgQw.zUsLQyPU5rr5iAw; path=/; expires=Wed, 08-Jan-25 07:38:36 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=pj2rN0TW0Pbj896mhZ0FJPsa.wj0Jld0C7lo52pGzdY-1736320116478-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8fea5b741f7e4d08-BOS'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2025-01-08 02:08:36,500 [INFO] httpx: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-08 02:08:36,501 [DEBUG] httpcore.http11: receive_response_body.started request=<Request [b'POST']>
2025-01-08 02:08:36,501 [DEBUG] httpcore.http11: receive_response_body.complete
2025-01-08 02:08:36,502 [DEBUG] httpcore.http11: response_closed.started
2025-01-08 02:08:36,502 [DEBUG] httpcore.http11: response_closed.complete
2025-01-08 02:08:36,502 [DEBUG] openai._base_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "200 OK"
2025-01-08 02:08:36,509 [INFO] src.luna_functions_handledispatch: GPT reply (for mention @lunabot:localhost) => Hello! How can I assist you today?
2025-01-08 02:08:36,543 [INFO] src.luna_functions: Posted GPT reply to room !FkbKmoFPWsWYTwKnwg:localhost
2025-01-08 02:08:36,543 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:08:36,543 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:08:36,543 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:08:36,543 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:08:36,543 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:08:36,543 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:08:36,544 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:08:36,544 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:08:36,544 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:08:36,544 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:08:36,544 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:08:36,544 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:08:36,544 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm online and ready to assist you. How can I help you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:08:36,544 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:08:36,544 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:08:36,544 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:08:36,544 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:08:36,544 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:08:36,544 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:08:36,544 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:08:36,544 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:08:36,544 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:08:36,544 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:08:36,544 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:08:36,544 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:08:36,544 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:08:36,544 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:08:36,544 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:08:36,544 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:08:36,544 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:08:36,544 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:08:36,544 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:08:36,544 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:08:36,544 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:08:36,544 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:08:36,552 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:08:36,552 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:08:36,552 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:08:36,552 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:08:36,552 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:10:46,214 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-08 02:10:46,215 [DEBUG] __main__: Exiting configure_logging function.
2025-01-08 02:10:46,215 [DEBUG] __main__: Logging configuration complete.
2025-01-08 02:10:46,215 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-08 02:10:46,215 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 02:10:46,215 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-08 02:10:46,215 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-08 02:10:46,215 [DEBUG] __main__: Entering start_console_thread function.
2025-01-08 02:10:46,217 [INFO] __main__: Console thread started successfully.
2025-01-08 02:10:46,217 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-08 02:10:46,217 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-08 02:10:46,218 [INFO] __main__: Starting main_logic coroutine.
2025-01-08 02:10:46,218 [DEBUG] __main__: Entering main_logic function...
2025-01-08 02:10:46,218 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-08 02:10:46,220 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-08 02:10:46,220 [INFO] src.luna_functions: Using saved token for user @lunabot:localhost.
2025-01-08 02:10:46,220 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-08 02:10:46,223 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 02:10:46,272 [INFO] nio.client.base_client: New joined room !HPrbJYfQkoGnlztkrS:localhost
2025-01-08 02:10:46,272 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-08 02:10:46,273 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomNameEvent
2025-01-08 02:10:46,273 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomJoinRulesEvent
2025-01-08 02:10:46,273 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type PowerLevelsEvent
2025-01-08 02:10:46,273 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-08 02:10:46,273 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomCreateEvent
2025-01-08 02:10:46,273 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomGuestAccessEvent
2025-01-08 02:10:46,273 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:10:46,273 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:10:46,273 [DEBUG] src.luna_functions_handledispatch: User message => 'are you there @luna?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:10:46,273 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:10:46,273 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:10:46,273 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:10:46,273 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:10:46,273 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here. How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:10:46,273 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:10:46,273 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:10:46,273 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:10:46,273 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:10:46,273 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here. How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:10:46,273 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:10:46,273 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:10:46,273 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:10:46,273 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:10:46,273 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here. How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:10:46,273 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:10:46,273 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:10:46,273 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:10:46,273 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:10:46,273 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here! How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:10:46,273 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:10:46,273 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:10:46,273 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:10:46,273 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:10:46,273 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here. How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:10:46,273 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:10:46,273 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:10:46,273 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:10:46,273 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:10:46,273 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here! How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:10:46,273 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:10:46,273 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:10:46,273 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:10:46,273 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:10:46,273 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here. How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:10:46,273 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:10:46,273 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:10:46,273 [INFO] nio.client.base_client: New joined room !FkbKmoFPWsWYTwKnwg:localhost
2025-01-08 02:10:46,273 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type PowerLevelsEvent
2025-01-08 02:10:46,273 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-08 02:10:46,273 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomJoinRulesEvent
2025-01-08 02:10:46,273 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomGuestAccessEvent
2025-01-08 02:10:46,273 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-08 02:10:46,273 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomCreateEvent
2025-01-08 02:10:46,274 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:10:46,274 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:10:46,274 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I am online and ready to assist you. How can I help you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:10:46,274 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:10:46,274 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:10:46,274 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:10:46,274 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:10:46,274 [DEBUG] src.luna_functions_handledispatch: User message => 'lunabot: ' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:10:46,274 [DEBUG] src.luna_functions_handledispatch: m.mentions => {'user_ids': ['@lunabot:localhost']}
2025-01-08 02:10:46,274 [INFO] src.luna_functions_handledispatch: Mentioned user_ids => ['@lunabot:localhost']
2025-01-08 02:10:46,274 [INFO] src.luna_functions_handledispatch: Processing mention for user => @lunabot:localhost
2025-01-08 02:10:46,296 [DEBUG] openai._base_client: Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': 'You are a helpful bot responding to a mention of @lunabot:localhost.'}, {'role': 'user', 'content': 'lunabot: '}], 'model': 'gpt-4', 'max_tokens': 300, 'temperature': 0.7}}
2025-01-08 02:10:46,300 [DEBUG] httpcore.connection: connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2025-01-08 02:10:46,348 [DEBUG] httpcore.connection: connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x1095a3e00>
2025-01-08 02:10:46,348 [DEBUG] httpcore.connection: start_tls.started ssl_context=<ssl.SSLContext object at 0x10556e3c0> server_hostname='api.openai.com' timeout=5.0
2025-01-08 02:10:46,373 [DEBUG] httpcore.connection: start_tls.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10954f9d0>
2025-01-08 02:10:46,373 [DEBUG] httpcore.http11: send_request_headers.started request=<Request [b'POST']>
2025-01-08 02:10:46,373 [DEBUG] httpcore.http11: send_request_headers.complete
2025-01-08 02:10:46,373 [DEBUG] httpcore.http11: send_request_body.started request=<Request [b'POST']>
2025-01-08 02:10:46,373 [DEBUG] httpcore.http11: send_request_body.complete
2025-01-08 02:10:46,373 [DEBUG] httpcore.http11: receive_response_headers.started request=<Request [b'POST']>
2025-01-08 02:10:47,215 [DEBUG] httpcore.http11: receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Wed, 08 Jan 2025 07:10:47 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-yzbp3micnvwwjimbcblinra3'), (b'openai-processing-ms', b'724'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'5000'), (b'x-ratelimit-limit-tokens', b'80000'), (b'x-ratelimit-remaining-requests', b'4999'), (b'x-ratelimit-remaining-tokens', b'79678'), (b'x-ratelimit-reset-requests', b'12ms'), (b'x-ratelimit-reset-tokens', b'241ms'), (b'x-request-id', b'req_1d63e2ad92b321602ee8430e5c9f8dbb'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=bzK0QIU6_ZOx5_nczp4G5fwZSYZEcYIEuNZ8zkHmX0k-1736320247-1.0.1.1-w5frd0o3R8zpoJ1zca3s_YkuTGCjsUlKLqVNvZxEnOXuGAd8JT_HZQunvP3UVxLdfDhjAYDqdRYADRBi1nPnig; path=/; expires=Wed, 08-Jan-25 07:40:47 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=O80SfE3B_SXSFg6jwYjCG00wc6vVDNs3NuPyYkrldUw-1736320247162-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8fea5ea3e9623b70-BOS'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2025-01-08 02:10:47,218 [INFO] httpx: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-08 02:10:47,218 [DEBUG] httpcore.http11: receive_response_body.started request=<Request [b'POST']>
2025-01-08 02:10:47,219 [DEBUG] httpcore.http11: receive_response_body.complete
2025-01-08 02:10:47,219 [DEBUG] httpcore.http11: response_closed.started
2025-01-08 02:10:47,219 [DEBUG] httpcore.http11: response_closed.complete
2025-01-08 02:10:47,219 [DEBUG] openai._base_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "200 OK"
2025-01-08 02:10:47,226 [INFO] src.luna_functions_handledispatch: GPT reply (for mention @lunabot:localhost) => Hello! How can I assist you today?
2025-01-08 02:10:47,279 [INFO] src.luna_functions: Posted GPT reply to room !FkbKmoFPWsWYTwKnwg:localhost
2025-01-08 02:10:47,279 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:10:47,279 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:10:47,279 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:10:47,279 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:10:47,279 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:10:47,279 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:10:47,279 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:10:47,279 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:10:47,279 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:10:47,279 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:10:47,279 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:10:47,279 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:10:47,279 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm online and ready to assist you. How can I help you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:10:47,279 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:10:47,279 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:10:47,279 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:10:47,279 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:10:47,279 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:10:47,279 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:10:47,279 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:10:47,279 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:10:47,280 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:10:47,280 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:10:47,280 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:10:47,280 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:10:47,280 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:10:47,280 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:10:47,280 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:10:47,280 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:10:47,280 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:10:47,280 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:10:47,280 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:10:47,280 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:10:47,280 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:10:47,280 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:10:47,280 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:10:47,280 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:10:47,280 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:10:47,280 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:10:47,280 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:10:47,286 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:10:47,286 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:10:47,286 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:10:47,286 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:10:47,286 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:10:49,689 [INFO] src.console_functions: Console screen cleared.
2025-01-08 02:10:49,690 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 02:10:53,465 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 02:11:17,369 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 02:11:18,368 [INFO] src.console_functions: Console received 'exit' command; requesting shutdown.
2025-01-08 02:11:18,369 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 02:11:18,369 [ERROR] __main__: An unexpected exception occurred in main_logic: Event loop stopped before Future completed.
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/./luna.py", line 135, in luna
    loop.run_until_complete(main_logic())
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 718, in run_until_complete
    raise RuntimeError('Event loop stopped before Future completed.')
RuntimeError: Event loop stopped before Future completed.
2025-01-08 02:11:18,376 [DEBUG] __main__: Preparing to close the event loop.
2025-01-08 02:11:18,376 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-08 02:11:20,676 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-08 02:11:20,676 [DEBUG] __main__: Exiting configure_logging function.
2025-01-08 02:11:20,676 [DEBUG] __main__: Logging configuration complete.
2025-01-08 02:11:20,676 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-08 02:11:20,676 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 02:11:20,676 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-08 02:11:20,676 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-08 02:11:20,676 [DEBUG] __main__: Entering start_console_thread function.
2025-01-08 02:11:20,679 [INFO] __main__: Console thread started successfully.
2025-01-08 02:11:20,679 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-08 02:11:20,679 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-08 02:11:20,679 [INFO] __main__: Starting main_logic coroutine.
2025-01-08 02:11:20,679 [DEBUG] __main__: Entering main_logic function...
2025-01-08 02:11:20,679 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-08 02:11:20,681 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-08 02:11:20,681 [INFO] src.luna_functions: Using saved token for user @lunabot:localhost.
2025-01-08 02:11:20,681 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-08 02:11:20,685 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 02:11:20,704 [INFO] nio.client.base_client: New joined room !HPrbJYfQkoGnlztkrS:localhost
2025-01-08 02:11:20,704 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-08 02:11:20,704 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomNameEvent
2025-01-08 02:11:20,704 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomJoinRulesEvent
2025-01-08 02:11:20,704 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type PowerLevelsEvent
2025-01-08 02:11:20,704 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-08 02:11:20,704 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomCreateEvent
2025-01-08 02:11:20,704 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomGuestAccessEvent
2025-01-08 02:11:20,704 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:11:20,705 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:11:20,705 [DEBUG] src.luna_functions_handledispatch: User message => 'are you there @luna?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:11:20,705 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:11:20,705 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:11:20,705 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:11:20,705 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:11:20,705 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here. How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:11:20,705 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:11:20,705 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:11:20,705 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:11:20,705 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:11:20,705 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here. How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:11:20,705 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:11:20,705 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:11:20,705 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:11:20,705 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:11:20,705 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here. How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:11:20,705 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:11:20,705 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:11:20,705 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:11:20,705 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:11:20,705 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here! How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:11:20,705 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:11:20,705 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:11:20,705 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:11:20,705 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:11:20,705 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here. How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:11:20,705 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:11:20,705 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:11:20,705 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:11:20,705 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:11:20,705 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here! How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:11:20,705 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:11:20,705 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:11:20,705 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:11:20,705 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:11:20,705 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here. How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:11:20,705 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:11:20,705 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:11:20,705 [INFO] nio.client.base_client: New joined room !FkbKmoFPWsWYTwKnwg:localhost
2025-01-08 02:11:20,705 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type PowerLevelsEvent
2025-01-08 02:11:20,705 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-08 02:11:20,705 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomJoinRulesEvent
2025-01-08 02:11:20,705 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomGuestAccessEvent
2025-01-08 02:11:20,705 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-08 02:11:20,705 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomCreateEvent
2025-01-08 02:11:20,705 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:11:20,705 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:11:20,705 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I am online and ready to assist you. How can I help you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:11:20,705 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:11:20,705 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:11:20,705 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:11:20,705 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:11:20,705 [DEBUG] src.luna_functions_handledispatch: User message => 'lunabot: ' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:11:20,705 [DEBUG] src.luna_functions_handledispatch: m.mentions => {'user_ids': ['@lunabot:localhost']}
2025-01-08 02:11:20,705 [INFO] src.luna_functions_handledispatch: Mentioned user_ids => ['@lunabot:localhost']
2025-01-08 02:11:20,705 [INFO] src.luna_functions_handledispatch: Processing mention for user => @lunabot:localhost
2025-01-08 02:11:20,727 [DEBUG] openai._base_client: Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': 'You are a helpful bot responding to a mention of @lunabot:localhost.'}, {'role': 'user', 'content': 'lunabot: '}], 'model': 'gpt-4', 'max_tokens': 300, 'temperature': 0.7}}
2025-01-08 02:11:20,730 [DEBUG] httpcore.connection: connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2025-01-08 02:11:20,789 [DEBUG] httpcore.connection: connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10fbd3e00>
2025-01-08 02:11:20,789 [DEBUG] httpcore.connection: start_tls.started ssl_context=<ssl.SSLContext object at 0x10a86e3c0> server_hostname='api.openai.com' timeout=5.0
2025-01-08 02:11:20,825 [INFO] src.console_functions: Console screen cleared.
2025-01-08 02:11:20,825 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 02:11:20,834 [DEBUG] httpcore.connection: start_tls.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10fb7f9d0>
2025-01-08 02:11:20,834 [DEBUG] httpcore.http11: send_request_headers.started request=<Request [b'POST']>
2025-01-08 02:11:20,834 [DEBUG] httpcore.http11: send_request_headers.complete
2025-01-08 02:11:20,834 [DEBUG] httpcore.http11: send_request_body.started request=<Request [b'POST']>
2025-01-08 02:11:20,834 [DEBUG] httpcore.http11: send_request_body.complete
2025-01-08 02:11:20,834 [DEBUG] httpcore.http11: receive_response_headers.started request=<Request [b'POST']>
2025-01-08 02:11:21,831 [DEBUG] httpcore.http11: receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Wed, 08 Jan 2025 07:11:21 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-yzbp3micnvwwjimbcblinra3'), (b'openai-processing-ms', b'832'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'5000'), (b'x-ratelimit-limit-tokens', b'80000'), (b'x-ratelimit-remaining-requests', b'4999'), (b'x-ratelimit-remaining-tokens', b'79678'), (b'x-ratelimit-reset-requests', b'12ms'), (b'x-ratelimit-reset-tokens', b'241ms'), (b'x-request-id', b'req_1cd7c7e845129ec401ea85f608446663'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=Zte4LYCHDbKalI8syrP8gorxWWmUXfMNQVSYyShlmBQ-1736320281-1.0.1.1-Z3kbafoUwru5WGBldWu.ey7t_.fSIa_YZEsCQGydMPUnI5dW0hH5pvqjy2O9oj4DPm4AGXgpj5eKLhvD3n8Qbw; path=/; expires=Wed, 08-Jan-25 07:41:21 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=kSPhuXDkd.IWCSy2UWFiAOIJNoKB.3dmdJSKev1dsPU-1736320281727-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8fea5f7b4f0a9032-BOS'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2025-01-08 02:11:21,834 [INFO] httpx: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-08 02:11:21,834 [DEBUG] httpcore.http11: receive_response_body.started request=<Request [b'POST']>
2025-01-08 02:11:21,835 [DEBUG] httpcore.http11: receive_response_body.complete
2025-01-08 02:11:21,835 [DEBUG] httpcore.http11: response_closed.started
2025-01-08 02:11:21,835 [DEBUG] httpcore.http11: response_closed.complete
2025-01-08 02:11:21,835 [DEBUG] openai._base_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "200 OK"
2025-01-08 02:11:21,842 [INFO] src.luna_functions_handledispatch: GPT reply (for mention @lunabot:localhost) => Hello! How can I assist you today?
2025-01-08 02:11:21,879 [INFO] src.luna_functions: Posted GPT reply to room !FkbKmoFPWsWYTwKnwg:localhost
2025-01-08 02:11:21,879 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:11:21,879 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:11:21,879 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:11:21,879 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:11:21,879 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:11:21,879 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:11:21,879 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:11:21,879 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:11:21,879 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:11:21,879 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:11:21,879 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:11:21,879 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:11:21,879 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm online and ready to assist you. How can I help you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:11:21,879 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:11:21,880 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:11:21,880 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:11:21,880 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:11:21,880 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:11:21,880 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:11:21,880 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:11:21,880 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:11:21,880 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:11:21,880 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:11:21,880 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:11:21,880 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:11:21,880 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:11:21,880 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:11:21,880 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:11:21,880 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:11:21,880 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:11:21,880 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:11:21,880 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:11:21,880 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:11:21,880 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:11:21,880 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:11:21,880 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:11:21,880 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:11:21,880 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:11:21,880 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:11:21,880 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:11:21,884 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:11:21,884 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:11:21,884 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:11:21,884 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:11:21,884 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:11:21,890 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:11:21,890 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:11:21,890 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:11:21,890 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:11:21,890 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:11:23,065 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 02:11:35,374 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 02:11:38,275 [DEBUG] src.console_functions: Showing help to user.
2025-01-08 02:11:38,277 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 02:11:42,534 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 02:13:56,360 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-08 02:13:56,360 [DEBUG] __main__: Exiting configure_logging function.
2025-01-08 02:13:56,360 [DEBUG] __main__: Logging configuration complete.
2025-01-08 02:13:56,360 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-08 02:13:56,361 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 02:13:56,361 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-08 02:13:56,361 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-08 02:13:56,361 [DEBUG] __main__: Entering start_console_thread function.
2025-01-08 02:13:56,364 [INFO] __main__: Console thread started successfully.
2025-01-08 02:13:56,364 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-08 02:13:56,364 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-08 02:13:56,364 [INFO] __main__: Starting main_logic coroutine.
2025-01-08 02:13:56,364 [DEBUG] __main__: Entering main_logic function...
2025-01-08 02:13:56,366 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-08 02:13:56,366 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-08 02:13:56,366 [INFO] src.luna_functions: Using saved token for user @lunabot:localhost.
2025-01-08 02:13:56,367 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-08 02:13:56,370 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 02:13:56,427 [INFO] nio.client.base_client: New joined room !HPrbJYfQkoGnlztkrS:localhost
2025-01-08 02:13:56,427 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-08 02:13:56,427 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomNameEvent
2025-01-08 02:13:56,427 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomJoinRulesEvent
2025-01-08 02:13:56,427 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type PowerLevelsEvent
2025-01-08 02:13:56,427 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-08 02:13:56,427 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomCreateEvent
2025-01-08 02:13:56,428 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomGuestAccessEvent
2025-01-08 02:13:56,428 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:13:56,428 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:13:56,428 [DEBUG] src.luna_functions_handledispatch: User message => 'are you there @luna?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:13:56,428 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:13:56,428 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:13:56,428 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:13:56,428 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:13:56,428 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here. How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:13:56,428 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:13:56,428 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:13:56,428 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:13:56,428 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:13:56,428 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here. How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:13:56,428 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:13:56,428 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:13:56,428 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:13:56,428 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:13:56,428 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here. How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:13:56,428 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:13:56,428 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:13:56,428 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:13:56,428 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:13:56,428 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here! How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:13:56,428 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:13:56,428 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:13:56,428 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:13:56,428 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:13:56,428 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here. How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:13:56,428 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:13:56,428 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:13:56,428 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:13:56,428 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:13:56,428 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here! How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:13:56,428 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:13:56,428 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:13:56,428 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:13:56,428 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:13:56,428 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here. How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:13:56,428 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:13:56,428 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:13:56,428 [INFO] nio.client.base_client: New joined room !FkbKmoFPWsWYTwKnwg:localhost
2025-01-08 02:13:56,428 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type PowerLevelsEvent
2025-01-08 02:13:56,428 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-08 02:13:56,428 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomJoinRulesEvent
2025-01-08 02:13:56,428 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomGuestAccessEvent
2025-01-08 02:13:56,428 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-08 02:13:56,428 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomCreateEvent
2025-01-08 02:13:56,428 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:13:56,428 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:13:56,429 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:13:56,429 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:13:56,429 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:13:56,429 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:13:56,429 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:13:56,429 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:13:56,429 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:13:56,429 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:13:56,429 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:13:56,429 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:13:56,429 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm online and ready to assist you. How can I help you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:13:56,429 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:13:56,429 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:13:56,429 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:13:56,429 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:13:56,429 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:13:56,429 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:13:56,429 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:13:56,429 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:13:56,429 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:13:56,429 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:13:56,429 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:13:56,429 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:13:56,429 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:13:56,429 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:13:56,429 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:13:56,429 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:13:56,429 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:13:56,429 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:13:56,429 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:13:56,429 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:13:56,429 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:13:56,429 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:13:56,429 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:13:56,429 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:13:56,429 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:13:56,429 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:13:56,429 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:13:56,429 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:13:56,429 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:13:56,429 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:13:56,429 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:13:56,429 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:13:56,429 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:13:56,429 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:13:56,429 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:13:56,429 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:13:56,429 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:17:32,235 [WARNING] __main__: KeyboardInterrupt received. Shutting down Director.
2025-01-08 02:17:32,236 [DEBUG] __main__: Preparing to close the event loop.
2025-01-08 02:17:32,237 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-08 02:17:32,323 [ERROR] asyncio: Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x10cb5f8c0>
2025-01-08 02:17:34,961 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-08 02:17:34,961 [DEBUG] __main__: Exiting configure_logging function.
2025-01-08 02:17:34,961 [DEBUG] __main__: Logging configuration complete.
2025-01-08 02:17:34,961 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-08 02:17:34,961 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 02:17:34,961 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-08 02:17:34,961 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-08 02:17:34,961 [DEBUG] __main__: Entering start_console_thread function.
2025-01-08 02:17:34,964 [INFO] __main__: Console thread started successfully.
2025-01-08 02:17:34,964 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-08 02:17:34,964 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-08 02:17:34,964 [INFO] __main__: Starting main_logic coroutine.
2025-01-08 02:17:34,964 [DEBUG] __main__: Entering main_logic function...
2025-01-08 02:17:34,964 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-08 02:17:34,966 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-08 02:17:34,966 [INFO] src.luna_functions: Using saved token for user @lunabot:localhost.
2025-01-08 02:17:34,966 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-08 02:17:34,970 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 02:17:35,001 [INFO] nio.client.base_client: New joined room !FkbKmoFPWsWYTwKnwg:localhost
2025-01-08 02:17:35,001 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type PowerLevelsEvent
2025-01-08 02:17:35,001 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-08 02:17:35,001 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomJoinRulesEvent
2025-01-08 02:17:35,001 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomGuestAccessEvent
2025-01-08 02:17:35,001 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-08 02:17:35,001 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomCreateEvent
2025-01-08 02:17:35,001 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:17:35,001 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:17:35,001 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:17:35,001 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:17:35,001 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:17:35,001 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:17:35,001 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:17:35,001 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:17:35,001 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:17:35,001 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:17:35,001 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:17:35,001 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:17:35,001 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm online and ready to assist you. How can I help you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:17:35,001 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:17:35,001 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:17:35,001 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:17:35,001 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:17:35,001 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:17:35,001 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:17:35,001 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:17:35,002 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:17:35,002 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:17:35,002 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:17:35,002 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:17:35,002 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:17:35,002 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:17:35,002 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:17:35,002 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:17:35,002 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:17:35,002 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:17:35,002 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:17:35,002 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:17:35,002 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:17:35,002 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:17:35,002 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:17:35,002 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:17:35,002 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:17:35,002 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:17:35,002 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:17:35,002 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:17:35,002 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:17:35,002 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:17:35,002 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:17:35,002 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:17:35,002 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:17:35,002 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:17:35,002 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:17:35,002 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:17:35,002 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:17:35,002 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:17:35,002 [INFO] nio.client.base_client: New joined room !HPrbJYfQkoGnlztkrS:localhost
2025-01-08 02:17:35,002 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-08 02:17:35,002 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomNameEvent
2025-01-08 02:17:35,002 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomJoinRulesEvent
2025-01-08 02:17:35,002 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type PowerLevelsEvent
2025-01-08 02:17:35,002 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-08 02:17:35,002 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomCreateEvent
2025-01-08 02:17:35,002 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomGuestAccessEvent
2025-01-08 02:17:35,002 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:17:35,002 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:17:35,002 [DEBUG] src.luna_functions_handledispatch: User message => 'are you there @luna?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:17:35,002 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:17:35,002 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:17:35,002 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:17:35,002 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:17:35,002 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here. How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:17:35,002 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:17:35,002 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:17:35,002 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:17:35,002 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:17:35,002 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here. How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:17:35,002 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:17:35,002 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:17:35,002 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:17:35,002 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:17:35,002 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here. How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:17:35,002 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:17:35,002 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:17:35,002 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:17:35,002 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:17:35,002 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here! How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:17:35,002 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:17:35,002 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:17:35,002 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:17:35,002 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:17:35,002 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here. How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:17:35,002 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:17:35,002 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:17:35,003 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:17:35,003 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:17:35,003 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here! How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:17:35,003 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:17:35,003 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:17:35,003 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:17:35,003 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:17:35,003 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here. How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:17:35,003 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:17:35,003 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:31:29,523 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-08 02:31:29,523 [DEBUG] __main__: Exiting configure_logging function.
2025-01-08 02:31:29,523 [DEBUG] __main__: Logging configuration complete.
2025-01-08 02:31:29,523 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-08 02:31:29,523 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 02:31:29,524 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-08 02:31:29,524 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-08 02:31:29,524 [DEBUG] __main__: Entering start_console_thread function.
2025-01-08 02:31:29,526 [INFO] __main__: Console thread started successfully.
2025-01-08 02:31:29,526 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-08 02:31:29,526 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-08 02:31:29,526 [INFO] __main__: Starting main_logic coroutine.
2025-01-08 02:31:29,526 [DEBUG] __main__: Entering main_logic function...
2025-01-08 02:31:29,526 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-08 02:31:29,529 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-08 02:31:29,529 [INFO] src.luna_functions: Using saved token for user @lunabot:localhost.
2025-01-08 02:31:29,529 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-08 02:31:29,532 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 02:31:29,574 [INFO] nio.client.base_client: New joined room !FkbKmoFPWsWYTwKnwg:localhost
2025-01-08 02:31:29,574 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type PowerLevelsEvent
2025-01-08 02:31:29,574 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-08 02:31:29,574 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomJoinRulesEvent
2025-01-08 02:31:29,574 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomGuestAccessEvent
2025-01-08 02:31:29,574 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-08 02:31:29,574 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomCreateEvent
2025-01-08 02:31:29,574 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:31:29,574 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:31:29,574 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:31:29,574 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:31:29,574 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:31:29,574 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:31:29,574 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:31:29,574 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:31:29,574 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:31:29,574 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:31:29,574 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:31:29,574 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:31:29,574 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm online and ready to assist you. How can I help you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:31:29,574 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:31:29,574 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:31:29,574 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:31:29,575 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:31:29,575 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:31:29,575 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:31:29,575 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:31:29,575 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:31:29,575 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:31:29,575 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:31:29,575 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:31:29,575 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:31:29,575 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:31:29,575 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:31:29,575 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:31:29,575 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:31:29,575 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:31:29,575 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:31:29,575 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:31:29,575 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:31:29,575 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:31:29,575 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:31:29,575 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:31:29,575 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:31:29,575 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:31:29,575 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:31:29,575 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:31:29,575 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:31:29,575 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:31:29,575 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:31:29,575 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:31:29,575 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:31:29,575 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:31:29,575 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:31:29,575 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:31:29,575 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:31:29,575 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:31:29,575 [INFO] nio.client.base_client: New joined room !HPrbJYfQkoGnlztkrS:localhost
2025-01-08 02:31:29,575 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-08 02:31:29,575 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomNameEvent
2025-01-08 02:31:29,575 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomJoinRulesEvent
2025-01-08 02:31:29,575 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type PowerLevelsEvent
2025-01-08 02:31:29,575 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-08 02:31:29,575 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomCreateEvent
2025-01-08 02:31:29,575 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomGuestAccessEvent
2025-01-08 02:31:29,575 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:31:29,575 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:31:29,575 [DEBUG] src.luna_functions_handledispatch: User message => 'are you there @luna?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:31:29,575 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:31:29,575 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:31:29,575 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:31:29,575 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:31:29,575 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here. How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:31:29,575 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:31:29,575 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:31:29,575 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:31:29,575 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:31:29,575 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here. How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:31:29,575 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:31:29,575 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:31:29,575 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:31:29,575 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:31:29,575 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here. How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:31:29,575 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:31:29,575 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:31:29,576 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:31:29,576 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:31:29,576 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here! How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:31:29,576 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:31:29,576 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:31:29,576 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:31:29,576 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:31:29,576 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here. How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:31:29,576 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:31:29,576 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:31:29,576 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:31:29,576 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:31:29,576 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here! How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:31:29,576 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:31:29,576 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:31:29,576 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:31:29,576 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:31:29,576 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here. How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:31:29,576 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:31:29,576 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:31:31,522 [INFO] src.console_functions: Console screen cleared.
2025-01-08 02:31:31,522 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 02:34:45,475 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-08 02:34:45,475 [DEBUG] __main__: Exiting configure_logging function.
2025-01-08 02:34:45,475 [DEBUG] __main__: Logging configuration complete.
2025-01-08 02:34:45,475 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-08 02:34:45,475 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 02:34:45,475 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-08 02:34:45,475 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-08 02:34:45,475 [DEBUG] __main__: Entering start_console_thread function.
2025-01-08 02:34:45,478 [INFO] __main__: Console thread started successfully.
2025-01-08 02:34:45,478 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-08 02:34:45,478 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-08 02:34:45,478 [INFO] __main__: Starting main_logic coroutine.
2025-01-08 02:34:45,478 [DEBUG] __main__: Entering main_logic function...
2025-01-08 02:34:45,478 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-08 02:34:45,480 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-08 02:34:45,480 [INFO] src.luna_functions: Using saved token for user @lunabot:localhost.
2025-01-08 02:34:45,480 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-08 02:34:45,483 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 02:34:45,523 [INFO] nio.client.base_client: New joined room !FkbKmoFPWsWYTwKnwg:localhost
2025-01-08 02:34:45,523 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type PowerLevelsEvent
2025-01-08 02:34:45,523 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-08 02:34:45,523 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomJoinRulesEvent
2025-01-08 02:34:45,523 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomGuestAccessEvent
2025-01-08 02:34:45,523 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-08 02:34:45,523 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomCreateEvent
2025-01-08 02:34:45,523 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:34:45,523 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:34:45,523 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:34:45,523 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:34:45,523 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:34:45,523 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:34:45,523 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:34:45,523 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:34:45,523 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:34:45,523 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:34:45,523 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:34:45,523 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:34:45,523 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm online and ready to assist you. How can I help you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:34:45,523 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:34:45,523 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:34:45,523 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:34:45,523 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:34:45,523 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:34:45,523 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:34:45,523 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:34:45,523 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:34:45,523 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:34:45,523 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:34:45,523 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:34:45,523 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:34:45,523 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:34:45,523 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:34:45,523 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:34:45,523 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:34:45,523 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:34:45,523 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:34:45,523 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:34:45,523 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:34:45,523 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:34:45,523 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:34:45,523 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:34:45,523 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:34:45,523 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:34:45,523 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:34:45,523 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:34:45,523 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:34:45,523 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:34:45,523 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:34:45,523 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:34:45,523 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:34:45,523 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:34:45,523 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:34:45,523 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:34:45,523 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:34:45,523 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:34:45,523 [INFO] nio.client.base_client: New joined room !HPrbJYfQkoGnlztkrS:localhost
2025-01-08 02:34:45,523 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-08 02:34:45,523 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomNameEvent
2025-01-08 02:34:45,524 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomJoinRulesEvent
2025-01-08 02:34:45,524 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type PowerLevelsEvent
2025-01-08 02:34:45,524 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-08 02:34:45,524 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomCreateEvent
2025-01-08 02:34:45,524 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomGuestAccessEvent
2025-01-08 02:34:45,524 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:34:45,524 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:34:45,524 [DEBUG] src.luna_functions_handledispatch: User message => 'are you there @luna?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:34:45,524 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:34:45,524 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:34:45,524 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:34:45,524 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:34:45,524 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here. How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:34:45,524 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:34:45,524 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:34:45,524 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:34:45,524 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:34:45,524 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here. How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:34:45,524 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:34:45,524 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:34:45,524 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:34:45,524 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:34:45,524 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here. How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:34:45,524 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:34:45,524 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:34:45,524 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:34:45,524 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:34:45,524 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here! How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:34:45,524 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:34:45,524 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:34:45,524 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:34:45,524 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:34:45,524 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here. How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:34:45,524 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:34:45,524 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:34:45,524 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:34:45,524 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:34:45,524 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here! How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:34:45,524 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:34:45,524 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:34:45,524 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:34:45,524 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:34:45,524 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here. How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:34:45,524 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:34:45,524 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:34:54,290 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 02:34:58,855 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 02:35:05,802 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 02:35:11,070 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 02:35:34,752 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 02:35:37,157 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 02:35:41,471 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 02:35:45,333 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 02:36:56,093 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:36:56,094 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:36:56,094 [DEBUG] src.luna_functions_handledispatch: User message => 'you there lunabot ' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:36:56,094 [DEBUG] src.luna_functions_handledispatch: m.mentions => {'user_ids': ['@lunabot:localhost']}
2025-01-08 02:36:56,095 [INFO] src.luna_functions_handledispatch: Mentioned user_ids => ['@lunabot:localhost']
2025-01-08 02:36:56,095 [INFO] src.luna_functions_handledispatch: Processing mention for user => @lunabot:localhost
2025-01-08 02:36:56,133 [DEBUG] openai._base_client: Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': 'You are a helpful bot responding to a mention of @lunabot:localhost.'}, {'role': 'user', 'content': 'you there lunabot '}], 'model': 'gpt-4', 'max_tokens': 300, 'temperature': 0.7}}
2025-01-08 02:36:56,139 [DEBUG] httpcore.connection: connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2025-01-08 02:36:56,182 [DEBUG] httpcore.connection: connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x1215c5160>
2025-01-08 02:36:56,182 [DEBUG] httpcore.connection: start_tls.started ssl_context=<ssl.SSLContext object at 0x110c6b890> server_hostname='api.openai.com' timeout=5.0
2025-01-08 02:36:56,206 [DEBUG] httpcore.connection: start_tls.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x12157a210>
2025-01-08 02:36:56,207 [DEBUG] httpcore.http11: send_request_headers.started request=<Request [b'POST']>
2025-01-08 02:36:56,207 [DEBUG] httpcore.http11: send_request_headers.complete
2025-01-08 02:36:56,207 [DEBUG] httpcore.http11: send_request_body.started request=<Request [b'POST']>
2025-01-08 02:36:56,207 [DEBUG] httpcore.http11: send_request_body.complete
2025-01-08 02:36:56,207 [DEBUG] httpcore.http11: receive_response_headers.started request=<Request [b'POST']>
2025-01-08 02:36:57,424 [DEBUG] httpcore.http11: receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Wed, 08 Jan 2025 07:36:57 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-yzbp3micnvwwjimbcblinra3'), (b'openai-processing-ms', b'1142'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'5000'), (b'x-ratelimit-limit-tokens', b'80000'), (b'x-ratelimit-remaining-requests', b'4999'), (b'x-ratelimit-remaining-tokens', b'79676'), (b'x-ratelimit-reset-requests', b'12ms'), (b'x-ratelimit-reset-tokens', b'243ms'), (b'x-request-id', b'req_61a848bbebbed6d0138f93f0aabee1a8'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=QGkAYaqUqlZZ4oJgGiFV5l9flMt3HgpxQDvnugCr_PU-1736321817-1.0.1.1-b35EU5cNBM_MlVKtXn3cfNqAw9.Detf5a1kxKemzHkYubz7l15CIOopf0gc5NxOcQI1Vn1YaBt6txEkwRAQz_A; path=/; expires=Wed, 08-Jan-25 08:06:57 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=q3zdrg8g1oPy636YQ7ekdMGAPaiMbw42cVSuqzHUpUQ-1736321817397-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8fea84f749513b93-BOS'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2025-01-08 02:36:57,426 [INFO] httpx: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-08 02:36:57,427 [DEBUG] httpcore.http11: receive_response_body.started request=<Request [b'POST']>
2025-01-08 02:36:57,427 [DEBUG] httpcore.http11: receive_response_body.complete
2025-01-08 02:36:57,427 [DEBUG] httpcore.http11: response_closed.started
2025-01-08 02:36:57,428 [DEBUG] httpcore.http11: response_closed.complete
2025-01-08 02:36:57,428 [DEBUG] openai._base_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "200 OK"
2025-01-08 02:36:57,439 [INFO] src.luna_functions_handledispatch: GPT reply (for mention @lunabot:localhost) => Yes, I'm here! How can I assist you today?
2025-01-08 02:36:57,484 [INFO] src.luna_functions: Posted GPT reply to room !HPrbJYfQkoGnlztkrS:localhost
2025-01-08 02:36:57,491 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:36:57,491 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:36:57,491 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here! How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:36:57,491 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:36:57,491 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:41:36,950 [INFO] src.console_functions: Console received 'exit' command; requesting shutdown.
2025-01-08 02:41:36,952 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 02:41:36,952 [ERROR] __main__: An unexpected exception occurred in main_logic: Event loop stopped before Future completed.
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 135, in luna
    loop.run_until_complete(main_logic())
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 718, in run_until_complete
    raise RuntimeError('Event loop stopped before Future completed.')
RuntimeError: Event loop stopped before Future completed.
2025-01-08 02:41:36,959 [DEBUG] __main__: Preparing to close the event loop.
2025-01-08 02:41:36,959 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-08 02:41:39,398 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-08 02:41:39,398 [DEBUG] __main__: Exiting configure_logging function.
2025-01-08 02:41:39,398 [DEBUG] __main__: Logging configuration complete.
2025-01-08 02:41:39,398 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-08 02:41:39,398 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 02:41:39,398 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-08 02:41:39,398 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-08 02:41:39,398 [DEBUG] __main__: Entering start_console_thread function.
2025-01-08 02:41:39,401 [INFO] __main__: Console thread started successfully.
2025-01-08 02:41:39,401 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-08 02:41:39,401 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-08 02:41:39,401 [INFO] __main__: Starting main_logic coroutine.
2025-01-08 02:41:39,401 [DEBUG] __main__: Entering main_logic function...
2025-01-08 02:41:39,401 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-08 02:41:39,403 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-08 02:41:39,403 [INFO] src.luna_functions: Using saved token for user @lunabot:localhost.
2025-01-08 02:41:39,403 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-08 02:41:39,406 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 02:41:39,436 [INFO] nio.client.base_client: New joined room !FkbKmoFPWsWYTwKnwg:localhost
2025-01-08 02:41:39,437 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type PowerLevelsEvent
2025-01-08 02:41:39,437 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-08 02:41:39,437 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomJoinRulesEvent
2025-01-08 02:41:39,437 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomGuestAccessEvent
2025-01-08 02:41:39,437 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-08 02:41:39,437 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomCreateEvent
2025-01-08 02:41:39,437 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:41:39,437 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:41:39,437 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:41:39,437 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:41:39,437 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:41:39,437 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:41:39,437 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:41:39,437 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:41:39,437 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:41:39,437 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:41:39,437 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:41:39,437 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:41:39,437 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm online and ready to assist you. How can I help you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:41:39,437 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:41:39,437 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:41:39,437 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:41:39,437 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:41:39,437 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:41:39,437 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:41:39,437 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:41:39,437 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:41:39,437 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:41:39,437 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:41:39,437 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:41:39,437 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:41:39,437 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:41:39,437 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:41:39,437 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:41:39,437 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:41:39,437 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:41:39,437 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:41:39,437 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:41:39,437 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:41:39,437 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:41:39,437 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:41:39,437 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:41:39,437 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:41:39,437 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:41:39,437 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:41:39,437 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:41:39,437 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:41:39,437 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:41:39,437 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:41:39,437 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:41:39,437 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:41:39,437 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:41:39,437 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:41:39,437 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:41:39,438 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:41:39,438 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:41:39,438 [INFO] nio.client.base_client: New joined room !HPrbJYfQkoGnlztkrS:localhost
2025-01-08 02:41:39,438 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-08 02:41:39,438 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomNameEvent
2025-01-08 02:41:39,438 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomJoinRulesEvent
2025-01-08 02:41:39,438 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type PowerLevelsEvent
2025-01-08 02:41:39,438 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-08 02:41:39,438 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomCreateEvent
2025-01-08 02:41:39,438 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomGuestAccessEvent
2025-01-08 02:41:39,438 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:41:39,438 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:41:39,438 [DEBUG] src.luna_functions_handledispatch: User message => 'are you there @luna?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:41:39,438 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:41:39,438 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:41:39,438 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:41:39,438 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:41:39,438 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here. How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:41:39,438 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:41:39,438 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:41:39,438 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:41:39,438 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:41:39,438 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here. How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:41:39,438 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:41:39,438 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:41:39,438 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:41:39,438 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:41:39,438 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here. How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:41:39,438 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:41:39,438 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:41:39,438 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:41:39,438 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:41:39,438 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here! How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:41:39,438 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:41:39,438 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:41:39,438 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:41:39,438 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:41:39,438 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here. How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:41:39,438 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:41:39,438 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:41:39,438 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:41:39,438 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:41:39,438 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here! How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:41:39,438 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:41:39,438 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:41:39,438 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:41:39,438 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:41:39,438 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here. How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:41:39,438 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:41:39,438 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:41:39,438 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:41:39,438 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:41:39,438 [DEBUG] src.luna_functions_handledispatch: User message => 'you there lunabot ' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:41:39,438 [DEBUG] src.luna_functions_handledispatch: m.mentions => {'user_ids': ['@lunabot:localhost']}
2025-01-08 02:41:39,438 [INFO] src.luna_functions_handledispatch: Mentioned user_ids => ['@lunabot:localhost']
2025-01-08 02:41:39,438 [INFO] src.luna_functions_handledispatch: Processing mention for user => @lunabot:localhost
2025-01-08 02:41:39,492 [DEBUG] openai._base_client: Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': 'You are a helpful bot responding to a mention of @lunabot:localhost.'}, {'role': 'user', 'content': 'you there lunabot '}], 'model': 'gpt-4', 'max_tokens': 300, 'temperature': 0.7}}
2025-01-08 02:41:39,496 [DEBUG] httpcore.connection: connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2025-01-08 02:41:39,584 [DEBUG] httpcore.connection: connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10de9be00>
2025-01-08 02:41:39,584 [DEBUG] httpcore.connection: start_tls.started ssl_context=<ssl.SSLContext object at 0x106077890> server_hostname='api.openai.com' timeout=5.0
2025-01-08 02:41:39,616 [DEBUG] httpcore.connection: start_tls.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10de4f9d0>
2025-01-08 02:41:39,616 [DEBUG] httpcore.http11: send_request_headers.started request=<Request [b'POST']>
2025-01-08 02:41:39,616 [DEBUG] httpcore.http11: send_request_headers.complete
2025-01-08 02:41:39,616 [DEBUG] httpcore.http11: send_request_body.started request=<Request [b'POST']>
2025-01-08 02:41:39,617 [DEBUG] httpcore.http11: send_request_body.complete
2025-01-08 02:41:39,617 [DEBUG] httpcore.http11: receive_response_headers.started request=<Request [b'POST']>
2025-01-08 02:41:40,278 [DEBUG] httpcore.http11: receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Wed, 08 Jan 2025 07:41:40 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-yzbp3micnvwwjimbcblinra3'), (b'openai-processing-ms', b'562'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'5000'), (b'x-ratelimit-limit-tokens', b'80000'), (b'x-ratelimit-remaining-requests', b'4999'), (b'x-ratelimit-remaining-tokens', b'79676'), (b'x-ratelimit-reset-requests', b'12ms'), (b'x-ratelimit-reset-tokens', b'243ms'), (b'x-request-id', b'req_321e6aefd8aeb8cff4c081258b522f8c'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=Jb_JYLB_6tUqKvweS0euzDTsjXiiV9jphKusqECJR5Y-1736322100-1.0.1.1-2k.cSpVogBlMP9yRx.qHu3XfjMt8yvB6pls6SBjEyqBeqfEaSe968yXBidHxJ1yPny2K5U23wUIHR_S4_oQStA; path=/; expires=Wed, 08-Jan-25 08:11:40 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=kSHtK6eIZZCBKJZF.Dqd_lew9OruJ2TrY7.UOYyWaAI-1736322100234-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8fea8be29f958fdb-BOS'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2025-01-08 02:41:40,281 [INFO] httpx: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-08 02:41:40,281 [DEBUG] httpcore.http11: receive_response_body.started request=<Request [b'POST']>
2025-01-08 02:41:40,282 [DEBUG] httpcore.http11: receive_response_body.complete
2025-01-08 02:41:40,283 [DEBUG] httpcore.http11: response_closed.started
2025-01-08 02:41:40,283 [DEBUG] httpcore.http11: response_closed.complete
2025-01-08 02:41:40,283 [DEBUG] openai._base_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "200 OK"
2025-01-08 02:41:40,290 [INFO] src.luna_functions_handledispatch: GPT reply (for mention @lunabot:localhost) => Yes, I'm here! How can I assist you today?
2025-01-08 02:41:40,328 [INFO] src.luna_functions: Posted GPT reply to room !HPrbJYfQkoGnlztkrS:localhost
2025-01-08 02:41:40,328 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:41:40,328 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:41:40,328 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here! How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:41:40,328 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:41:40,329 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:41:40,337 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:41:40,337 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:41:40,337 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here! How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:41:40,337 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:41:40,337 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:41:42,414 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 02:41:47,800 [DEBUG] src.console_functions: cmd_create_room called with args='test32', loop=<_UnixSelectorEventLoop running=True closed=False debug=False>
2025-01-08 02:41:47,800 [INFO] src.console_functions: SYSTEM: Creating a new room named 'test32'...
2025-01-08 02:41:47,800 [DEBUG] src.console_functions: Attempting to load token from 'director_token.json'...
2025-01-08 02:41:47,801 [DEBUG] src.console_functions: Loaded token data. user_id=@lunabot:localhost, access_token=(redacted), device_id=SYLZUYWURQ
2025-01-08 02:41:47,801 [DEBUG] src.console_functions: Creating local AsyncClient for user_id='@lunabot:localhost' with homeserver='http://localhost:8008'
2025-01-08 02:41:47,801 [DEBUG] src.console_functions: Scheduling do_create_room() on the existing loop with run_coroutine_threadsafe.
2025-01-08 02:41:47,801 [DEBUG] src.console_functions: Blocking on future_create.result() to get the room_create response.
2025-01-08 02:41:47,801 [DEBUG] src.console_functions: do_create_room: about to call room_create(name='test32', visibility='public')
2025-01-08 02:41:47,801 [ERROR] src.console_functions: Exception in do_create_room during room_create.
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/src/console_functions.py", line 157, in do_create_room
    resp = await client.room_create(name=room_name, visibility="public")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/base_client.py", line 116, in wrapper
    return await func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 2519, in room_create
    method, path, data = Api.room_create(
                         ~~~~~~~~~~~~~~~^
        self.access_token,
        ^^^^^^^^^^^^^^^^^^
    ...<13 lines>...
        space=space,
        ^^^^^^^^^^^^
    )
    ^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/api.py", line 1085, in room_create
    "visibility": visibility.value,
                  ^^^^^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'value'
2025-01-08 02:41:47,807 [ERROR] src.console_functions: Exception while creating room in cmd_create_room.
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/src/console_functions.py", line 177, in cmd_create_room
    resp = future_create.result()
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 456, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/Users/evanrobinson/Documents/Luna2/luna/src/console_functions.py", line 162, in do_create_room
    raise exc
  File "/Users/evanrobinson/Documents/Luna2/luna/src/console_functions.py", line 157, in do_create_room
    resp = await client.room_create(name=room_name, visibility="public")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/base_client.py", line 116, in wrapper
    return await func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 2519, in room_create
    method, path, data = Api.room_create(
                         ~~~~~~~~~~~~~~~^
        self.access_token,
        ^^^^^^^^^^^^^^^^^^
    ...<13 lines>...
        space=space,
        ^^^^^^^^^^^^
    )
    ^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/api.py", line 1085, in room_create
    "visibility": visibility.value,
                  ^^^^^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'value'
2025-01-08 02:41:47,809 [DEBUG] src.console_functions: Scheduling do_close_client() to gracefully close the AsyncClient.
2025-01-08 02:41:47,809 [DEBUG] src.console_functions: Blocking on future_close.result() to confirm the client is closed.
2025-01-08 02:41:47,809 [DEBUG] src.console_functions: do_close_client: closing the AsyncClient.
2025-01-08 02:41:47,809 [DEBUG] src.console_functions: do_close_client: client closed successfully.
2025-01-08 02:41:47,809 [DEBUG] src.console_functions: cmd_create_room: Done with final block.
2025-01-08 02:41:47,810 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 02:46:41,105 [INFO] src.console_functions: Console received 'exit' command; requesting shutdown.
2025-01-08 02:46:41,106 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 02:46:41,106 [ERROR] __main__: An unexpected exception occurred in main_logic: Event loop stopped before Future completed.
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 135, in luna
    loop.run_until_complete(main_logic())
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 718, in run_until_complete
    raise RuntimeError('Event loop stopped before Future completed.')
RuntimeError: Event loop stopped before Future completed.
2025-01-08 02:46:41,113 [DEBUG] __main__: Preparing to close the event loop.
2025-01-08 02:46:41,114 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-08 02:47:45,833 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-08 02:47:45,833 [DEBUG] __main__: Exiting configure_logging function.
2025-01-08 02:47:45,833 [DEBUG] __main__: Logging configuration complete.
2025-01-08 02:47:45,833 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-08 02:47:45,834 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 02:47:45,834 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-08 02:47:45,834 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-08 02:47:45,834 [DEBUG] __main__: Entering start_console_thread function.
2025-01-08 02:47:45,837 [INFO] __main__: Console thread started successfully.
2025-01-08 02:47:45,837 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-08 02:47:45,837 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-08 02:47:45,837 [INFO] __main__: Starting main_logic coroutine.
2025-01-08 02:47:45,837 [DEBUG] __main__: Entering main_logic function...
2025-01-08 02:47:45,837 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-08 02:47:45,839 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-08 02:47:45,839 [INFO] src.luna_functions: Using saved token for user @lunabot:localhost.
2025-01-08 02:47:45,839 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-08 02:47:45,842 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 02:47:45,885 [INFO] nio.client.base_client: New joined room !FkbKmoFPWsWYTwKnwg:localhost
2025-01-08 02:47:45,885 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type PowerLevelsEvent
2025-01-08 02:47:45,885 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-08 02:47:45,885 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomJoinRulesEvent
2025-01-08 02:47:45,885 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomGuestAccessEvent
2025-01-08 02:47:45,885 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-08 02:47:45,885 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomCreateEvent
2025-01-08 02:47:45,885 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:47:45,885 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:47:45,885 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:47:45,885 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:47:45,885 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:47:45,885 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:47:45,885 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:47:45,885 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:47:45,885 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:47:45,885 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:47:45,885 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:47:45,885 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:47:45,885 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm online and ready to assist you. How can I help you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:47:45,885 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:47:45,885 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:47:45,885 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:47:45,885 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:47:45,885 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:47:45,885 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:47:45,885 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:47:45,886 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:47:45,886 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:47:45,886 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:47:45,886 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:47:45,886 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:47:45,886 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:47:45,886 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:47:45,886 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:47:45,886 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:47:45,886 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:47:45,886 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:47:45,886 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:47:45,886 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:47:45,886 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:47:45,886 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:47:45,886 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:47:45,886 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:47:45,886 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:47:45,886 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:47:45,886 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:47:45,886 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:47:45,886 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:47:45,886 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:47:45,886 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:47:45,886 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:47:45,886 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:47:45,886 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:47:45,886 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:47:45,886 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:47:45,886 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:47:45,886 [INFO] nio.client.base_client: New joined room !HPrbJYfQkoGnlztkrS:localhost
2025-01-08 02:47:45,886 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-08 02:47:45,886 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomNameEvent
2025-01-08 02:47:45,886 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomJoinRulesEvent
2025-01-08 02:47:45,886 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type PowerLevelsEvent
2025-01-08 02:47:45,886 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-08 02:47:45,886 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomCreateEvent
2025-01-08 02:47:45,886 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomGuestAccessEvent
2025-01-08 02:47:45,886 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:47:45,886 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:47:45,886 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here. How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:47:45,886 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:47:45,886 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:47:45,886 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:47:45,886 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:47:45,886 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here. How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:47:45,886 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:47:45,886 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:47:45,886 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:47:45,886 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:47:45,886 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here. How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:47:45,886 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:47:45,886 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:47:45,886 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:47:45,886 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:47:45,886 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here! How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:47:45,886 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:47:45,886 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:47:45,886 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:47:45,886 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:47:45,886 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here. How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:47:45,886 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:47:45,887 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:47:45,887 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:47:45,887 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:47:45,887 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here! How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:47:45,887 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:47:45,887 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:47:45,887 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:47:45,887 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:47:45,887 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here. How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:47:45,887 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:47:45,887 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:47:45,887 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:47:45,887 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:47:45,887 [DEBUG] src.luna_functions_handledispatch: User message => 'you there lunabot ' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:47:45,887 [DEBUG] src.luna_functions_handledispatch: m.mentions => {'user_ids': ['@lunabot:localhost']}
2025-01-08 02:47:45,887 [INFO] src.luna_functions_handledispatch: Mentioned user_ids => ['@lunabot:localhost']
2025-01-08 02:47:45,887 [INFO] src.luna_functions_handledispatch: Processing mention for user => @lunabot:localhost
2025-01-08 02:47:45,935 [DEBUG] openai._base_client: Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': 'You are a helpful bot responding to a mention of @lunabot:localhost.'}, {'role': 'user', 'content': 'you there lunabot '}], 'model': 'gpt-4', 'max_tokens': 300, 'temperature': 0.7}}
2025-01-08 02:47:45,939 [DEBUG] httpcore.connection: connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2025-01-08 02:47:46,113 [DEBUG] httpcore.connection: connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x118fc7e00>
2025-01-08 02:47:46,113 [DEBUG] httpcore.connection: start_tls.started ssl_context=<ssl.SSLContext object at 0x1083c7890> server_hostname='api.openai.com' timeout=5.0
2025-01-08 02:47:46,136 [DEBUG] httpcore.connection: start_tls.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x118f73b10>
2025-01-08 02:47:46,137 [DEBUG] httpcore.http11: send_request_headers.started request=<Request [b'POST']>
2025-01-08 02:47:46,137 [DEBUG] httpcore.http11: send_request_headers.complete
2025-01-08 02:47:46,137 [DEBUG] httpcore.http11: send_request_body.started request=<Request [b'POST']>
2025-01-08 02:47:46,138 [DEBUG] httpcore.http11: send_request_body.complete
2025-01-08 02:47:46,138 [DEBUG] httpcore.http11: receive_response_headers.started request=<Request [b'POST']>
2025-01-08 02:47:46,920 [DEBUG] httpcore.http11: receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Wed, 08 Jan 2025 07:47:46 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-yzbp3micnvwwjimbcblinra3'), (b'openai-processing-ms', b'474'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'5000'), (b'x-ratelimit-limit-tokens', b'80000'), (b'x-ratelimit-remaining-requests', b'4999'), (b'x-ratelimit-remaining-tokens', b'79676'), (b'x-ratelimit-reset-requests', b'12ms'), (b'x-ratelimit-reset-tokens', b'243ms'), (b'x-request-id', b'req_e922d0356f5e9409924c28a775a26031'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=8ljzuEEgeARpqMABY2Hc5uOJZ.OSpJdNrsCw.5vmhgY-1736322466-1.0.1.1-ywjSbTyToCmohQjJU7m5pIoR4Km.TiPb0aRo7eDf5xInf5i0qI51Gf1MbphrTcSgDojYE7mizDQ5bFKOU1TU9A; path=/; expires=Wed, 08-Jan-25 08:17:46 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=VaZrWb13KPsXd1Hr5xTw6UTa0RERbVLb4uQ2wPqgfLM-1736322466814-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8fea94d54ad56aca-BOS'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2025-01-08 02:47:46,921 [INFO] httpx: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-08 02:47:46,921 [DEBUG] httpcore.http11: receive_response_body.started request=<Request [b'POST']>
2025-01-08 02:47:46,922 [DEBUG] httpcore.http11: receive_response_body.complete
2025-01-08 02:47:46,922 [DEBUG] httpcore.http11: response_closed.started
2025-01-08 02:47:46,922 [DEBUG] httpcore.http11: response_closed.complete
2025-01-08 02:47:46,922 [DEBUG] openai._base_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "200 OK"
2025-01-08 02:47:46,926 [INFO] src.luna_functions_handledispatch: GPT reply (for mention @lunabot:localhost) => Yes, I'm here! How can I assist you today?
2025-01-08 02:47:46,956 [INFO] src.luna_functions: Posted GPT reply to room !HPrbJYfQkoGnlztkrS:localhost
2025-01-08 02:47:46,956 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:47:46,956 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:47:46,956 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here! How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:47:46,956 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:47:46,956 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:47:46,956 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:47:46,956 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:47:46,956 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here! How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:47:46,956 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:47:46,956 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:47:46,963 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:47:46,963 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:47:46,963 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here! How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:47:46,963 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:47:46,963 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:47:47,918 [INFO] src.console_functions: Console screen cleared.
2025-01-08 02:47:47,918 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 02:47:52,715 [DEBUG] src.console_functions: cmd_create_room called with args='test432', loop=<_UnixSelectorEventLoop running=True closed=False debug=False>
2025-01-08 02:47:52,715 [INFO] src.console_functions: SYSTEM: Creating a new room named 'test432'...
2025-01-08 02:47:52,715 [DEBUG] src.console_functions: Attempting to load token from 'director_token.json'...
2025-01-08 02:47:52,715 [DEBUG] src.console_functions: Loaded token data. user_id=@lunabot:localhost, access_token=(redacted), device_id=SYLZUYWURQ
2025-01-08 02:47:52,715 [DEBUG] src.console_functions: Creating local AsyncClient for user_id='@lunabot:localhost' with homeserver='http://localhost:8008'
2025-01-08 02:47:52,715 [DEBUG] src.console_functions: Scheduling do_create_room() on the existing loop with run_coroutine_threadsafe.
2025-01-08 02:47:52,715 [DEBUG] src.console_functions: Blocking on future_create.result() to get the room_create response.
2025-01-08 02:47:52,715 [DEBUG] src.console_functions: do_create_room: about to call room_create(name='test432', visibility='public')
2025-01-08 02:47:52,715 [ERROR] src.console_functions: Exception in do_create_room during room_create.
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/src/console_functions.py", line 159, in do_create_room
    resp = await client.room_create(name=room_name, visibility=RoomVisibility.PUBLIC,)
                                                               ^^^^^^^^^^^^^^^^^^^^^
AttributeError: type object 'RoomVisibility' has no attribute 'PUBLIC'
2025-01-08 02:47:52,716 [ERROR] src.console_functions: Exception while creating room in cmd_create_room.
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/src/console_functions.py", line 179, in cmd_create_room
    resp = future_create.result()
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 456, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/Users/evanrobinson/Documents/Luna2/luna/src/console_functions.py", line 164, in do_create_room
    raise exc
  File "/Users/evanrobinson/Documents/Luna2/luna/src/console_functions.py", line 159, in do_create_room
    resp = await client.room_create(name=room_name, visibility=RoomVisibility.PUBLIC,)
                                                               ^^^^^^^^^^^^^^^^^^^^^
AttributeError: type object 'RoomVisibility' has no attribute 'PUBLIC'
2025-01-08 02:47:52,717 [DEBUG] src.console_functions: Scheduling do_close_client() to gracefully close the AsyncClient.
2025-01-08 02:47:52,717 [DEBUG] src.console_functions: Blocking on future_close.result() to confirm the client is closed.
2025-01-08 02:47:52,717 [DEBUG] src.console_functions: do_close_client: closing the AsyncClient.
2025-01-08 02:47:52,717 [DEBUG] src.console_functions: do_close_client: client closed successfully.
2025-01-08 02:47:52,717 [DEBUG] src.console_functions: cmd_create_room: Done with final block.
2025-01-08 02:47:52,717 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 02:48:30,155 [DEBUG] src.console_functions: cmd_create_room called with args='test432', loop=<_UnixSelectorEventLoop running=True closed=False debug=False>
2025-01-08 02:48:30,155 [INFO] src.console_functions: SYSTEM: Creating a new room named 'test432'...
2025-01-08 02:48:30,155 [DEBUG] src.console_functions: Attempting to load token from 'director_token.json'...
2025-01-08 02:48:30,159 [DEBUG] src.console_functions: Loaded token data. user_id=@lunabot:localhost, access_token=(redacted), device_id=SYLZUYWURQ
2025-01-08 02:48:30,160 [DEBUG] src.console_functions: Creating local AsyncClient for user_id='@lunabot:localhost' with homeserver='http://localhost:8008'
2025-01-08 02:48:30,160 [DEBUG] src.console_functions: Scheduling do_create_room() on the existing loop with run_coroutine_threadsafe.
2025-01-08 02:48:30,160 [DEBUG] src.console_functions: Blocking on future_create.result() to get the room_create response.
2025-01-08 02:48:30,160 [DEBUG] src.console_functions: do_create_room: about to call room_create(name='test432', visibility='public')
2025-01-08 02:48:30,160 [ERROR] src.console_functions: Exception in do_create_room during room_create.
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/src/console_functions.py", line 159, in do_create_room
    resp = await client.room_create(name=room_name, visibility=RoomVisibility.public,)
                                                               ^^^^^^^^^^^^^^^^^^^^^
AttributeError: type object 'RoomVisibility' has no attribute 'PUBLIC'
2025-01-08 02:48:30,162 [ERROR] src.console_functions: Exception while creating room in cmd_create_room.
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/src/console_functions.py", line 179, in cmd_create_room
    resp = future_create.result()
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 456, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/Users/evanrobinson/Documents/Luna2/luna/src/console_functions.py", line 164, in do_create_room
    raise exc
  File "/Users/evanrobinson/Documents/Luna2/luna/src/console_functions.py", line 159, in do_create_room
    resp = await client.room_create(name=room_name, visibility=RoomVisibility.public,)
                                                               ^^^^^^^^^^^^^^^^^^^^^
AttributeError: type object 'RoomVisibility' has no attribute 'PUBLIC'
2025-01-08 02:48:30,163 [DEBUG] src.console_functions: Scheduling do_close_client() to gracefully close the AsyncClient.
2025-01-08 02:48:30,163 [DEBUG] src.console_functions: Blocking on future_close.result() to confirm the client is closed.
2025-01-08 02:48:30,163 [DEBUG] src.console_functions: do_close_client: closing the AsyncClient.
2025-01-08 02:48:30,163 [DEBUG] src.console_functions: do_close_client: client closed successfully.
2025-01-08 02:48:30,163 [DEBUG] src.console_functions: cmd_create_room: Done with final block.
2025-01-08 02:48:30,163 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 02:48:31,637 [INFO] src.console_functions: Console received 'exit' command; requesting shutdown.
2025-01-08 02:48:31,637 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 02:48:31,637 [ERROR] __main__: An unexpected exception occurred in main_logic: Event loop stopped before Future completed.
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 135, in luna
    loop.run_until_complete(main_logic())
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 718, in run_until_complete
    raise RuntimeError('Event loop stopped before Future completed.')
RuntimeError: Event loop stopped before Future completed.
2025-01-08 02:48:31,640 [DEBUG] __main__: Preparing to close the event loop.
2025-01-08 02:48:31,641 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-08 02:48:33,829 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-08 02:48:33,829 [DEBUG] __main__: Exiting configure_logging function.
2025-01-08 02:48:33,829 [DEBUG] __main__: Logging configuration complete.
2025-01-08 02:48:33,829 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-08 02:48:33,829 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 02:48:33,829 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-08 02:48:33,829 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-08 02:48:33,829 [DEBUG] __main__: Entering start_console_thread function.
2025-01-08 02:48:33,832 [INFO] __main__: Console thread started successfully.
2025-01-08 02:48:33,832 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-08 02:48:33,832 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-08 02:48:33,832 [INFO] __main__: Starting main_logic coroutine.
2025-01-08 02:48:33,833 [DEBUG] __main__: Entering main_logic function...
2025-01-08 02:48:33,833 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-08 02:48:33,833 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-08 02:48:33,835 [INFO] src.luna_functions: Using saved token for user @lunabot:localhost.
2025-01-08 02:48:33,835 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-08 02:48:33,840 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 02:48:33,858 [INFO] nio.client.base_client: New joined room !FkbKmoFPWsWYTwKnwg:localhost
2025-01-08 02:48:33,858 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type PowerLevelsEvent
2025-01-08 02:48:33,858 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-08 02:48:33,858 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomJoinRulesEvent
2025-01-08 02:48:33,858 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomGuestAccessEvent
2025-01-08 02:48:33,858 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-08 02:48:33,858 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomCreateEvent
2025-01-08 02:48:33,858 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:48:33,858 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:48:33,858 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:48:33,858 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:48:33,858 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:48:33,859 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:48:33,859 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:48:33,859 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:48:33,859 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:48:33,859 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:48:33,859 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:48:33,859 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:48:33,859 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm online and ready to assist you. How can I help you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:48:33,859 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:48:33,859 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:48:33,859 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:48:33,859 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:48:33,859 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:48:33,859 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:48:33,859 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:48:33,859 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:48:33,859 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:48:33,859 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:48:33,859 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:48:33,859 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:48:33,859 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:48:33,859 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:48:33,859 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:48:33,859 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:48:33,859 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:48:33,859 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:48:33,859 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:48:33,859 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:48:33,859 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:48:33,859 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:48:33,859 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:48:33,859 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:48:33,859 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:48:33,859 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:48:33,859 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:48:33,859 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:48:33,859 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:48:33,859 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:48:33,859 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:48:33,859 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:48:33,859 [INFO] nio.rooms: Room !FkbKmoFPWsWYTwKnwg:localhost handling event of type RoomMessageText
2025-01-08 02:48:33,859 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:48:33,859 [DEBUG] src.luna_functions_handledispatch: User message => 'Hello! How can I assist you today?' (room_id=!FkbKmoFPWsWYTwKnwg:localhost)
2025-01-08 02:48:33,859 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:48:33,859 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:48:33,859 [INFO] nio.client.base_client: New joined room !HPrbJYfQkoGnlztkrS:localhost
2025-01-08 02:48:33,859 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-08 02:48:33,859 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomNameEvent
2025-01-08 02:48:33,859 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomJoinRulesEvent
2025-01-08 02:48:33,859 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type PowerLevelsEvent
2025-01-08 02:48:33,860 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-08 02:48:33,860 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomCreateEvent
2025-01-08 02:48:33,860 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomGuestAccessEvent
2025-01-08 02:48:33,860 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:48:33,860 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:48:33,860 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here. How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:48:33,860 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:48:33,860 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:48:33,860 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:48:33,860 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:48:33,860 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here. How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:48:33,860 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:48:33,860 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:48:33,860 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:48:33,860 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:48:33,860 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here. How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:48:33,860 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:48:33,860 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:48:33,860 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:48:33,860 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:48:33,860 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here! How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:48:33,860 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:48:33,860 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:48:33,860 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:48:33,860 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:48:33,860 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here. How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:48:33,860 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:48:33,860 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:48:33,860 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:48:33,860 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:48:33,860 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here! How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:48:33,860 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:48:33,860 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:48:33,860 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:48:33,860 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:48:33,860 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here. How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:48:33,860 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:48:33,860 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:48:33,860 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:48:33,860 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:48:33,860 [DEBUG] src.luna_functions_handledispatch: User message => 'you there lunabot ' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:48:33,860 [DEBUG] src.luna_functions_handledispatch: m.mentions => {'user_ids': ['@lunabot:localhost']}
2025-01-08 02:48:33,860 [INFO] src.luna_functions_handledispatch: Mentioned user_ids => ['@lunabot:localhost']
2025-01-08 02:48:33,860 [INFO] src.luna_functions_handledispatch: Processing mention for user => @lunabot:localhost
2025-01-08 02:48:33,885 [DEBUG] openai._base_client: Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': 'You are a helpful bot responding to a mention of @lunabot:localhost.'}, {'role': 'user', 'content': 'you there lunabot '}], 'model': 'gpt-4', 'max_tokens': 300, 'temperature': 0.7}}
2025-01-08 02:48:33,890 [DEBUG] httpcore.connection: connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2025-01-08 02:48:33,992 [DEBUG] httpcore.connection: connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10c9d3cb0>
2025-01-08 02:48:33,992 [DEBUG] httpcore.connection: start_tls.started ssl_context=<ssl.SSLContext object at 0x1091b3890> server_hostname='api.openai.com' timeout=5.0
2025-01-08 02:48:34,013 [DEBUG] httpcore.connection: start_tls.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10c883390>
2025-01-08 02:48:34,013 [DEBUG] httpcore.http11: send_request_headers.started request=<Request [b'POST']>
2025-01-08 02:48:34,014 [DEBUG] httpcore.http11: send_request_headers.complete
2025-01-08 02:48:34,014 [DEBUG] httpcore.http11: send_request_body.started request=<Request [b'POST']>
2025-01-08 02:48:34,014 [DEBUG] httpcore.http11: send_request_body.complete
2025-01-08 02:48:34,014 [DEBUG] httpcore.http11: receive_response_headers.started request=<Request [b'POST']>
2025-01-08 02:48:34,024 [INFO] src.console_functions: Console screen cleared.
2025-01-08 02:48:34,024 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 02:48:34,698 [DEBUG] httpcore.http11: receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Wed, 08 Jan 2025 07:48:34 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-yzbp3micnvwwjimbcblinra3'), (b'openai-processing-ms', b'611'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'5000'), (b'x-ratelimit-limit-tokens', b'80000'), (b'x-ratelimit-remaining-requests', b'4999'), (b'x-ratelimit-remaining-tokens', b'79676'), (b'x-ratelimit-reset-requests', b'12ms'), (b'x-ratelimit-reset-tokens', b'243ms'), (b'x-request-id', b'req_7f4878478e305a640b51c08aeaecc4ae'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=OdaSrUq3ewfFstlepufxLyVQ73wYDCVLdtDSQa6MIks-1736322514-1.0.1.1-I80r10XgsagP4V0MwwsDkxmYtnXQ60gxKRXDTeI4pC8AuydSaaA85Ky9GByavgbvUn9HP7qs8nDvSTkQXEss0A; path=/; expires=Wed, 08-Jan-25 08:18:34 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=UQdKJnwFEyYbncYdCf4JevLFclVYV_fv_CXN1nXQhdo-1736322514684-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8fea9600ab7a8d17-BOS'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2025-01-08 02:48:34,699 [INFO] httpx: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-08 02:48:34,699 [DEBUG] httpcore.http11: receive_response_body.started request=<Request [b'POST']>
2025-01-08 02:48:34,699 [DEBUG] httpcore.http11: receive_response_body.complete
2025-01-08 02:48:34,699 [DEBUG] httpcore.http11: response_closed.started
2025-01-08 02:48:34,699 [DEBUG] httpcore.http11: response_closed.complete
2025-01-08 02:48:34,699 [DEBUG] openai._base_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "200 OK"
2025-01-08 02:48:34,702 [INFO] src.luna_functions_handledispatch: GPT reply (for mention @lunabot:localhost) => Yes, I'm here! How can I assist you today?
2025-01-08 02:48:34,738 [INFO] src.luna_functions: Posted GPT reply to room !HPrbJYfQkoGnlztkrS:localhost
2025-01-08 02:48:34,738 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:48:34,738 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:48:34,738 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here! How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:48:34,738 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:48:34,738 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:48:34,738 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:48:34,738 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:48:34,738 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here! How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:48:34,739 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:48:34,739 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:48:34,741 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:48:34,741 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:48:34,741 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here! How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:48:34,741 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:48:34,741 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:48:34,749 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomMessageText
2025-01-08 02:48:34,749 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-08 02:48:34,749 [DEBUG] src.luna_functions_handledispatch: User message => 'Yes, I'm here! How can I assist you today?' (room_id=!HPrbJYfQkoGnlztkrS:localhost)
2025-01-08 02:48:34,749 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-08 02:48:34,749 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-08 02:48:39,509 [DEBUG] src.console_functions: cmd_create_room called with args='129732', loop=<_UnixSelectorEventLoop running=True closed=False debug=False>
2025-01-08 02:48:39,509 [INFO] src.console_functions: SYSTEM: Creating a new room named '129732'...
2025-01-08 02:48:39,510 [DEBUG] src.console_functions: Attempting to load token from 'director_token.json'...
2025-01-08 02:48:39,510 [DEBUG] src.console_functions: Loaded token data. user_id=@lunabot:localhost, access_token=(redacted), device_id=SYLZUYWURQ
2025-01-08 02:48:39,510 [DEBUG] src.console_functions: Creating local AsyncClient for user_id='@lunabot:localhost' with homeserver='http://localhost:8008'
2025-01-08 02:48:39,510 [DEBUG] src.console_functions: Scheduling do_create_room() on the existing loop with run_coroutine_threadsafe.
2025-01-08 02:48:39,510 [DEBUG] src.console_functions: Blocking on future_create.result() to get the room_create response.
2025-01-08 02:48:39,510 [DEBUG] src.console_functions: do_create_room: about to call room_create(name='129732', visibility='public')
2025-01-08 02:48:39,570 [INFO] nio.client.base_client: New joined room !VsYgleTlXoQacelwTz:localhost
2025-01-08 02:48:39,570 [INFO] nio.rooms: Room !VsYgleTlXoQacelwTz:localhost handling event of type RoomCreateEvent
2025-01-08 02:48:39,576 [DEBUG] src.console_functions: do_create_room: room_create call returned RoomCreateResponse(uuid='', start_time=None, end_time=None, timeout=0, transport_response=<ClientResponse(http://localhost:8008/_matrix/client/v3/createRoom) [200 OK]>
<CIMultiDictProxy('Server': 'Synapse/1.121.1', 'Date': 'Wed, 08 Jan 2025 07:48:39 GMT', 'Content-Type': 'application/json', 'Cache-Control': 'no-cache, no-store, must-revalidate', 'Access-Control-Allow-Origin': '*', 'Access-Control-Allow-Methods': 'GET, HEAD, POST, PUT, DELETE, OPTIONS', 'Access-Control-Allow-Headers': 'X-Requested-With, Content-Type, Authorization, Date', 'Access-Control-Expose-Headers': 'Synapse-Trace-Id, Server', 'Transfer-Encoding': 'chunked')>
, room_id='!VsYgleTlXoQacelwTz:localhost')
2025-01-08 02:48:39,576 [DEBUG] src.console_functions: future_create.result() returned => RoomCreateResponse(uuid='', start_time=None, end_time=None, timeout=0, transport_response=<ClientResponse(http://localhost:8008/_matrix/client/v3/createRoom) [200 OK]>
<CIMultiDictProxy('Server': 'Synapse/1.121.1', 'Date': 'Wed, 08 Jan 2025 07:48:39 GMT', 'Content-Type': 'application/json', 'Cache-Control': 'no-cache, no-store, must-revalidate', 'Access-Control-Allow-Origin': '*', 'Access-Control-Allow-Methods': 'GET, HEAD, POST, PUT, DELETE, OPTIONS', 'Access-Control-Allow-Headers': 'X-Requested-With, Content-Type, Authorization, Date', 'Access-Control-Expose-Headers': 'Synapse-Trace-Id, Server', 'Transfer-Encoding': 'chunked')>
, room_id='!VsYgleTlXoQacelwTz:localhost')
2025-01-08 02:48:39,576 [INFO] src.console_functions: SYSTEM: Created room '129732' => !VsYgleTlXoQacelwTz:localhost
2025-01-08 02:48:39,576 [DEBUG] src.console_functions: Scheduling do_close_client() to gracefully close the AsyncClient.
2025-01-08 02:48:39,576 [DEBUG] src.console_functions: Blocking on future_close.result() to confirm the client is closed.
2025-01-08 02:48:39,577 [DEBUG] src.console_functions: do_close_client: closing the AsyncClient.
2025-01-08 02:48:39,577 [DEBUG] src.console_functions: do_close_client: client closed successfully.
2025-01-08 02:48:39,577 [DEBUG] src.console_functions: cmd_create_room: Done with final block.
2025-01-08 02:48:39,577 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 02:48:39,583 [INFO] nio.rooms: Room !VsYgleTlXoQacelwTz:localhost handling event of type PowerLevelsEvent
2025-01-08 02:48:39,583 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-08 02:48:39,583 [INFO] nio.rooms: Room !VsYgleTlXoQacelwTz:localhost handling event of type RoomJoinRulesEvent
2025-01-08 02:48:39,583 [INFO] nio.rooms: Room !VsYgleTlXoQacelwTz:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-08 02:48:39,583 [INFO] nio.rooms: Room !VsYgleTlXoQacelwTz:localhost handling event of type RoomNameEvent
2025-01-08 02:48:48,054 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 02:48:52,523 [INFO] src.console_functions: Console received 'exit' command; requesting shutdown.
2025-01-08 02:48:52,524 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-08 02:48:52,524 [ERROR] __main__: An unexpected exception occurred in main_logic: Event loop stopped before Future completed.
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 135, in luna
    loop.run_until_complete(main_logic())
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 718, in run_until_complete
    raise RuntimeError('Event loop stopped before Future completed.')
RuntimeError: Event loop stopped before Future completed.
2025-01-08 02:48:52,528 [DEBUG] __main__: Preparing to close the event loop.
2025-01-08 02:48:52,528 [INFO] __main__: Event loop closed. Exiting main function.
