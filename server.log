2025-01-05 18:24:24,505 [INFO] src.console_functions: Log rotation complete. Logging to server.log again.
2025-01-05 18:24:24,505 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 18:29:51,521 [DEBUG] src.console_functions: Showing help to user.
2025-01-05 18:29:51,522 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 18:31:59,788 [INFO] src.console_functions: Console received 'restart' command; restarting now.
2025-01-05 18:32:00,719 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-05 18:32:00,719 [DEBUG] __main__: Exiting configure_logging function.
2025-01-05 18:32:00,719 [DEBUG] __main__: Logging configuration complete.
2025-01-05 18:32:00,719 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-05 18:32:00,719 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 18:32:00,719 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-05 18:32:00,719 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-05 18:32:00,719 [DEBUG] __main__: Entering start_console_thread function.
2025-01-05 18:32:00,722 [INFO] __main__: Console thread started successfully.
2025-01-05 18:32:00,722 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-05 18:32:00,722 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-05 18:32:00,722 [INFO] __main__: Starting main_logic coroutine.
2025-01-05 18:32:00,722 [DEBUG] __main__: Entering main_logic function...
2025-01-05 18:32:00,722 [DEBUG] __main__: Attempting to load or log in the client.
2025-01-05 18:32:00,727 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 18:32:00,824 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-05 18:32:00,825 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-05 18:32:00,825 [INFO] src.luna_functions: Using saved token for user @luna:localhost.
2025-01-05 18:32:00,825 [DEBUG] __main__: Client obtained. Storing reference to DIRECTOR_CLIENT in src.luna_functions.
2025-01-05 18:32:00,825 [DEBUG] __main__: Callbacks registered successfully.
2025-01-05 18:32:00,825 [DEBUG] __main__: Starting sync_forever loop. Awaiting new events with timeout=30000.
2025-01-05 18:32:00,857 [INFO] nio.client.base_client: New joined room !PmOiRDooqweqMsXyTN:localhost
2025-01-05 18:32:00,857 [INFO] nio.rooms: Room !PmOiRDooqweqMsXyTN:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-05 18:32:00,857 [INFO] nio.rooms: Room !PmOiRDooqweqMsXyTN:localhost handling event of type RoomJoinRulesEvent
2025-01-05 18:32:00,857 [INFO] nio.rooms: Room !PmOiRDooqweqMsXyTN:localhost handling event of type PowerLevelsEvent
2025-01-05 18:32:00,857 [INFO] nio.rooms: Changing power level for user @luna:localhost from 0 to 100
2025-01-05 18:32:00,857 [INFO] nio.rooms: Room !PmOiRDooqweqMsXyTN:localhost handling event of type RoomCreateEvent
2025-01-05 18:32:00,857 [INFO] nio.rooms: Room !PmOiRDooqweqMsXyTN:localhost handling event of type RoomGuestAccessEvent
2025-01-05 18:32:00,857 [INFO] nio.rooms: Room !PmOiRDooqweqMsXyTN:localhost handling event of type RoomMessageText
2025-01-05 18:32:00,857 [DEBUG] src.luna_functions: Ignoring my own message.
2025-01-05 18:32:00,857 [INFO] nio.rooms: Room !PmOiRDooqweqMsXyTN:localhost handling event of type RoomMessageText
2025-01-05 18:32:00,857 [DEBUG] src.luna_functions: Ignoring my own message.
2025-01-05 18:32:00,857 [INFO] nio.rooms: Room !PmOiRDooqweqMsXyTN:localhost handling event of type RoomMessageText
2025-01-05 18:32:00,857 [DEBUG] src.luna_functions: Ignoring my own message.
2025-01-05 18:32:00,857 [INFO] nio.rooms: Room !PmOiRDooqweqMsXyTN:localhost handling event of type RoomMessageText
2025-01-05 18:32:00,857 [DEBUG] src.luna_functions: Ignoring my own message.
2025-01-05 18:32:00,857 [INFO] nio.rooms: Room !PmOiRDooqweqMsXyTN:localhost handling event of type RoomMessageText
2025-01-05 18:32:00,857 [DEBUG] src.luna_functions: Ignoring my own message.
2025-01-05 18:32:00,857 [INFO] nio.rooms: Room !PmOiRDooqweqMsXyTN:localhost handling event of type RoomMessageText
2025-01-05 18:32:00,857 [DEBUG] src.luna_functions: Ignoring my own message.
2025-01-05 18:32:00,857 [INFO] nio.rooms: Room !PmOiRDooqweqMsXyTN:localhost handling event of type RoomMessageText
2025-01-05 18:32:00,857 [DEBUG] src.luna_functions: Ignoring my own message.
2025-01-05 18:32:00,857 [INFO] nio.rooms: Room !PmOiRDooqweqMsXyTN:localhost handling event of type RoomMessageText
2025-01-05 18:32:00,857 [DEBUG] src.luna_functions: Ignoring my own message.
2025-01-05 18:32:00,857 [INFO] nio.rooms: Room !PmOiRDooqweqMsXyTN:localhost handling event of type RoomMessageText
2025-01-05 18:32:00,857 [DEBUG] src.luna_functions: Ignoring my own message.
2025-01-05 18:32:00,857 [INFO] nio.rooms: Room !PmOiRDooqweqMsXyTN:localhost handling event of type RoomMessageText
2025-01-05 18:32:00,857 [DEBUG] src.luna_functions: Ignoring my own message.
2025-01-05 18:32:00,857 [INFO] nio.client.base_client: New joined room !byRaIjLPSRhKcNeUTu:localhost
2025-01-05 18:32:00,857 [INFO] nio.rooms: Room !byRaIjLPSRhKcNeUTu:localhost handling event of type RoomTopicEvent
2025-01-05 18:32:00,857 [INFO] nio.rooms: Room !byRaIjLPSRhKcNeUTu:localhost handling event of type RoomNameEvent
2025-01-05 18:32:00,857 [INFO] nio.rooms: Room !byRaIjLPSRhKcNeUTu:localhost handling event of type RoomAliasEvent
2025-01-05 18:32:00,857 [INFO] nio.rooms: Room !byRaIjLPSRhKcNeUTu:localhost handling event of type RoomJoinRulesEvent
2025-01-05 18:32:00,857 [INFO] nio.rooms: Room !byRaIjLPSRhKcNeUTu:localhost handling event of type PowerLevelsEvent
2025-01-05 18:32:00,857 [INFO] nio.rooms: Room !byRaIjLPSRhKcNeUTu:localhost handling event of type RoomCreateEvent
2025-01-05 18:32:00,857 [INFO] nio.rooms: Room !byRaIjLPSRhKcNeUTu:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-05 18:32:00,857 [INFO] nio.rooms: Room !byRaIjLPSRhKcNeUTu:localhost handling event of type RoomMessageText
2025-01-05 18:32:00,857 [DEBUG] src.luna_functions: Ignoring my own message.
2025-01-05 18:32:00,857 [INFO] nio.rooms: Room !byRaIjLPSRhKcNeUTu:localhost handling event of type RoomMessageText
2025-01-05 18:32:00,857 [DEBUG] src.luna_functions: Ignoring my own message.
2025-01-05 18:32:00,857 [INFO] nio.rooms: Room !byRaIjLPSRhKcNeUTu:localhost handling event of type RoomMessageText
2025-01-05 18:32:00,857 [DEBUG] src.luna_functions: Ignoring my own message.
2025-01-05 18:32:00,857 [INFO] nio.rooms: Room !byRaIjLPSRhKcNeUTu:localhost handling event of type RoomMessageText
2025-01-05 18:32:00,857 [DEBUG] src.luna_functions: Ignoring my own message.
2025-01-05 18:32:00,857 [INFO] nio.rooms: Room !byRaIjLPSRhKcNeUTu:localhost handling event of type RoomMessageText
2025-01-05 18:32:00,857 [DEBUG] src.luna_functions: Ignoring my own message.
2025-01-05 18:32:00,857 [INFO] nio.rooms: Room !byRaIjLPSRhKcNeUTu:localhost handling event of type RoomMessageText
2025-01-05 18:32:00,857 [DEBUG] src.luna_functions: Ignoring my own message.
2025-01-05 18:32:00,857 [INFO] nio.rooms: Room !byRaIjLPSRhKcNeUTu:localhost handling event of type RoomMessageText
2025-01-05 18:32:00,857 [DEBUG] src.luna_functions: Ignoring my own message.
2025-01-05 18:32:00,857 [INFO] nio.rooms: Room !byRaIjLPSRhKcNeUTu:localhost handling event of type RoomMessageText
2025-01-05 18:32:00,858 [DEBUG] src.luna_functions: Ignoring my own message.
2025-01-05 18:32:00,858 [INFO] nio.rooms: Room !byRaIjLPSRhKcNeUTu:localhost handling event of type RoomMessageText
2025-01-05 18:32:00,858 [DEBUG] src.luna_functions: Ignoring my own message.
2025-01-05 18:32:00,858 [INFO] nio.rooms: Room !byRaIjLPSRhKcNeUTu:localhost handling event of type RoomMessageText
2025-01-05 18:32:00,858 [DEBUG] src.luna_functions: Ignoring my own message.
2025-01-05 18:32:02,713 [INFO] src.console_functions: Console screen cleared.
2025-01-05 18:32:02,713 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 18:33:31,893 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 18:34:29,452 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 18:34:54,808 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 18:35:51,596 [INFO] src.console_functions: Console received 'restart' command; restarting now.
2025-01-05 18:35:52,496 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-05 18:35:52,496 [DEBUG] __main__: Exiting configure_logging function.
2025-01-05 18:35:52,496 [DEBUG] __main__: Logging configuration complete.
2025-01-05 18:35:52,496 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-05 18:35:52,496 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 18:35:52,496 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-05 18:35:52,496 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-05 18:35:52,496 [DEBUG] __main__: Entering start_console_thread function.
2025-01-05 18:35:52,499 [INFO] __main__: Console thread started successfully.
2025-01-05 18:35:52,499 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-05 18:35:52,499 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-05 18:35:52,499 [INFO] __main__: Starting main_logic coroutine.
2025-01-05 18:35:52,499 [DEBUG] __main__: Entering main_logic function...
2025-01-05 18:35:52,499 [DEBUG] __main__: Attempting to load or log in the client.
2025-01-05 18:35:52,504 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 18:35:52,600 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-05 18:35:52,602 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-05 18:35:52,602 [INFO] src.luna_functions: Using saved token for user @luna:localhost.
2025-01-05 18:35:52,602 [DEBUG] __main__: Client obtained. Storing reference to DIRECTOR_CLIENT in src.luna_functions.
2025-01-05 18:35:52,602 [DEBUG] __main__: Callbacks registered successfully.
2025-01-05 18:35:52,602 [DEBUG] __main__: Starting sync_forever loop. Awaiting new events with timeout=30000.
2025-01-05 18:35:52,636 [INFO] nio.client.base_client: New joined room !PmOiRDooqweqMsXyTN:localhost
2025-01-05 18:35:52,636 [INFO] nio.rooms: Room !PmOiRDooqweqMsXyTN:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-05 18:35:52,636 [INFO] nio.rooms: Room !PmOiRDooqweqMsXyTN:localhost handling event of type RoomJoinRulesEvent
2025-01-05 18:35:52,636 [INFO] nio.rooms: Room !PmOiRDooqweqMsXyTN:localhost handling event of type PowerLevelsEvent
2025-01-05 18:35:52,637 [INFO] nio.rooms: Changing power level for user @luna:localhost from 0 to 100
2025-01-05 18:35:52,637 [INFO] nio.rooms: Room !PmOiRDooqweqMsXyTN:localhost handling event of type RoomCreateEvent
2025-01-05 18:35:52,637 [INFO] nio.rooms: Room !PmOiRDooqweqMsXyTN:localhost handling event of type RoomGuestAccessEvent
2025-01-05 18:35:52,637 [INFO] nio.rooms: Room !PmOiRDooqweqMsXyTN:localhost handling event of type RoomMessageText
2025-01-05 18:35:52,637 [DEBUG] src.luna_functions: Ignoring my own message.
2025-01-05 18:35:52,637 [INFO] nio.rooms: Room !PmOiRDooqweqMsXyTN:localhost handling event of type RoomMessageText
2025-01-05 18:35:52,637 [DEBUG] src.luna_functions: Ignoring my own message.
2025-01-05 18:35:52,637 [INFO] nio.rooms: Room !PmOiRDooqweqMsXyTN:localhost handling event of type RoomMessageText
2025-01-05 18:35:52,637 [DEBUG] src.luna_functions: Ignoring my own message.
2025-01-05 18:35:52,637 [INFO] nio.rooms: Room !PmOiRDooqweqMsXyTN:localhost handling event of type RoomMessageText
2025-01-05 18:35:52,637 [DEBUG] src.luna_functions: Ignoring my own message.
2025-01-05 18:35:52,637 [INFO] nio.rooms: Room !PmOiRDooqweqMsXyTN:localhost handling event of type RoomMessageText
2025-01-05 18:35:52,637 [DEBUG] src.luna_functions: Ignoring my own message.
2025-01-05 18:35:52,637 [INFO] nio.rooms: Room !PmOiRDooqweqMsXyTN:localhost handling event of type RoomMessageText
2025-01-05 18:35:52,637 [DEBUG] src.luna_functions: Ignoring my own message.
2025-01-05 18:35:52,637 [INFO] nio.rooms: Room !PmOiRDooqweqMsXyTN:localhost handling event of type RoomMessageText
2025-01-05 18:35:52,637 [DEBUG] src.luna_functions: Ignoring my own message.
2025-01-05 18:35:52,637 [INFO] nio.rooms: Room !PmOiRDooqweqMsXyTN:localhost handling event of type RoomMessageText
2025-01-05 18:35:52,637 [DEBUG] src.luna_functions: Ignoring my own message.
2025-01-05 18:35:52,637 [INFO] nio.rooms: Room !PmOiRDooqweqMsXyTN:localhost handling event of type RoomMessageText
2025-01-05 18:35:52,637 [DEBUG] src.luna_functions: Ignoring my own message.
2025-01-05 18:35:52,637 [INFO] nio.rooms: Room !PmOiRDooqweqMsXyTN:localhost handling event of type RoomMessageText
2025-01-05 18:35:52,637 [DEBUG] src.luna_functions: Ignoring my own message.
2025-01-05 18:35:52,637 [INFO] nio.client.base_client: New joined room !byRaIjLPSRhKcNeUTu:localhost
2025-01-05 18:35:52,637 [INFO] nio.rooms: Room !byRaIjLPSRhKcNeUTu:localhost handling event of type RoomTopicEvent
2025-01-05 18:35:52,637 [INFO] nio.rooms: Room !byRaIjLPSRhKcNeUTu:localhost handling event of type RoomNameEvent
2025-01-05 18:35:52,637 [INFO] nio.rooms: Room !byRaIjLPSRhKcNeUTu:localhost handling event of type RoomAliasEvent
2025-01-05 18:35:52,637 [INFO] nio.rooms: Room !byRaIjLPSRhKcNeUTu:localhost handling event of type RoomJoinRulesEvent
2025-01-05 18:35:52,637 [INFO] nio.rooms: Room !byRaIjLPSRhKcNeUTu:localhost handling event of type PowerLevelsEvent
2025-01-05 18:35:52,637 [INFO] nio.rooms: Room !byRaIjLPSRhKcNeUTu:localhost handling event of type RoomCreateEvent
2025-01-05 18:35:52,637 [INFO] nio.rooms: Room !byRaIjLPSRhKcNeUTu:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-05 18:35:52,637 [INFO] nio.rooms: Room !byRaIjLPSRhKcNeUTu:localhost handling event of type RoomMessageText
2025-01-05 18:35:52,637 [DEBUG] src.luna_functions: Ignoring my own message.
2025-01-05 18:35:52,637 [INFO] nio.rooms: Room !byRaIjLPSRhKcNeUTu:localhost handling event of type RoomMessageText
2025-01-05 18:35:52,637 [DEBUG] src.luna_functions: Ignoring my own message.
2025-01-05 18:35:52,637 [INFO] nio.rooms: Room !byRaIjLPSRhKcNeUTu:localhost handling event of type RoomMessageText
2025-01-05 18:35:52,638 [DEBUG] src.luna_functions: Ignoring my own message.
2025-01-05 18:35:52,638 [INFO] nio.rooms: Room !byRaIjLPSRhKcNeUTu:localhost handling event of type RoomMessageText
2025-01-05 18:35:52,638 [DEBUG] src.luna_functions: Ignoring my own message.
2025-01-05 18:35:52,638 [INFO] nio.rooms: Room !byRaIjLPSRhKcNeUTu:localhost handling event of type RoomMessageText
2025-01-05 18:35:52,638 [DEBUG] src.luna_functions: Ignoring my own message.
2025-01-05 18:35:52,638 [INFO] nio.rooms: Room !byRaIjLPSRhKcNeUTu:localhost handling event of type RoomMessageText
2025-01-05 18:35:52,638 [DEBUG] src.luna_functions: Ignoring my own message.
2025-01-05 18:35:52,638 [INFO] nio.rooms: Room !byRaIjLPSRhKcNeUTu:localhost handling event of type RoomMessageText
2025-01-05 18:35:52,638 [DEBUG] src.luna_functions: Ignoring my own message.
2025-01-05 18:35:52,638 [INFO] nio.rooms: Room !byRaIjLPSRhKcNeUTu:localhost handling event of type RoomMessageText
2025-01-05 18:35:52,638 [DEBUG] src.luna_functions: Ignoring my own message.
2025-01-05 18:35:52,638 [INFO] nio.rooms: Room !byRaIjLPSRhKcNeUTu:localhost handling event of type RoomMessageText
2025-01-05 18:35:52,638 [DEBUG] src.luna_functions: Ignoring my own message.
2025-01-05 18:35:52,638 [INFO] nio.rooms: Room !byRaIjLPSRhKcNeUTu:localhost handling event of type RoomMessageText
2025-01-05 18:35:52,638 [DEBUG] src.luna_functions: Ignoring my own message.
2025-01-05 18:35:57,694 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 18:36:12,803 [INFO] nio.rooms: Room !byRaIjLPSRhKcNeUTu:localhost handling event of type RoomMessageText
2025-01-05 18:36:12,803 [INFO] src.luna_functions: Fetching last 100 messages from room !byRaIjLPSRhKcNeUTu:localhost.
2025-01-05 18:36:12,826 [INFO] src.luna_functions: Fetched 33 messages from room !byRaIjLPSRhKcNeUTu:localhost.
2025-01-05 18:36:12,826 [DEBUG] src.luna_functions: Formatted context for GPT: [{'role': 'system', 'content': 'You are a helpful assistant. The provided context array includes messages from an ongoing conversation. Treat this context as fair use and consider it an essential part of the conversation. Your responses should build on this context coherently.'}, {'role': 'user', 'content': 'hello?'}, {'role': 'user', 'content': "I'm sorry, but as an AI, I don't have access to personal data about individuals unless it has been shared with me in the course of our conversation. I'm designed to respect user privacy and confidentiality."}, {'role': 'user', 'content': 'From our previous discussions, it seems you were seeking assistance with a mathematical problem related to the constant Pi. Would you like to continue with that topic, or is there something new you need help with?'}, {'role': 'user', 'content': "As an artificial intelligence, I don't eat so I don't have personal experiences or preferences. However, I can provide information or even a recipe for apple pie! Now, how can I assist you with your inquiry about Pi, the mathematical constant?"}, {'role': 'user', 'content': 'Understood, you need help with a problem related to Pi. Could you please specify the problem so I can assist you more effectively? Are we dealing with geometry, trigonometry, or another area of math?'}, {'role': 'user', 'content': "Sure, I'd be happy to help you with your math problem. Could you please provide me with the details of the problem you're trying to solve?"}, {'role': 'user', 'content': "I'm sorry, but as an AI, I don't have the ability to access personal data about individuals unless it has been shared with me in the course of our conversation. I am designed to respect user privacy and confidentiality."}, {'role': 'user', 'content': 'From our previous conversations, it appears you were looking for assistance with a math problem related to Pi, the mathematical constant. Can you provide more specific details about this problem so I can assist you better?'}, {'role': 'user', 'content': "As an AI, I don't have personal experiences or preferences, but I can provide information about apple pie or Pi (the mathematical constant). How can I assist you further?"}, {'role': 'user', 'content': "Sure, I'd be happy to help you with your question about Pi. Could you please provide me with the details of the problem you're trying to solve?"}, {'role': 'user', 'content': "Sure, I'd be happy to help you with your math problem. Could you please provide me with the details of the problem you're trying to solve?"}, {'role': 'user', 'content': "I'm sorry, but as an AI, I don't have the ability to access personal data about individuals unless it has been shared with me in the course of our conversation. I am designed to respect user privacy and confidentiality."}, {'role': 'user', 'content': "what's my name?"}, {'role': 'user', 'content': 'Based on our previous interactions, you were looking to test the private channel. Do you need assistance with this or is there something else you need help with?'}, {'role': 'user', 'content': 'what do I need help with again'}, {'role': 'user', 'content': "As an artificial intelligence, I don't eat food. But I can certainly provide you with a great recipe for apple pie if you'd like!"}, {'role': 'user', 'content': 'not the kind of pi you eat but I love apple pie, you?'}, {'role': 'user', 'content': "Pi is a mathematical constant that represents the ratio of a circle's circumference to its diameter. It's approximately 3.14159, but it's an irrational number, meaning it goes on indefinitely without repeating. How can I assist you further with Pi?"}, {'role': 'user', 'content': "It's about pi"}, {'role': 'user', 'content': "Of course, I'd be happy to help with your math problem. Could you please tell me what the problem is?"}, {'role': 'user', 'content': 'I need help figuring out a math problem'}, {'role': 'user', 'content': 'Nice to meet you, Steve. How can I assist you today?'}, {'role': 'user', 'content': "I'm steve"}, {'role': 'user', 'content': "I'm an artificial intelligence and don't have an account executive. However, I'm here to assist you. How can I help you further?"}, {'role': 'user', 'content': "what's your ae"}, {'role': 'user', 'content': "I'm glad to hear that! If you have any other questions or need further assistance with the private channel, feel free to ask."}, {'role': 'user', 'content': 'great'}, {'role': 'user', 'content': "I'm here and ready to assist. How may I help you with the test?"}, {'role': 'user', 'content': 'test'}, {'role': 'user', 'content': "I'm here and ready to assist. How can we test the private channel according to your needs?"}, {'role': 'user', 'content': 'Hello! How can I assist you with the private channel?'}, {'role': 'user', 'content': 'test'}, {'role': 'user', 'content': 'test private channel'}, {'role': 'user', 'content': 'hello?'}]
2025-01-05 18:36:12,861 [DEBUG] openai._base_client: Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': 'You are a helpful assistant. The provided context array includes messages from an ongoing conversation. Treat this context as fair use and consider it an essential part of the conversation. Your responses should build on this context coherently.'}, {'role': 'user', 'content': 'hello?'}, {'role': 'user', 'content': "I'm sorry, but as an AI, I don't have access to personal data about individuals unless it has been shared with me in the course of our conversation. I'm designed to respect user privacy and confidentiality."}, {'role': 'user', 'content': 'From our previous discussions, it seems you were seeking assistance with a mathematical problem related to the constant Pi. Would you like to continue with that topic, or is there something new you need help with?'}, {'role': 'user', 'content': "As an artificial intelligence, I don't eat so I don't have personal experiences or preferences. However, I can provide information or even a recipe for apple pie! Now, how can I assist you with your inquiry about Pi, the mathematical constant?"}, {'role': 'user', 'content': 'Understood, you need help with a problem related to Pi. Could you please specify the problem so I can assist you more effectively? Are we dealing with geometry, trigonometry, or another area of math?'}, {'role': 'user', 'content': "Sure, I'd be happy to help you with your math problem. Could you please provide me with the details of the problem you're trying to solve?"}, {'role': 'user', 'content': "I'm sorry, but as an AI, I don't have the ability to access personal data about individuals unless it has been shared with me in the course of our conversation. I am designed to respect user privacy and confidentiality."}, {'role': 'user', 'content': 'From our previous conversations, it appears you were looking for assistance with a math problem related to Pi, the mathematical constant. Can you provide more specific details about this problem so I can assist you better?'}, {'role': 'user', 'content': "As an AI, I don't have personal experiences or preferences, but I can provide information about apple pie or Pi (the mathematical constant). How can I assist you further?"}, {'role': 'user', 'content': "Sure, I'd be happy to help you with your question about Pi. Could you please provide me with the details of the problem you're trying to solve?"}, {'role': 'user', 'content': "Sure, I'd be happy to help you with your math problem. Could you please provide me with the details of the problem you're trying to solve?"}, {'role': 'user', 'content': "I'm sorry, but as an AI, I don't have the ability to access personal data about individuals unless it has been shared with me in the course of our conversation. I am designed to respect user privacy and confidentiality."}, {'role': 'user', 'content': "what's my name?"}, {'role': 'user', 'content': 'Based on our previous interactions, you were looking to test the private channel. Do you need assistance with this or is there something else you need help with?'}, {'role': 'user', 'content': 'what do I need help with again'}, {'role': 'user', 'content': "As an artificial intelligence, I don't eat food. But I can certainly provide you with a great recipe for apple pie if you'd like!"}, {'role': 'user', 'content': 'not the kind of pi you eat but I love apple pie, you?'}, {'role': 'user', 'content': "Pi is a mathematical constant that represents the ratio of a circle's circumference to its diameter. It's approximately 3.14159, but it's an irrational number, meaning it goes on indefinitely without repeating. How can I assist you further with Pi?"}, {'role': 'user', 'content': "It's about pi"}, {'role': 'user', 'content': "Of course, I'd be happy to help with your math problem. Could you please tell me what the problem is?"}, {'role': 'user', 'content': 'I need help figuring out a math problem'}, {'role': 'user', 'content': 'Nice to meet you, Steve. How can I assist you today?'}, {'role': 'user', 'content': "I'm steve"}, {'role': 'user', 'content': "I'm an artificial intelligence and don't have an account executive. However, I'm here to assist you. How can I help you further?"}, {'role': 'user', 'content': "what's your ae"}, {'role': 'user', 'content': "I'm glad to hear that! If you have any other questions or need further assistance with the private channel, feel free to ask."}, {'role': 'user', 'content': 'great'}, {'role': 'user', 'content': "I'm here and ready to assist. How may I help you with the test?"}, {'role': 'user', 'content': 'test'}, {'role': 'user', 'content': "I'm here and ready to assist. How can we test the private channel according to your needs?"}, {'role': 'user', 'content': 'Hello! How can I assist you with the private channel?'}, {'role': 'user', 'content': 'test'}, {'role': 'user', 'content': 'test private channel'}, {'role': 'user', 'content': 'hello?'}], 'model': 'gpt-4', 'max_tokens': 300, 'temperature': 0.7}}
2025-01-05 18:36:12,865 [DEBUG] httpcore.connection: connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2025-01-05 18:36:12,985 [DEBUG] httpcore.connection: connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x1203b70e0>
2025-01-05 18:36:12,985 [DEBUG] httpcore.connection: start_tls.started ssl_context=<ssl.SSLContext object at 0x107769640> server_hostname='api.openai.com' timeout=5.0
2025-01-05 18:36:13,031 [DEBUG] httpcore.connection: start_tls.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x12025f750>
2025-01-05 18:36:13,031 [DEBUG] httpcore.http11: send_request_headers.started request=<Request [b'POST']>
2025-01-05 18:36:13,031 [DEBUG] httpcore.http11: send_request_headers.complete
2025-01-05 18:36:13,032 [DEBUG] httpcore.http11: send_request_body.started request=<Request [b'POST']>
2025-01-05 18:36:13,032 [DEBUG] httpcore.http11: send_request_body.complete
2025-01-05 18:36:13,032 [DEBUG] httpcore.http11: receive_response_headers.started request=<Request [b'POST']>
2025-01-05 18:36:14,069 [DEBUG] httpcore.http11: receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Sun, 05 Jan 2025 23:36:13 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-yzbp3micnvwwjimbcblinra3'), (b'openai-processing-ms', b'670'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'5000'), (b'x-ratelimit-limit-tokens', b'80000'), (b'x-ratelimit-remaining-requests', b'4999'), (b'x-ratelimit-remaining-tokens', b'78734'), (b'x-ratelimit-reset-requests', b'12ms'), (b'x-ratelimit-reset-tokens', b'949ms'), (b'x-request-id', b'req_176539ff181ffa29b8dfb9eb02d4b750'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=3xmP_wMuZ.gAgg6hWTaKy_7DTi1e3Ya.vHFb1UE_orc-1736120173-1.0.1.1-yYpkwBOEPDNgFA.RBuDC7Vj0bPR5BG3cRiQXkI6QcE6gclebQL4.trtu3lFMvgXU7a0vHvBTv9mxh10gz15Ecw; path=/; expires=Mon, 06-Jan-25 00:06:13 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=31YIgSuIREdrCSHRp6CFegMruTo16uCEs1f4vqYjUdY-1736120173916-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8fd74a0a5f800fa8-EWR'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2025-01-05 18:36:14,072 [INFO] httpx: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-05 18:36:14,072 [DEBUG] httpcore.http11: receive_response_body.started request=<Request [b'POST']>
2025-01-05 18:36:14,073 [DEBUG] httpcore.http11: receive_response_body.complete
2025-01-05 18:36:14,073 [DEBUG] httpcore.http11: response_closed.started
2025-01-05 18:36:14,073 [DEBUG] httpcore.http11: response_closed.complete
2025-01-05 18:36:14,074 [DEBUG] openai._base_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "200 OK"
2025-01-05 18:36:14,081 [INFO] src.luna_functions: GPT response: Hello! How can I assist you today?
2025-01-05 18:36:14,129 [INFO] nio.rooms: Room !byRaIjLPSRhKcNeUTu:localhost handling event of type RoomMessageText
2025-01-05 18:36:14,129 [DEBUG] src.luna_functions: Ignoring my own message.
2025-01-05 18:37:29,917 [INFO] src.console_functions: Console received 'fetch_all' command. Blocking until done...
2025-01-05 18:37:29,918 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 18:37:29,918 [INFO] src.luna_functions: No room_ids specified. Using all joined rooms: ['!PmOiRDooqweqMsXyTN:localhost', '!byRaIjLPSRhKcNeUTu:localhost']
2025-01-05 18:37:29,918 [INFO] src.luna_functions: Fetching *all* messages for room: !PmOiRDooqweqMsXyTN:localhost
2025-01-05 18:37:29,961 [DEBUG] src.luna_functions: Fetched 70 messages this page for room=!PmOiRDooqweqMsXyTN:localhost, new end=t1-1_0_0_0_0_0_0_0_0_0
2025-01-05 18:37:30,231 [INFO] src.luna_functions: No more chunk for !PmOiRDooqweqMsXyTN:localhost, done paging.
2025-01-05 18:37:30,232 [INFO] src.luna_functions: Fetching *all* messages for room: !byRaIjLPSRhKcNeUTu:localhost
2025-01-05 18:37:30,255 [DEBUG] src.luna_functions: Fetched 44 messages this page for room=!byRaIjLPSRhKcNeUTu:localhost, new end=t1-12_0_0_0_0_0_0_0_0_0
2025-01-05 18:37:30,527 [INFO] src.luna_functions: No more chunk for !byRaIjLPSRhKcNeUTu:localhost, done paging.
2025-01-05 18:37:30,535 [INFO] src.luna_functions: Fetched total 96 messages across 2 room(s).
2025-01-05 18:37:30,543 [INFO] src.luna_functions: Wrote all records to new CSV luna_messages.csv.
2025-01-05 18:38:59,676 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-05 18:38:59,679 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-05 18:38:59,882 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-05 18:39:00,286 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-05 18:39:01,091 [WARNING] nio.client.async_client: Timed out, sleeping for 1s
2025-01-05 18:39:02,697 [WARNING] nio.client.async_client: Timed out, sleeping for 3s
2025-01-05 18:39:05,900 [WARNING] nio.client.async_client: Timed out, sleeping for 6s
2025-01-05 18:39:08,697 [INFO] src.console_functions: Console screen cleared.
2025-01-05 18:39:08,697 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 18:39:12,308 [WARNING] nio.client.async_client: Timed out, sleeping for 12s
2025-01-05 18:39:15,157 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 18:39:25,115 [WARNING] nio.client.async_client: Timed out, sleeping for 25s
2025-01-05 18:39:43,838 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 18:46:03,237 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-05 18:46:03,238 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-05 18:46:03,450 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-05 18:46:03,854 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-05 18:46:04,661 [WARNING] nio.client.async_client: Timed out, sleeping for 1s
2025-01-05 18:46:06,265 [WARNING] nio.client.async_client: Timed out, sleeping for 3s
2025-01-05 18:46:09,472 [WARNING] nio.client.async_client: Timed out, sleeping for 6s
2025-01-05 18:46:15,878 [WARNING] nio.client.async_client: Timed out, sleeping for 12s
2025-01-05 18:46:28,685 [WARNING] nio.client.async_client: Timed out, sleeping for 25s
2025-01-05 18:46:54,291 [WARNING] nio.client.async_client: Timed out, sleeping for 51s
2025-01-05 18:47:45,495 [WARNING] nio.client.async_client: Timed out, sleeping for 60s
2025-01-05 18:48:45,502 [WARNING] nio.client.async_client: Timed out, sleeping for 60s
2025-01-05 18:49:45,509 [WARNING] nio.client.async_client: Timed out, sleeping for 60s
2025-01-05 18:50:45,516 [WARNING] nio.client.async_client: Timed out, sleeping for 60s
2025-01-05 18:51:45,520 [WARNING] nio.client.async_client: Timed out, sleeping for 60s
2025-01-05 18:52:45,539 [WARNING] nio.client.async_client: Timed out, sleeping for 60s
2025-01-05 18:53:45,545 [WARNING] nio.client.async_client: Timed out, sleeping for 60s
2025-01-05 18:54:45,553 [WARNING] nio.client.async_client: Timed out, sleeping for 60s
2025-01-05 18:55:45,559 [WARNING] nio.client.async_client: Timed out, sleeping for 60s
2025-01-05 18:56:45,566 [WARNING] nio.client.async_client: Timed out, sleeping for 60s
2025-01-05 18:57:45,578 [WARNING] nio.client.async_client: Timed out, sleeping for 60s
2025-01-05 18:58:45,586 [WARNING] nio.client.async_client: Timed out, sleeping for 60s
2025-01-05 18:59:45,593 [WARNING] nio.client.async_client: Timed out, sleeping for 60s
2025-01-05 19:00:45,600 [WARNING] nio.client.async_client: Timed out, sleeping for 60s
2025-01-05 19:01:45,606 [WARNING] nio.client.async_client: Timed out, sleeping for 60s
2025-01-05 19:02:18,571 [INFO] src.console_apparatus: User exited the console (EOF or KeyboardInterrupt).
2025-01-05 19:02:25,270 [WARNING] __main__: KeyboardInterrupt received. Shutting down Director.
2025-01-05 19:02:25,270 [DEBUG] __main__: Preparing to close the event loop.
2025-01-05 19:02:25,271 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-05 19:02:25,327 [ERROR] asyncio: Task was destroyed but it is pending!
task: <Task pending name='Task-193016' coro=<AsyncClient.sync() running at /Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/base_client.py:116> wait_for=<Future pending cb=[Task.task_wakeup()]> cb=[_AsCompletedIterator._handle_completion()]>
2025-01-05 19:02:25,362 [ERROR] asyncio: Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x120344590>
2025-01-05 19:02:29,619 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-05 19:02:29,619 [DEBUG] __main__: Exiting configure_logging function.
2025-01-05 19:02:29,619 [DEBUG] __main__: Logging configuration complete.
2025-01-05 19:02:29,619 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-05 19:02:29,619 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 19:02:29,619 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-05 19:02:29,619 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-05 19:02:29,620 [DEBUG] __main__: Entering start_console_thread function.
2025-01-05 19:02:29,622 [INFO] __main__: Console thread started successfully.
2025-01-05 19:02:29,622 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-05 19:02:29,622 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-05 19:02:29,622 [INFO] __main__: Starting main_logic coroutine.
2025-01-05 19:02:29,624 [DEBUG] __main__: Entering main_logic function...
2025-01-05 19:02:29,624 [DEBUG] __main__: Attempting to load or log in the client.
2025-01-05 19:02:29,626 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 19:02:29,725 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-05 19:02:29,725 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-05 19:02:29,726 [INFO] src.luna_functions: Using saved token for user @luna:localhost.
2025-01-05 19:02:29,726 [DEBUG] __main__: Client obtained. Storing reference to DIRECTOR_CLIENT in src.luna_functions.
2025-01-05 19:02:29,726 [DEBUG] __main__: Callbacks registered successfully.
2025-01-05 19:02:29,726 [DEBUG] __main__: Starting sync_forever loop. Awaiting new events with timeout=30000.
2025-01-05 19:02:29,731 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-05 19:02:29,731 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-05 19:02:29,936 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-05 19:02:30,339 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-05 19:02:31,143 [WARNING] nio.client.async_client: Timed out, sleeping for 1s
2025-01-05 19:02:32,746 [WARNING] nio.client.async_client: Timed out, sleeping for 3s
2025-01-05 19:02:35,951 [WARNING] nio.client.async_client: Timed out, sleeping for 6s
2025-01-05 19:02:42,357 [WARNING] nio.client.async_client: Timed out, sleeping for 12s
2025-01-05 19:03:41,044 [WARNING] nio.client.async_client: Timed out, sleeping for 25s
2025-01-05 19:04:06,652 [WARNING] nio.client.async_client: Timed out, sleeping for 51s
2025-01-05 19:08:06,197 [WARNING] nio.client.async_client: Timed out, sleeping for 60s
2025-01-05 19:12:44,569 [WARNING] nio.client.async_client: Timed out, sleeping for 60s
2025-01-05 19:13:46,728 [WARNING] nio.client.async_client: Timed out, sleeping for 60s
2025-01-05 19:18:56,982 [WARNING] nio.client.async_client: Timed out, sleeping for 60s
2025-01-05 19:20:02,269 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-05 19:20:02,271 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-05 19:20:02,475 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-05 19:20:02,882 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-05 19:20:03,686 [WARNING] nio.client.async_client: Timed out, sleeping for 1s
2025-01-05 19:20:05,290 [WARNING] nio.client.async_client: Timed out, sleeping for 3s
2025-01-05 19:20:08,498 [WARNING] nio.client.async_client: Timed out, sleeping for 6s
2025-01-05 19:20:14,071 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 19:20:14,903 [WARNING] nio.client.async_client: Timed out, sleeping for 12s
2025-01-05 19:20:27,715 [WARNING] nio.client.async_client: Timed out, sleeping for 25s
2025-01-05 19:20:53,318 [WARNING] nio.client.async_client: Timed out, sleeping for 51s
2025-01-05 19:21:44,527 [WARNING] nio.client.async_client: Timed out, sleeping for 60s
2025-01-05 19:22:36,149 [INFO] src.console_apparatus: User exited the console (EOF or KeyboardInterrupt).
2025-01-05 19:22:39,756 [WARNING] __main__: KeyboardInterrupt received. Shutting down Director.
2025-01-05 19:22:39,756 [DEBUG] __main__: Preparing to close the event loop.
2025-01-05 19:22:39,757 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-05 19:22:39,802 [ERROR] asyncio: Task was destroyed but it is pending!
task: <Task pending name='Task-4671' coro=<AsyncClient.sync() running at /Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/base_client.py:116> wait_for=<Future pending cb=[Task.task_wakeup()]> cb=[_AsCompletedIterator._handle_completion()]>
2025-01-05 19:22:39,840 [ERROR] asyncio: Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x1145106e0>
2025-01-05 19:22:42,193 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-05 19:22:42,194 [DEBUG] __main__: Exiting configure_logging function.
2025-01-05 19:22:42,194 [DEBUG] __main__: Logging configuration complete.
2025-01-05 19:22:42,194 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-05 19:22:42,194 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 19:22:42,194 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-05 19:22:42,194 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-05 19:22:42,194 [DEBUG] __main__: Entering start_console_thread function.
2025-01-05 19:22:42,196 [INFO] __main__: Console thread started successfully.
2025-01-05 19:22:42,196 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-05 19:22:42,196 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-05 19:22:42,196 [INFO] __main__: Starting main_logic coroutine.
2025-01-05 19:22:42,196 [DEBUG] __main__: Entering main_logic function...
2025-01-05 19:22:42,198 [DEBUG] __main__: Attempting to load or log in the client.
2025-01-05 19:22:42,201 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 19:22:42,300 [DEBUG] src.luna_functions: No valid token found, attempting normal password login.
2025-01-05 19:22:42,305 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-05 19:22:42,306 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-05 19:22:42,519 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-05 19:22:42,924 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-05 19:22:43,729 [WARNING] nio.client.async_client: Timed out, sleeping for 1s
2025-01-05 19:22:45,334 [WARNING] nio.client.async_client: Timed out, sleeping for 3s
2025-01-05 19:22:48,540 [WARNING] nio.client.async_client: Timed out, sleeping for 6s
2025-01-05 19:22:54,944 [WARNING] nio.client.async_client: Timed out, sleeping for 12s
2025-01-05 19:23:07,764 [ERROR] src.luna_functions: Failed to log in: LoginError: M_FORBIDDEN Invalid username or password
2025-01-05 19:23:07,764 [DEBUG] src.luna_functions: Closing client due to login failure.
2025-01-05 19:23:07,765 [DEBUG] __main__: Preparing to close the event loop.
2025-01-05 19:23:07,765 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-05 19:23:29,936 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-05 19:23:29,936 [DEBUG] __main__: Exiting configure_logging function.
2025-01-05 19:23:29,936 [DEBUG] __main__: Logging configuration complete.
2025-01-05 19:23:29,937 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-05 19:23:29,937 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 19:23:29,937 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-05 19:23:29,937 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-05 19:23:29,937 [DEBUG] __main__: Entering start_console_thread function.
2025-01-05 19:23:29,939 [INFO] __main__: Console thread started successfully.
2025-01-05 19:23:29,939 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-05 19:23:29,939 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-05 19:23:29,939 [INFO] __main__: Starting main_logic coroutine.
2025-01-05 19:23:29,941 [DEBUG] __main__: Entering main_logic function...
2025-01-05 19:23:29,941 [DEBUG] __main__: Attempting to load or log in the client.
2025-01-05 19:23:29,943 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 19:23:30,042 [DEBUG] src.luna_functions: No valid token found, attempting normal password login.
2025-01-05 19:23:30,054 [ERROR] src.luna_functions: Failed to log in: LoginError: M_FORBIDDEN Invalid username or password
2025-01-05 19:23:30,054 [DEBUG] src.luna_functions: Closing client due to login failure.
2025-01-05 19:23:30,054 [DEBUG] __main__: Preparing to close the event loop.
2025-01-05 19:23:30,054 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-05 19:23:36,646 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-05 19:23:36,646 [DEBUG] __main__: Exiting configure_logging function.
2025-01-05 19:23:36,646 [DEBUG] __main__: Logging configuration complete.
2025-01-05 19:23:36,646 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-05 19:23:36,646 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 19:23:36,646 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-05 19:23:36,646 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-05 19:23:36,646 [DEBUG] __main__: Entering start_console_thread function.
2025-01-05 19:23:36,649 [INFO] __main__: Console thread started successfully.
2025-01-05 19:23:36,649 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-05 19:23:36,649 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-05 19:23:36,651 [INFO] __main__: Starting main_logic coroutine.
2025-01-05 19:23:36,651 [DEBUG] __main__: Entering main_logic function...
2025-01-05 19:23:36,651 [DEBUG] __main__: Attempting to load or log in the client.
2025-01-05 19:23:36,653 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 19:23:36,752 [DEBUG] src.luna_functions: No valid token found, attempting normal password login.
2025-01-05 19:23:36,765 [ERROR] src.luna_functions: Failed to log in: LoginError: M_FORBIDDEN Invalid username or password
2025-01-05 19:23:36,765 [DEBUG] src.luna_functions: Closing client due to login failure.
2025-01-05 19:23:36,765 [DEBUG] __main__: Preparing to close the event loop.
2025-01-05 19:23:36,765 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-05 19:23:38,917 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-05 19:23:38,917 [DEBUG] __main__: Exiting configure_logging function.
2025-01-05 19:23:38,917 [DEBUG] __main__: Logging configuration complete.
2025-01-05 19:23:38,917 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-05 19:23:38,917 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 19:23:38,918 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-05 19:23:38,918 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-05 19:23:38,918 [DEBUG] __main__: Entering start_console_thread function.
2025-01-05 19:23:38,920 [INFO] __main__: Console thread started successfully.
2025-01-05 19:23:38,920 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-05 19:23:38,920 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-05 19:23:38,920 [INFO] __main__: Starting main_logic coroutine.
2025-01-05 19:23:38,922 [DEBUG] __main__: Entering main_logic function...
2025-01-05 19:23:38,922 [DEBUG] __main__: Attempting to load or log in the client.
2025-01-05 19:23:38,924 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 19:23:39,023 [DEBUG] src.luna_functions: No valid token found, attempting normal password login.
2025-01-05 19:23:39,033 [ERROR] src.luna_functions: Failed to log in: LoginError: M_FORBIDDEN Invalid username or password
2025-01-05 19:23:39,033 [DEBUG] src.luna_functions: Closing client due to login failure.
2025-01-05 19:23:39,034 [DEBUG] __main__: Preparing to close the event loop.
2025-01-05 19:23:39,034 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-05 19:23:40,459 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-05 19:23:40,460 [DEBUG] __main__: Exiting configure_logging function.
2025-01-05 19:23:40,460 [DEBUG] __main__: Logging configuration complete.
2025-01-05 19:23:40,460 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-05 19:23:40,460 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 19:23:40,460 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-05 19:23:40,460 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-05 19:23:40,460 [DEBUG] __main__: Entering start_console_thread function.
2025-01-05 19:23:40,462 [INFO] __main__: Console thread started successfully.
2025-01-05 19:23:40,462 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-05 19:23:40,462 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-05 19:23:40,462 [INFO] __main__: Starting main_logic coroutine.
2025-01-05 19:23:40,463 [DEBUG] __main__: Entering main_logic function...
2025-01-05 19:23:40,463 [DEBUG] __main__: Attempting to load or log in the client.
2025-01-05 19:23:40,467 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 19:23:40,564 [DEBUG] src.luna_functions: No valid token found, attempting normal password login.
2025-01-05 19:23:40,571 [ERROR] src.luna_functions: Failed to log in: LoginError: M_FORBIDDEN Invalid username or password
2025-01-05 19:23:40,571 [DEBUG] src.luna_functions: Closing client due to login failure.
2025-01-05 19:23:40,571 [DEBUG] __main__: Preparing to close the event loop.
2025-01-05 19:23:40,572 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-05 19:23:42,193 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-05 19:23:42,193 [DEBUG] __main__: Exiting configure_logging function.
2025-01-05 19:23:42,193 [DEBUG] __main__: Logging configuration complete.
2025-01-05 19:23:42,193 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-05 19:23:42,193 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 19:23:42,193 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-05 19:23:42,193 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-05 19:23:42,193 [DEBUG] __main__: Entering start_console_thread function.
2025-01-05 19:23:42,195 [INFO] __main__: Console thread started successfully.
2025-01-05 19:23:42,195 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-05 19:23:42,195 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-05 19:23:42,195 [INFO] __main__: Starting main_logic coroutine.
2025-01-05 19:23:42,197 [DEBUG] __main__: Entering main_logic function...
2025-01-05 19:23:42,197 [DEBUG] __main__: Attempting to load or log in the client.
2025-01-05 19:23:42,199 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 19:23:42,299 [DEBUG] src.luna_functions: No valid token found, attempting normal password login.
2025-01-05 19:23:42,816 [WARNING] nio.client.async_client: Got 429 response (ratelimited), sleeping for 339ms
2025-01-05 19:23:43,162 [ERROR] src.luna_functions: Failed to log in: LoginError: M_FORBIDDEN Invalid username or password
2025-01-05 19:23:43,162 [DEBUG] src.luna_functions: Closing client due to login failure.
2025-01-05 19:23:43,162 [DEBUG] __main__: Preparing to close the event loop.
2025-01-05 19:23:43,162 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-05 19:23:47,026 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-05 19:23:47,026 [DEBUG] __main__: Exiting configure_logging function.
2025-01-05 19:23:47,026 [DEBUG] __main__: Logging configuration complete.
2025-01-05 19:23:47,026 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-05 19:23:47,026 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 19:23:47,027 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-05 19:23:47,027 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-05 19:23:47,027 [DEBUG] __main__: Entering start_console_thread function.
2025-01-05 19:23:47,029 [INFO] __main__: Console thread started successfully.
2025-01-05 19:23:47,031 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-05 19:23:47,031 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-05 19:23:47,031 [INFO] __main__: Starting main_logic coroutine.
2025-01-05 19:23:47,031 [DEBUG] __main__: Entering main_logic function...
2025-01-05 19:23:47,032 [DEBUG] __main__: Attempting to load or log in the client.
2025-01-05 19:23:47,034 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 19:23:47,133 [DEBUG] src.luna_functions: No valid token found, attempting normal password login.
2025-01-05 19:23:47,646 [WARNING] nio.client.async_client: Got 429 response (ratelimited), sleeping for 1389ms
2025-01-05 19:23:49,046 [ERROR] src.luna_functions: Failed to log in: LoginError: M_FORBIDDEN Invalid username or password
2025-01-05 19:23:49,046 [DEBUG] src.luna_functions: Closing client due to login failure.
2025-01-05 19:23:49,046 [DEBUG] __main__: Preparing to close the event loop.
2025-01-05 19:23:49,047 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-05 19:26:14,333 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-05 19:26:14,333 [DEBUG] __main__: Exiting configure_logging function.
2025-01-05 19:26:14,333 [DEBUG] __main__: Logging configuration complete.
2025-01-05 19:26:14,333 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-05 19:26:14,333 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 19:26:14,333 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-05 19:26:14,333 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-05 19:26:14,333 [DEBUG] __main__: Entering start_console_thread function.
2025-01-05 19:26:14,335 [INFO] __main__: Console thread started successfully.
2025-01-05 19:26:14,335 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-05 19:26:14,337 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-05 19:26:14,337 [INFO] __main__: Starting main_logic coroutine.
2025-01-05 19:26:14,337 [DEBUG] __main__: Entering main_logic function...
2025-01-05 19:26:14,337 [DEBUG] __main__: Attempting to load or log in the client.
2025-01-05 19:26:14,339 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 19:26:14,438 [DEBUG] src.luna_functions: No valid token found, attempting normal password login.
2025-01-05 19:26:14,721 [INFO] src.luna_functions: Password login succeeded, storing token.
2025-01-05 19:26:14,723 [DEBUG] src.luna_functions: Token info for @lunabot:localhost saved to director_token.json.
2025-01-05 19:26:14,723 [DEBUG] __main__: Client obtained. Storing reference to DIRECTOR_CLIENT in src.luna_functions.
2025-01-05 19:26:14,723 [DEBUG] __main__: Callbacks registered successfully.
2025-01-05 19:26:14,723 [DEBUG] __main__: Starting sync_forever loop. Awaiting new events with timeout=30000.
2025-01-05 19:26:18,373 [DEBUG] src.console_functions: Showing help to user.
2025-01-05 19:26:18,374 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 20:23:18,264 [INFO] src.console_functions: Console received 'restart' command; restarting now.
2025-01-05 20:23:19,261 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-05 20:23:19,261 [DEBUG] __main__: Exiting configure_logging function.
2025-01-05 20:23:19,261 [DEBUG] __main__: Logging configuration complete.
2025-01-05 20:23:19,261 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-05 20:23:19,262 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 20:23:19,262 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-05 20:23:19,262 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-05 20:23:19,262 [DEBUG] __main__: Entering start_console_thread function.
2025-01-05 20:23:19,264 [INFO] __main__: Console thread started successfully.
2025-01-05 20:23:19,264 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-05 20:23:19,265 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-05 20:23:19,265 [INFO] __main__: Starting main_logic coroutine.
2025-01-05 20:23:19,265 [DEBUG] __main__: Entering main_logic function...
2025-01-05 20:23:19,267 [DEBUG] __main__: Attempting to load or log in the client.
2025-01-05 20:23:19,270 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 20:23:19,368 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-05 20:23:19,368 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-05 20:23:19,368 [INFO] src.luna_functions: Using saved token for user @lunabot:localhost.
2025-01-05 20:23:19,368 [DEBUG] __main__: Client obtained. Storing reference to DIRECTOR_CLIENT in src.luna_functions.
2025-01-05 20:23:19,369 [DEBUG] __main__: Callbacks registered successfully.
2025-01-05 20:23:19,369 [DEBUG] __main__: Starting sync_forever loop. Awaiting new events with timeout=30000.
2025-01-05 20:23:20,623 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 20:23:29,491 [DEBUG] src.console_functions: Showing help to user.
2025-01-05 20:23:29,492 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 20:26:32,756 [INFO] src.console_apparatus: User exited the console (EOF or KeyboardInterrupt).
2025-01-05 20:27:33,578 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-05 20:27:33,578 [DEBUG] __main__: Exiting configure_logging function.
2025-01-05 20:27:33,579 [DEBUG] __main__: Logging configuration complete.
2025-01-05 20:27:33,579 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-05 20:27:33,579 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 20:27:33,579 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-05 20:27:33,579 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-05 20:27:33,579 [DEBUG] __main__: Entering start_console_thread function.
2025-01-05 20:27:33,581 [INFO] __main__: Console thread started successfully.
2025-01-05 20:27:33,581 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-05 20:27:33,581 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-05 20:27:33,581 [INFO] __main__: Starting main_logic coroutine.
2025-01-05 20:27:33,581 [DEBUG] __main__: Entering main_logic function...
2025-01-05 20:27:33,583 [DEBUG] __main__: Attempting to load or log in the client.
2025-01-05 20:27:33,585 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 20:27:33,684 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-05 20:27:33,685 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-05 20:27:33,685 [INFO] src.luna_functions: Using saved token for user @lunabot:localhost.
2025-01-05 20:27:33,685 [DEBUG] __main__: Client obtained. Storing reference to DIRECTOR_CLIENT in src.luna_functions.
2025-01-05 20:27:33,685 [DEBUG] __main__: Callbacks registered successfully.
2025-01-05 20:27:33,685 [DEBUG] __main__: Starting sync_forever loop. Awaiting new events with timeout=30000.
2025-01-05 20:27:37,141 [INFO] src.console_functions: Console screen cleared.
2025-01-05 20:27:37,141 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 20:27:38,429 [DEBUG] src.console_functions: Showing help to user.
2025-01-05 20:27:38,431 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 20:28:09,763 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 20:28:09,763 [DEBUG] src.luna_functions: Attempting to add user: steveo with admin=False
2025-01-05 20:28:09,764 [ERROR] src.luna_functions: Exception while creating user @steveo:localhost: 'AsyncClient' object has no attribute 'api'
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/src/luna_functions.py", line 124, in add_user
    response = await client.api.request(
                     ^^^^^^^^^^
AttributeError: 'AsyncClient' object has no attribute 'api'
2025-01-05 20:29:52,708 [INFO] src.console_functions: Console received 'restart' command; restarting now.
2025-01-05 20:29:53,583 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-05 20:29:53,583 [DEBUG] __main__: Exiting configure_logging function.
2025-01-05 20:29:53,583 [DEBUG] __main__: Logging configuration complete.
2025-01-05 20:29:53,583 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-05 20:29:53,583 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 20:29:53,584 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-05 20:29:53,584 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-05 20:29:53,584 [DEBUG] __main__: Entering start_console_thread function.
2025-01-05 20:29:53,586 [INFO] __main__: Console thread started successfully.
2025-01-05 20:29:53,586 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-05 20:29:53,586 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-05 20:29:53,586 [INFO] __main__: Starting main_logic coroutine.
2025-01-05 20:29:53,588 [DEBUG] __main__: Entering main_logic function...
2025-01-05 20:29:53,588 [DEBUG] __main__: Attempting to load or log in the client.
2025-01-05 20:29:53,590 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 20:29:53,689 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-05 20:29:53,689 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-05 20:29:53,689 [INFO] src.luna_functions: Using saved token for user @lunabot:localhost.
2025-01-05 20:29:53,689 [DEBUG] __main__: Client obtained. Storing reference to DIRECTOR_CLIENT in src.luna_functions.
2025-01-05 20:29:53,689 [DEBUG] __main__: Callbacks registered successfully.
2025-01-05 20:29:53,689 [DEBUG] __main__: Starting sync_forever loop. Awaiting new events with timeout=30000.
2025-01-05 20:30:01,995 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 20:30:01,996 [INFO] src.luna_functions: Attempting to create user @evan:localhost, admin=False
2025-01-05 20:30:01,996 [ERROR] src.console_functions: Error adding user.
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/src/luna_functions.py", line 120, in add_user
    async with client.session.request(
               ^^^^^^^^^^^^^^
AttributeError: 'AsyncClient' object has no attribute 'session'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/src/console_functions.py", line 588, in on_done
    result = fut.result()
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/Users/evanrobinson/Documents/Luna2/luna/src/luna_functions.py", line 137, in add_user
    except aiohttp.ClientError as e:
           ^^^^^^^
NameError: name 'aiohttp' is not defined
2025-01-05 20:35:08,655 [INFO] src.console_apparatus: User exited the console (EOF or KeyboardInterrupt).
2025-01-05 20:37:01,270 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-05 20:37:01,270 [DEBUG] __main__: Exiting configure_logging function.
2025-01-05 20:37:01,270 [DEBUG] __main__: Logging configuration complete.
2025-01-05 20:37:01,270 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-05 20:37:01,271 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 20:37:01,271 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-05 20:37:01,271 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-05 20:37:01,271 [DEBUG] __main__: Entering start_console_thread function.
2025-01-05 20:37:01,273 [INFO] __main__: Console thread started successfully.
2025-01-05 20:37:01,273 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-05 20:37:01,273 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-05 20:37:01,273 [INFO] __main__: Starting main_logic coroutine.
2025-01-05 20:37:01,275 [DEBUG] __main__: Entering main_logic function...
2025-01-05 20:37:01,275 [DEBUG] __main__: Attempting to load or log in the client.
2025-01-05 20:37:01,278 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 20:37:01,376 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-05 20:37:01,378 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-05 20:37:01,378 [INFO] src.luna_functions: Using saved token for user @lunabot:localhost.
2025-01-05 20:37:01,378 [DEBUG] __main__: Client obtained. Storing reference to DIRECTOR_CLIENT in src.luna_functions.
2025-01-05 20:37:01,378 [DEBUG] __main__: Callbacks registered successfully.
2025-01-05 20:37:01,378 [DEBUG] __main__: Starting sync_forever loop. Awaiting new events with timeout=30000.
2025-01-05 20:37:04,044 [INFO] src.console_functions: Console screen cleared.
2025-01-05 20:37:04,044 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 20:37:09,016 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 20:37:09,017 [INFO] src.luna_functions: Creating user @evan:localhost, admin=False via http://localhost:8008/_synapse/admin/v2/users/@evan:localhost
2025-01-05 20:37:09,034 [ERROR] src.luna_functions: Error creating user @evan:localhost: 401 => {"errcode":"M_UNKNOWN_TOKEN","error":"Invalid access token passed.","soft_logout":false}
2025-01-05 20:40:54,339 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 20:40:55,917 [INFO] src.console_functions: Console received 'restart' command; restarting now.
2025-01-05 20:41:07,509 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-05 20:41:07,509 [DEBUG] __main__: Exiting configure_logging function.
2025-01-05 20:41:07,509 [DEBUG] __main__: Logging configuration complete.
2025-01-05 20:41:07,509 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-05 20:41:07,509 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 20:41:07,509 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-05 20:41:07,509 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-05 20:41:07,509 [DEBUG] __main__: Entering start_console_thread function.
2025-01-05 20:41:07,511 [INFO] __main__: Console thread started successfully.
2025-01-05 20:41:07,512 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-05 20:41:07,512 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-05 20:41:07,512 [INFO] __main__: Starting main_logic coroutine.
2025-01-05 20:41:07,512 [DEBUG] __main__: Entering main_logic function...
2025-01-05 20:41:07,512 [DEBUG] __main__: Attempting to load or log in the client.
2025-01-05 20:41:07,516 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 20:41:07,615 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-05 20:41:07,616 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-05 20:41:07,616 [INFO] src.luna_functions: Using saved token for user @lunabot:localhost.
2025-01-05 20:41:07,616 [DEBUG] __main__: Client obtained. Storing reference to DIRECTOR_CLIENT in src.luna_functions.
2025-01-05 20:41:07,616 [DEBUG] __main__: Callbacks registered successfully.
2025-01-05 20:41:07,616 [DEBUG] __main__: Starting sync_forever loop. Awaiting new events with timeout=30000.
2025-01-05 20:41:16,565 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 20:41:23,844 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 20:41:23,845 [INFO] src.luna_functions: Creating user @evan1:localhost, admin=False via http://localhost:8008/_synapse/admin/v2/users/@evan1:localhost
2025-01-05 20:41:24,115 [INFO] src.luna_functions: Created user @evan1:localhost (HTTP 201)
2025-01-05 21:03:43,912 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 21:03:44,589 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 21:03:45,308 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 21:03:45,902 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 21:03:46,344 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 21:03:47,057 [INFO] src.console_apparatus: User exited the console (EOF or KeyboardInterrupt).
2025-01-05 21:04:29,645 [INFO] nio.client.base_client: New invited room !MWdCMggaXzjGhumvZl:localhost
2025-01-05 21:04:29,646 [INFO] nio.rooms: Room !MWdCMggaXzjGhumvZl:localhost handling event of type InviteMemberEvent
2025-01-05 21:04:29,646 [INFO] src.luna_functions: Received invite to !MWdCMggaXzjGhumvZl:localhost, joining now.
2025-01-05 21:04:29,679 [INFO] nio.rooms: Room !MWdCMggaXzjGhumvZl:localhost handling event of type InviteMemberEvent
2025-01-05 21:04:29,679 [INFO] src.luna_functions: Received invite to !MWdCMggaXzjGhumvZl:localhost, joining now.
2025-01-05 21:04:29,702 [INFO] nio.client.base_client: New joined room !MWdCMggaXzjGhumvZl:localhost
2025-01-05 21:04:29,702 [INFO] nio.rooms: Room !MWdCMggaXzjGhumvZl:localhost handling event of type RoomCreateEvent
2025-01-05 21:04:29,702 [INFO] nio.rooms: Room !MWdCMggaXzjGhumvZl:localhost handling event of type PowerLevelsEvent
2025-01-05 21:04:29,702 [INFO] nio.rooms: Changing power level for user @admin:localhost from 0 to 100
2025-01-05 21:04:29,702 [INFO] nio.rooms: Room !MWdCMggaXzjGhumvZl:localhost handling event of type RoomJoinRulesEvent
2025-01-05 21:04:29,703 [INFO] nio.rooms: Room !MWdCMggaXzjGhumvZl:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-05 21:04:29,703 [INFO] nio.rooms: Room !MWdCMggaXzjGhumvZl:localhost handling event of type RoomGuestAccessEvent
2025-01-05 21:04:30,216 [INFO] nio.rooms: Room !MWdCMggaXzjGhumvZl:localhost handling event of type RoomMessageText
2025-01-05 21:04:30,216 [INFO] src.luna_functions: Fetching last 100 messages from room !MWdCMggaXzjGhumvZl:localhost.
2025-01-05 21:04:30,225 [INFO] src.luna_functions: Fetched 1 messages from room !MWdCMggaXzjGhumvZl:localhost.
2025-01-05 21:04:30,225 [DEBUG] src.luna_functions: Formatted context for GPT: [{'role': 'system', 'content': 'You are a helpful assistant. The provided context array includes messages from an ongoing conversation. Treat this context as fair use and consider it an essential part of the conversation. Your responses should build on this context coherently.'}, {'role': 'user', 'content': 'hello'}, {'role': 'user', 'content': 'hello'}]
2025-01-05 21:04:30,280 [DEBUG] openai._base_client: Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': 'You are a helpful assistant. The provided context array includes messages from an ongoing conversation. Treat this context as fair use and consider it an essential part of the conversation. Your responses should build on this context coherently.'}, {'role': 'user', 'content': 'hello'}, {'role': 'user', 'content': 'hello'}], 'model': 'gpt-4', 'max_tokens': 300, 'temperature': 0.7}}
2025-01-05 21:04:30,287 [DEBUG] httpcore.connection: connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2025-01-05 21:04:30,381 [DEBUG] httpcore.connection: connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10c425e80>
2025-01-05 21:04:30,381 [DEBUG] httpcore.connection: start_tls.started ssl_context=<ssl.SSLContext object at 0x1042c96d0> server_hostname='api.openai.com' timeout=5.0
2025-01-05 21:04:30,418 [DEBUG] httpcore.connection: start_tls.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10c269810>
2025-01-05 21:04:30,418 [DEBUG] httpcore.http11: send_request_headers.started request=<Request [b'POST']>
2025-01-05 21:04:30,419 [DEBUG] httpcore.http11: send_request_headers.complete
2025-01-05 21:04:30,419 [DEBUG] httpcore.http11: send_request_body.started request=<Request [b'POST']>
2025-01-05 21:04:30,419 [DEBUG] httpcore.http11: send_request_body.complete
2025-01-05 21:04:30,419 [DEBUG] httpcore.http11: receive_response_headers.started request=<Request [b'POST']>
2025-01-05 21:04:30,875 [DEBUG] httpcore.http11: receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 06 Jan 2025 02:04:30 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-yzbp3micnvwwjimbcblinra3'), (b'openai-processing-ms', b'371'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'5000'), (b'x-ratelimit-limit-tokens', b'80000'), (b'x-ratelimit-remaining-requests', b'4999'), (b'x-ratelimit-remaining-tokens', b'79633'), (b'x-ratelimit-reset-requests', b'12ms'), (b'x-ratelimit-reset-tokens', b'275ms'), (b'x-request-id', b'req_0f92efc2a169f3694a91010fa40ee38e'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=y507.TfW7138RGZrLZwUM0iGOk.0OGnKKD_IGQJ1BKQ-1736129070-1.0.1.1-8QobPGp5rbK9NW8hAHTBgUbp7eKuFLTxmGUHi5GcrGFt2EGQbWHY1mjEFYxOgxaF6bAVTtKeX4X0GkxACqhBHg; path=/; expires=Mon, 06-Jan-25 02:34:30 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=KdhIRETJiNQxVPAjhZtx1RHuiw5ybSzx9EdIeTZ3wqk-1736129070900-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8fd823426c0f4cc8-BOS'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2025-01-05 21:04:30,878 [INFO] httpx: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-05 21:04:30,878 [DEBUG] httpcore.http11: receive_response_body.started request=<Request [b'POST']>
2025-01-05 21:04:30,878 [DEBUG] httpcore.http11: receive_response_body.complete
2025-01-05 21:04:30,879 [DEBUG] httpcore.http11: response_closed.started
2025-01-05 21:04:30,879 [DEBUG] httpcore.http11: response_closed.complete
2025-01-05 21:04:30,879 [DEBUG] openai._base_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "200 OK"
2025-01-05 21:04:30,886 [INFO] src.luna_functions: GPT response: Hello! How can I assist you today?
2025-01-05 21:04:30,919 [INFO] nio.rooms: Room !MWdCMggaXzjGhumvZl:localhost handling event of type RoomMessageText
2025-01-05 21:04:30,919 [DEBUG] src.luna_functions: Ignoring my own message.
2025-01-05 21:06:07,437 [WARNING] __main__: KeyboardInterrupt received. Shutting down Director.
2025-01-05 21:06:07,438 [DEBUG] __main__: Preparing to close the event loop.
2025-01-05 21:06:07,438 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-05 21:06:07,521 [ERROR] asyncio: Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x10c1e8830>
2025-01-05 21:06:07,521 [ERROR] asyncio: Task was destroyed but it is pending!
task: <Task pending name='Task-589' coro=<AsyncClient.sync() running at /Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/base_client.py:116> wait_for=<Future pending cb=[Task.task_wakeup()]> cb=[_AsCompletedIterator._handle_completion()]>
2025-01-05 21:08:38,711 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-05 21:08:38,712 [DEBUG] __main__: Exiting configure_logging function.
2025-01-05 21:08:38,712 [DEBUG] __main__: Logging configuration complete.
2025-01-05 21:08:38,712 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-05 21:08:38,712 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 21:08:38,712 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-05 21:08:38,712 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-05 21:08:38,712 [DEBUG] __main__: Entering start_console_thread function.
2025-01-05 21:08:38,715 [INFO] __main__: Console thread started successfully.
2025-01-05 21:08:38,715 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-05 21:08:38,715 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-05 21:08:38,715 [INFO] __main__: Starting main_logic coroutine.
2025-01-05 21:08:38,717 [DEBUG] __main__: Entering main_logic function...
2025-01-05 21:08:38,717 [DEBUG] __main__: Attempting to load or log in the client.
2025-01-05 21:08:38,720 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 21:08:38,818 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-05 21:08:38,819 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-05 21:08:38,819 [INFO] src.luna_functions: Using saved token for user @lunabot:localhost.
2025-01-05 21:08:38,819 [DEBUG] __main__: Client obtained. Storing reference to DIRECTOR_CLIENT in src.luna_functions.
2025-01-05 21:08:38,819 [DEBUG] __main__: Callbacks registered successfully.
2025-01-05 21:08:38,819 [DEBUG] __main__: Starting sync_forever loop. Awaiting new events with timeout=30000.
2025-01-05 21:08:38,856 [INFO] nio.client.base_client: New joined room !MWdCMggaXzjGhumvZl:localhost
2025-01-05 21:08:38,856 [INFO] nio.rooms: Room !MWdCMggaXzjGhumvZl:localhost handling event of type RoomCreateEvent
2025-01-05 21:08:38,856 [INFO] nio.rooms: Room !MWdCMggaXzjGhumvZl:localhost handling event of type PowerLevelsEvent
2025-01-05 21:08:38,856 [INFO] nio.rooms: Changing power level for user @admin:localhost from 0 to 100
2025-01-05 21:08:38,856 [INFO] nio.rooms: Room !MWdCMggaXzjGhumvZl:localhost handling event of type RoomJoinRulesEvent
2025-01-05 21:08:38,856 [INFO] nio.rooms: Room !MWdCMggaXzjGhumvZl:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-05 21:08:38,856 [INFO] nio.rooms: Room !MWdCMggaXzjGhumvZl:localhost handling event of type RoomGuestAccessEvent
2025-01-05 21:08:38,857 [INFO] nio.rooms: Room !MWdCMggaXzjGhumvZl:localhost handling event of type RoomMessageText
2025-01-05 21:08:38,857 [INFO] src.luna_functions: Fetching last 100 messages from room !MWdCMggaXzjGhumvZl:localhost.
2025-01-05 21:08:38,861 [INFO] src.luna_functions: Fetched 2 messages from room !MWdCMggaXzjGhumvZl:localhost.
2025-01-05 21:08:38,861 [DEBUG] src.luna_functions: Formatted context for GPT: [{'role': 'system', 'content': 'You are a helpful assistant. The provided context array includes messages from an ongoing conversation. Treat this context as fair use and consider it an essential part of the conversation. Your responses should build on this context coherently.'}, {'role': 'user', 'content': 'Hello! How can I assist you today?'}, {'role': 'user', 'content': 'hello'}, {'role': 'user', 'content': 'hello'}]
2025-01-05 21:08:38,890 [DEBUG] openai._base_client: Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': 'You are a helpful assistant. The provided context array includes messages from an ongoing conversation. Treat this context as fair use and consider it an essential part of the conversation. Your responses should build on this context coherently.'}, {'role': 'user', 'content': 'Hello! How can I assist you today?'}, {'role': 'user', 'content': 'hello'}, {'role': 'user', 'content': 'hello'}], 'model': 'gpt-4', 'max_tokens': 300, 'temperature': 0.7}}
2025-01-05 21:08:38,894 [DEBUG] httpcore.connection: connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2025-01-05 21:08:38,961 [DEBUG] httpcore.connection: connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x1101d7230>
2025-01-05 21:08:38,961 [DEBUG] httpcore.connection: start_tls.started ssl_context=<ssl.SSLContext object at 0x1082396d0> server_hostname='api.openai.com' timeout=5.0
2025-01-05 21:08:38,988 [DEBUG] httpcore.connection: start_tls.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x1101b9e50>
2025-01-05 21:08:38,989 [DEBUG] httpcore.http11: send_request_headers.started request=<Request [b'POST']>
2025-01-05 21:08:38,989 [DEBUG] httpcore.http11: send_request_headers.complete
2025-01-05 21:08:38,989 [DEBUG] httpcore.http11: send_request_body.started request=<Request [b'POST']>
2025-01-05 21:08:38,989 [DEBUG] httpcore.http11: send_request_body.complete
2025-01-05 21:08:38,989 [DEBUG] httpcore.http11: receive_response_headers.started request=<Request [b'POST']>
2025-01-05 21:08:39,980 [DEBUG] httpcore.http11: receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 06 Jan 2025 02:08:40 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-yzbp3micnvwwjimbcblinra3'), (b'openai-processing-ms', b'915'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'5000'), (b'x-ratelimit-limit-tokens', b'80000'), (b'x-ratelimit-remaining-requests', b'4999'), (b'x-ratelimit-remaining-tokens', b'79623'), (b'x-ratelimit-reset-requests', b'12ms'), (b'x-ratelimit-reset-tokens', b'282ms'), (b'x-request-id', b'req_9348d0bd025cbcc280a1ea477d6cee9e'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=nu5mBIRxbd8qAYA2t0vh2ld12wqxwejQ8a8bewuG09U-1736129320-1.0.1.1-cnaspzZRzaZ5Ovmze.IqFju3fDyuVuYwKZtC_UaKEFn42T7CZ3EM.Jo0jYFQBuFpOGFUzXpkdzf0xai3l2baMw; path=/; expires=Mon, 06-Jan-25 02:38:40 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=pm8I.C7qeylFfgZFXNoQmE9DncuZAvyDxokM8tacoqg-1736129320008-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8fd82953f99e8f81-BOS'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2025-01-05 21:08:39,982 [INFO] httpx: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-05 21:08:39,983 [DEBUG] httpcore.http11: receive_response_body.started request=<Request [b'POST']>
2025-01-05 21:08:39,983 [DEBUG] httpcore.http11: receive_response_body.complete
2025-01-05 21:08:39,984 [DEBUG] httpcore.http11: response_closed.started
2025-01-05 21:08:39,984 [DEBUG] httpcore.http11: response_closed.complete
2025-01-05 21:08:39,984 [DEBUG] openai._base_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "200 OK"
2025-01-05 21:08:39,988 [INFO] src.luna_functions: GPT response: Hi there! How can I assist you today?
2025-01-05 21:08:40,010 [INFO] nio.rooms: Room !MWdCMggaXzjGhumvZl:localhost handling event of type RoomMessageText
2025-01-05 21:08:40,010 [DEBUG] src.luna_functions: Ignoring my own message.
2025-01-05 21:08:40,017 [INFO] nio.rooms: Room !MWdCMggaXzjGhumvZl:localhost handling event of type RoomMessageText
2025-01-05 21:08:40,017 [DEBUG] src.luna_functions: Ignoring my own message.
2025-01-05 21:08:41,818 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 21:08:43,614 [INFO] src.console_functions: Console screen cleared.
2025-01-05 21:08:43,614 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 21:30:58,120 [INFO] src.console_functions: Console received 'restart' command; restarting now.
2025-01-05 21:38:49,062 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-05 21:38:49,062 [DEBUG] __main__: Exiting configure_logging function.
2025-01-05 21:38:49,062 [DEBUG] __main__: Logging configuration complete.
2025-01-05 21:38:49,062 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-05 21:38:49,062 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 21:38:49,062 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-05 21:38:49,062 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-05 21:38:49,062 [DEBUG] __main__: Entering start_console_thread function.
2025-01-05 21:38:49,065 [INFO] __main__: Console thread started successfully.
2025-01-05 21:38:49,065 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-05 21:38:49,065 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-05 21:38:49,065 [INFO] __main__: Starting main_logic coroutine.
2025-01-05 21:38:49,067 [DEBUG] __main__: Entering main_logic function...
2025-01-05 21:38:49,067 [DEBUG] __main__: Attempting to load or log in the client.
2025-01-05 21:38:49,070 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 21:38:49,168 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-05 21:38:49,170 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-05 21:38:49,170 [INFO] src.luna_functions: Using saved token for user @lunabot:localhost.
2025-01-05 21:38:49,170 [DEBUG] __main__: Client obtained. Storing reference to DIRECTOR_CLIENT in src.luna_functions.
2025-01-05 21:38:49,170 [DEBUG] __main__: Callbacks registered successfully.
2025-01-05 21:38:49,170 [DEBUG] __main__: Starting sync_forever loop. Awaiting new events with timeout=30000.
2025-01-05 21:38:49,216 [INFO] nio.client.base_client: New joined room !MWdCMggaXzjGhumvZl:localhost
2025-01-05 21:38:49,217 [INFO] nio.rooms: Room !MWdCMggaXzjGhumvZl:localhost handling event of type RoomCreateEvent
2025-01-05 21:38:49,217 [INFO] nio.rooms: Room !MWdCMggaXzjGhumvZl:localhost handling event of type PowerLevelsEvent
2025-01-05 21:38:49,217 [INFO] nio.rooms: Changing power level for user @admin:localhost from 0 to 100
2025-01-05 21:38:49,217 [INFO] nio.rooms: Room !MWdCMggaXzjGhumvZl:localhost handling event of type RoomJoinRulesEvent
2025-01-05 21:38:49,217 [INFO] nio.rooms: Room !MWdCMggaXzjGhumvZl:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-05 21:38:49,217 [INFO] nio.rooms: Room !MWdCMggaXzjGhumvZl:localhost handling event of type RoomGuestAccessEvent
2025-01-05 21:38:49,217 [INFO] nio.rooms: Room !MWdCMggaXzjGhumvZl:localhost handling event of type RoomMessageText
2025-01-05 21:38:49,217 [INFO] src.luna_functions: Fetching last 100 messages from room !MWdCMggaXzjGhumvZl:localhost.
2025-01-05 21:38:49,224 [INFO] src.luna_functions: Fetched 3 messages from room !MWdCMggaXzjGhumvZl:localhost.
2025-01-05 21:38:49,224 [DEBUG] src.luna_functions: Formatted context for GPT: [{'role': 'system', 'content': 'You are a helpful assistant. The provided context array includes messages from an ongoing conversation. Treat this context as fair use and consider it an essential part of the conversation. Your responses should build on this context coherently.'}, {'role': 'user', 'content': 'Hi there! How can I assist you today?'}, {'role': 'user', 'content': 'Hello! How can I assist you today?'}, {'role': 'user', 'content': 'hello'}, {'role': 'user', 'content': 'hello'}]
2025-01-05 21:38:49,260 [DEBUG] openai._base_client: Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': 'You are a helpful assistant. The provided context array includes messages from an ongoing conversation. Treat this context as fair use and consider it an essential part of the conversation. Your responses should build on this context coherently.'}, {'role': 'user', 'content': 'Hi there! How can I assist you today?'}, {'role': 'user', 'content': 'Hello! How can I assist you today?'}, {'role': 'user', 'content': 'hello'}, {'role': 'user', 'content': 'hello'}], 'model': 'gpt-4', 'max_tokens': 300, 'temperature': 0.7}}
2025-01-05 21:38:49,264 [DEBUG] httpcore.connection: connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2025-01-05 21:38:49,311 [DEBUG] httpcore.connection: connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x115fb30e0>
2025-01-05 21:38:49,311 [DEBUG] httpcore.connection: start_tls.started ssl_context=<ssl.SSLContext object at 0x1129716d0> server_hostname='api.openai.com' timeout=5.0
2025-01-05 21:38:49,339 [DEBUG] httpcore.connection: start_tls.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x115f96990>
2025-01-05 21:38:49,339 [DEBUG] httpcore.http11: send_request_headers.started request=<Request [b'POST']>
2025-01-05 21:38:49,340 [DEBUG] httpcore.http11: send_request_headers.complete
2025-01-05 21:38:49,340 [DEBUG] httpcore.http11: send_request_body.started request=<Request [b'POST']>
2025-01-05 21:38:49,340 [DEBUG] httpcore.http11: send_request_body.complete
2025-01-05 21:38:49,340 [DEBUG] httpcore.http11: receive_response_headers.started request=<Request [b'POST']>
2025-01-05 21:38:50,305 [DEBUG] httpcore.http11: receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 06 Jan 2025 02:38:50 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-yzbp3micnvwwjimbcblinra3'), (b'openai-processing-ms', b'795'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'5000'), (b'x-ratelimit-limit-tokens', b'80000'), (b'x-ratelimit-remaining-requests', b'4999'), (b'x-ratelimit-remaining-tokens', b'79613'), (b'x-ratelimit-reset-requests', b'12ms'), (b'x-ratelimit-reset-tokens', b'290ms'), (b'x-request-id', b'req_c3684cbfd99f869ab563c8b9a4cb7176'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=ramp6rbM.Ik_BoZAf3fzpmvODedaPacNWnxL9py0O9A-1736131130-1.0.1.1-01.i_3mFsKhpeFYhB2HRNHpOqn0IVvXolcFuiji9b9FarwL2u7I208ZVA_GOu09QqCmmf12tdfqLuQnBjxC7IA; path=/; expires=Mon, 06-Jan-25 03:08:50 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=7LD822qN6hJjpK0lyXRhONhw47vU87P1fc5V4fAE0Rs-1736131130240-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8fd85586ad103021-BOS'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2025-01-05 21:38:50,306 [INFO] httpx: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-05 21:38:50,306 [DEBUG] httpcore.http11: receive_response_body.started request=<Request [b'POST']>
2025-01-05 21:38:50,307 [DEBUG] httpcore.http11: receive_response_body.complete
2025-01-05 21:38:50,307 [DEBUG] httpcore.http11: response_closed.started
2025-01-05 21:38:50,307 [DEBUG] httpcore.http11: response_closed.complete
2025-01-05 21:38:50,307 [DEBUG] openai._base_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "200 OK"
2025-01-05 21:38:50,313 [INFO] src.luna_functions: GPT response: Hello! How can I help you today?
2025-01-05 21:38:50,349 [INFO] nio.rooms: Room !MWdCMggaXzjGhumvZl:localhost handling event of type RoomMessageText
2025-01-05 21:38:50,349 [DEBUG] src.luna_functions: Ignoring my own message.
2025-01-05 21:38:50,349 [INFO] nio.rooms: Room !MWdCMggaXzjGhumvZl:localhost handling event of type RoomMessageText
2025-01-05 21:38:50,349 [DEBUG] src.luna_functions: Ignoring my own message.
2025-01-05 21:38:50,357 [INFO] nio.rooms: Room !MWdCMggaXzjGhumvZl:localhost handling event of type RoomMessageText
2025-01-05 21:38:50,357 [DEBUG] src.luna_functions: Ignoring my own message.
2025-01-05 21:38:55,187 [DEBUG] src.console_functions: Showing help to user.
2025-01-05 21:38:55,188 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 21:39:05,149 [INFO] src.console_functions: Console received 'restart' command; restarting now.
2025-01-05 21:39:05,959 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-05 21:39:05,959 [DEBUG] __main__: Exiting configure_logging function.
2025-01-05 21:39:05,959 [DEBUG] __main__: Logging configuration complete.
2025-01-05 21:39:05,959 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-05 21:39:05,959 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 21:39:05,959 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-05 21:39:05,959 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-05 21:39:05,959 [DEBUG] __main__: Entering start_console_thread function.
2025-01-05 21:39:05,962 [INFO] __main__: Console thread started successfully.
2025-01-05 21:39:05,962 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-05 21:39:05,962 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-05 21:39:05,962 [INFO] __main__: Starting main_logic coroutine.
2025-01-05 21:39:05,964 [DEBUG] __main__: Entering main_logic function...
2025-01-05 21:39:05,964 [DEBUG] __main__: Attempting to load or log in the client.
2025-01-05 21:39:05,966 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 21:39:06,065 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-05 21:39:06,066 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-05 21:39:06,066 [INFO] src.luna_functions: Using saved token for user @lunabot:localhost.
2025-01-05 21:39:06,066 [DEBUG] __main__: Client obtained. Storing reference to DIRECTOR_CLIENT in src.luna_functions.
2025-01-05 21:39:06,066 [DEBUG] __main__: Callbacks registered successfully.
2025-01-05 21:39:06,066 [DEBUG] __main__: Starting sync_forever loop. Awaiting new events with timeout=30000.
2025-01-05 21:39:06,085 [INFO] nio.client.base_client: New joined room !MWdCMggaXzjGhumvZl:localhost
2025-01-05 21:39:06,085 [INFO] nio.rooms: Room !MWdCMggaXzjGhumvZl:localhost handling event of type RoomCreateEvent
2025-01-05 21:39:06,085 [INFO] nio.rooms: Room !MWdCMggaXzjGhumvZl:localhost handling event of type PowerLevelsEvent
2025-01-05 21:39:06,085 [INFO] nio.rooms: Changing power level for user @admin:localhost from 0 to 100
2025-01-05 21:39:06,085 [INFO] nio.rooms: Room !MWdCMggaXzjGhumvZl:localhost handling event of type RoomJoinRulesEvent
2025-01-05 21:39:06,085 [INFO] nio.rooms: Room !MWdCMggaXzjGhumvZl:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-05 21:39:06,085 [INFO] nio.rooms: Room !MWdCMggaXzjGhumvZl:localhost handling event of type RoomGuestAccessEvent
2025-01-05 21:39:06,085 [INFO] nio.rooms: Room !MWdCMggaXzjGhumvZl:localhost handling event of type RoomMessageText
2025-01-05 21:39:06,085 [INFO] src.luna_functions: Fetching last 100 messages from room !MWdCMggaXzjGhumvZl:localhost.
2025-01-05 21:39:06,101 [INFO] src.luna_functions: Fetched 4 messages from room !MWdCMggaXzjGhumvZl:localhost.
2025-01-05 21:39:06,101 [DEBUG] src.luna_functions: Formatted context for GPT: [{'role': 'system', 'content': 'You are a helpful assistant. The provided context array includes messages from an ongoing conversation. Treat this context as fair use and consider it an essential part of the conversation. Your responses should build on this context coherently.'}, {'role': 'user', 'content': 'Hello! How can I help you today?'}, {'role': 'user', 'content': 'Hi there! How can I assist you today?'}, {'role': 'user', 'content': 'Hello! How can I assist you today?'}, {'role': 'user', 'content': 'hello'}, {'role': 'user', 'content': 'hello'}]
2025-01-05 21:39:06,122 [DEBUG] openai._base_client: Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': 'You are a helpful assistant. The provided context array includes messages from an ongoing conversation. Treat this context as fair use and consider it an essential part of the conversation. Your responses should build on this context coherently.'}, {'role': 'user', 'content': 'Hello! How can I help you today?'}, {'role': 'user', 'content': 'Hi there! How can I assist you today?'}, {'role': 'user', 'content': 'Hello! How can I assist you today?'}, {'role': 'user', 'content': 'hello'}, {'role': 'user', 'content': 'hello'}], 'model': 'gpt-4', 'max_tokens': 300, 'temperature': 0.7}}
2025-01-05 21:39:06,127 [DEBUG] httpcore.connection: connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2025-01-05 21:39:06,149 [DEBUG] httpcore.connection: connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10eeb70e0>
2025-01-05 21:39:06,149 [DEBUG] httpcore.connection: start_tls.started ssl_context=<ssl.SSLContext object at 0x106a716d0> server_hostname='api.openai.com' timeout=5.0
2025-01-05 21:39:06,175 [DEBUG] httpcore.connection: start_tls.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10ee92990>
2025-01-05 21:39:06,175 [DEBUG] httpcore.http11: send_request_headers.started request=<Request [b'POST']>
2025-01-05 21:39:06,175 [DEBUG] httpcore.http11: send_request_headers.complete
2025-01-05 21:39:06,175 [DEBUG] httpcore.http11: send_request_body.started request=<Request [b'POST']>
2025-01-05 21:39:06,175 [DEBUG] httpcore.http11: send_request_body.complete
2025-01-05 21:39:06,175 [DEBUG] httpcore.http11: receive_response_headers.started request=<Request [b'POST']>
2025-01-05 21:39:06,996 [DEBUG] httpcore.http11: receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 06 Jan 2025 02:39:06 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-yzbp3micnvwwjimbcblinra3'), (b'openai-processing-ms', b'641'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'5000'), (b'x-ratelimit-limit-tokens', b'80000'), (b'x-ratelimit-remaining-requests', b'4999'), (b'x-ratelimit-remaining-tokens', b'79604'), (b'x-ratelimit-reset-requests', b'12ms'), (b'x-ratelimit-reset-tokens', b'297ms'), (b'x-request-id', b'req_2cda5e98b787536a4e8d40abc281b739'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=SccieiLV9Su0obWdvjns8ntCd3bx30pCFay0_EuO2do-1736131146-1.0.1.1-.YyDNyuFfnmr3gkniU0KhQ0dXz.fN8mebOQZh4_.u2tx37qVmAY38ykaun3BdSNJpGqtocBJRgYz2sBkmkYBNQ; path=/; expires=Mon, 06-Jan-25 03:09:06 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=y_iC3dD6ydfrbbdH6Gvuhr5JtyBOrJbuVbkznf3mmRg-1736131146931-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8fd855efe8474ce0-BOS'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2025-01-05 21:39:06,997 [INFO] httpx: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-05 21:39:06,997 [DEBUG] httpcore.http11: receive_response_body.started request=<Request [b'POST']>
2025-01-05 21:39:06,998 [DEBUG] httpcore.http11: receive_response_body.complete
2025-01-05 21:39:06,998 [DEBUG] httpcore.http11: response_closed.started
2025-01-05 21:39:06,998 [DEBUG] httpcore.http11: response_closed.complete
2025-01-05 21:39:06,998 [DEBUG] openai._base_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "200 OK"
2025-01-05 21:39:07,003 [INFO] src.luna_functions: GPT response: Hello! How can I assist you today?
2025-01-05 21:39:07,036 [INFO] nio.rooms: Room !MWdCMggaXzjGhumvZl:localhost handling event of type RoomMessageText
2025-01-05 21:39:07,037 [DEBUG] src.luna_functions: Ignoring my own message.
2025-01-05 21:39:07,037 [INFO] nio.rooms: Room !MWdCMggaXzjGhumvZl:localhost handling event of type RoomMessageText
2025-01-05 21:39:07,037 [DEBUG] src.luna_functions: Ignoring my own message.
2025-01-05 21:39:07,038 [INFO] nio.rooms: Room !MWdCMggaXzjGhumvZl:localhost handling event of type RoomMessageText
2025-01-05 21:39:07,038 [DEBUG] src.luna_functions: Ignoring my own message.
2025-01-05 21:39:07,041 [INFO] nio.rooms: Room !MWdCMggaXzjGhumvZl:localhost handling event of type RoomMessageText
2025-01-05 21:39:07,041 [DEBUG] src.luna_functions: Ignoring my own message.
2025-01-05 21:39:07,238 [INFO] src.console_functions: Console screen cleared.
2025-01-05 21:39:07,238 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 21:39:08,970 [DEBUG] src.console_functions: Showing help to user.
2025-01-05 21:39:08,971 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 21:41:02,027 [INFO] src.console_functions: Console received 'restart' command; restarting now.
2025-01-05 21:41:02,872 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-05 21:41:02,872 [DEBUG] __main__: Exiting configure_logging function.
2025-01-05 21:41:02,872 [DEBUG] __main__: Logging configuration complete.
2025-01-05 21:41:02,872 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-05 21:41:02,873 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 21:41:02,873 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-05 21:41:02,873 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-05 21:41:02,873 [DEBUG] __main__: Entering start_console_thread function.
2025-01-05 21:41:02,875 [INFO] __main__: Console thread started successfully.
2025-01-05 21:41:02,875 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-05 21:41:02,875 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-05 21:41:02,875 [INFO] __main__: Starting main_logic coroutine.
2025-01-05 21:41:02,877 [DEBUG] __main__: Entering main_logic function...
2025-01-05 21:41:02,877 [DEBUG] __main__: Attempting to load or log in the client.
2025-01-05 21:41:02,879 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 21:41:02,978 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-05 21:41:02,979 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-05 21:41:02,980 [INFO] src.luna_functions: Using saved token for user @lunabot:localhost.
2025-01-05 21:41:02,980 [DEBUG] __main__: Client obtained. Storing reference to DIRECTOR_CLIENT in src.luna_functions.
2025-01-05 21:41:02,980 [DEBUG] __main__: Callbacks registered successfully.
2025-01-05 21:41:02,980 [DEBUG] __main__: Starting sync_forever loop. Awaiting new events with timeout=30000.
2025-01-05 21:41:03,007 [INFO] nio.client.base_client: New joined room !MWdCMggaXzjGhumvZl:localhost
2025-01-05 21:41:03,007 [INFO] nio.rooms: Room !MWdCMggaXzjGhumvZl:localhost handling event of type PowerLevelsEvent
2025-01-05 21:41:03,007 [INFO] nio.rooms: Room !MWdCMggaXzjGhumvZl:localhost handling event of type RoomCreateEvent
2025-01-05 21:41:03,007 [INFO] nio.rooms: Room !MWdCMggaXzjGhumvZl:localhost handling event of type RoomJoinRulesEvent
2025-01-05 21:41:03,007 [INFO] nio.rooms: Room !MWdCMggaXzjGhumvZl:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-05 21:41:03,007 [INFO] nio.rooms: Room !MWdCMggaXzjGhumvZl:localhost handling event of type RoomGuestAccessEvent
2025-01-05 21:41:03,007 [INFO] nio.rooms: Room !MWdCMggaXzjGhumvZl:localhost handling event of type RoomMessageText
2025-01-05 21:41:03,007 [INFO] src.luna_functions: Fetching last 100 messages from room !MWdCMggaXzjGhumvZl:localhost.
2025-01-05 21:41:03,016 [INFO] src.luna_functions: Fetched 5 messages from room !MWdCMggaXzjGhumvZl:localhost.
2025-01-05 21:41:03,017 [DEBUG] src.luna_functions: Formatted context for GPT: [{'role': 'system', 'content': 'You are a helpful assistant. The provided context array includes messages from an ongoing conversation. Treat this context as fair use and consider it an essential part of the conversation. Your responses should build on this context coherently.'}, {'role': 'user', 'content': 'Hello! How can I assist you today?'}, {'role': 'user', 'content': 'Hello! How can I help you today?'}, {'role': 'user', 'content': 'Hi there! How can I assist you today?'}, {'role': 'user', 'content': 'Hello! How can I assist you today?'}, {'role': 'user', 'content': 'hello'}, {'role': 'user', 'content': 'hello'}]
2025-01-05 21:41:03,040 [DEBUG] openai._base_client: Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': 'You are a helpful assistant. The provided context array includes messages from an ongoing conversation. Treat this context as fair use and consider it an essential part of the conversation. Your responses should build on this context coherently.'}, {'role': 'user', 'content': 'Hello! How can I assist you today?'}, {'role': 'user', 'content': 'Hello! How can I help you today?'}, {'role': 'user', 'content': 'Hi there! How can I assist you today?'}, {'role': 'user', 'content': 'Hello! How can I assist you today?'}, {'role': 'user', 'content': 'hello'}, {'role': 'user', 'content': 'hello'}], 'model': 'gpt-4', 'max_tokens': 300, 'temperature': 0.7}}
2025-01-05 21:41:03,044 [DEBUG] httpcore.connection: connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2025-01-05 21:41:03,153 [DEBUG] httpcore.connection: connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x1218b70e0>
2025-01-05 21:41:03,154 [DEBUG] httpcore.connection: start_tls.started ssl_context=<ssl.SSLContext object at 0x1106e16d0> server_hostname='api.openai.com' timeout=5.0
2025-01-05 21:41:03,180 [DEBUG] httpcore.connection: start_tls.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x121896990>
2025-01-05 21:41:03,181 [DEBUG] httpcore.http11: send_request_headers.started request=<Request [b'POST']>
2025-01-05 21:41:03,181 [DEBUG] httpcore.http11: send_request_headers.complete
2025-01-05 21:41:03,181 [DEBUG] httpcore.http11: send_request_body.started request=<Request [b'POST']>
2025-01-05 21:41:03,181 [DEBUG] httpcore.http11: send_request_body.complete
2025-01-05 21:41:03,181 [DEBUG] httpcore.http11: receive_response_headers.started request=<Request [b'POST']>
2025-01-05 21:41:04,020 [DEBUG] src.console_functions: Showing help to user.
2025-01-05 21:41:04,022 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 21:41:04,349 [DEBUG] httpcore.http11: receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 06 Jan 2025 02:41:04 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-yzbp3micnvwwjimbcblinra3'), (b'openai-processing-ms', b'996'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'5000'), (b'x-ratelimit-limit-tokens', b'80000'), (b'x-ratelimit-remaining-requests', b'4999'), (b'x-ratelimit-remaining-tokens', b'79595'), (b'x-ratelimit-reset-requests', b'12ms'), (b'x-ratelimit-reset-tokens', b'303ms'), (b'x-request-id', b'req_d2a75280323ec8a7f0565e3fbadd28aa'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=lQ_P_LKH1LUgU9m.Ka1bJVGniWYpeILuxUkAwxTqF80-1736131264-1.0.1.1-zyx7Ju3Ne84WEdaEFsAwspJg_q1tUAMwVMk0wWIeh4KyxBzuD4TAIxbZ32FZpfnWOLwCzzxdE8jePDBh_69AQg; path=/; expires=Mon, 06-Jan-25 03:11:04 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=l.Air9TTc7ab7ox.M5dflhAXdTWDZz4bevWdqz_fQYs-1736131264292-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8fd858cb28388f86-BOS'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2025-01-05 21:41:04,351 [INFO] httpx: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-05 21:41:04,351 [DEBUG] httpcore.http11: receive_response_body.started request=<Request [b'POST']>
2025-01-05 21:41:04,352 [DEBUG] httpcore.http11: receive_response_body.complete
2025-01-05 21:41:04,352 [DEBUG] httpcore.http11: response_closed.started
2025-01-05 21:41:04,352 [DEBUG] httpcore.http11: response_closed.complete
2025-01-05 21:41:04,352 [DEBUG] openai._base_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "200 OK"
2025-01-05 21:41:04,358 [INFO] src.luna_functions: GPT response: Hello! How can I assist you today?
2025-01-05 21:41:04,390 [INFO] nio.rooms: Room !MWdCMggaXzjGhumvZl:localhost handling event of type RoomMessageText
2025-01-05 21:41:04,390 [DEBUG] src.luna_functions: Ignoring my own message.
2025-01-05 21:41:04,390 [INFO] nio.rooms: Room !MWdCMggaXzjGhumvZl:localhost handling event of type RoomMessageText
2025-01-05 21:41:04,390 [DEBUG] src.luna_functions: Ignoring my own message.
2025-01-05 21:41:04,391 [INFO] nio.rooms: Room !MWdCMggaXzjGhumvZl:localhost handling event of type RoomMessageText
2025-01-05 21:41:04,391 [DEBUG] src.luna_functions: Ignoring my own message.
2025-01-05 21:41:04,391 [INFO] nio.rooms: Room !MWdCMggaXzjGhumvZl:localhost handling event of type RoomMessageText
2025-01-05 21:41:04,391 [DEBUG] src.luna_functions: Ignoring my own message.
2025-01-05 21:41:04,398 [INFO] nio.rooms: Room !MWdCMggaXzjGhumvZl:localhost handling event of type RoomMessageText
2025-01-05 21:41:04,398 [DEBUG] src.luna_functions: Ignoring my own message.
2025-01-05 21:41:17,386 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 21:42:10,607 [INFO] src.console_functions: Console received 'restart' command; restarting now.
2025-01-05 21:42:11,473 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-05 21:42:11,473 [DEBUG] __main__: Exiting configure_logging function.
2025-01-05 21:42:11,473 [DEBUG] __main__: Logging configuration complete.
2025-01-05 21:42:11,473 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-05 21:42:11,473 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 21:42:11,473 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-05 21:42:11,474 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-05 21:42:11,474 [DEBUG] __main__: Entering start_console_thread function.
2025-01-05 21:42:11,476 [INFO] __main__: Console thread started successfully.
2025-01-05 21:42:11,476 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-05 21:42:11,476 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-05 21:42:11,476 [INFO] __main__: Starting main_logic coroutine.
2025-01-05 21:42:11,476 [DEBUG] __main__: Entering main_logic function...
2025-01-05 21:42:11,476 [DEBUG] __main__: Attempting to load or log in the client.
2025-01-05 21:42:11,481 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 21:42:11,578 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-05 21:42:11,578 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-05 21:42:11,578 [INFO] src.luna_functions: Using saved token for user @lunabot:localhost.
2025-01-05 21:42:11,578 [DEBUG] __main__: Client obtained. Storing reference to DIRECTOR_CLIENT in src.luna_functions.
2025-01-05 21:42:11,578 [DEBUG] __main__: Callbacks registered successfully.
2025-01-05 21:42:11,578 [DEBUG] __main__: Starting sync_forever loop. Awaiting new events with timeout=30000.
2025-01-05 21:42:11,589 [INFO] nio.client.base_client: New joined room !MWdCMggaXzjGhumvZl:localhost
2025-01-05 21:42:11,589 [INFO] nio.rooms: Room !MWdCMggaXzjGhumvZl:localhost handling event of type PowerLevelsEvent
2025-01-05 21:42:11,589 [INFO] nio.rooms: Room !MWdCMggaXzjGhumvZl:localhost handling event of type RoomCreateEvent
2025-01-05 21:42:11,589 [INFO] nio.rooms: Room !MWdCMggaXzjGhumvZl:localhost handling event of type RoomJoinRulesEvent
2025-01-05 21:42:11,589 [INFO] nio.rooms: Room !MWdCMggaXzjGhumvZl:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-05 21:42:11,589 [INFO] nio.rooms: Room !MWdCMggaXzjGhumvZl:localhost handling event of type RoomGuestAccessEvent
2025-01-05 21:42:11,589 [INFO] nio.rooms: Room !MWdCMggaXzjGhumvZl:localhost handling event of type RoomMessageText
2025-01-05 21:42:11,589 [INFO] src.luna_functions: Fetching last 100 messages from room !MWdCMggaXzjGhumvZl:localhost.
2025-01-05 21:42:11,608 [INFO] src.luna_functions: Fetched 6 messages from room !MWdCMggaXzjGhumvZl:localhost.
2025-01-05 21:42:11,608 [DEBUG] src.luna_functions: Formatted context for GPT: [{'role': 'system', 'content': 'You are a helpful assistant. The provided context array includes messages from an ongoing conversation. Treat this context as fair use and consider it an essential part of the conversation. Your responses should build on this context coherently.'}, {'role': 'user', 'content': 'Hello! How can I assist you today?'}, {'role': 'user', 'content': 'Hello! How can I assist you today?'}, {'role': 'user', 'content': 'Hello! How can I help you today?'}, {'role': 'user', 'content': 'Hi there! How can I assist you today?'}, {'role': 'user', 'content': 'Hello! How can I assist you today?'}, {'role': 'user', 'content': 'hello'}, {'role': 'user', 'content': 'hello'}]
2025-01-05 21:42:11,649 [DEBUG] openai._base_client: Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': 'You are a helpful assistant. The provided context array includes messages from an ongoing conversation. Treat this context as fair use and consider it an essential part of the conversation. Your responses should build on this context coherently.'}, {'role': 'user', 'content': 'Hello! How can I assist you today?'}, {'role': 'user', 'content': 'Hello! How can I assist you today?'}, {'role': 'user', 'content': 'Hello! How can I help you today?'}, {'role': 'user', 'content': 'Hi there! How can I assist you today?'}, {'role': 'user', 'content': 'Hello! How can I assist you today?'}, {'role': 'user', 'content': 'hello'}, {'role': 'user', 'content': 'hello'}], 'model': 'gpt-4', 'max_tokens': 300, 'temperature': 0.7}}
2025-01-05 21:42:11,653 [DEBUG] httpcore.connection: connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2025-01-05 21:42:11,672 [DEBUG] httpcore.connection: connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x121eb70e0>
2025-01-05 21:42:11,673 [DEBUG] httpcore.connection: start_tls.started ssl_context=<ssl.SSLContext object at 0x1108716d0> server_hostname='api.openai.com' timeout=5.0
2025-01-05 21:42:11,699 [DEBUG] httpcore.connection: start_tls.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x121e96990>
2025-01-05 21:42:11,700 [DEBUG] httpcore.http11: send_request_headers.started request=<Request [b'POST']>
2025-01-05 21:42:11,700 [DEBUG] httpcore.http11: send_request_headers.complete
2025-01-05 21:42:11,700 [DEBUG] httpcore.http11: send_request_body.started request=<Request [b'POST']>
2025-01-05 21:42:11,700 [DEBUG] httpcore.http11: send_request_body.complete
2025-01-05 21:42:11,700 [DEBUG] httpcore.http11: receive_response_headers.started request=<Request [b'POST']>
2025-01-05 21:42:12,856 [DEBUG] httpcore.http11: receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 06 Jan 2025 02:42:12 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-yzbp3micnvwwjimbcblinra3'), (b'openai-processing-ms', b'1039'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'5000'), (b'x-ratelimit-limit-tokens', b'80000'), (b'x-ratelimit-remaining-requests', b'4999'), (b'x-ratelimit-remaining-tokens', b'79585'), (b'x-ratelimit-reset-requests', b'12ms'), (b'x-ratelimit-reset-tokens', b'311ms'), (b'x-request-id', b'req_9c9c5fa68f06a0ee5a47bc80e03ef1d7'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=qUTEuhd10LKndakk6w0uRNYohygtymcqtt92Dtwxiz4-1736131332-1.0.1.1-nGL1vnPSaSHWw3m20IZnV3MTj5js0FFcvDC4Fgede2Q.kn7QfN4LCkJ5tXX3GkOfD6xirT.7y8HXKSv..dX.Vw; path=/; expires=Mon, 06-Jan-25 03:12:12 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=AiemhvlQ6xT36nHZs8X2TStZ0L1LdgLG_Zv4EqUWFOw-1736131332843-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8fd85a777ee78fb4-BOS'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2025-01-05 21:42:12,857 [INFO] httpx: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-05 21:42:12,858 [DEBUG] httpcore.http11: receive_response_body.started request=<Request [b'POST']>
2025-01-05 21:42:12,858 [DEBUG] httpcore.http11: receive_response_body.complete
2025-01-05 21:42:12,858 [DEBUG] httpcore.http11: response_closed.started
2025-01-05 21:42:12,859 [DEBUG] httpcore.http11: response_closed.complete
2025-01-05 21:42:12,859 [DEBUG] openai._base_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "200 OK"
2025-01-05 21:42:12,865 [INFO] src.luna_functions: GPT response: Hello! How can I assist you today?
2025-01-05 21:42:12,902 [INFO] nio.rooms: Room !MWdCMggaXzjGhumvZl:localhost handling event of type RoomMessageText
2025-01-05 21:42:12,903 [DEBUG] src.luna_functions: Ignoring my own message.
2025-01-05 21:42:12,903 [INFO] nio.rooms: Room !MWdCMggaXzjGhumvZl:localhost handling event of type RoomMessageText
2025-01-05 21:42:12,903 [DEBUG] src.luna_functions: Ignoring my own message.
2025-01-05 21:42:12,903 [INFO] nio.rooms: Room !MWdCMggaXzjGhumvZl:localhost handling event of type RoomMessageText
2025-01-05 21:42:12,903 [DEBUG] src.luna_functions: Ignoring my own message.
2025-01-05 21:42:12,903 [INFO] nio.rooms: Room !MWdCMggaXzjGhumvZl:localhost handling event of type RoomMessageText
2025-01-05 21:42:12,903 [DEBUG] src.luna_functions: Ignoring my own message.
2025-01-05 21:42:12,915 [INFO] nio.rooms: Room !MWdCMggaXzjGhumvZl:localhost handling event of type RoomMessageText
2025-01-05 21:42:12,915 [DEBUG] src.luna_functions: Ignoring my own message.
2025-01-05 21:42:12,924 [INFO] nio.rooms: Room !MWdCMggaXzjGhumvZl:localhost handling event of type RoomMessageText
2025-01-05 21:42:12,924 [DEBUG] src.luna_functions: Ignoring my own message.
2025-01-05 21:42:13,673 [DEBUG] src.console_functions: Showing help to user.
2025-01-05 21:42:13,675 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 21:42:30,065 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 21:42:30,066 [INFO] src.luna_functions: Creating user @stevo:localhost, admin=False via http://localhost:8008/_synapse/admin/v2/users/@stevo:localhost
2025-01-05 21:42:30,342 [INFO] src.luna_functions: Created user @stevo:localhost (HTTP 201)
2025-01-05 21:43:41,558 [INFO] nio.client.base_client: New invited room !zBULrAeUnYNFsMQZSG:localhost
2025-01-05 21:43:41,558 [INFO] nio.rooms: Room !zBULrAeUnYNFsMQZSG:localhost handling event of type InviteMemberEvent
2025-01-05 21:43:41,558 [INFO] src.luna_functions: Received invite to !zBULrAeUnYNFsMQZSG:localhost, joining now.
2025-01-05 21:43:41,587 [INFO] nio.rooms: Room !zBULrAeUnYNFsMQZSG:localhost handling event of type InviteMemberEvent
2025-01-05 21:43:41,587 [INFO] src.luna_functions: Received invite to !zBULrAeUnYNFsMQZSG:localhost, joining now.
2025-01-05 21:43:41,645 [INFO] nio.client.base_client: New joined room !zBULrAeUnYNFsMQZSG:localhost
2025-01-05 21:43:41,645 [INFO] nio.rooms: Room !zBULrAeUnYNFsMQZSG:localhost handling event of type RoomCreateEvent
2025-01-05 21:43:41,646 [INFO] nio.rooms: Room !zBULrAeUnYNFsMQZSG:localhost handling event of type PowerLevelsEvent
2025-01-05 21:43:41,646 [INFO] nio.rooms: Changing power level for user @admin:localhost from 0 to 100
2025-01-05 21:43:41,646 [INFO] nio.rooms: Room !zBULrAeUnYNFsMQZSG:localhost handling event of type RoomJoinRulesEvent
2025-01-05 21:43:41,646 [INFO] nio.rooms: Room !zBULrAeUnYNFsMQZSG:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-05 21:43:41,646 [INFO] nio.rooms: Room !zBULrAeUnYNFsMQZSG:localhost handling event of type RoomGuestAccessEvent
2025-01-05 21:43:42,129 [INFO] nio.rooms: Room !zBULrAeUnYNFsMQZSG:localhost handling event of type RoomMessageText
2025-01-05 21:43:42,130 [INFO] src.luna_functions: Fetching last 100 messages from room !zBULrAeUnYNFsMQZSG:localhost.
2025-01-05 21:43:42,137 [INFO] src.luna_functions: Fetched 1 messages from room !zBULrAeUnYNFsMQZSG:localhost.
2025-01-05 21:43:42,138 [DEBUG] src.luna_functions: Formatted context for GPT: [{'role': 'system', 'content': 'You are a helpful assistant. The provided context array includes messages from an ongoing conversation. Treat this context as fair use and consider it an essential part of the conversation. Your responses should build on this context coherently.'}, {'role': 'user', 'content': 'Can you see this?'}, {'role': 'user', 'content': 'Can you see this?'}]
2025-01-05 21:43:42,141 [DEBUG] openai._base_client: Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': 'You are a helpful assistant. The provided context array includes messages from an ongoing conversation. Treat this context as fair use and consider it an essential part of the conversation. Your responses should build on this context coherently.'}, {'role': 'user', 'content': 'Can you see this?'}, {'role': 'user', 'content': 'Can you see this?'}], 'model': 'gpt-4', 'max_tokens': 300, 'temperature': 0.7}}
2025-01-05 21:43:42,142 [DEBUG] httpcore.connection: close.started
2025-01-05 21:43:42,142 [DEBUG] httpcore.connection: close.complete
2025-01-05 21:43:42,142 [DEBUG] httpcore.connection: connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2025-01-05 21:43:42,197 [DEBUG] httpcore.connection: connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x1231a0690>
2025-01-05 21:43:42,197 [DEBUG] httpcore.connection: start_tls.started ssl_context=<ssl.SSLContext object at 0x1108716d0> server_hostname='api.openai.com' timeout=5.0
2025-01-05 21:43:42,227 [DEBUG] httpcore.connection: start_tls.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x121eae2c0>
2025-01-05 21:43:42,228 [DEBUG] httpcore.http11: send_request_headers.started request=<Request [b'POST']>
2025-01-05 21:43:42,228 [DEBUG] httpcore.http11: send_request_headers.complete
2025-01-05 21:43:42,228 [DEBUG] httpcore.http11: send_request_body.started request=<Request [b'POST']>
2025-01-05 21:43:42,229 [DEBUG] httpcore.http11: send_request_body.complete
2025-01-05 21:43:42,229 [DEBUG] httpcore.http11: receive_response_headers.started request=<Request [b'POST']>
2025-01-05 21:43:43,825 [DEBUG] httpcore.http11: receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 06 Jan 2025 02:43:43 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-yzbp3micnvwwjimbcblinra3'), (b'openai-processing-ms', b'1503'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'5000'), (b'x-ratelimit-limit-tokens', b'80000'), (b'x-ratelimit-remaining-requests', b'4999'), (b'x-ratelimit-remaining-tokens', b'79627'), (b'x-ratelimit-reset-requests', b'12ms'), (b'x-ratelimit-reset-tokens', b'279ms'), (b'x-request-id', b'req_af39d460fd56e084679faec28741dcf1'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8fd85cad4ff84ce9-BOS'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2025-01-05 21:43:43,826 [INFO] httpx: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-05 21:43:43,827 [DEBUG] httpcore.http11: receive_response_body.started request=<Request [b'POST']>
2025-01-05 21:43:43,831 [DEBUG] httpcore.http11: receive_response_body.complete
2025-01-05 21:43:43,832 [DEBUG] httpcore.http11: response_closed.started
2025-01-05 21:43:43,832 [DEBUG] httpcore.http11: response_closed.complete
2025-01-05 21:43:43,833 [DEBUG] openai._base_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "200 OK"
2025-01-05 21:43:43,835 [INFO] src.luna_functions: GPT response: As a text-based AI, I don't have the ability to see in the traditional sense. However, I can process and understand the text you send me. If you're trying to show me something, could you describe it in text or ask a question about it? I'm here to help.
2025-01-05 21:43:43,881 [INFO] nio.rooms: Room !zBULrAeUnYNFsMQZSG:localhost handling event of type RoomMessageText
2025-01-05 21:43:43,882 [DEBUG] src.luna_functions: Ignoring my own message.
2025-01-05 21:44:15,134 [INFO] nio.client.base_client: New invited room !MYwtCNJHYyKRgVVqqC:localhost
2025-01-05 21:44:15,134 [INFO] nio.rooms: Room !MYwtCNJHYyKRgVVqqC:localhost handling event of type InviteMemberEvent
2025-01-05 21:44:15,134 [INFO] src.luna_functions: Received invite to !MYwtCNJHYyKRgVVqqC:localhost, joining now.
2025-01-05 21:44:15,156 [INFO] nio.rooms: Room !MYwtCNJHYyKRgVVqqC:localhost handling event of type InviteMemberEvent
2025-01-05 21:44:15,157 [INFO] src.luna_functions: Received invite to !MYwtCNJHYyKRgVVqqC:localhost, joining now.
2025-01-05 21:44:15,179 [INFO] nio.client.base_client: New joined room !MYwtCNJHYyKRgVVqqC:localhost
2025-01-05 21:44:15,180 [INFO] nio.rooms: Room !MYwtCNJHYyKRgVVqqC:localhost handling event of type RoomCreateEvent
2025-01-05 21:44:15,180 [INFO] nio.rooms: Room !MYwtCNJHYyKRgVVqqC:localhost handling event of type PowerLevelsEvent
2025-01-05 21:44:15,180 [INFO] nio.rooms: Changing power level for user @admin:localhost from 0 to 100
2025-01-05 21:44:15,180 [INFO] nio.rooms: Room !MYwtCNJHYyKRgVVqqC:localhost handling event of type RoomJoinRulesEvent
2025-01-05 21:44:15,180 [INFO] nio.rooms: Room !MYwtCNJHYyKRgVVqqC:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-05 21:44:15,180 [INFO] nio.rooms: Room !MYwtCNJHYyKRgVVqqC:localhost handling event of type RoomGuestAccessEvent
2025-01-05 21:44:15,180 [INFO] nio.rooms: Room !MYwtCNJHYyKRgVVqqC:localhost handling event of type RoomMessageText
2025-01-05 21:44:15,180 [INFO] src.luna_functions: Fetching last 100 messages from room !MYwtCNJHYyKRgVVqqC:localhost.
2025-01-05 21:44:15,188 [INFO] src.luna_functions: Fetched 3 messages from room !MYwtCNJHYyKRgVVqqC:localhost.
2025-01-05 21:44:15,188 [DEBUG] src.luna_functions: Formatted context for GPT: [{'role': 'system', 'content': 'You are a helpful assistant. The provided context array includes messages from an ongoing conversation. Treat this context as fair use and consider it an essential part of the conversation. Your responses should build on this context coherently.'}, {'role': 'user', 'content': 'anyone listening?'}, {'role': 'user', 'content': 'test'}, {'role': 'user', 'content': 'Hi Stevo'}, {'role': 'user', 'content': 'Hi Stevo'}]
2025-01-05 21:44:15,191 [DEBUG] openai._base_client: Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': 'You are a helpful assistant. The provided context array includes messages from an ongoing conversation. Treat this context as fair use and consider it an essential part of the conversation. Your responses should build on this context coherently.'}, {'role': 'user', 'content': 'anyone listening?'}, {'role': 'user', 'content': 'test'}, {'role': 'user', 'content': 'Hi Stevo'}, {'role': 'user', 'content': 'Hi Stevo'}], 'model': 'gpt-4', 'max_tokens': 300, 'temperature': 0.7}}
2025-01-05 21:44:15,192 [DEBUG] httpcore.connection: close.started
2025-01-05 21:44:15,192 [DEBUG] httpcore.connection: close.complete
2025-01-05 21:44:15,192 [DEBUG] httpcore.connection: connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2025-01-05 21:44:15,218 [DEBUG] httpcore.connection: connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x121eaefd0>
2025-01-05 21:44:15,218 [DEBUG] httpcore.connection: start_tls.started ssl_context=<ssl.SSLContext object at 0x1108716d0> server_hostname='api.openai.com' timeout=5.0
2025-01-05 21:44:15,241 [DEBUG] httpcore.connection: start_tls.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x121ed72f0>
2025-01-05 21:44:15,241 [DEBUG] httpcore.http11: send_request_headers.started request=<Request [b'POST']>
2025-01-05 21:44:15,242 [DEBUG] httpcore.http11: send_request_headers.complete
2025-01-05 21:44:15,242 [DEBUG] httpcore.http11: send_request_body.started request=<Request [b'POST']>
2025-01-05 21:44:15,242 [DEBUG] httpcore.http11: send_request_body.complete
2025-01-05 21:44:15,242 [DEBUG] httpcore.http11: receive_response_headers.started request=<Request [b'POST']>
2025-01-05 21:44:15,944 [DEBUG] httpcore.http11: receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 06 Jan 2025 02:44:15 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-yzbp3micnvwwjimbcblinra3'), (b'openai-processing-ms', b'559'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'5000'), (b'x-ratelimit-limit-tokens', b'80000'), (b'x-ratelimit-remaining-requests', b'4999'), (b'x-ratelimit-remaining-tokens', b'79624'), (b'x-ratelimit-reset-requests', b'12ms'), (b'x-ratelimit-reset-tokens', b'282ms'), (b'x-request-id', b'req_d69178e4374c8fab1ed08266c44e8756'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8fd85d7b89df4cf8-BOS'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2025-01-05 21:44:15,946 [INFO] httpx: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-05 21:44:15,946 [DEBUG] httpcore.http11: receive_response_body.started request=<Request [b'POST']>
2025-01-05 21:44:15,947 [DEBUG] httpcore.http11: receive_response_body.complete
2025-01-05 21:44:15,947 [DEBUG] httpcore.http11: response_closed.started
2025-01-05 21:44:15,948 [DEBUG] httpcore.http11: response_closed.complete
2025-01-05 21:44:15,948 [DEBUG] openai._base_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "200 OK"
2025-01-05 21:44:15,949 [INFO] src.luna_functions: GPT response: Hello! How can I assist you today?
2025-01-05 21:44:15,985 [INFO] nio.rooms: Room !MYwtCNJHYyKRgVVqqC:localhost handling event of type RoomMessageText
2025-01-05 21:44:15,985 [INFO] src.luna_functions: Fetching last 100 messages from room !MYwtCNJHYyKRgVVqqC:localhost.
2025-01-05 21:44:15,999 [INFO] src.luna_functions: Fetched 4 messages from room !MYwtCNJHYyKRgVVqqC:localhost.
2025-01-05 21:44:16,000 [DEBUG] src.luna_functions: Formatted context for GPT: [{'role': 'system', 'content': 'You are a helpful assistant. The provided context array includes messages from an ongoing conversation. Treat this context as fair use and consider it an essential part of the conversation. Your responses should build on this context coherently.'}, {'role': 'user', 'content': 'Hello! How can I assist you today?'}, {'role': 'user', 'content': 'anyone listening?'}, {'role': 'user', 'content': 'test'}, {'role': 'user', 'content': 'Hi Stevo'}, {'role': 'user', 'content': 'test'}]
2025-01-05 21:44:16,009 [DEBUG] openai._base_client: Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': 'You are a helpful assistant. The provided context array includes messages from an ongoing conversation. Treat this context as fair use and consider it an essential part of the conversation. Your responses should build on this context coherently.'}, {'role': 'user', 'content': 'Hello! How can I assist you today?'}, {'role': 'user', 'content': 'anyone listening?'}, {'role': 'user', 'content': 'test'}, {'role': 'user', 'content': 'Hi Stevo'}, {'role': 'user', 'content': 'test'}], 'model': 'gpt-4', 'max_tokens': 300, 'temperature': 0.7}}
2025-01-05 21:44:16,010 [DEBUG] httpcore.http11: send_request_headers.started request=<Request [b'POST']>
2025-01-05 21:44:16,010 [DEBUG] httpcore.http11: send_request_headers.complete
2025-01-05 21:44:16,010 [DEBUG] httpcore.http11: send_request_body.started request=<Request [b'POST']>
2025-01-05 21:44:16,010 [DEBUG] httpcore.http11: send_request_body.complete
2025-01-05 21:44:16,010 [DEBUG] httpcore.http11: receive_response_headers.started request=<Request [b'POST']>
2025-01-05 21:44:17,992 [DEBUG] httpcore.http11: receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 06 Jan 2025 02:44:17 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-yzbp3micnvwwjimbcblinra3'), (b'openai-processing-ms', b'1885'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'5000'), (b'x-ratelimit-limit-tokens', b'80000'), (b'x-ratelimit-remaining-requests', b'4999'), (b'x-ratelimit-remaining-tokens', b'79616'), (b'x-ratelimit-reset-requests', b'12ms'), (b'x-ratelimit-reset-tokens', b'288ms'), (b'x-request-id', b'req_ac3d887aa786c11e3560a44393f69e11'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8fd85d805a214cf8-BOS'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2025-01-05 21:44:17,994 [INFO] httpx: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-05 21:44:17,995 [DEBUG] httpcore.http11: receive_response_body.started request=<Request [b'POST']>
2025-01-05 21:44:17,996 [DEBUG] httpcore.http11: receive_response_body.complete
2025-01-05 21:44:17,996 [DEBUG] httpcore.http11: response_closed.started
2025-01-05 21:44:17,996 [DEBUG] httpcore.http11: response_closed.complete
2025-01-05 21:44:17,997 [DEBUG] openai._base_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "200 OK"
2025-01-05 21:44:17,997 [INFO] src.luna_functions: GPT response: Hello! Yes, I'm here to assist you. How can I help you today?
2025-01-05 21:44:18,040 [INFO] nio.rooms: Room !MYwtCNJHYyKRgVVqqC:localhost handling event of type RoomMessageText
2025-01-05 21:44:18,040 [INFO] src.luna_functions: Fetching last 100 messages from room !MYwtCNJHYyKRgVVqqC:localhost.
2025-01-05 21:44:18,054 [INFO] src.luna_functions: Fetched 5 messages from room !MYwtCNJHYyKRgVVqqC:localhost.
2025-01-05 21:44:18,055 [DEBUG] src.luna_functions: Formatted context for GPT: [{'role': 'system', 'content': 'You are a helpful assistant. The provided context array includes messages from an ongoing conversation. Treat this context as fair use and consider it an essential part of the conversation. Your responses should build on this context coherently.'}, {'role': 'user', 'content': "Hello! Yes, I'm here to assist you. How can I help you today?"}, {'role': 'user', 'content': 'Hello! How can I assist you today?'}, {'role': 'user', 'content': 'anyone listening?'}, {'role': 'user', 'content': 'test'}, {'role': 'user', 'content': 'Hi Stevo'}, {'role': 'user', 'content': 'anyone listening?'}]
2025-01-05 21:44:18,060 [DEBUG] openai._base_client: Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': 'You are a helpful assistant. The provided context array includes messages from an ongoing conversation. Treat this context as fair use and consider it an essential part of the conversation. Your responses should build on this context coherently.'}, {'role': 'user', 'content': "Hello! Yes, I'm here to assist you. How can I help you today?"}, {'role': 'user', 'content': 'Hello! How can I assist you today?'}, {'role': 'user', 'content': 'anyone listening?'}, {'role': 'user', 'content': 'test'}, {'role': 'user', 'content': 'Hi Stevo'}, {'role': 'user', 'content': 'anyone listening?'}], 'model': 'gpt-4', 'max_tokens': 300, 'temperature': 0.7}}
2025-01-05 21:44:18,061 [DEBUG] httpcore.http11: send_request_headers.started request=<Request [b'POST']>
2025-01-05 21:44:18,062 [DEBUG] httpcore.http11: send_request_headers.complete
2025-01-05 21:44:18,062 [DEBUG] httpcore.http11: send_request_body.started request=<Request [b'POST']>
2025-01-05 21:44:18,063 [DEBUG] httpcore.http11: send_request_body.complete
2025-01-05 21:44:18,063 [DEBUG] httpcore.http11: receive_response_headers.started request=<Request [b'POST']>
2025-01-05 21:44:18,913 [DEBUG] httpcore.http11: receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 06 Jan 2025 02:44:18 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-yzbp3micnvwwjimbcblinra3'), (b'openai-processing-ms', b'743'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'5000'), (b'x-ratelimit-limit-tokens', b'80000'), (b'x-ratelimit-remaining-requests', b'4999'), (b'x-ratelimit-remaining-tokens', b'79596'), (b'x-ratelimit-reset-requests', b'12ms'), (b'x-ratelimit-reset-tokens', b'303ms'), (b'x-request-id', b'req_ee048d4b1d9fdb8c7a709b0b30de7090'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8fd85d8d284a4cf8-BOS'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2025-01-05 21:44:18,914 [INFO] httpx: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-05 21:44:18,914 [DEBUG] httpcore.http11: receive_response_body.started request=<Request [b'POST']>
2025-01-05 21:44:18,915 [DEBUG] httpcore.http11: receive_response_body.complete
2025-01-05 21:44:18,915 [DEBUG] httpcore.http11: response_closed.started
2025-01-05 21:44:18,915 [DEBUG] httpcore.http11: response_closed.complete
2025-01-05 21:44:18,916 [DEBUG] openai._base_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "200 OK"
2025-01-05 21:44:18,916 [INFO] src.luna_functions: GPT response: Hello! Yes, I'm here. How can I assist you today?
2025-01-05 21:44:18,962 [INFO] nio.rooms: Room !MYwtCNJHYyKRgVVqqC:localhost handling event of type RoomMessageText
2025-01-05 21:44:18,962 [DEBUG] src.luna_functions: Ignoring my own message.
2025-01-05 21:44:18,962 [INFO] nio.rooms: Room !MYwtCNJHYyKRgVVqqC:localhost handling event of type RoomMessageText
2025-01-05 21:44:18,962 [DEBUG] src.luna_functions: Ignoring my own message.
2025-01-05 21:44:18,962 [INFO] nio.rooms: Room !MYwtCNJHYyKRgVVqqC:localhost handling event of type RoomMessageText
2025-01-05 21:44:18,962 [DEBUG] src.luna_functions: Ignoring my own message.
2025-01-05 21:52:55,265 [INFO] src.console_functions: Console screen cleared.
2025-01-05 21:52:55,266 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 16:36:29,224 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-07 16:36:29,224 [DEBUG] __main__: Exiting configure_logging function.
2025-01-07 16:36:29,225 [DEBUG] __main__: Logging configuration complete.
2025-01-07 16:36:29,225 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-07 16:36:29,225 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 16:36:29,225 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-07 16:36:29,225 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-07 16:36:29,225 [DEBUG] __main__: Entering start_console_thread function.
2025-01-07 16:36:29,227 [INFO] __main__: Console thread started successfully.
2025-01-07 16:36:29,227 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-07 16:36:29,227 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-07 16:36:29,227 [INFO] __main__: Starting main_logic coroutine.
2025-01-07 16:36:29,227 [DEBUG] __main__: Entering main_logic function...
2025-01-07 16:36:29,227 [DEBUG] __main__: Attempting to load or log in the client.
2025-01-07 16:36:29,232 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 16:36:29,330 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-07 16:36:29,332 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-07 16:36:29,332 [INFO] src.luna_functions: Using saved token for user @lunabot:localhost.
2025-01-07 16:36:29,332 [DEBUG] __main__: Client obtained. Storing reference to DIRECTOR_CLIENT in src.luna_functions.
2025-01-07 16:36:29,332 [DEBUG] __main__: Callbacks registered successfully.
2025-01-07 16:36:29,332 [DEBUG] __main__: Starting sync_forever loop. Awaiting new events with timeout=30000.
2025-01-07 16:36:35,849 [DEBUG] src.console_functions: Showing help to user.
2025-01-07 16:36:35,851 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 16:36:49,869 [INFO] src.console_apparatus: User exited the console (EOF or KeyboardInterrupt).
2025-01-07 16:36:50,647 [WARNING] __main__: KeyboardInterrupt received. Shutting down Director.
2025-01-07 16:36:50,647 [DEBUG] __main__: Preparing to close the event loop.
2025-01-07 16:36:50,647 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-07 16:36:50,711 [ERROR] asyncio: Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x10db106e0>
2025-01-07 16:36:50,712 [ERROR] asyncio: Task was destroyed but it is pending!
task: <Task pending name='Task-15408' coro=<AsyncClient.sync() running at /Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/base_client.py:116> wait_for=<Future pending cb=[Task.task_wakeup()]> cb=[_AsCompletedIterator._handle_completion()]>
2025-01-07 17:29:48,869 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-07 17:29:48,869 [DEBUG] __main__: Exiting configure_logging function.
2025-01-07 17:29:48,869 [DEBUG] __main__: Logging configuration complete.
2025-01-07 17:29:48,869 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-07 17:29:48,869 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 17:29:48,870 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-07 17:29:48,870 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-07 17:29:48,870 [DEBUG] __main__: Entering start_console_thread function.
2025-01-07 17:29:48,872 [INFO] __main__: Console thread started successfully.
2025-01-07 17:29:48,872 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-07 17:29:48,872 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-07 17:29:48,872 [INFO] __main__: Starting main_logic coroutine.
2025-01-07 17:29:48,872 [DEBUG] __main__: Entering main_logic function...
2025-01-07 17:29:48,872 [DEBUG] __main__: Attempting to load or log in the client.
2025-01-07 17:29:48,877 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 17:29:48,973 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-07 17:29:48,975 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-07 17:29:48,975 [INFO] src.luna_functions: Using saved token for user @lunabot:localhost.
2025-01-07 17:29:48,975 [DEBUG] __main__: Client obtained. Storing reference to DIRECTOR_CLIENT in src.luna_functions.
2025-01-07 17:29:48,975 [DEBUG] __main__: Callbacks registered successfully.
2025-01-07 17:29:48,975 [DEBUG] __main__: Starting sync_forever loop. Awaiting new events with timeout=30000.
2025-01-07 17:29:56,999 [DEBUG] src.console_functions: Showing help to user.
2025-01-07 17:29:57,002 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 17:30:01,344 [INFO] src.console_functions: Console received 'exit' command; calling sys.exit(0).
2025-01-07 17:30:09,915 [WARNING] __main__: KeyboardInterrupt received. Shutting down Director.
2025-01-07 17:30:09,915 [DEBUG] __main__: Preparing to close the event loop.
2025-01-07 17:30:09,915 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-07 17:30:10,003 [ERROR] asyncio: Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x10c6106e0>
2025-01-07 17:30:10,004 [ERROR] asyncio: Task was destroyed but it is pending!
task: <Task pending name='Task-12467' coro=<AsyncClient.sync() running at /Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/base_client.py:116> wait_for=<Future pending cb=[Task.task_wakeup()]> cb=[_AsCompletedIterator._handle_completion()]>
2025-01-07 18:13:16,187 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-07 18:13:16,187 [DEBUG] __main__: Exiting configure_logging function.
2025-01-07 18:13:16,187 [DEBUG] __main__: Logging configuration complete.
2025-01-07 18:13:16,187 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-07 18:13:16,187 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 18:13:16,187 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-07 18:13:16,187 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-07 18:13:16,187 [DEBUG] __main__: Entering start_console_thread function.
2025-01-07 18:13:16,189 [INFO] __main__: Console thread started successfully.
2025-01-07 18:13:16,189 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-07 18:13:16,189 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-07 18:13:16,189 [INFO] __main__: Starting main_logic coroutine.
2025-01-07 18:13:16,191 [DEBUG] __main__: Entering main_logic function...
2025-01-07 18:13:16,191 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-07 18:13:16,192 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-07 18:13:16,192 [INFO] src.luna_functions: Using saved token for user @lunabot:localhost.
2025-01-07 18:13:16,192 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-07 18:13:16,195 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 18:13:18,894 [DEBUG] src.console_functions: Showing help to user.
2025-01-07 18:13:18,897 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 18:13:20,159 [INFO] src.console_apparatus: User exited the console (EOF or KeyboardInterrupt).
2025-01-07 18:13:21,121 [WARNING] __main__: KeyboardInterrupt received. Shutting down Director.
2025-01-07 18:13:21,121 [DEBUG] __main__: Preparing to close the event loop.
2025-01-07 18:13:21,121 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-07 18:13:21,209 [ERROR] asyncio: Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x10c352f90>
2025-01-07 18:13:40,974 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-07 18:13:40,974 [DEBUG] __main__: Exiting configure_logging function.
2025-01-07 18:13:40,974 [DEBUG] __main__: Logging configuration complete.
2025-01-07 18:13:40,974 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-07 18:13:40,974 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 18:13:40,974 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-07 18:13:40,974 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-07 18:13:40,974 [DEBUG] __main__: Entering start_console_thread function.
2025-01-07 18:13:40,976 [INFO] __main__: Console thread started successfully.
2025-01-07 18:13:40,976 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-07 18:13:40,976 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-07 18:13:40,976 [INFO] __main__: Starting main_logic coroutine.
2025-01-07 18:13:40,978 [DEBUG] __main__: Entering main_logic function...
2025-01-07 18:13:40,978 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-07 18:13:40,979 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-07 18:13:40,979 [INFO] src.luna_functions: Using saved token for user @lunabot:localhost.
2025-01-07 18:13:40,980 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-07 18:13:40,981 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 18:13:42,007 [INFO] src.console_apparatus: User exited the console (EOF or KeyboardInterrupt).
2025-01-07 18:13:44,159 [WARNING] __main__: KeyboardInterrupt received. Shutting down Director.
2025-01-07 18:13:44,159 [DEBUG] __main__: Preparing to close the event loop.
2025-01-07 18:13:44,160 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-07 18:13:44,239 [ERROR] asyncio: Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x114b530e0>
2025-01-07 18:13:44,240 [ERROR] asyncio: Unclosed connector
connections: ['deque([(<aiohttp.client_proto.ResponseHandler object at 0x114bd8110>, 721525.015823833)])']
connector: <aiohttp.connector.TCPConnector object at 0x114b53230>
2025-01-07 18:14:01,469 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-07 18:14:01,469 [DEBUG] __main__: Exiting configure_logging function.
2025-01-07 18:14:01,469 [DEBUG] __main__: Logging configuration complete.
2025-01-07 18:14:01,469 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-07 18:14:01,469 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 18:14:01,470 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-07 18:14:01,470 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-07 18:14:01,470 [DEBUG] __main__: Entering start_console_thread function.
2025-01-07 18:14:01,472 [INFO] __main__: Console thread started successfully.
2025-01-07 18:14:01,472 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-07 18:14:01,472 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-07 18:14:01,472 [INFO] __main__: Starting main_logic coroutine.
2025-01-07 18:14:01,474 [DEBUG] __main__: Entering main_logic function...
2025-01-07 18:14:01,474 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-07 18:14:01,474 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-07 18:14:01,474 [INFO] src.luna_functions: Using saved token for user @lunabot:localhost.
2025-01-07 18:14:01,474 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-07 18:14:01,477 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 18:14:04,077 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 18:14:06,033 [INFO] src.console_functions: Console received 'exit' command; requesting shutdown.
2025-01-07 18:14:06,033 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 18:14:11,673 [INFO] src.console_functions: Console received 'restart' command; restarting now.
2025-01-07 18:14:12,335 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-07 18:14:12,335 [DEBUG] __main__: Exiting configure_logging function.
2025-01-07 18:14:12,335 [DEBUG] __main__: Logging configuration complete.
2025-01-07 18:14:12,335 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-07 18:14:12,335 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 18:14:12,336 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-07 18:14:12,336 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-07 18:14:12,336 [DEBUG] __main__: Entering start_console_thread function.
2025-01-07 18:14:12,338 [INFO] __main__: Console thread started successfully.
2025-01-07 18:14:12,338 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-07 18:14:12,338 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-07 18:14:12,338 [INFO] __main__: Starting main_logic coroutine.
2025-01-07 18:14:12,340 [DEBUG] __main__: Entering main_logic function...
2025-01-07 18:14:12,340 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-07 18:14:12,340 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-07 18:14:12,341 [INFO] src.luna_functions: Using saved token for user @lunabot:localhost.
2025-01-07 18:14:12,341 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-07 18:14:12,343 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 18:14:15,097 [INFO] src.console_functions: Console received 'exit' command; requesting shutdown.
2025-01-07 18:14:15,097 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 18:14:21,262 [INFO] src.console_apparatus: User exited the console (EOF or KeyboardInterrupt).
2025-01-07 18:14:21,460 [WARNING] __main__: KeyboardInterrupt received. Shutting down Director.
2025-01-07 18:14:21,461 [DEBUG] __main__: Preparing to close the event loop.
2025-01-07 18:14:21,462 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-07 18:14:21,529 [ERROR] asyncio: Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x10c49b0e0>
2025-01-07 18:14:21,529 [ERROR] asyncio: Unclosed connector
connections: ['deque([(<aiohttp.client_proto.ResponseHandler object at 0x10c520110>, 721562.317528208)])']
connector: <aiohttp.connector.TCPConnector object at 0x10c49b230>
2025-01-07 18:16:34,020 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-07 18:16:34,020 [DEBUG] __main__: Exiting configure_logging function.
2025-01-07 18:16:34,020 [DEBUG] __main__: Logging configuration complete.
2025-01-07 18:16:34,020 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-07 18:16:34,020 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 18:16:34,020 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-07 18:16:34,020 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-07 18:16:34,020 [DEBUG] __main__: Entering start_console_thread function.
2025-01-07 18:16:34,023 [INFO] __main__: Console thread started successfully.
2025-01-07 18:16:34,023 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-07 18:16:34,023 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-07 18:16:34,023 [INFO] __main__: Starting main_logic coroutine.
2025-01-07 18:16:34,023 [DEBUG] __main__: Entering main_logic function...
2025-01-07 18:16:34,023 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-07 18:16:34,025 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-07 18:16:34,025 [INFO] src.luna_functions: Using saved token for user @lunabot:localhost.
2025-01-07 18:16:34,025 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-07 18:16:34,028 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 18:16:36,534 [INFO] src.console_functions: Console received 'exit' command; requesting shutdown.
2025-01-07 18:25:02,631 [WARNING] __main__: KeyboardInterrupt received. Shutting down Director.
2025-01-07 18:25:02,631 [DEBUG] __main__: Preparing to close the event loop.
2025-01-07 18:25:02,631 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-07 18:25:02,697 [ERROR] asyncio: Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x10cd66ba0>
2025-01-07 18:25:02,698 [ERROR] asyncio: Unclosed connector
connections: ['deque([(<aiohttp.client_proto.ResponseHandler object at 0x10cde09b0>, 722203.498279791)])']
connector: <aiohttp.connector.TCPConnector object at 0x10cd66cf0>
2025-01-07 18:25:05,293 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-07 18:25:05,293 [DEBUG] __main__: Exiting configure_logging function.
2025-01-07 18:25:05,293 [DEBUG] __main__: Logging configuration complete.
2025-01-07 18:25:05,293 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-07 18:25:05,293 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 18:25:05,293 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-07 18:25:05,293 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-07 18:25:05,293 [DEBUG] __main__: Entering start_console_thread function.
2025-01-07 18:25:05,295 [INFO] __main__: Console thread started successfully.
2025-01-07 18:25:05,295 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-07 18:25:05,295 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-07 18:25:05,295 [INFO] __main__: Starting main_logic coroutine.
2025-01-07 18:25:05,295 [DEBUG] __main__: Entering main_logic function...
2025-01-07 18:25:05,295 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-07 18:25:05,297 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-07 18:25:05,298 [INFO] src.luna_functions: Using saved token for user @lunabot:localhost.
2025-01-07 18:25:05,298 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-07 18:25:05,301 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 18:25:07,117 [DEBUG] src.console_functions: Showing help to user.
2025-01-07 18:25:07,119 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 18:25:08,760 [INFO] src.console_functions: Console received 'exit' command; requesting shutdown.
2025-01-07 18:25:08,760 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 18:25:11,661 [INFO] src.console_functions: Console received 'exit' command; requesting shutdown.
2025-01-07 18:25:11,662 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 18:25:13,754 [INFO] src.console_functions: Console received 'exit' command; requesting shutdown.
2025-01-07 18:25:13,754 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 18:27:19,161 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-07 18:27:19,162 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-07 18:27:19,366 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-07 18:27:19,771 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-07 18:27:20,574 [WARNING] nio.client.async_client: Timed out, sleeping for 1s
2025-01-07 18:27:22,188 [WARNING] nio.client.async_client: Timed out, sleeping for 3s
2025-01-07 18:27:24,678 [INFO] src.console_functions: Console received 'exit' command; requesting shutdown.
2025-01-07 18:27:24,679 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 18:27:25,392 [WARNING] nio.client.async_client: Timed out, sleeping for 6s
2025-01-07 18:27:29,943 [INFO] src.console_functions: Console received 'exit' command; requesting shutdown.
2025-01-07 18:27:29,943 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 18:27:31,797 [WARNING] nio.client.async_client: Timed out, sleeping for 12s
2025-01-07 18:27:44,601 [WARNING] nio.client.async_client: Timed out, sleeping for 25s
2025-01-07 18:28:10,215 [WARNING] nio.client.async_client: Timed out, sleeping for 51s
2025-01-07 18:29:01,421 [WARNING] nio.client.async_client: Timed out, sleeping for 60s
2025-01-07 18:30:01,428 [WARNING] nio.client.async_client: Timed out, sleeping for 60s
2025-01-07 18:31:01,434 [WARNING] nio.client.async_client: Timed out, sleeping for 60s
2025-01-07 18:32:01,441 [WARNING] nio.client.async_client: Timed out, sleeping for 60s
2025-01-07 18:32:28,984 [INFO] src.console_apparatus: User exited the console (EOF or KeyboardInterrupt).
2025-01-07 18:32:29,200 [WARNING] __main__: KeyboardInterrupt received. Shutting down Director.
2025-01-07 18:32:29,200 [DEBUG] __main__: Preparing to close the event loop.
2025-01-07 18:32:29,200 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-07 18:32:29,277 [ERROR] asyncio: Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x13d866ba0>
2025-01-07 18:32:31,512 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-07 18:32:31,512 [DEBUG] __main__: Exiting configure_logging function.
2025-01-07 18:32:31,512 [DEBUG] __main__: Logging configuration complete.
2025-01-07 18:32:31,512 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-07 18:32:31,512 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 18:32:31,512 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-07 18:32:31,512 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-07 18:32:31,512 [DEBUG] __main__: Entering start_console_thread function.
2025-01-07 18:32:31,514 [INFO] __main__: Console thread started successfully.
2025-01-07 18:32:31,514 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-07 18:32:31,514 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-07 18:32:31,514 [INFO] __main__: Starting main_logic coroutine.
2025-01-07 18:32:31,515 [DEBUG] __main__: Entering main_logic function...
2025-01-07 18:32:31,515 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-07 18:32:31,516 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-07 18:32:31,516 [INFO] src.luna_functions: Using saved token for user @lunabot:localhost.
2025-01-07 18:32:31,517 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-07 18:32:31,520 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 18:32:31,522 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-07 18:32:31,523 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-07 18:32:31,726 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-07 18:32:32,130 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-07 18:32:32,935 [WARNING] nio.client.async_client: Timed out, sleeping for 1s
2025-01-07 18:32:34,539 [WARNING] nio.client.async_client: Timed out, sleeping for 3s
2025-01-07 18:32:35,020 [INFO] src.console_functions: Console received 'exit' command; requesting shutdown.
2025-01-07 18:32:35,020 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 18:32:37,743 [WARNING] nio.client.async_client: Timed out, sleeping for 6s
2025-01-07 18:32:44,149 [WARNING] nio.client.async_client: Timed out, sleeping for 12s
2025-01-07 18:32:56,955 [WARNING] nio.client.async_client: Timed out, sleeping for 25s
2025-01-07 18:33:22,561 [WARNING] nio.client.async_client: Timed out, sleeping for 51s
2025-01-07 18:34:13,765 [WARNING] nio.client.async_client: Timed out, sleeping for 60s
2025-01-07 18:34:30,685 [INFO] src.console_apparatus: User exited the console (EOF or KeyboardInterrupt).
2025-01-07 18:34:30,838 [WARNING] __main__: KeyboardInterrupt received. Shutting down Director.
2025-01-07 18:34:30,839 [DEBUG] __main__: Preparing to close the event loop.
2025-01-07 18:34:30,839 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-07 18:34:30,941 [ERROR] asyncio: Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x10be0eba0>
2025-01-07 18:34:33,682 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-07 18:34:33,682 [DEBUG] __main__: Exiting configure_logging function.
2025-01-07 18:34:33,682 [DEBUG] __main__: Logging configuration complete.
2025-01-07 18:34:33,682 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-07 18:34:33,682 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 18:34:33,682 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-07 18:34:33,682 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-07 18:34:33,682 [DEBUG] __main__: Entering start_console_thread function.
2025-01-07 18:34:33,684 [INFO] __main__: Console thread started successfully.
2025-01-07 18:34:33,684 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-07 18:34:33,684 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-07 18:34:33,684 [INFO] __main__: Starting main_logic coroutine.
2025-01-07 18:34:33,685 [DEBUG] __main__: Entering main_logic function...
2025-01-07 18:34:33,685 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-07 18:34:33,686 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-07 18:34:33,686 [INFO] src.luna_functions: Using saved token for user @lunabot:localhost.
2025-01-07 18:34:33,687 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-07 18:34:33,690 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 18:34:33,692 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-07 18:34:33,693 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-07 18:34:33,896 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-07 18:34:34,299 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-07 18:34:35,103 [WARNING] nio.client.async_client: Timed out, sleeping for 1s
2025-01-07 18:34:35,545 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 18:34:36,706 [WARNING] nio.client.async_client: Timed out, sleeping for 3s
2025-01-07 18:34:39,575 [INFO] src.console_functions: Console received 'exit' command; requesting shutdown.
2025-01-07 18:34:39,575 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 18:34:39,911 [WARNING] nio.client.async_client: Timed out, sleeping for 6s
2025-01-07 18:34:41,687 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 18:34:46,314 [WARNING] nio.client.async_client: Timed out, sleeping for 12s
2025-01-07 18:34:59,118 [WARNING] nio.client.async_client: Timed out, sleeping for 25s
2025-01-07 18:35:24,721 [WARNING] nio.client.async_client: Timed out, sleeping for 51s
2025-01-07 18:36:15,925 [WARNING] nio.client.async_client: Timed out, sleeping for 60s
2025-01-07 18:37:15,933 [WARNING] nio.client.async_client: Timed out, sleeping for 60s
2025-01-07 18:38:15,940 [WARNING] nio.client.async_client: Timed out, sleeping for 60s
2025-01-07 18:39:15,946 [WARNING] nio.client.async_client: Timed out, sleeping for 60s
2025-01-07 18:40:15,953 [WARNING] nio.client.async_client: Timed out, sleeping for 60s
2025-01-07 18:41:15,962 [WARNING] nio.client.async_client: Timed out, sleeping for 60s
2025-01-07 18:42:15,971 [WARNING] nio.client.async_client: Timed out, sleeping for 60s
2025-01-07 18:43:15,979 [WARNING] nio.client.async_client: Timed out, sleeping for 60s
2025-01-07 18:44:15,986 [WARNING] nio.client.async_client: Timed out, sleeping for 60s
2025-01-07 18:45:15,991 [WARNING] nio.client.async_client: Timed out, sleeping for 60s
2025-01-07 18:46:15,999 [WARNING] nio.client.async_client: Timed out, sleeping for 60s
2025-01-07 18:47:16,007 [WARNING] nio.client.async_client: Timed out, sleeping for 60s
2025-01-07 18:48:16,014 [WARNING] nio.client.async_client: Timed out, sleeping for 60s
2025-01-07 18:49:16,024 [WARNING] nio.client.async_client: Timed out, sleeping for 60s
2025-01-07 18:50:16,031 [WARNING] nio.client.async_client: Timed out, sleeping for 60s
2025-01-07 18:51:16,041 [WARNING] nio.client.async_client: Timed out, sleeping for 60s
2025-01-07 18:52:16,047 [WARNING] nio.client.async_client: Timed out, sleeping for 60s
2025-01-07 18:53:16,056 [WARNING] nio.client.async_client: Timed out, sleeping for 60s
2025-01-07 18:54:16,064 [WARNING] nio.client.async_client: Timed out, sleeping for 60s
2025-01-07 18:55:16,079 [WARNING] nio.client.async_client: Timed out, sleeping for 60s
2025-01-07 18:56:16,192 [WARNING] nio.client.async_client: Timed out, sleeping for 60s
2025-01-07 18:57:16,206 [WARNING] nio.client.async_client: Timed out, sleeping for 60s
2025-01-07 18:58:16,212 [WARNING] nio.client.async_client: Timed out, sleeping for 60s
2025-01-07 18:59:16,226 [WARNING] nio.client.async_client: Timed out, sleeping for 60s
2025-01-07 19:00:16,233 [WARNING] nio.client.async_client: Timed out, sleeping for 60s
2025-01-07 19:01:16,248 [WARNING] nio.client.async_client: Timed out, sleeping for 60s
2025-01-07 19:02:16,259 [WARNING] nio.client.async_client: Timed out, sleeping for 60s
2025-01-07 19:03:16,270 [WARNING] nio.client.async_client: Timed out, sleeping for 60s
2025-01-07 19:04:16,273 [WARNING] nio.client.async_client: Timed out, sleeping for 60s
2025-01-07 19:05:16,280 [WARNING] nio.client.async_client: Timed out, sleeping for 60s
2025-01-07 19:06:16,291 [WARNING] nio.client.async_client: Timed out, sleeping for 60s
2025-01-07 19:07:16,299 [WARNING] nio.client.async_client: Timed out, sleeping for 60s
2025-01-07 19:08:16,313 [WARNING] nio.client.async_client: Timed out, sleeping for 60s
2025-01-07 19:09:16,321 [WARNING] nio.client.async_client: Timed out, sleeping for 60s
2025-01-07 19:10:16,329 [WARNING] nio.client.async_client: Timed out, sleeping for 60s
2025-01-07 19:11:16,335 [WARNING] nio.client.async_client: Timed out, sleeping for 60s
2025-01-07 19:12:16,341 [WARNING] nio.client.async_client: Timed out, sleeping for 60s
2025-01-07 19:12:24,787 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:12:25,730 [INFO] src.console_functions: Console received 'exit' command; requesting shutdown.
2025-01-07 19:12:25,730 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:12:26,607 [INFO] src.console_functions: Console received 'exit' command; requesting shutdown.
2025-01-07 19:12:26,608 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:12:27,329 [INFO] src.console_functions: Console received 'exit' command; requesting shutdown.
2025-01-07 19:12:27,329 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:12:27,980 [INFO] src.console_functions: Console received 'exit' command; requesting shutdown.
2025-01-07 19:12:27,980 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:12:28,663 [INFO] src.console_functions: Console received 'exit' command; requesting shutdown.
2025-01-07 19:12:28,663 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:12:30,392 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:13:16,348 [WARNING] nio.client.async_client: Timed out, sleeping for 60s
2025-01-07 19:13:31,791 [INFO] src.console_apparatus: User exited the console (EOF or KeyboardInterrupt).
2025-01-07 19:13:32,419 [WARNING] __main__: KeyboardInterrupt received. Shutting down Director.
2025-01-07 19:13:32,419 [DEBUG] __main__: Preparing to close the event loop.
2025-01-07 19:13:32,420 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-07 19:13:32,521 [ERROR] asyncio: Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x10baeaba0>
2025-01-07 19:13:35,102 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-07 19:13:35,102 [DEBUG] __main__: Exiting configure_logging function.
2025-01-07 19:13:35,102 [DEBUG] __main__: Logging configuration complete.
2025-01-07 19:13:35,102 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-07 19:13:35,102 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:13:35,102 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-07 19:13:35,102 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-07 19:13:35,102 [DEBUG] __main__: Entering start_console_thread function.
2025-01-07 19:13:35,105 [INFO] __main__: Console thread started successfully.
2025-01-07 19:13:35,105 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-07 19:13:35,105 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-07 19:13:35,105 [INFO] __main__: Starting main_logic coroutine.
2025-01-07 19:13:35,106 [DEBUG] __main__: Entering main_logic function...
2025-01-07 19:13:35,106 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-07 19:13:35,108 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-07 19:13:35,109 [INFO] src.luna_functions: Using saved token for user @lunabot:localhost.
2025-01-07 19:13:35,109 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-07 19:13:35,114 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:13:35,117 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-07 19:13:35,117 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-07 19:13:35,319 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-07 19:13:35,721 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-07 19:13:36,526 [WARNING] nio.client.async_client: Timed out, sleeping for 1s
2025-01-07 19:13:37,460 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:13:38,128 [WARNING] nio.client.async_client: Timed out, sleeping for 3s
2025-01-07 19:13:39,845 [INFO] src.console_functions: Console received 'exit' command; requesting shutdown.
2025-01-07 19:13:39,846 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:13:39,846 [ERROR] __main__: An unexpected exception occurred in main_logic: Event loop stopped before Future completed.
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 135, in luna
    loop.run_until_complete(main_logic())
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 718, in run_until_complete
    raise RuntimeError('Event loop stopped before Future completed.')
RuntimeError: Event loop stopped before Future completed.
2025-01-07 19:13:39,848 [DEBUG] __main__: Preparing to close the event loop.
2025-01-07 19:13:39,848 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-07 19:13:39,912 [ERROR] asyncio: Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x128d6af90>
2025-01-07 19:16:50,194 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-07 19:16:50,194 [DEBUG] __main__: Exiting configure_logging function.
2025-01-07 19:16:50,194 [DEBUG] __main__: Logging configuration complete.
2025-01-07 19:16:50,194 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-07 19:16:50,194 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:16:50,195 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-07 19:16:50,195 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-07 19:16:50,195 [DEBUG] __main__: Entering start_console_thread function.
2025-01-07 19:16:50,197 [INFO] __main__: Console thread started successfully.
2025-01-07 19:16:50,197 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-07 19:16:50,197 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-07 19:16:50,197 [INFO] __main__: Starting main_logic coroutine.
2025-01-07 19:16:50,197 [DEBUG] __main__: Entering main_logic function...
2025-01-07 19:16:50,198 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-07 19:16:50,200 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-07 19:16:50,200 [INFO] src.luna_functions: Using saved token for user @lunabot:localhost.
2025-01-07 19:16:50,200 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-07 19:16:50,203 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:16:54,674 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-07 19:16:54,676 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-07 19:16:54,880 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-07 19:16:55,285 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-07 19:16:56,090 [WARNING] nio.client.async_client: Timed out, sleeping for 1s
2025-01-07 19:16:57,697 [WARNING] nio.client.async_client: Timed out, sleeping for 3s
2025-01-07 19:17:00,901 [WARNING] nio.client.async_client: Timed out, sleeping for 6s
2025-01-07 19:17:07,308 [WARNING] nio.client.async_client: Timed out, sleeping for 12s
2025-01-07 19:17:13,759 [INFO] src.console_functions: Console received 'exit' command; requesting shutdown.
2025-01-07 19:17:13,760 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:17:13,760 [ERROR] __main__: An unexpected exception occurred in main_logic: Event loop stopped before Future completed.
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 135, in luna
    loop.run_until_complete(main_logic())
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 718, in run_until_complete
    raise RuntimeError('Event loop stopped before Future completed.')
RuntimeError: Event loop stopped before Future completed.
2025-01-07 19:17:13,762 [DEBUG] __main__: Preparing to close the event loop.
2025-01-07 19:17:13,762 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-07 19:17:13,835 [ERROR] asyncio: Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x10bdbaba0>
2025-01-07 19:18:01,875 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-07 19:18:01,875 [DEBUG] __main__: Exiting configure_logging function.
2025-01-07 19:18:01,875 [DEBUG] __main__: Logging configuration complete.
2025-01-07 19:18:01,875 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-07 19:18:01,875 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:18:01,875 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-07 19:18:01,875 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-07 19:18:01,875 [DEBUG] __main__: Entering start_console_thread function.
2025-01-07 19:18:01,878 [INFO] __main__: Console thread started successfully.
2025-01-07 19:18:01,878 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-07 19:18:01,878 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-07 19:18:01,878 [INFO] __main__: Starting main_logic coroutine.
2025-01-07 19:18:01,878 [DEBUG] __main__: Entering main_logic function...
2025-01-07 19:18:01,878 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-07 19:18:01,880 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-07 19:18:01,880 [INFO] src.luna_functions: Using saved token for user @lunabot:localhost.
2025-01-07 19:18:01,880 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-07 19:18:01,884 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:18:01,891 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-07 19:18:01,892 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-07 19:18:02,094 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-07 19:18:02,244 [DEBUG] src.console_functions: Showing help to user.
2025-01-07 19:18:02,245 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:18:02,498 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-07 19:18:03,301 [WARNING] nio.client.async_client: Timed out, sleeping for 1s
2025-01-07 19:18:04,902 [WARNING] nio.client.async_client: Timed out, sleeping for 3s
2025-01-07 19:18:08,104 [WARNING] nio.client.async_client: Timed out, sleeping for 6s
2025-01-07 19:18:13,560 [INFO] src.console_apparatus: User exited the console (EOF or KeyboardInterrupt).
2025-01-07 19:18:14,507 [WARNING] nio.client.async_client: Timed out, sleeping for 12s
2025-01-07 19:18:27,313 [WARNING] nio.client.async_client: Timed out, sleeping for 25s
2025-01-07 19:18:54,687 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-07 19:18:54,687 [DEBUG] __main__: Exiting configure_logging function.
2025-01-07 19:18:54,687 [DEBUG] __main__: Logging configuration complete.
2025-01-07 19:18:54,687 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-07 19:18:54,687 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:18:54,688 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-07 19:18:54,688 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-07 19:18:54,688 [DEBUG] __main__: Entering start_console_thread function.
2025-01-07 19:18:54,690 [INFO] __main__: Console thread started successfully.
2025-01-07 19:18:54,690 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-07 19:18:54,690 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-07 19:18:54,690 [INFO] __main__: Starting main_logic coroutine.
2025-01-07 19:18:54,690 [DEBUG] __main__: Entering main_logic function...
2025-01-07 19:18:54,690 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-07 19:18:54,692 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-07 19:18:54,692 [INFO] src.luna_functions: Using saved token for user @lunabot:localhost.
2025-01-07 19:18:54,692 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-07 19:18:54,696 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:18:54,698 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-07 19:18:54,698 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-07 19:18:54,901 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-07 19:18:55,306 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-07 19:18:56,113 [WARNING] nio.client.async_client: Timed out, sleeping for 1s
2025-01-07 19:18:57,081 [DEBUG] src.console_functions: Showing help to user.
2025-01-07 19:18:57,083 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:18:57,717 [WARNING] nio.client.async_client: Timed out, sleeping for 3s
2025-01-07 19:19:00,923 [WARNING] nio.client.async_client: Timed out, sleeping for 6s
2025-01-07 19:19:06,486 [INFO] src.console_apparatus: User exited the console (EOF or KeyboardInterrupt).
2025-01-07 19:19:07,329 [WARNING] nio.client.async_client: Timed out, sleeping for 12s
2025-01-07 19:19:26,278 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-07 19:19:26,279 [DEBUG] __main__: Exiting configure_logging function.
2025-01-07 19:19:26,279 [DEBUG] __main__: Logging configuration complete.
2025-01-07 19:19:26,279 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-07 19:19:26,279 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:19:26,279 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-07 19:19:26,279 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-07 19:19:26,279 [DEBUG] __main__: Entering start_console_thread function.
2025-01-07 19:19:26,281 [INFO] __main__: Console thread started successfully.
2025-01-07 19:19:26,281 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-07 19:19:26,281 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-07 19:19:26,281 [INFO] __main__: Starting main_logic coroutine.
2025-01-07 19:19:26,281 [DEBUG] __main__: Entering main_logic function...
2025-01-07 19:19:26,281 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-07 19:19:26,283 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-07 19:19:26,283 [INFO] src.luna_functions: Using saved token for user @lunabot:localhost.
2025-01-07 19:19:26,283 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-07 19:19:26,287 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:19:26,289 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-07 19:19:26,290 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-07 19:19:26,493 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-07 19:19:26,896 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-07 19:19:27,701 [WARNING] nio.client.async_client: Timed out, sleeping for 1s
2025-01-07 19:19:29,303 [WARNING] nio.client.async_client: Timed out, sleeping for 3s
2025-01-07 19:19:30,808 [DEBUG] src.console_functions: Showing help to user.
2025-01-07 19:19:30,811 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:19:32,506 [WARNING] nio.client.async_client: Timed out, sleeping for 6s
2025-01-07 19:19:38,912 [WARNING] nio.client.async_client: Timed out, sleeping for 12s
2025-01-07 19:19:47,525 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:19:47,528 [INFO] src.luna_functions: Creating user @lunabot:localhost, admin=True via http://localhost:8008/_synapse/admin/v2/users/@lunabot:localhost
2025-01-07 19:19:47,531 [ERROR] src.luna_functions: Network error creating user @lunabot:localhost
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/aiohttp/connector.py", line 1115, in _wrap_create_connection
    sock = await aiohappyeyeballs.start_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/aiohappyeyeballs/impl.py", line 123, in start_connection
    raise OSError(first_errno, msg)
ConnectionRefusedError: [Errno 61] Multiple exceptions: [Errno 61] Connect call failed ('::1', 8008, 0, 0), [Errno 61] Connect call failed ('127.0.0.1', 8008)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/src/luna_functions.py", line 165, in add_user_via_admin_api
    async with session.request("PUT", url, headers=headers, json=body) as resp:
               ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/aiohttp/client.py", line 1425, in __aenter__
    self._resp: _RetType = await self._coro
                           ^^^^^^^^^^^^^^^^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/aiohttp/client.py", line 703, in _request
    conn = await self._connector.connect(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        req, traces=traces, timeout=real_timeout
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/aiohttp/connector.py", line 548, in connect
    proto = await self._create_connection(req, traces, timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/aiohttp/connector.py", line 1056, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/aiohttp/connector.py", line 1400, in _create_direct_connection
    raise last_exc
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/aiohttp/connector.py", line 1369, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
    )
    ^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/aiohttp/connector.py", line 1130, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host localhost:8008 ssl:default [Multiple exceptions: [Errno 61] Connect call failed ('::1', 8008, 0, 0), [Errno 61] Connect call failed ('127.0.0.1', 8008)]
2025-01-07 19:19:51,720 [WARNING] nio.client.async_client: Timed out, sleeping for 25s
2025-01-07 19:20:00,732 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:20:00,735 [INFO] src.luna_functions: Creating user @lunabot:localhost, admin=True via http://localhost:8008/_synapse/admin/v2/users/@lunabot:localhost
2025-01-07 19:20:00,748 [ERROR] src.luna_functions: Error creating user @lunabot:localhost: 401 => {"errcode":"M_UNKNOWN_TOKEN","error":"Invalid access token passed.","soft_logout":false}
2025-01-07 19:20:02,548 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:20:02,549 [INFO] src.luna_functions: Creating user @lunabot:localhost, admin=True via http://localhost:8008/_synapse/admin/v2/users/@lunabot:localhost
2025-01-07 19:20:02,556 [ERROR] src.luna_functions: Error creating user @lunabot:localhost: 401 => {"errcode":"M_UNKNOWN_TOKEN","error":"Invalid access token passed.","soft_logout":false}
2025-01-07 19:20:16,521 [INFO] src.console_functions: Console received 'exit' command; requesting shutdown.
2025-01-07 19:20:16,522 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:20:16,522 [ERROR] __main__: An unexpected exception occurred in main_logic: Event loop stopped before Future completed.
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 135, in luna
    loop.run_until_complete(main_logic())
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 718, in run_until_complete
    raise RuntimeError('Event loop stopped before Future completed.')
RuntimeError: Event loop stopped before Future completed.
2025-01-07 19:20:16,527 [DEBUG] __main__: Preparing to close the event loop.
2025-01-07 19:20:16,527 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-07 19:20:22,031 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-07 19:20:22,031 [DEBUG] __main__: Exiting configure_logging function.
2025-01-07 19:20:22,031 [DEBUG] __main__: Logging configuration complete.
2025-01-07 19:20:22,031 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-07 19:20:22,031 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:20:22,031 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-07 19:20:22,031 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-07 19:20:22,031 [DEBUG] __main__: Entering start_console_thread function.
2025-01-07 19:20:22,034 [INFO] __main__: Console thread started successfully.
2025-01-07 19:20:22,034 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-07 19:20:22,034 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-07 19:20:22,034 [INFO] __main__: Starting main_logic coroutine.
2025-01-07 19:20:22,034 [DEBUG] __main__: Entering main_logic function...
2025-01-07 19:20:22,034 [DEBUG] src.luna_functions: No valid token found, attempting normal password login.
2025-01-07 19:20:22,039 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:20:22,312 [INFO] src.luna_functions: Password login succeeded, storing token.
2025-01-07 19:20:22,314 [DEBUG] src.luna_functions: Token info for @lunabot:localhost saved to director_token.json.
2025-01-07 19:20:22,314 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-07 19:20:43,391 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:20:44,851 [DEBUG] src.console_functions: Showing help to user.
2025-01-07 19:20:44,853 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:22:12,985 [INFO] src.console_functions: Console received 'restart' command; restarting now.
2025-01-07 19:22:13,873 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-07 19:22:13,873 [DEBUG] __main__: Exiting configure_logging function.
2025-01-07 19:22:13,873 [DEBUG] __main__: Logging configuration complete.
2025-01-07 19:22:13,873 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-07 19:22:13,873 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:22:13,874 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-07 19:22:13,874 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-07 19:22:13,874 [DEBUG] __main__: Entering start_console_thread function.
2025-01-07 19:22:13,876 [INFO] __main__: Console thread started successfully.
2025-01-07 19:22:13,876 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-07 19:22:13,876 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-07 19:22:13,876 [INFO] __main__: Starting main_logic coroutine.
2025-01-07 19:22:13,876 [DEBUG] __main__: Entering main_logic function...
2025-01-07 19:22:13,876 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-07 19:22:13,876 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-07 19:22:13,878 [INFO] src.luna_functions: Using saved token for user @lunabot:localhost.
2025-01-07 19:22:13,878 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-07 19:22:13,882 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:22:20,073 [DEBUG] src.console_functions: Showing help to user.
2025-01-07 19:22:20,075 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:22:38,204 [INFO] src.console_functions: Console received 'exit' command; requesting shutdown.
2025-01-07 19:22:38,205 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:22:38,205 [ERROR] __main__: An unexpected exception occurred in main_logic: Event loop stopped before Future completed.
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 135, in luna
    loop.run_until_complete(main_logic())
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 718, in run_until_complete
    raise RuntimeError('Event loop stopped before Future completed.')
RuntimeError: Event loop stopped before Future completed.
2025-01-07 19:22:38,211 [DEBUG] __main__: Preparing to close the event loop.
2025-01-07 19:22:38,211 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-07 19:27:38,681 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-07 19:27:38,681 [DEBUG] __main__: Exiting configure_logging function.
2025-01-07 19:27:38,681 [DEBUG] __main__: Logging configuration complete.
2025-01-07 19:27:38,681 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-07 19:27:38,681 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:27:38,681 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-07 19:27:38,681 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-07 19:27:38,681 [DEBUG] __main__: Entering start_console_thread function.
2025-01-07 19:27:38,683 [INFO] __main__: Console thread started successfully.
2025-01-07 19:27:38,684 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-07 19:27:38,684 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-07 19:27:38,684 [INFO] __main__: Starting main_logic coroutine.
2025-01-07 19:27:38,684 [DEBUG] __main__: Entering main_logic function...
2025-01-07 19:27:38,684 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-07 19:27:38,686 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-07 19:27:38,686 [INFO] src.luna_functions: Using saved token for user @lunabot:localhost.
2025-01-07 19:27:38,686 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-07 19:27:38,689 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:27:40,291 [DEBUG] src.console_functions: Showing help to user.
2025-01-07 19:27:40,294 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:27:42,632 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:28:10,737 [INFO] src.console_functions: (Console) Scheduling creation of room 'test'
2025-01-07 19:28:10,737 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:28:15,167 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:28:17,100 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:31:04,008 [INFO] src.console_apparatus: User exited the console (EOF or KeyboardInterrupt).
2025-01-07 19:31:51,516 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-07 19:31:51,516 [DEBUG] __main__: Exiting configure_logging function.
2025-01-07 19:31:51,516 [DEBUG] __main__: Logging configuration complete.
2025-01-07 19:31:51,516 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-07 19:31:51,516 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:31:51,516 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-07 19:31:51,516 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-07 19:31:51,516 [DEBUG] __main__: Entering start_console_thread function.
2025-01-07 19:31:51,519 [INFO] __main__: Console thread started successfully.
2025-01-07 19:31:51,519 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-07 19:31:51,519 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-07 19:31:51,519 [INFO] __main__: Starting main_logic coroutine.
2025-01-07 19:31:51,519 [DEBUG] __main__: Entering main_logic function...
2025-01-07 19:31:51,519 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-07 19:31:51,521 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-07 19:31:51,521 [INFO] src.luna_functions: Using saved token for user @lunabot:localhost.
2025-01-07 19:31:51,521 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-07 19:31:51,525 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:31:53,250 [INFO] src.console_functions: Console screen cleared.
2025-01-07 19:31:53,250 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:32:17,940 [WARNING] __main__: KeyboardInterrupt received. Shutting down Director.
2025-01-07 19:32:17,940 [DEBUG] __main__: Preparing to close the event loop.
2025-01-07 19:32:17,940 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-07 19:32:18,037 [ERROR] asyncio: Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x11976eba0>
2025-01-07 19:32:20,473 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-07 19:32:20,473 [DEBUG] __main__: Exiting configure_logging function.
2025-01-07 19:32:20,473 [DEBUG] __main__: Logging configuration complete.
2025-01-07 19:32:20,473 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-07 19:32:20,473 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:32:20,473 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-07 19:32:20,473 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-07 19:32:20,473 [DEBUG] __main__: Entering start_console_thread function.
2025-01-07 19:32:20,475 [INFO] __main__: Console thread started successfully.
2025-01-07 19:32:20,475 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-07 19:32:20,476 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-07 19:32:20,476 [INFO] __main__: Starting main_logic coroutine.
2025-01-07 19:32:20,476 [DEBUG] __main__: Entering main_logic function...
2025-01-07 19:32:20,476 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-07 19:32:20,478 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-07 19:32:20,478 [INFO] src.luna_functions: Using saved token for user @lunabot:localhost.
2025-01-07 19:32:20,478 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-07 19:32:20,481 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:32:32,899 [WARNING] __main__: KeyboardInterrupt received. Shutting down Director.
2025-01-07 19:32:32,899 [DEBUG] __main__: Preparing to close the event loop.
2025-01-07 19:32:32,900 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-07 19:32:32,994 [ERROR] asyncio: Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x10e222ba0>
2025-01-07 19:32:34,706 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-07 19:32:34,706 [DEBUG] __main__: Exiting configure_logging function.
2025-01-07 19:32:34,706 [DEBUG] __main__: Logging configuration complete.
2025-01-07 19:32:34,706 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-07 19:32:34,706 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:32:34,706 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-07 19:32:34,706 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-07 19:32:34,706 [DEBUG] __main__: Entering start_console_thread function.
2025-01-07 19:32:34,709 [INFO] __main__: Console thread started successfully.
2025-01-07 19:32:34,709 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-07 19:32:34,709 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-07 19:32:34,709 [INFO] __main__: Starting main_logic coroutine.
2025-01-07 19:32:34,711 [DEBUG] __main__: Entering main_logic function...
2025-01-07 19:32:34,711 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-07 19:32:34,711 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-07 19:32:34,711 [INFO] src.luna_functions: Using saved token for user @lunabot:localhost.
2025-01-07 19:32:34,711 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-07 19:32:34,714 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:32:43,048 [WARNING] __main__: KeyboardInterrupt received. Shutting down Director.
2025-01-07 19:32:43,049 [DEBUG] __main__: Preparing to close the event loop.
2025-01-07 19:32:43,049 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-07 19:32:43,146 [ERROR] asyncio: Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x11466af90>
2025-01-07 19:32:48,672 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-07 19:32:48,672 [DEBUG] __main__: Exiting configure_logging function.
2025-01-07 19:32:48,672 [DEBUG] __main__: Logging configuration complete.
2025-01-07 19:32:48,672 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-07 19:32:48,672 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:32:48,672 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-07 19:32:48,672 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-07 19:32:48,672 [DEBUG] __main__: Entering start_console_thread function.
2025-01-07 19:32:48,674 [INFO] __main__: Console thread started successfully.
2025-01-07 19:32:48,674 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-07 19:32:48,674 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-07 19:32:48,675 [INFO] __main__: Starting main_logic coroutine.
2025-01-07 19:32:48,676 [DEBUG] __main__: Entering main_logic function...
2025-01-07 19:32:48,676 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-07 19:32:48,677 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-07 19:32:48,677 [INFO] src.luna_functions: Using saved token for user @lunabot:localhost.
2025-01-07 19:32:48,677 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-07 19:32:48,679 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:32:49,419 [DEBUG] src.console_functions: Showing help to user.
2025-01-07 19:32:49,421 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:33:13,038 [WARNING] __main__: KeyboardInterrupt received. Shutting down Director.
2025-01-07 19:33:13,039 [DEBUG] __main__: Preparing to close the event loop.
2025-01-07 19:33:13,039 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-07 19:33:13,119 [ERROR] asyncio: Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x11626af90>
2025-01-07 19:33:14,813 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-07 19:33:14,813 [DEBUG] __main__: Exiting configure_logging function.
2025-01-07 19:33:14,813 [DEBUG] __main__: Logging configuration complete.
2025-01-07 19:33:14,813 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-07 19:33:14,813 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:33:14,813 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-07 19:33:14,813 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-07 19:33:14,813 [DEBUG] __main__: Entering start_console_thread function.
2025-01-07 19:33:14,815 [INFO] __main__: Console thread started successfully.
2025-01-07 19:33:14,815 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-07 19:33:14,815 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-07 19:33:14,815 [INFO] __main__: Starting main_logic coroutine.
2025-01-07 19:33:14,817 [DEBUG] __main__: Entering main_logic function...
2025-01-07 19:33:14,817 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-07 19:33:14,817 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-07 19:33:14,818 [INFO] src.luna_functions: Using saved token for user @lunabot:localhost.
2025-01-07 19:33:14,818 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-07 19:33:14,820 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:33:37,138 [WARNING] __main__: KeyboardInterrupt received. Shutting down Director.
2025-01-07 19:33:37,138 [DEBUG] __main__: Preparing to close the event loop.
2025-01-07 19:33:37,138 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-07 19:33:37,218 [ERROR] asyncio: Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x12116af90>
2025-01-07 19:33:40,612 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-07 19:33:40,612 [DEBUG] __main__: Exiting configure_logging function.
2025-01-07 19:33:40,612 [DEBUG] __main__: Logging configuration complete.
2025-01-07 19:33:40,612 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-07 19:33:40,612 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:33:40,612 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-07 19:33:40,612 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-07 19:33:40,612 [DEBUG] __main__: Entering start_console_thread function.
2025-01-07 19:33:40,615 [INFO] __main__: Console thread started successfully.
2025-01-07 19:33:40,615 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-07 19:33:40,615 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-07 19:33:40,615 [INFO] __main__: Starting main_logic coroutine.
2025-01-07 19:33:40,616 [DEBUG] __main__: Entering main_logic function...
2025-01-07 19:33:40,617 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-07 19:33:40,617 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-07 19:33:40,617 [INFO] src.luna_functions: Using saved token for user @lunabot:localhost.
2025-01-07 19:33:40,617 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-07 19:33:40,620 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:33:42,017 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:33:49,763 [INFO] src.console_functions: (Console) Scheduling creation of room 'test'
2025-01-07 19:33:49,764 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:33:59,260 [INFO] src.console_functions: (Console) Scheduling creation of room 'test2'
2025-01-07 19:33:59,261 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:34:05,806 [INFO] src.console_functions: (Console) Scheduling creation of room 'test2'
2025-01-07 19:34:05,806 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:35:41,166 [INFO] src.console_functions: Console received 'restart' command; restarting now.
2025-01-07 19:35:42,125 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-07 19:35:42,125 [DEBUG] __main__: Exiting configure_logging function.
2025-01-07 19:35:42,125 [DEBUG] __main__: Logging configuration complete.
2025-01-07 19:35:42,125 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-07 19:35:42,125 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:35:42,125 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-07 19:35:42,125 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-07 19:35:42,125 [DEBUG] __main__: Entering start_console_thread function.
2025-01-07 19:35:42,128 [INFO] __main__: Console thread started successfully.
2025-01-07 19:35:42,128 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-07 19:35:42,128 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-07 19:35:42,128 [INFO] __main__: Starting main_logic coroutine.
2025-01-07 19:35:42,128 [DEBUG] __main__: Entering main_logic function...
2025-01-07 19:35:42,128 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-07 19:35:42,130 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-07 19:35:42,130 [INFO] src.luna_functions: Using saved token for user @lunabot:localhost.
2025-01-07 19:35:42,130 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-07 19:35:42,133 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:35:45,956 [INFO] src.console_functions: (Console) Scheduling creation of room 'test'
2025-01-07 19:35:45,957 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:36:05,617 [INFO] src.console_functions: Console received 'restart' command; restarting now.
2025-01-07 19:36:06,451 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-07 19:36:06,451 [DEBUG] __main__: Exiting configure_logging function.
2025-01-07 19:36:06,451 [DEBUG] __main__: Logging configuration complete.
2025-01-07 19:36:06,451 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-07 19:36:06,451 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:36:06,451 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-07 19:36:06,451 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-07 19:36:06,451 [DEBUG] __main__: Entering start_console_thread function.
2025-01-07 19:36:06,453 [INFO] __main__: Console thread started successfully.
2025-01-07 19:36:06,454 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-07 19:36:06,454 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-07 19:36:06,454 [INFO] __main__: Starting main_logic coroutine.
2025-01-07 19:36:06,454 [DEBUG] __main__: Entering main_logic function...
2025-01-07 19:36:06,454 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-07 19:36:06,456 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-07 19:36:06,456 [INFO] src.luna_functions: Using saved token for user @lunabot:localhost.
2025-01-07 19:36:06,456 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-07 19:36:06,459 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:36:08,854 [INFO] src.console_functions: (Console) Scheduling creation of room 'test'
2025-01-07 19:36:08,855 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:36:08,934 [INFO] nio.client.base_client: New joined room !HPrbJYfQkoGnlztkrS:localhost
2025-01-07 19:36:08,934 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomCreateEvent
2025-01-07 19:36:08,940 [INFO] src.luna_functions: Successfully created room 'test' with ID: !HPrbJYfQkoGnlztkrS:localhost
2025-01-07 19:36:08,946 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type PowerLevelsEvent
2025-01-07 19:36:08,946 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-07 19:36:08,946 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomJoinRulesEvent
2025-01-07 19:36:08,946 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-07 19:36:08,946 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomGuestAccessEvent
2025-01-07 19:36:08,946 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomNameEvent
2025-01-07 19:36:12,684 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:38:36,216 [INFO] src.console_functions: Console received 'restart' command; restarting now.
2025-01-07 19:38:37,063 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-07 19:38:37,063 [DEBUG] __main__: Exiting configure_logging function.
2025-01-07 19:38:37,063 [DEBUG] __main__: Logging configuration complete.
2025-01-07 19:38:37,063 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-07 19:38:37,063 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:38:37,063 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-07 19:38:37,063 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-07 19:38:37,063 [DEBUG] __main__: Entering start_console_thread function.
2025-01-07 19:38:37,066 [INFO] __main__: Console thread started successfully.
2025-01-07 19:38:37,066 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-07 19:38:37,066 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-07 19:38:37,066 [INFO] __main__: Starting main_logic coroutine.
2025-01-07 19:38:37,066 [DEBUG] __main__: Entering main_logic function...
2025-01-07 19:38:37,066 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-07 19:38:37,068 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-07 19:38:37,068 [INFO] src.luna_functions: Using saved token for user @lunabot:localhost.
2025-01-07 19:38:37,068 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-07 19:38:37,071 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:38:37,093 [INFO] nio.client.base_client: New joined room !HPrbJYfQkoGnlztkrS:localhost
2025-01-07 19:38:37,093 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomCreateEvent
2025-01-07 19:38:37,093 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type PowerLevelsEvent
2025-01-07 19:38:37,093 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-07 19:38:37,093 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomJoinRulesEvent
2025-01-07 19:38:37,093 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-07 19:38:37,093 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomGuestAccessEvent
2025-01-07 19:38:37,093 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomNameEvent
2025-01-07 19:42:39,071 [WARNING] __main__: KeyboardInterrupt received. Shutting down Director.
2025-01-07 19:42:39,073 [DEBUG] __main__: Preparing to close the event loop.
2025-01-07 19:42:39,074 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-07 19:42:39,161 [ERROR] asyncio: Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x10c1f2e40>
2025-01-07 19:42:41,145 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-07 19:42:41,145 [DEBUG] __main__: Exiting configure_logging function.
2025-01-07 19:42:41,145 [DEBUG] __main__: Logging configuration complete.
2025-01-07 19:42:41,145 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-07 19:42:41,145 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:42:41,145 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-07 19:42:41,145 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-07 19:42:41,145 [DEBUG] __main__: Entering start_console_thread function.
2025-01-07 19:42:41,147 [INFO] __main__: Console thread started successfully.
2025-01-07 19:42:41,148 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-07 19:42:41,148 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-07 19:42:41,148 [INFO] __main__: Starting main_logic coroutine.
2025-01-07 19:42:41,148 [DEBUG] __main__: Entering main_logic function...
2025-01-07 19:42:41,148 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-07 19:42:41,150 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-07 19:42:41,150 [INFO] src.luna_functions: Using saved token for user @lunabot:localhost.
2025-01-07 19:42:41,150 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-07 19:42:41,153 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:42:41,178 [INFO] nio.client.base_client: New joined room !HPrbJYfQkoGnlztkrS:localhost
2025-01-07 19:42:41,178 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomCreateEvent
2025-01-07 19:42:41,178 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type PowerLevelsEvent
2025-01-07 19:42:41,178 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-07 19:42:41,178 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomJoinRulesEvent
2025-01-07 19:42:41,178 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-07 19:42:41,178 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomGuestAccessEvent
2025-01-07 19:42:41,178 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomNameEvent
2025-01-07 19:42:58,333 [WARNING] __main__: KeyboardInterrupt received. Shutting down Director.
2025-01-07 19:42:58,333 [DEBUG] __main__: Preparing to close the event loop.
2025-01-07 19:42:58,333 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-07 19:42:58,409 [ERROR] asyncio: Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x10d84eba0>
2025-01-07 19:43:00,363 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-07 19:43:00,364 [DEBUG] __main__: Exiting configure_logging function.
2025-01-07 19:43:00,364 [DEBUG] __main__: Logging configuration complete.
2025-01-07 19:43:00,364 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-07 19:43:00,364 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:43:00,364 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-07 19:43:00,364 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-07 19:43:00,364 [DEBUG] __main__: Entering start_console_thread function.
2025-01-07 19:43:00,367 [INFO] __main__: Console thread started successfully.
2025-01-07 19:43:00,367 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-07 19:43:00,367 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-07 19:43:00,367 [INFO] __main__: Starting main_logic coroutine.
2025-01-07 19:43:00,369 [DEBUG] __main__: Entering main_logic function...
2025-01-07 19:43:00,369 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-07 19:43:00,369 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-07 19:43:00,369 [INFO] src.luna_functions: Using saved token for user @lunabot:localhost.
2025-01-07 19:43:00,369 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-07 19:43:00,372 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:43:00,383 [INFO] nio.client.base_client: New joined room !HPrbJYfQkoGnlztkrS:localhost
2025-01-07 19:43:00,384 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomCreateEvent
2025-01-07 19:43:00,384 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type PowerLevelsEvent
2025-01-07 19:43:00,384 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-07 19:43:00,384 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomJoinRulesEvent
2025-01-07 19:43:00,384 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-07 19:43:00,384 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomGuestAccessEvent
2025-01-07 19:43:00,384 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomNameEvent
2025-01-07 19:45:01,202 [WARNING] __main__: KeyboardInterrupt received. Shutting down Director.
2025-01-07 19:45:01,202 [DEBUG] __main__: Preparing to close the event loop.
2025-01-07 19:45:01,202 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-07 19:45:01,274 [ERROR] asyncio: Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x10f8c2ba0>
2025-01-07 19:45:03,091 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-07 19:45:03,091 [DEBUG] __main__: Exiting configure_logging function.
2025-01-07 19:45:03,091 [DEBUG] __main__: Logging configuration complete.
2025-01-07 19:45:03,091 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-07 19:45:03,091 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:45:03,091 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-07 19:45:03,091 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-07 19:45:03,091 [DEBUG] __main__: Entering start_console_thread function.
2025-01-07 19:45:03,094 [INFO] __main__: Console thread started successfully.
2025-01-07 19:45:03,094 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-07 19:45:03,094 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-07 19:45:03,094 [INFO] __main__: Starting main_logic coroutine.
2025-01-07 19:45:03,094 [DEBUG] __main__: Entering main_logic function...
2025-01-07 19:45:03,094 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-07 19:45:03,096 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-07 19:45:03,096 [INFO] src.luna_functions: Using saved token for user @lunabot:localhost.
2025-01-07 19:45:03,096 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-07 19:45:03,100 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:45:03,120 [INFO] nio.client.base_client: New joined room !HPrbJYfQkoGnlztkrS:localhost
2025-01-07 19:45:03,120 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomCreateEvent
2025-01-07 19:45:03,120 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type PowerLevelsEvent
2025-01-07 19:45:03,120 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-07 19:45:03,120 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomJoinRulesEvent
2025-01-07 19:45:03,120 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-07 19:45:03,120 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomGuestAccessEvent
2025-01-07 19:45:03,120 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomNameEvent
2025-01-07 19:45:06,467 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:46:23,129 [INFO] src.console_functions: Console received 'restart' command; restarting now.
2025-01-07 19:46:24,171 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-07 19:46:24,171 [DEBUG] __main__: Exiting configure_logging function.
2025-01-07 19:46:24,171 [DEBUG] __main__: Logging configuration complete.
2025-01-07 19:46:24,171 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-07 19:46:24,171 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:46:24,171 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-07 19:46:24,171 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-07 19:46:24,171 [DEBUG] __main__: Entering start_console_thread function.
2025-01-07 19:46:24,174 [INFO] __main__: Console thread started successfully.
2025-01-07 19:46:24,174 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-07 19:46:24,174 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-07 19:46:24,174 [INFO] __main__: Starting main_logic coroutine.
2025-01-07 19:46:24,175 [DEBUG] __main__: Entering main_logic function...
2025-01-07 19:46:24,175 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-07 19:46:24,177 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-07 19:46:24,177 [INFO] src.luna_functions: Using saved token for user @lunabot:localhost.
2025-01-07 19:46:24,177 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-07 19:46:24,181 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:46:24,190 [INFO] nio.client.base_client: New joined room !HPrbJYfQkoGnlztkrS:localhost
2025-01-07 19:46:24,193 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomCreateEvent
2025-01-07 19:46:24,193 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type PowerLevelsEvent
2025-01-07 19:46:24,193 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-07 19:46:24,194 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomJoinRulesEvent
2025-01-07 19:46:24,194 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-07 19:46:24,194 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomGuestAccessEvent
2025-01-07 19:46:24,194 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomNameEvent
2025-01-07 19:46:25,283 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:46:47,608 [INFO] src.console_functions: Console received 'restart' command; restarting now.
2025-01-07 19:46:48,475 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-07 19:46:48,475 [DEBUG] __main__: Exiting configure_logging function.
2025-01-07 19:46:48,475 [DEBUG] __main__: Logging configuration complete.
2025-01-07 19:46:48,475 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-07 19:46:48,475 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:46:48,475 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-07 19:46:48,475 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-07 19:46:48,475 [DEBUG] __main__: Entering start_console_thread function.
2025-01-07 19:46:48,478 [INFO] __main__: Console thread started successfully.
2025-01-07 19:46:48,478 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-07 19:46:48,478 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-07 19:46:48,478 [INFO] __main__: Starting main_logic coroutine.
2025-01-07 19:46:48,478 [DEBUG] __main__: Entering main_logic function...
2025-01-07 19:46:48,478 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-07 19:46:48,480 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-07 19:46:48,480 [INFO] src.luna_functions: Using saved token for user @lunabot:localhost.
2025-01-07 19:46:48,481 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-07 19:46:48,484 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:46:48,497 [INFO] nio.client.base_client: New joined room !HPrbJYfQkoGnlztkrS:localhost
2025-01-07 19:46:48,497 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomCreateEvent
2025-01-07 19:46:48,497 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type PowerLevelsEvent
2025-01-07 19:46:48,497 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-07 19:46:48,497 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomJoinRulesEvent
2025-01-07 19:46:48,497 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-07 19:46:48,497 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomGuestAccessEvent
2025-01-07 19:46:48,497 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomNameEvent
2025-01-07 19:46:49,628 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:47:04,546 [INFO] src.console_functions: Console received 'restart' command; restarting now.
2025-01-07 19:47:05,465 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-07 19:47:05,465 [DEBUG] __main__: Exiting configure_logging function.
2025-01-07 19:47:05,465 [DEBUG] __main__: Logging configuration complete.
2025-01-07 19:47:05,465 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-07 19:47:05,465 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:47:05,465 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-07 19:47:05,465 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-07 19:47:05,465 [DEBUG] __main__: Entering start_console_thread function.
2025-01-07 19:47:05,468 [INFO] __main__: Console thread started successfully.
2025-01-07 19:47:05,468 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-07 19:47:05,468 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-07 19:47:05,468 [INFO] __main__: Starting main_logic coroutine.
2025-01-07 19:47:05,468 [DEBUG] __main__: Entering main_logic function...
2025-01-07 19:47:05,468 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-07 19:47:05,470 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-07 19:47:05,470 [INFO] src.luna_functions: Using saved token for user @lunabot:localhost.
2025-01-07 19:47:05,470 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-07 19:47:05,474 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:47:05,498 [INFO] nio.client.base_client: New joined room !HPrbJYfQkoGnlztkrS:localhost
2025-01-07 19:47:05,498 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomCreateEvent
2025-01-07 19:47:05,498 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type PowerLevelsEvent
2025-01-07 19:47:05,498 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-07 19:47:05,498 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomJoinRulesEvent
2025-01-07 19:47:05,498 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-07 19:47:05,498 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomGuestAccessEvent
2025-01-07 19:47:05,498 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomNameEvent
2025-01-07 19:47:06,212 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:48:47,848 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:51:28,795 [INFO] src.console_functions: Console received 'restart' command; restarting now.
2025-01-07 19:51:29,713 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-07 19:51:29,714 [DEBUG] __main__: Exiting configure_logging function.
2025-01-07 19:51:29,714 [DEBUG] __main__: Logging configuration complete.
2025-01-07 19:51:29,714 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-07 19:51:29,714 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:51:29,714 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-07 19:51:29,714 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-07 19:51:29,714 [DEBUG] __main__: Entering start_console_thread function.
2025-01-07 19:51:29,716 [INFO] __main__: Console thread started successfully.
2025-01-07 19:51:29,716 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-07 19:51:29,716 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-07 19:51:29,716 [INFO] __main__: Starting main_logic coroutine.
2025-01-07 19:51:29,716 [DEBUG] __main__: Entering main_logic function...
2025-01-07 19:51:29,716 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-07 19:51:29,718 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-07 19:51:29,718 [INFO] src.luna_functions: Using saved token for user @lunabot:localhost.
2025-01-07 19:51:29,718 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-07 19:51:29,722 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:51:29,740 [INFO] nio.client.base_client: New joined room !HPrbJYfQkoGnlztkrS:localhost
2025-01-07 19:51:29,740 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomCreateEvent
2025-01-07 19:51:29,740 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type PowerLevelsEvent
2025-01-07 19:51:29,740 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-07 19:51:29,740 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomJoinRulesEvent
2025-01-07 19:51:29,740 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-07 19:51:29,740 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomGuestAccessEvent
2025-01-07 19:51:29,740 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomNameEvent
2025-01-07 19:51:44,359 [WARNING] __main__: KeyboardInterrupt received. Shutting down Director.
2025-01-07 19:51:44,359 [DEBUG] __main__: Preparing to close the event loop.
2025-01-07 19:51:44,359 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-07 19:51:44,455 [ERROR] asyncio: Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x11a66b0e0>
2025-01-07 19:51:46,663 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-07 19:51:46,663 [DEBUG] __main__: Exiting configure_logging function.
2025-01-07 19:51:46,663 [DEBUG] __main__: Logging configuration complete.
2025-01-07 19:51:46,663 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-07 19:51:46,663 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:51:46,663 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-07 19:51:46,663 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-07 19:51:46,663 [DEBUG] __main__: Entering start_console_thread function.
2025-01-07 19:51:46,666 [INFO] __main__: Console thread started successfully.
2025-01-07 19:51:46,666 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-07 19:51:46,666 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-07 19:51:46,666 [INFO] __main__: Starting main_logic coroutine.
2025-01-07 19:51:46,666 [DEBUG] __main__: Entering main_logic function...
2025-01-07 19:51:46,666 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-07 19:51:46,668 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-07 19:51:46,668 [INFO] src.luna_functions: Using saved token for user @lunabot:localhost.
2025-01-07 19:51:46,668 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-07 19:51:46,672 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:51:46,683 [INFO] nio.client.base_client: New joined room !HPrbJYfQkoGnlztkrS:localhost
2025-01-07 19:51:46,683 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomCreateEvent
2025-01-07 19:51:46,683 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type PowerLevelsEvent
2025-01-07 19:51:46,683 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-07 19:51:46,684 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomJoinRulesEvent
2025-01-07 19:51:46,684 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-07 19:51:46,684 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomGuestAccessEvent
2025-01-07 19:51:46,684 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomNameEvent
2025-01-07 19:51:48,615 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:51:58,226 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:58:52,583 [INFO] src.console_apparatus: User exited the console (EOF or KeyboardInterrupt).
2025-01-07 19:58:54,961 [WARNING] __main__: KeyboardInterrupt received. Shutting down Director.
2025-01-07 19:58:54,962 [DEBUG] __main__: Preparing to close the event loop.
2025-01-07 19:58:54,962 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-07 19:58:55,040 [ERROR] asyncio: Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x10dfcb0e0>
2025-01-07 19:58:57,278 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-07 19:58:57,278 [DEBUG] __main__: Exiting configure_logging function.
2025-01-07 19:58:57,278 [DEBUG] __main__: Logging configuration complete.
2025-01-07 19:58:57,278 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-07 19:58:57,278 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:58:57,278 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-07 19:58:57,278 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-07 19:58:57,278 [DEBUG] __main__: Entering start_console_thread function.
2025-01-07 19:58:57,280 [INFO] __main__: Console thread started successfully.
2025-01-07 19:58:57,280 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-07 19:58:57,280 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-07 19:58:57,280 [INFO] __main__: Starting main_logic coroutine.
2025-01-07 19:58:57,280 [DEBUG] __main__: Entering main_logic function...
2025-01-07 19:58:57,280 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-07 19:58:57,282 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-07 19:58:57,282 [INFO] src.luna_functions: Using saved token for user @lunabot:localhost.
2025-01-07 19:58:57,282 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-07 19:58:57,286 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:58:57,305 [INFO] nio.client.base_client: New joined room !HPrbJYfQkoGnlztkrS:localhost
2025-01-07 19:58:57,305 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomCreateEvent
2025-01-07 19:58:57,305 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type PowerLevelsEvent
2025-01-07 19:58:57,305 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-07 19:58:57,305 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomJoinRulesEvent
2025-01-07 19:58:57,305 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-07 19:58:57,305 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomGuestAccessEvent
2025-01-07 19:58:57,305 [INFO] nio.rooms: Room !HPrbJYfQkoGnlztkrS:localhost handling event of type RoomNameEvent
2025-01-07 19:59:00,348 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:59:04,373 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:59:07,120 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:59:10,039 [INFO] src.console_functions: Console screen cleared.
2025-01-07 19:59:10,040 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:59:11,529 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 19:59:17,561 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 20:00:45,126 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 20:00:45,129 [INFO] src.luna_functions: Creating user @bob:localhost, admin=False via http://localhost:8008/_synapse/admin/v2/users/@bob:localhost
2025-01-07 20:00:45,402 [INFO] src.luna_functions: Created user @bob:localhost (HTTP 201)
2025-01-07 20:00:49,875 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 20:00:55,149 [INFO] src.console_functions: Console screen cleared.
2025-01-07 20:00:55,149 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 20:01:02,072 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 20:01:04,411 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 20:01:17,867 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 20:01:17,916 [INFO] src.luna_functions: Successfully invited @bob:localhost to !HPrbJYfQkoGnlztkrS:localhost.
2025-01-07 20:01:23,580 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 21:05:12,774 [DEBUG] src.console_functions: Showing help to user.
2025-01-07 21:05:12,779 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 21:05:20,523 [INFO] src.console_functions: Console received 'fetch_all' command. Blocking until done...
2025-01-07 21:05:20,524 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 21:05:20,524 [INFO] src.luna_functions: No room_ids specified. Using all joined rooms: ['!HPrbJYfQkoGnlztkrS:localhost']
2025-01-07 21:05:20,524 [INFO] src.luna_functions: Fetching *all* messages for room: !HPrbJYfQkoGnlztkrS:localhost
2025-01-07 21:05:20,563 [DEBUG] src.luna_functions: Fetched 8 messages this page for room=!HPrbJYfQkoGnlztkrS:localhost, new end=t1-25_0_0_0_0_0_0_0_0_0
2025-01-07 21:05:20,831 [INFO] src.luna_functions: No more chunk for !HPrbJYfQkoGnlztkrS:localhost, done paging.
2025-01-07 21:05:20,858 [INFO] src.luna_functions: Fetched total 0 messages across 1 room(s).
2025-01-07 21:05:20,863 [INFO] src.luna_functions: Wrote all records to new CSV luna_messages.csv.
2025-01-07 22:30:09,827 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-07 22:30:09,828 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-07 22:30:10,032 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-07 22:30:10,437 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-07 22:30:11,248 [WARNING] nio.client.async_client: Timed out, sleeping for 1s
2025-01-07 22:30:12,851 [WARNING] nio.client.async_client: Timed out, sleeping for 3s
2025-01-07 22:30:14,501 [INFO] src.console_functions: Console received 'exit' command; requesting shutdown.
2025-01-07 22:30:14,501 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-07 22:30:14,501 [ERROR] __main__: An unexpected exception occurred in main_logic: Event loop stopped before Future completed.
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 135, in luna
    loop.run_until_complete(main_logic())
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 718, in run_until_complete
    raise RuntimeError('Event loop stopped before Future completed.')
RuntimeError: Event loop stopped before Future completed.
2025-01-07 22:30:14,505 [DEBUG] __main__: Preparing to close the event loop.
2025-01-07 22:30:14,505 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-07 22:30:14,597 [ERROR] asyncio: Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x10c513230>
