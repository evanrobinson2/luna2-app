2025-01-09 20:03:37,669 [INFO] src.console_functions: Log rotation complete. Logging to server.log again.
2025-01-09 20:03:37,669 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 20:03:41,999 [INFO] src.console_functions: Console received 'exit' command; requesting shutdown.
2025-01-09 20:03:42,000 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 20:03:42,000 [ERROR] __main__: An unexpected exception occurred in main_logic: Event loop stopped before Future completed.
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 139, in luna
    loop.run_until_complete(main_logic())
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 718, in run_until_complete
    raise RuntimeError('Event loop stopped before Future completed.')
RuntimeError: Event loop stopped before Future completed.
2025-01-09 20:03:42,005 [DEBUG] __main__: Preparing to close the event loop.
2025-01-09 20:03:42,006 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-09 20:03:44,328 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-09 20:03:44,328 [DEBUG] __main__: Exiting configure_logging function.
2025-01-09 20:03:44,328 [DEBUG] __main__: Logging configuration complete.
2025-01-09 20:03:44,328 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-09 20:03:44,328 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 20:03:44,328 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-09 20:03:44,328 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-09 20:03:44,328 [DEBUG] __main__: Entering start_console_thread function.
2025-01-09 20:03:44,331 [INFO] __main__: Console thread started successfully.
2025-01-09 20:03:44,331 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-09 20:03:44,331 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-09 20:03:44,331 [INFO] __main__: Starting main_logic coroutine.
2025-01-09 20:03:44,331 [DEBUG] __main__: Entering main_logic function...
2025-01-09 20:03:44,331 [DEBUG] src.luna_functions: Found director_token.json; attempting token-based login.
2025-01-09 20:03:44,333 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-09 20:03:44,342 [INFO] src.luna_functions: Token-based login verified for user @lunabot:localhost.
2025-01-09 20:03:44,342 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-09 20:03:44,349 [INFO] nio.client.base_client: New joined room !fhmXoYxDdsImUkYUpf:localhost
2025-01-09 20:03:44,349 [INFO] src.console_functions: Console screen cleared.
2025-01-09 20:03:44,349 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomCreateEvent
2025-01-09 20:03:44,349 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type PowerLevelsEvent
2025-01-09 20:03:44,349 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-09 20:03:44,349 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomJoinRulesEvent
2025-01-09 20:03:44,349 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-09 20:03:44,349 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomNameEvent
2025-01-09 20:03:44,349 [INFO] nio.client.base_client: New joined room !wksSOEXmjceGUTMkdv:localhost
2025-01-09 20:03:44,349 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type PowerLevelsEvent
2025-01-09 20:03:44,349 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomGuestAccessEvent
2025-01-09 20:03:44,349 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomCreateEvent
2025-01-09 20:03:44,349 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-09 20:03:44,349 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomJoinRulesEvent
2025-01-09 20:03:44,349 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:03:44,351 [DEBUG] src.luna_functions_handledispatch: Loaded existing CSV with 17 records.
2025-01-09 20:03:44,351 [INFO] src.luna_functions_handledispatch: Duplicate message $YEEE6Eu4D4oq94dRx0-eR5_XkGp-FLUrfJuhz3iNNxM found. Skipping append.
2025-01-09 20:03:44,351 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-09 20:03:44,351 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-09 20:03:44,351 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-09 20:03:44,351 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:03:44,352 [DEBUG] src.luna_functions_handledispatch: Loaded existing CSV with 17 records.
2025-01-09 20:03:44,352 [INFO] src.luna_functions_handledispatch: Duplicate message $bRmC9-BIuYA2PaFJAo1QMlliLnmee43ZUvJnPNUmqsE found. Skipping append.
2025-01-09 20:03:44,352 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-09 20:03:44,352 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-09 20:03:44,352 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-09 20:03:44,352 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:03:44,353 [DEBUG] src.luna_functions_handledispatch: Loaded existing CSV with 17 records.
2025-01-09 20:03:44,353 [INFO] src.luna_functions_handledispatch: Duplicate message $4EGQtPe7EEejPIQJ1NpSyWwi2iZNtCKEPjDzw927_PM found. Skipping append.
2025-01-09 20:03:44,353 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-09 20:03:44,353 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-09 20:03:44,353 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-09 20:03:44,353 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:03:44,353 [DEBUG] src.luna_functions_handledispatch: Loaded existing CSV with 17 records.
2025-01-09 20:03:44,353 [INFO] src.luna_functions_handledispatch: Duplicate message $Ppx1ZDpCG2Wrd5hIthbCcpJtxEv9l99Ct5Z2yHsmv0k found. Skipping append.
2025-01-09 20:03:44,354 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-09 20:03:44,354 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-09 20:03:44,354 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-09 20:03:44,354 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:03:44,354 [DEBUG] src.luna_functions_handledispatch: Loaded existing CSV with 17 records.
2025-01-09 20:03:44,355 [INFO] src.luna_functions_handledispatch: Duplicate message $p-I9SGwrIIzim4AIrdkKXanrZljCgelOcIbxEUrnlEA found. Skipping append.
2025-01-09 20:03:44,355 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-09 20:03:44,355 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-09 20:03:44,355 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-09 20:03:44,355 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:03:44,355 [DEBUG] src.luna_functions_handledispatch: Loaded existing CSV with 17 records.
2025-01-09 20:03:44,355 [INFO] src.luna_functions_handledispatch: Duplicate message $z18Rz0OiJyKqQXeSFpr0OS1_OJ8bFBsGwlgylUYpAmc found. Skipping append.
2025-01-09 20:03:44,355 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-09 20:03:44,355 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-09 20:03:44,355 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-09 20:03:44,355 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:03:44,356 [DEBUG] src.luna_functions_handledispatch: Loaded existing CSV with 17 records.
2025-01-09 20:03:44,356 [INFO] src.luna_functions_handledispatch: Duplicate message $ekEex5aE0TJL8UEe9jfRSR3UJ9bwnucsVOoI6ssKOGg found. Skipping append.
2025-01-09 20:03:44,356 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-09 20:03:44,356 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-09 20:03:44,356 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-09 20:03:44,356 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:03:44,357 [DEBUG] src.luna_functions_handledispatch: Loaded existing CSV with 17 records.
2025-01-09 20:03:44,357 [INFO] src.luna_functions_handledispatch: Duplicate message $yLdlqQlvJRDFHqNWENgE52Gn6xAe01FfjB9KuZIuAkk found. Skipping append.
2025-01-09 20:03:44,357 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-09 20:03:44,357 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-09 20:03:44,357 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-09 20:03:44,357 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:03:44,357 [DEBUG] src.luna_functions_handledispatch: Loaded existing CSV with 17 records.
2025-01-09 20:03:44,357 [INFO] src.luna_functions_handledispatch: Duplicate message $c_MbmkjPqtyy8oKBRehD9VMqfP6MVetBFuJVDB5DU5k found. Skipping append.
2025-01-09 20:03:44,357 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-09 20:03:44,357 [DEBUG] src.luna_functions_handledispatch: m.mentions => {'user_ids': ['@lunabot:localhost']}
2025-01-09 20:03:44,358 [INFO] src.luna_functions_handledispatch: Mentioned user_ids => ['@lunabot:localhost']
2025-01-09 20:03:44,358 [INFO] src.luna_functions_handledispatch: Processing mention for user => @lunabot:localhost
2025-01-09 20:03:44,377 [DEBUG] openai._base_client: Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': 'You are a helpful bot responding to a mention of @lunabot:localhost.'}, {'role': 'user', 'content': 'lunabot: are you there?'}], 'model': 'gpt-4', 'max_tokens': 300, 'temperature': 0.7}}
2025-01-09 20:03:44,381 [DEBUG] httpcore.connection: connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2025-01-09 20:03:44,416 [DEBUG] httpcore.connection: connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10e8102f0>
2025-01-09 20:03:44,416 [DEBUG] httpcore.connection: start_tls.started ssl_context=<ssl.SSLContext object at 0x106633800> server_hostname='api.openai.com' timeout=5.0
2025-01-09 20:03:44,446 [DEBUG] httpcore.connection: start_tls.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10e76fb10>
2025-01-09 20:03:44,446 [DEBUG] httpcore.http11: send_request_headers.started request=<Request [b'POST']>
2025-01-09 20:03:44,446 [DEBUG] httpcore.http11: send_request_headers.complete
2025-01-09 20:03:44,446 [DEBUG] httpcore.http11: send_request_body.started request=<Request [b'POST']>
2025-01-09 20:03:44,447 [DEBUG] httpcore.http11: send_request_body.complete
2025-01-09 20:03:44,447 [DEBUG] httpcore.http11: receive_response_headers.started request=<Request [b'POST']>
2025-01-09 20:03:44,483 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 20:03:45,804 [DEBUG] httpcore.http11: receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Fri, 10 Jan 2025 01:03:45 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-yzbp3micnvwwjimbcblinra3'), (b'openai-processing-ms', b'1203'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'5000'), (b'x-ratelimit-limit-tokens', b'80000'), (b'x-ratelimit-remaining-requests', b'4999'), (b'x-ratelimit-remaining-tokens', b'79675'), (b'x-ratelimit-reset-requests', b'12ms'), (b'x-ratelimit-reset-tokens', b'243ms'), (b'x-request-id', b'req_b7a5e964ea6e90e2c6db6fc5016708dd'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=XdBhJrPTkyP5ma6kTnpBm4xVIoegNz4rePmvVNXswO4-1736471025-1.0.1.1-2sxSxLax0gjav4LXjmifS4x2g0I1GDWF3B_UOMvnyoILXglzMrPsVs43yfK8p9g8TJcFpHes_4zthRntsOlLpw; path=/; expires=Fri, 10-Jan-25 01:33:45 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=3TQiGbjdHWBgx6veSuAag4D_wWPThAgqRDCLxMy6os4-1736471025770-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8ff8bfbf38c0c997-IAD'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2025-01-09 20:03:45,806 [INFO] httpx: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-09 20:03:45,807 [DEBUG] httpcore.http11: receive_response_body.started request=<Request [b'POST']>
2025-01-09 20:03:45,807 [DEBUG] httpcore.http11: receive_response_body.complete
2025-01-09 20:03:45,807 [DEBUG] httpcore.http11: response_closed.started
2025-01-09 20:03:45,807 [DEBUG] httpcore.http11: response_closed.complete
2025-01-09 20:03:45,808 [DEBUG] openai._base_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "200 OK"
2025-01-09 20:03:45,813 [INFO] src.luna_functions_handledispatch: GPT reply (for mention @lunabot:localhost) => Yes, I'm here! How can I assist you today?
2025-01-09 20:03:45,846 [INFO] src.luna_functions: Posted GPT reply to room !wksSOEXmjceGUTMkdv:localhost
2025-01-09 20:03:45,846 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:03:45,856 [DEBUG] src.luna_functions_handledispatch: Loaded existing CSV with 17 records.
2025-01-09 20:03:45,857 [INFO] src.luna_functions_handledispatch: Duplicate message $kM_TlgcCb7bvfWL-3ri4cRls6sM4xy8_hpPEgeCKv9U found. Skipping append.
2025-01-09 20:03:45,857 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-09 20:03:45,857 [DEBUG] src.luna_functions_handledispatch: m.mentions => {'user_ids': ['@lunabot:localhost']}
2025-01-09 20:03:45,857 [INFO] src.luna_functions_handledispatch: Mentioned user_ids => ['@lunabot:localhost']
2025-01-09 20:03:45,857 [INFO] src.luna_functions_handledispatch: Processing mention for user => @lunabot:localhost
2025-01-09 20:03:45,860 [DEBUG] openai._base_client: Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': 'You are a helpful bot responding to a mention of @lunabot:localhost.'}, {'role': 'user', 'content': 'lunabot: hello?'}], 'model': 'gpt-4', 'max_tokens': 300, 'temperature': 0.7}}
2025-01-09 20:03:45,861 [DEBUG] httpcore.http11: send_request_headers.started request=<Request [b'POST']>
2025-01-09 20:03:45,862 [DEBUG] httpcore.http11: send_request_headers.complete
2025-01-09 20:03:45,862 [DEBUG] httpcore.http11: send_request_body.started request=<Request [b'POST']>
2025-01-09 20:03:45,862 [DEBUG] httpcore.http11: send_request_body.complete
2025-01-09 20:03:45,862 [DEBUG] httpcore.http11: receive_response_headers.started request=<Request [b'POST']>
2025-01-09 20:03:46,826 [DEBUG] httpcore.http11: receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Fri, 10 Jan 2025 01:03:46 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-yzbp3micnvwwjimbcblinra3'), (b'openai-processing-ms', b'833'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'5000'), (b'x-ratelimit-limit-tokens', b'80000'), (b'x-ratelimit-remaining-requests', b'4999'), (b'x-ratelimit-remaining-tokens', b'79677'), (b'x-ratelimit-reset-requests', b'12ms'), (b'x-ratelimit-reset-tokens', b'242ms'), (b'x-request-id', b'req_e856c555b8021d91e1f14515b30f5559'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8ff8bfc81f5bc997-IAD'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2025-01-09 20:03:46,827 [INFO] httpx: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-09 20:03:46,828 [DEBUG] httpcore.http11: receive_response_body.started request=<Request [b'POST']>
2025-01-09 20:03:46,829 [DEBUG] httpcore.http11: receive_response_body.complete
2025-01-09 20:03:46,829 [DEBUG] httpcore.http11: response_closed.started
2025-01-09 20:03:46,829 [DEBUG] httpcore.http11: response_closed.complete
2025-01-09 20:03:46,829 [DEBUG] openai._base_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "200 OK"
2025-01-09 20:03:46,830 [INFO] src.luna_functions_handledispatch: GPT reply (for mention @lunabot:localhost) => Hello! How can I assist you today?
2025-01-09 20:03:46,863 [INFO] src.luna_functions: Posted GPT reply to room !wksSOEXmjceGUTMkdv:localhost
2025-01-09 20:03:46,867 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:03:46,870 [DEBUG] src.luna_functions_handledispatch: Loaded existing CSV with 17 records.
2025-01-09 20:03:46,870 [INFO] src.luna_functions_handledispatch: Duplicate message $WzbY0besmEOcu_IPhpEzzaNaTBvFnrnMN1YRF8h5so0 found. Skipping append.
2025-01-09 20:03:46,870 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-09 20:03:46,870 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-09 20:03:46,870 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-09 20:03:46,872 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:03:46,873 [DEBUG] src.luna_functions_handledispatch: Loaded existing CSV with 17 records.
2025-01-09 20:03:46,873 [INFO] src.luna_functions_handledispatch: Duplicate message $DLaEihTuxKbkpVZeHhzWaqNlA0SAdAuE06SPz3abmN4 found. Skipping append.
2025-01-09 20:03:46,873 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-09 20:03:46,873 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-09 20:03:46,873 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-09 20:03:46,878 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:03:46,879 [DEBUG] src.luna_functions_handledispatch: Loaded existing CSV with 17 records.
2025-01-09 20:03:46,879 [INFO] src.luna_functions_handledispatch: Duplicate message $0GTDnUCZgOFxCHFZ838XlfBypMzbS6CGF7JK_Sxl-38 found. Skipping append.
2025-01-09 20:03:46,879 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-09 20:03:46,879 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-09 20:03:46,879 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-09 20:03:46,879 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:03:46,880 [DEBUG] src.luna_functions_handledispatch: Loaded existing CSV with 17 records.
2025-01-09 20:03:46,880 [INFO] src.luna_functions_handledispatch: Duplicate message $XIstA_vCtyn7yCMOAUUDpnkoQ0pMcc6E7Qfgu3Jo78c found. Skipping append.
2025-01-09 20:03:46,880 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-09 20:03:46,880 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-09 20:03:46,880 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-09 20:03:46,884 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:03:46,885 [DEBUG] src.luna_functions_handledispatch: Loaded existing CSV with 17 records.
2025-01-09 20:03:46,887 [INFO] src.luna_functions_handledispatch: Appended new message $dFAEZlA6R4k0X9-WFW4vEGYnCQ5r7aSeDKdeSsKkc8E to luna_messages.csv.
2025-01-09 20:03:46,887 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-09 20:03:46,887 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-09 20:03:46,887 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-09 20:03:46,887 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:03:46,887 [DEBUG] src.luna_functions_handledispatch: Loaded existing CSV with 18 records.
2025-01-09 20:03:46,888 [INFO] src.luna_functions_handledispatch: Appended new message $gAiUL6DnU2XEg2GVauPry9k2UYMol1ck5LyZIgVZUSk to luna_messages.csv.
2025-01-09 20:03:46,888 [INFO] src.luna_functions_handledispatch: Handling on_room_message with multi-mention iteration approach.
2025-01-09 20:03:46,888 [DEBUG] src.luna_functions_handledispatch: m.mentions => {}
2025-01-09 20:03:46,888 [DEBUG] src.luna_functions_handledispatch: No user_ids in m.mentions => no mention recognized.
2025-01-09 20:07:17,080 [INFO] src.console_functions: Console received 'exit' command; requesting shutdown.
2025-01-09 20:07:17,081 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 20:07:17,081 [ERROR] __main__: An unexpected exception occurred in main_logic: Event loop stopped before Future completed.
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 139, in luna
    loop.run_until_complete(main_logic())
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 718, in run_until_complete
    raise RuntimeError('Event loop stopped before Future completed.')
RuntimeError: Event loop stopped before Future completed.
2025-01-09 20:07:17,087 [DEBUG] __main__: Preparing to close the event loop.
2025-01-09 20:07:17,088 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-09 20:08:44,807 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-09 20:08:44,807 [DEBUG] __main__: Exiting configure_logging function.
2025-01-09 20:08:44,807 [DEBUG] __main__: Logging configuration complete.
2025-01-09 20:08:44,807 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-09 20:08:44,808 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 20:08:44,808 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-09 20:08:44,808 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-09 20:08:44,808 [DEBUG] __main__: Entering start_console_thread function.
2025-01-09 20:08:44,811 [INFO] __main__: Console thread started successfully.
2025-01-09 20:08:44,811 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-09 20:08:44,811 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-09 20:08:44,811 [INFO] __main__: Starting main_logic coroutine.
2025-01-09 20:08:44,811 [DEBUG] __main__: Entering main_logic function...
2025-01-09 20:08:44,811 [DEBUG] src.luna_functions: Found director_token.json; attempting token-based login.
2025-01-09 20:08:44,813 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-09 20:08:44,822 [INFO] src.luna_functions: Token-based login verified for user @lunabot:localhost.
2025-01-09 20:08:44,822 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-09 20:08:44,841 [INFO] src.console_functions: Console screen cleared.
2025-01-09 20:08:44,852 [INFO] nio.client.base_client: New joined room !fhmXoYxDdsImUkYUpf:localhost
2025-01-09 20:08:44,852 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomCreateEvent
2025-01-09 20:08:44,852 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type PowerLevelsEvent
2025-01-09 20:08:44,852 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-09 20:08:44,852 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomJoinRulesEvent
2025-01-09 20:08:44,852 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-09 20:08:44,852 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomNameEvent
2025-01-09 20:08:44,852 [INFO] nio.client.base_client: New joined room !wksSOEXmjceGUTMkdv:localhost
2025-01-09 20:08:44,853 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type PowerLevelsEvent
2025-01-09 20:08:44,853 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomGuestAccessEvent
2025-01-09 20:08:44,853 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomCreateEvent
2025-01-09 20:08:44,853 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-09 20:08:44,853 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomJoinRulesEvent
2025-01-09 20:08:44,853 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:08:44,859 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:08:44,859 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:08:44,860 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:08:44,860 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:08:44,861 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:08:44,862 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:08:44,863 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:08:44,863 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:08:44,864 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:08:44,965 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 20:08:54,906 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:08:54,963 [DEBUG] openai._base_client: Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': 'You are a helpful bot responding to a mention of @lunabot:localhost.'}, {'role': 'user', 'content': ':lunabot: are you there'}], 'model': 'gpt-4', 'max_tokens': 300, 'temperature': 0.7}}
2025-01-09 20:08:54,969 [DEBUG] httpcore.connection: connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2025-01-09 20:08:55,038 [DEBUG] httpcore.connection: connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10f09e7b0>
2025-01-09 20:08:55,038 [DEBUG] httpcore.connection: start_tls.started ssl_context=<ssl.SSLContext object at 0x1067bb800> server_hostname='api.openai.com' timeout=5.0
2025-01-09 20:08:55,078 [DEBUG] httpcore.connection: start_tls.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10f067110>
2025-01-09 20:08:55,079 [DEBUG] httpcore.http11: send_request_headers.started request=<Request [b'POST']>
2025-01-09 20:08:55,079 [DEBUG] httpcore.http11: send_request_headers.complete
2025-01-09 20:08:55,079 [DEBUG] httpcore.http11: send_request_body.started request=<Request [b'POST']>
2025-01-09 20:08:55,080 [DEBUG] httpcore.http11: send_request_body.complete
2025-01-09 20:08:55,080 [DEBUG] httpcore.http11: receive_response_headers.started request=<Request [b'POST']>
2025-01-09 20:08:56,273 [DEBUG] httpcore.http11: receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Fri, 10 Jan 2025 01:08:56 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-yzbp3micnvwwjimbcblinra3'), (b'openai-processing-ms', b'1120'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'5000'), (b'x-ratelimit-limit-tokens', b'80000'), (b'x-ratelimit-remaining-requests', b'4999'), (b'x-ratelimit-remaining-tokens', b'79675'), (b'x-ratelimit-reset-requests', b'12ms'), (b'x-ratelimit-reset-tokens', b'243ms'), (b'x-request-id', b'req_8d210be26c8fae1a6f4d7a7ff9f9cc2a'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=c2SqF_DdQSt3bdQNsnEEENlnzQFJTn7uJJYAS6SHwlg-1736471336-1.0.1.1-CBquLQIDA21q7f44B636LPLwPGAq3YaaOWG3tE8I_5GoC4jAAS2sUarez9P6HoBzWjd.mgHIKZ8TCQFGYec7gQ; path=/; expires=Fri, 10-Jan-25 01:38:56 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=l0B3VCkxWe_xowBEh_jaYaxDNMutcHoHENa9z_Z1oMU-1736471336312-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8ff8c754aba4884e-IAD'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2025-01-09 20:08:56,279 [INFO] httpx: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-09 20:08:56,279 [DEBUG] httpcore.http11: receive_response_body.started request=<Request [b'POST']>
2025-01-09 20:08:56,280 [DEBUG] httpcore.http11: receive_response_body.complete
2025-01-09 20:08:56,280 [DEBUG] httpcore.http11: response_closed.started
2025-01-09 20:08:56,280 [DEBUG] httpcore.http11: response_closed.complete
2025-01-09 20:08:56,281 [DEBUG] openai._base_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "200 OK"
2025-01-09 20:08:56,325 [INFO] src.luna_functions: Posted GPT reply to room !wksSOEXmjceGUTMkdv:localhost
2025-01-09 20:08:56,336 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:09:06,322 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:09:19,657 [INFO] src.console_functions: Console received 'exit' command; requesting shutdown.
2025-01-09 20:09:19,659 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 20:09:19,659 [ERROR] __main__: An unexpected exception occurred in main_logic: Event loop stopped before Future completed.
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 139, in luna
    loop.run_until_complete(main_logic())
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 718, in run_until_complete
    raise RuntimeError('Event loop stopped before Future completed.')
RuntimeError: Event loop stopped before Future completed.
2025-01-09 20:09:19,666 [DEBUG] __main__: Preparing to close the event loop.
2025-01-09 20:09:19,666 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-09 20:09:22,125 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-09 20:09:22,125 [DEBUG] __main__: Exiting configure_logging function.
2025-01-09 20:09:22,125 [DEBUG] __main__: Logging configuration complete.
2025-01-09 20:09:22,125 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-09 20:09:22,125 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 20:09:22,126 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-09 20:09:22,126 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-09 20:09:22,126 [DEBUG] __main__: Entering start_console_thread function.
2025-01-09 20:09:22,128 [INFO] __main__: Console thread started successfully.
2025-01-09 20:09:22,128 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-09 20:09:22,128 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-09 20:09:22,128 [INFO] __main__: Starting main_logic coroutine.
2025-01-09 20:09:22,128 [DEBUG] __main__: Entering main_logic function...
2025-01-09 20:09:22,128 [DEBUG] src.luna_functions: Found director_token.json; attempting token-based login.
2025-01-09 20:09:22,130 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-09 20:09:22,139 [INFO] src.luna_functions: Token-based login verified for user @lunabot:localhost.
2025-01-09 20:09:22,139 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-09 20:09:22,142 [INFO] src.console_functions: Console screen cleared.
2025-01-09 20:09:22,146 [INFO] nio.client.base_client: New joined room !fhmXoYxDdsImUkYUpf:localhost
2025-01-09 20:09:22,146 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomCreateEvent
2025-01-09 20:09:22,146 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type PowerLevelsEvent
2025-01-09 20:09:22,146 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-09 20:09:22,146 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomJoinRulesEvent
2025-01-09 20:09:22,146 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-09 20:09:22,147 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomNameEvent
2025-01-09 20:09:22,147 [INFO] nio.client.base_client: New joined room !wksSOEXmjceGUTMkdv:localhost
2025-01-09 20:09:22,147 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type PowerLevelsEvent
2025-01-09 20:09:22,147 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomGuestAccessEvent
2025-01-09 20:09:22,147 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomCreateEvent
2025-01-09 20:09:22,147 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-09 20:09:22,147 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomJoinRulesEvent
2025-01-09 20:09:22,147 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:09:22,148 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:09:22,149 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:09:22,150 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:09:22,151 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:09:22,152 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:09:22,152 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:09:22,153 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:09:22,154 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:09:22,155 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:09:22,169 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:09:22,173 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:09:22,187 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:09:22,265 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 20:09:32,396 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:14:34,568 [INFO] src.console_functions: Console received 'exit' command; requesting shutdown.
2025-01-09 20:14:34,568 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 20:14:34,569 [ERROR] __main__: An unexpected exception occurred in main_logic: Event loop stopped before Future completed.
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 139, in luna
    loop.run_until_complete(main_logic())
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 718, in run_until_complete
    raise RuntimeError('Event loop stopped before Future completed.')
RuntimeError: Event loop stopped before Future completed.
2025-01-09 20:14:34,576 [DEBUG] __main__: Preparing to close the event loop.
2025-01-09 20:14:34,577 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-09 20:14:36,856 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-09 20:14:36,856 [DEBUG] __main__: Exiting configure_logging function.
2025-01-09 20:14:36,856 [DEBUG] __main__: Logging configuration complete.
2025-01-09 20:14:36,856 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-09 20:14:36,856 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 20:14:36,857 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-09 20:14:36,857 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-09 20:14:36,857 [DEBUG] __main__: Entering start_console_thread function.
2025-01-09 20:14:36,859 [INFO] __main__: Console thread started successfully.
2025-01-09 20:14:36,859 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-09 20:14:36,859 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-09 20:14:36,859 [INFO] __main__: Starting main_logic coroutine.
2025-01-09 20:14:36,859 [DEBUG] __main__: Entering main_logic function...
2025-01-09 20:14:36,859 [DEBUG] src.luna_functions: Found director_token.json; attempting token-based login.
2025-01-09 20:14:36,861 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-09 20:14:36,871 [INFO] src.luna_functions: Token-based login verified for user @lunabot:localhost.
2025-01-09 20:14:36,871 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-09 20:14:36,881 [INFO] src.console_functions: Console screen cleared.
2025-01-09 20:14:36,894 [INFO] nio.client.base_client: New joined room !fhmXoYxDdsImUkYUpf:localhost
2025-01-09 20:14:36,894 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomCreateEvent
2025-01-09 20:14:36,894 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type PowerLevelsEvent
2025-01-09 20:14:36,894 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-09 20:14:36,894 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomJoinRulesEvent
2025-01-09 20:14:36,895 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-09 20:14:36,895 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomNameEvent
2025-01-09 20:14:36,895 [INFO] nio.client.base_client: New joined room !wksSOEXmjceGUTMkdv:localhost
2025-01-09 20:14:36,895 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type PowerLevelsEvent
2025-01-09 20:14:36,895 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomGuestAccessEvent
2025-01-09 20:14:36,895 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomCreateEvent
2025-01-09 20:14:36,895 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-09 20:14:36,895 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomJoinRulesEvent
2025-01-09 20:14:36,895 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:14:36,897 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:14:36,898 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:14:36,899 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:14:36,899 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:14:36,900 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:14:36,901 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:14:36,901 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:14:36,902 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:14:36,903 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:14:37,013 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 20:14:50,231 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:14:50,272 [DEBUG] openai._base_client: Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': 'You are a helpful bot responding to a mention of @lunabot:localhost.'}, {'role': 'user', 'content': 'lunabot: tell me something interesting about metametals.'}], 'model': 'gpt-4', 'max_tokens': 300, 'temperature': 0.7}}
2025-01-09 20:14:50,277 [DEBUG] httpcore.connection: connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2025-01-09 20:14:50,342 [DEBUG] httpcore.connection: connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x11002a7b0>
2025-01-09 20:14:50,342 [DEBUG] httpcore.connection: start_tls.started ssl_context=<ssl.SSLContext object at 0x108397800> server_hostname='api.openai.com' timeout=5.0
2025-01-09 20:14:50,382 [DEBUG] httpcore.connection: start_tls.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10fff4410>
2025-01-09 20:14:50,382 [DEBUG] httpcore.http11: send_request_headers.started request=<Request [b'POST']>
2025-01-09 20:14:50,383 [DEBUG] httpcore.http11: send_request_headers.complete
2025-01-09 20:14:50,383 [DEBUG] httpcore.http11: send_request_body.started request=<Request [b'POST']>
2025-01-09 20:14:50,383 [DEBUG] httpcore.http11: send_request_body.complete
2025-01-09 20:14:50,383 [DEBUG] httpcore.http11: receive_response_headers.started request=<Request [b'POST']>
2025-01-09 20:14:53,953 [DEBUG] httpcore.http11: receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Fri, 10 Jan 2025 01:14:53 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-yzbp3micnvwwjimbcblinra3'), (b'openai-processing-ms', b'3486'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'5000'), (b'x-ratelimit-limit-tokens', b'80000'), (b'x-ratelimit-remaining-requests', b'4999'), (b'x-ratelimit-remaining-tokens', b'79667'), (b'x-ratelimit-reset-requests', b'12ms'), (b'x-ratelimit-reset-tokens', b'249ms'), (b'x-request-id', b'req_5d19e06557af17ec26daf99f145b736a'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=LXUchf2ektGVoU.jWCW3DnLcaYReHfgkRP.AbjybVJU-1736471693-1.0.1.1-dQg1JMqGA_9.VX30.01GfkIHhbf7.89fxK0PDEPuWYiixihcSC7o6pYtzn75MmMEwPIUeh0DSuw0RcGSs7qEvQ; path=/; expires=Fri, 10-Jan-25 01:44:53 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=sd3uKEt1Fvlq85yx6Yaksx6weRUAaPFfe_fTeFyE02E-1736471693990-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8ff8d0015a971fda-IAD'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2025-01-09 20:14:53,957 [INFO] httpx: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-09 20:14:53,958 [DEBUG] httpcore.http11: receive_response_body.started request=<Request [b'POST']>
2025-01-09 20:14:53,958 [DEBUG] httpcore.http11: receive_response_body.complete
2025-01-09 20:14:53,958 [DEBUG] httpcore.http11: response_closed.started
2025-01-09 20:14:53,959 [DEBUG] httpcore.http11: response_closed.complete
2025-01-09 20:14:53,959 [DEBUG] openai._base_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "200 OK"
2025-01-09 20:14:54,004 [INFO] src.luna_functions: Posted GPT reply to room !wksSOEXmjceGUTMkdv:localhost
2025-01-09 20:14:54,012 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:14:54,022 [DEBUG] openai._base_client: Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': 'You are Luna, a helpful assistant.'}, {'role': 'user', 'content': '@lunabot:localhost\n\nMetamaterials are artificially structured materials used to control and manipulate light, sound, and many other physical phenomena. The properties of metamaterials are derived not from their base material, but from their specifically designed structures. Their precise shape, geometry, size, orientation and arrangement give them their smart properties capable of manipulating electromagnetic waves, by blocking, absorbing, enhancing, or bending waves, to achieve benefits that go beyond what is possible with conventional materials. Interestingly, "metametals" is often used to refer to metamaterials that interact with light in the metal spectrum. They are a hot topic in the field of material science and photonics.'}], 'model': 'gpt-4', 'max_tokens': 300, 'temperature': 0.7}}
2025-01-09 20:14:54,023 [DEBUG] httpcore.http11: send_request_headers.started request=<Request [b'POST']>
2025-01-09 20:14:54,024 [DEBUG] httpcore.http11: send_request_headers.complete
2025-01-09 20:14:54,024 [DEBUG] httpcore.http11: send_request_body.started request=<Request [b'POST']>
2025-01-09 20:14:54,024 [DEBUG] httpcore.http11: send_request_body.complete
2025-01-09 20:14:54,024 [DEBUG] httpcore.http11: receive_response_headers.started request=<Request [b'POST']>
2025-01-09 20:14:58,471 [DEBUG] httpcore.http11: receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Fri, 10 Jan 2025 01:14:58 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-yzbp3micnvwwjimbcblinra3'), (b'openai-processing-ms', b'4361'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'5000'), (b'x-ratelimit-limit-tokens', b'80000'), (b'x-ratelimit-remaining-requests', b'4999'), (b'x-ratelimit-remaining-tokens', b'79505'), (b'x-ratelimit-reset-requests', b'12ms'), (b'x-ratelimit-reset-tokens', b'371ms'), (b'x-request-id', b'req_3699d0a6294bd50a058fa71a03a37331'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8ff8d01828a91fda-IAD'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2025-01-09 20:14:58,472 [INFO] httpx: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-09 20:14:58,473 [DEBUG] httpcore.http11: receive_response_body.started request=<Request [b'POST']>
2025-01-09 20:14:58,473 [DEBUG] httpcore.http11: receive_response_body.complete
2025-01-09 20:14:58,474 [DEBUG] httpcore.http11: response_closed.started
2025-01-09 20:14:58,474 [DEBUG] httpcore.http11: response_closed.complete
2025-01-09 20:14:58,474 [DEBUG] openai._base_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "200 OK"
2025-01-09 20:14:58,511 [INFO] src.luna_functions: Posted GPT reply to room !wksSOEXmjceGUTMkdv:localhost
2025-01-09 20:14:58,522 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:14:58,531 [DEBUG] openai._base_client: Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': 'You are Luna, a helpful assistant.'}, {'role': 'user', 'content': 'Absolutely correct! Metamaterials indeed offer a wide range of exciting possibilities due to their unique properties. These materials are engineered to have characteristics that are not found in naturally occurring materials. \n\nFor instance, metamaterials can be designed to affect waves of electromagnetic radiation or sound in a manner that is impossible with conventional materials. This opens up a world of potential applications, ranging from cloaking devices that could render objects invisible to sensors that can detect tiny amounts of substances.\n\n"Metametals" is a term often used to refer to a specific type of metamaterials that interact with light in the metal spectrum. These metametals can be engineered to have properties such as a negative index of refraction or the ability to enhance the resolution of optical systems.\n\nThe study of metamaterials is a rapidly evolving field and it\'s exciting to think about what future developments might bring.'}], 'model': 'gpt-4', 'max_tokens': 300, 'temperature': 0.7}}
2025-01-09 20:14:58,532 [DEBUG] httpcore.http11: send_request_headers.started request=<Request [b'POST']>
2025-01-09 20:14:58,532 [DEBUG] httpcore.http11: send_request_headers.complete
2025-01-09 20:14:58,532 [DEBUG] httpcore.http11: send_request_body.started request=<Request [b'POST']>
2025-01-09 20:14:58,532 [DEBUG] httpcore.http11: send_request_body.complete
2025-01-09 20:14:58,532 [DEBUG] httpcore.http11: receive_response_headers.started request=<Request [b'POST']>
2025-01-09 20:15:12,609 [DEBUG] httpcore.http11: receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Fri, 10 Jan 2025 01:15:12 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-yzbp3micnvwwjimbcblinra3'), (b'openai-processing-ms', b'13997'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'5000'), (b'x-ratelimit-limit-tokens', b'80000'), (b'x-ratelimit-remaining-requests', b'4999'), (b'x-ratelimit-remaining-tokens', b'79448'), (b'x-ratelimit-reset-requests', b'12ms'), (b'x-ratelimit-reset-tokens', b'414ms'), (b'x-request-id', b'req_8464b6aa6493dcd2de9347a8e3e4a747'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8ff8d0344caf1fda-IAD'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2025-01-09 20:15:12,611 [INFO] httpx: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-09 20:15:12,611 [DEBUG] httpcore.http11: receive_response_body.started request=<Request [b'POST']>
2025-01-09 20:15:12,622 [DEBUG] httpcore.http11: receive_response_body.complete
2025-01-09 20:15:12,622 [DEBUG] httpcore.http11: response_closed.started
2025-01-09 20:15:12,622 [DEBUG] httpcore.http11: response_closed.complete
2025-01-09 20:15:12,623 [DEBUG] openai._base_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "200 OK"
2025-01-09 20:15:12,655 [INFO] src.luna_functions: Posted GPT reply to room !wksSOEXmjceGUTMkdv:localhost
2025-01-09 20:15:12,668 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:15:12,674 [DEBUG] openai._base_client: Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': 'You are Luna, a helpful assistant.'}, {'role': 'user', 'content': 'Absolutely, the future of metamaterials is indeed very exciting and holds limitless potential. To add on, some other potential applications of metamaterials may include superlenses which could improve microscopes, making them powerful enough to see viruses directly. They could also be used to improve wireless internet, making it faster and more reliable.\n\nMoreover, they could potentially be used in the medical field for improving imaging and treatments. For example, with metamaterials, it might be possible to create a "perfect lens" that could focus light to a point smaller than its wavelength, which could revolutionize the field of optics and microscopy.\n\nFurthermore, they could also be used to create more efficient solar panels, stealth technology for military aircraft, and even soundproofing materials. But these are just a few examples, the potential applications of metamaterials are really only limited by our imagination. \n\nThe ongoing research in this field is indeed very exciting, and it will be interesting to see what new innovations and applications will come in the future.'}], 'model': 'gpt-4', 'max_tokens': 300, 'temperature': 0.7}}
2025-01-09 20:15:12,675 [DEBUG] httpcore.http11: send_request_headers.started request=<Request [b'POST']>
2025-01-09 20:15:12,676 [DEBUG] httpcore.http11: send_request_headers.complete
2025-01-09 20:15:12,676 [DEBUG] httpcore.http11: send_request_body.started request=<Request [b'POST']>
2025-01-09 20:15:12,676 [DEBUG] httpcore.http11: send_request_body.complete
2025-01-09 20:15:12,676 [DEBUG] httpcore.http11: receive_response_headers.started request=<Request [b'POST']>
2025-01-09 20:15:17,793 [DEBUG] httpcore.http11: receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Fri, 10 Jan 2025 01:15:17 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-yzbp3micnvwwjimbcblinra3'), (b'openai-processing-ms', b'5049'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'5000'), (b'x-ratelimit-limit-tokens', b'80000'), (b'x-ratelimit-remaining-requests', b'4999'), (b'x-ratelimit-remaining-tokens', b'79415'), (b'x-ratelimit-reset-requests', b'12ms'), (b'x-ratelimit-reset-tokens', b'438ms'), (b'x-request-id', b'req_03a59e35c5fd08940d2c5aa7578d770a'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8ff8d08caed51fda-IAD'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2025-01-09 20:15:17,794 [INFO] httpx: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-09 20:15:17,794 [DEBUG] httpcore.http11: receive_response_body.started request=<Request [b'POST']>
2025-01-09 20:15:17,795 [DEBUG] httpcore.http11: receive_response_body.complete
2025-01-09 20:15:17,795 [DEBUG] httpcore.http11: response_closed.started
2025-01-09 20:15:17,795 [DEBUG] httpcore.http11: response_closed.complete
2025-01-09 20:15:17,795 [DEBUG] openai._base_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "200 OK"
2025-01-09 20:15:17,824 [INFO] src.luna_functions: Posted GPT reply to room !wksSOEXmjceGUTMkdv:localhost
2025-01-09 20:15:17,834 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:15:17,839 [DEBUG] openai._base_client: Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': 'You are Luna, a helpful assistant.'}, {'role': 'user', 'content': 'Absolutely! Metamaterials\' ability to manipulate waves could also lead to the creation of "invisibility cloaks." While it might sound like science fiction, researchers have already successfully tested this concept at small scales. The cloak would work by bending light or other electromagnetic waves around an object, effectively making it invisible.\n\nIn addition, metamaterials could be used to improve earthquake-resistant structures. By directing seismic waves around buildings instead of through them, they could potentially prevent a lot of damage during earthquakes.\n\nMetamaterials could also have significant implications for telecommunications. They could potentially be used to create antennas that are more efficient, smaller, and capable of operating over a wider range of frequencies. This could lead to significant improvements in mobile communication technologies.\n\nOverall, the future of metamaterials is indeed a very promising field with a plethora of potential applications that could revolutionize various sectors of technology and science. The key to unlocking these potentials lies in further research and development.'}], 'model': 'gpt-4', 'max_tokens': 300, 'temperature': 0.7}}
2025-01-09 20:15:17,840 [DEBUG] httpcore.http11: send_request_headers.started request=<Request [b'POST']>
2025-01-09 20:15:17,840 [DEBUG] httpcore.http11: send_request_headers.complete
2025-01-09 20:15:17,840 [DEBUG] httpcore.http11: send_request_body.started request=<Request [b'POST']>
2025-01-09 20:15:17,840 [DEBUG] httpcore.http11: send_request_body.complete
2025-01-09 20:15:17,840 [DEBUG] httpcore.http11: receive_response_headers.started request=<Request [b'POST']>
2025-01-09 20:15:23,971 [INFO] src.console_functions: Console received 'exit' command; requesting shutdown.
2025-01-09 20:15:23,971 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 20:15:23,971 [ERROR] __main__: An unexpected exception occurred in main_logic: Event loop stopped before Future completed.
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 139, in luna
    loop.run_until_complete(main_logic())
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 718, in run_until_complete
    raise RuntimeError('Event loop stopped before Future completed.')
RuntimeError: Event loop stopped before Future completed.
2025-01-09 20:15:23,978 [DEBUG] __main__: Preparing to close the event loop.
2025-01-09 20:15:23,979 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-09 20:16:49,769 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-09 20:16:49,769 [DEBUG] __main__: Exiting configure_logging function.
2025-01-09 20:16:49,769 [DEBUG] __main__: Logging configuration complete.
2025-01-09 20:16:49,769 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-09 20:16:49,769 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 20:16:49,769 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-09 20:16:49,769 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-09 20:16:49,769 [DEBUG] __main__: Entering start_console_thread function.
2025-01-09 20:16:49,772 [INFO] __main__: Console thread started successfully.
2025-01-09 20:16:49,772 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-09 20:16:49,773 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-09 20:16:49,773 [INFO] __main__: Starting main_logic coroutine.
2025-01-09 20:16:49,773 [DEBUG] __main__: Entering main_logic function...
2025-01-09 20:16:49,773 [DEBUG] src.luna_functions: Found director_token.json; attempting token-based login.
2025-01-09 20:16:49,775 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-09 20:16:49,788 [INFO] src.luna_functions: Token-based login verified for user @lunabot:localhost.
2025-01-09 20:16:49,788 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-09 20:16:49,793 [INFO] src.console_functions: Console screen cleared.
2025-01-09 20:16:49,825 [INFO] nio.client.base_client: New joined room !fhmXoYxDdsImUkYUpf:localhost
2025-01-09 20:16:49,825 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomCreateEvent
2025-01-09 20:16:49,825 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type PowerLevelsEvent
2025-01-09 20:16:49,825 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-09 20:16:49,825 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomJoinRulesEvent
2025-01-09 20:16:49,825 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-09 20:16:49,825 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomNameEvent
2025-01-09 20:16:49,825 [INFO] nio.client.base_client: New joined room !wksSOEXmjceGUTMkdv:localhost
2025-01-09 20:16:49,825 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type PowerLevelsEvent
2025-01-09 20:16:49,825 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomGuestAccessEvent
2025-01-09 20:16:49,825 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomCreateEvent
2025-01-09 20:16:49,825 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-09 20:16:49,825 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomJoinRulesEvent
2025-01-09 20:16:49,825 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:16:49,826 [ERROR] __main__: Error in client.sync: name 'LUNA_USER_ID' is not defined
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 95, in main_logic
    await client.sync(timeout=5000)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/base_client.py", line 116, in wrapper
    return await func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 1232, in sync
    response = await self._send(
               ^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 880, in _send
    await self.receive_response(resp)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 770, in receive_response
    await self._handle_sync(response)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 737, in _handle_sync
    await self._handle_joined_rooms(response)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 635, in _handle_joined_rooms
    await self._on_event(event, room)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 697, in _on_event
    await cb.async_execute(event, room)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/base_client.py", line 160, in async_execute
    await result
  File "/Users/evanrobinson/Documents/Luna2/luna/src/luna_functions_handledispatch.py", line 182, in on_room_message
    if event.sender == LUNA_USER_ID:
                       ^^^^^^^^^^^^
NameError: name 'LUNA_USER_ID' is not defined
2025-01-09 20:16:49,921 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 20:17:16,822 [INFO] src.console_functions: Console received 'exit' command; requesting shutdown.
2025-01-09 20:17:16,824 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 20:17:16,824 [ERROR] __main__: An unexpected exception occurred in main_logic: Event loop stopped before Future completed.
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 139, in luna
    loop.run_until_complete(main_logic())
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 718, in run_until_complete
    raise RuntimeError('Event loop stopped before Future completed.')
RuntimeError: Event loop stopped before Future completed.
2025-01-09 20:17:16,829 [DEBUG] __main__: Preparing to close the event loop.
2025-01-09 20:17:16,830 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-09 20:17:18,621 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-09 20:17:18,621 [DEBUG] __main__: Exiting configure_logging function.
2025-01-09 20:17:18,621 [DEBUG] __main__: Logging configuration complete.
2025-01-09 20:17:18,621 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-09 20:17:18,621 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 20:17:18,621 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-09 20:17:18,621 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-09 20:17:18,621 [DEBUG] __main__: Entering start_console_thread function.
2025-01-09 20:17:18,624 [INFO] __main__: Console thread started successfully.
2025-01-09 20:17:18,624 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-09 20:17:18,624 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-09 20:17:18,624 [INFO] __main__: Starting main_logic coroutine.
2025-01-09 20:17:18,624 [DEBUG] __main__: Entering main_logic function...
2025-01-09 20:17:18,624 [DEBUG] src.luna_functions: Found director_token.json; attempting token-based login.
2025-01-09 20:17:18,626 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-09 20:17:18,641 [INFO] src.luna_functions: Token-based login verified for user @lunabot:localhost.
2025-01-09 20:17:18,641 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-09 20:17:18,648 [INFO] nio.client.base_client: New joined room !fhmXoYxDdsImUkYUpf:localhost
2025-01-09 20:17:18,648 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomCreateEvent
2025-01-09 20:17:18,648 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type PowerLevelsEvent
2025-01-09 20:17:18,648 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-09 20:17:18,648 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomJoinRulesEvent
2025-01-09 20:17:18,648 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-09 20:17:18,648 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomNameEvent
2025-01-09 20:17:18,648 [INFO] nio.client.base_client: New joined room !wksSOEXmjceGUTMkdv:localhost
2025-01-09 20:17:18,648 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type PowerLevelsEvent
2025-01-09 20:17:18,648 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomGuestAccessEvent
2025-01-09 20:17:18,648 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomCreateEvent
2025-01-09 20:17:18,648 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-09 20:17:18,648 [INFO] src.console_functions: Console screen cleared.
2025-01-09 20:17:18,648 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomJoinRulesEvent
2025-01-09 20:17:18,648 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:17:18,648 [ERROR] __main__: Error in client.sync: name 'LUNA_USER_ID' is not defined
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 95, in main_logic
    await client.sync(timeout=5000)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/base_client.py", line 116, in wrapper
    return await func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 1232, in sync
    response = await self._send(
               ^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 880, in _send
    await self.receive_response(resp)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 770, in receive_response
    await self._handle_sync(response)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 737, in _handle_sync
    await self._handle_joined_rooms(response)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 635, in _handle_joined_rooms
    await self._on_event(event, room)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 697, in _on_event
    await cb.async_execute(event, room)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/base_client.py", line 160, in async_execute
    await result
  File "/Users/evanrobinson/Documents/Luna2/luna/src/luna_functions_handledispatch.py", line 182, in on_room_message
    if event.sender == LUNA_USER_ID:
                       ^^^^^^^^^^^^
NameError: name 'LUNA_USER_ID' is not defined
2025-01-09 20:17:18,687 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 20:17:28,430 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:17:28,431 [ERROR] __main__: Error in client.sync: name 'LUNA_USER_ID' is not defined
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 95, in main_logic
    await client.sync(timeout=5000)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/base_client.py", line 116, in wrapper
    return await func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 1232, in sync
    response = await self._send(
               ^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 880, in _send
    await self.receive_response(resp)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 770, in receive_response
    await self._handle_sync(response)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 737, in _handle_sync
    await self._handle_joined_rooms(response)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 635, in _handle_joined_rooms
    await self._on_event(event, room)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 697, in _on_event
    await cb.async_execute(event, room)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/base_client.py", line 160, in async_execute
    await result
  File "/Users/evanrobinson/Documents/Luna2/luna/src/luna_functions_handledispatch.py", line 182, in on_room_message
    if event.sender == LUNA_USER_ID:
                       ^^^^^^^^^^^^
NameError: name 'LUNA_USER_ID' is not defined
2025-01-09 20:17:39,437 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:17:39,437 [ERROR] __main__: Error in client.sync: name 'LUNA_USER_ID' is not defined
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 95, in main_logic
    await client.sync(timeout=5000)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/base_client.py", line 116, in wrapper
    return await func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 1232, in sync
    response = await self._send(
               ^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 880, in _send
    await self.receive_response(resp)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 770, in receive_response
    await self._handle_sync(response)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 737, in _handle_sync
    await self._handle_joined_rooms(response)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 635, in _handle_joined_rooms
    await self._on_event(event, room)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 697, in _on_event
    await cb.async_execute(event, room)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/base_client.py", line 160, in async_execute
    await result
  File "/Users/evanrobinson/Documents/Luna2/luna/src/luna_functions_handledispatch.py", line 182, in on_room_message
    if event.sender == LUNA_USER_ID:
                       ^^^^^^^^^^^^
NameError: name 'LUNA_USER_ID' is not defined
2025-01-09 20:18:28,204 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 20:19:27,469 [INFO] src.console_functions: Console received 'exit' command; requesting shutdown.
2025-01-09 20:19:27,469 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 20:19:27,469 [ERROR] __main__: An unexpected exception occurred in main_logic: Event loop stopped before Future completed.
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 139, in luna
    loop.run_until_complete(main_logic())
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 718, in run_until_complete
    raise RuntimeError('Event loop stopped before Future completed.')
RuntimeError: Event loop stopped before Future completed.
2025-01-09 20:19:27,473 [DEBUG] __main__: Preparing to close the event loop.
2025-01-09 20:19:27,474 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-09 20:19:29,503 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-09 20:19:29,503 [DEBUG] __main__: Exiting configure_logging function.
2025-01-09 20:19:29,503 [DEBUG] __main__: Logging configuration complete.
2025-01-09 20:19:29,503 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-09 20:19:29,503 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 20:19:29,503 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-09 20:19:29,503 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-09 20:19:29,503 [DEBUG] __main__: Entering start_console_thread function.
2025-01-09 20:19:29,505 [INFO] __main__: Console thread started successfully.
2025-01-09 20:19:29,505 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-09 20:19:29,505 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-09 20:19:29,505 [INFO] __main__: Starting main_logic coroutine.
2025-01-09 20:19:29,506 [DEBUG] __main__: Entering main_logic function...
2025-01-09 20:19:29,506 [DEBUG] src.luna_functions: Found director_token.json; attempting token-based login.
2025-01-09 20:19:29,507 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-09 20:19:29,516 [INFO] src.luna_functions: Token-based login verified for user @lunabot:localhost.
2025-01-09 20:19:29,517 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-09 20:19:29,526 [INFO] src.console_functions: Console screen cleared.
2025-01-09 20:19:29,536 [INFO] nio.client.base_client: New joined room !fhmXoYxDdsImUkYUpf:localhost
2025-01-09 20:19:29,536 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomCreateEvent
2025-01-09 20:19:29,536 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type PowerLevelsEvent
2025-01-09 20:19:29,536 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-09 20:19:29,536 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomJoinRulesEvent
2025-01-09 20:19:29,536 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-09 20:19:29,536 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomNameEvent
2025-01-09 20:19:29,536 [INFO] nio.client.base_client: New joined room !wksSOEXmjceGUTMkdv:localhost
2025-01-09 20:19:29,536 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type PowerLevelsEvent
2025-01-09 20:19:29,536 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomGuestAccessEvent
2025-01-09 20:19:29,536 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomCreateEvent
2025-01-09 20:19:29,536 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-09 20:19:29,536 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomJoinRulesEvent
2025-01-09 20:19:29,536 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:19:29,536 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:19:29,543 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:19:29,543 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:19:29,544 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:19:29,544 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:19:29,544 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:19:29,544 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:19:29,544 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:19:29,585 [DEBUG] openai._base_client: Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': 'You are Luna, a helpful assistant.'}, {'role': 'user', 'content': 'Testing'}], 'model': 'gpt-4', 'max_tokens': 300, 'temperature': 0.7}}
2025-01-09 20:19:29,589 [DEBUG] httpcore.connection: connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2025-01-09 20:19:29,663 [DEBUG] httpcore.connection: connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x11b4246e0>
2025-01-09 20:19:29,663 [DEBUG] httpcore.connection: start_tls.started ssl_context=<ssl.SSLContext object at 0x1181b7800> server_hostname='api.openai.com' timeout=5.0
2025-01-09 20:19:29,679 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 20:19:29,695 [DEBUG] httpcore.connection: start_tls.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x11b1bc050>
2025-01-09 20:19:29,695 [DEBUG] httpcore.http11: send_request_headers.started request=<Request [b'POST']>
2025-01-09 20:19:29,695 [DEBUG] httpcore.http11: send_request_headers.complete
2025-01-09 20:19:29,695 [DEBUG] httpcore.http11: send_request_body.started request=<Request [b'POST']>
2025-01-09 20:19:29,695 [DEBUG] httpcore.http11: send_request_body.complete
2025-01-09 20:19:29,696 [DEBUG] httpcore.http11: receive_response_headers.started request=<Request [b'POST']>
2025-01-09 20:19:30,346 [DEBUG] httpcore.http11: receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Fri, 10 Jan 2025 01:19:30 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-yzbp3micnvwwjimbcblinra3'), (b'openai-processing-ms', b'492'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'5000'), (b'x-ratelimit-limit-tokens', b'80000'), (b'x-ratelimit-remaining-requests', b'4999'), (b'x-ratelimit-remaining-tokens', b'79687'), (b'x-ratelimit-reset-requests', b'12ms'), (b'x-ratelimit-reset-tokens', b'234ms'), (b'x-request-id', b'req_b7bce8f938e698e837adf350edfa35ba'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=xHTA8iK9cXxY9xkNPGBVk7vUn4CgveVUt_knrWbsGT4-1736471970-1.0.1.1-oQ7ysUVjNMz_rs6ug8OQZSxyxrKjFFjqK4wtYo2ZY6l2ksBFaJ8Fcf2ZnB63eN7SDt25Iz1Ksdi3Ae7wuL0fFg; path=/; expires=Fri, 10-Jan-25 01:49:30 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=vMhmvgld3._kVfCl4cYrE5OL1ma7qzj7.q.U3ZhpU6g-1736471970327-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8ff8d6d3180bd645-IAD'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2025-01-09 20:19:30,349 [INFO] httpx: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-09 20:19:30,349 [DEBUG] httpcore.http11: receive_response_body.started request=<Request [b'POST']>
2025-01-09 20:19:30,350 [DEBUG] httpcore.http11: receive_response_body.complete
2025-01-09 20:19:30,350 [DEBUG] httpcore.http11: response_closed.started
2025-01-09 20:19:30,351 [DEBUG] httpcore.http11: response_closed.complete
2025-01-09 20:19:30,351 [DEBUG] openai._base_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "200 OK"
2025-01-09 20:19:30,393 [INFO] src.luna_functions: Posted GPT reply to room !wksSOEXmjceGUTMkdv:localhost
2025-01-09 20:19:30,393 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:19:30,402 [DEBUG] openai._base_client: Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': 'You are Luna, a helpful assistant.'}, {'role': 'user', 'content': '@luna?'}], 'model': 'gpt-4', 'max_tokens': 300, 'temperature': 0.7}}
2025-01-09 20:19:30,403 [DEBUG] httpcore.http11: send_request_headers.started request=<Request [b'POST']>
2025-01-09 20:19:30,404 [DEBUG] httpcore.http11: send_request_headers.complete
2025-01-09 20:19:30,404 [DEBUG] httpcore.http11: send_request_body.started request=<Request [b'POST']>
2025-01-09 20:19:30,404 [DEBUG] httpcore.http11: send_request_body.complete
2025-01-09 20:19:30,404 [DEBUG] httpcore.http11: receive_response_headers.started request=<Request [b'POST']>
2025-01-09 20:19:31,574 [DEBUG] httpcore.http11: receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Fri, 10 Jan 2025 01:19:31 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-yzbp3micnvwwjimbcblinra3'), (b'openai-processing-ms', b'948'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'5000'), (b'x-ratelimit-limit-tokens', b'80000'), (b'x-ratelimit-remaining-requests', b'4999'), (b'x-ratelimit-remaining-tokens', b'79688'), (b'x-ratelimit-reset-requests', b'12ms'), (b'x-ratelimit-reset-tokens', b'234ms'), (b'x-request-id', b'req_b881ec1f12ba0b4372e49132619e3633'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8ff8d6d79b6dd645-IAD'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2025-01-09 20:19:31,576 [INFO] httpx: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-09 20:19:31,576 [DEBUG] httpcore.http11: receive_response_body.started request=<Request [b'POST']>
2025-01-09 20:19:31,577 [DEBUG] httpcore.http11: receive_response_body.complete
2025-01-09 20:19:31,577 [DEBUG] httpcore.http11: response_closed.started
2025-01-09 20:19:31,577 [DEBUG] httpcore.http11: response_closed.complete
2025-01-09 20:19:31,578 [DEBUG] openai._base_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "200 OK"
2025-01-09 20:19:31,609 [INFO] src.luna_functions: Posted GPT reply to room !wksSOEXmjceGUTMkdv:localhost
2025-01-09 20:19:31,623 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:19:31,624 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:19:33,866 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:19:33,876 [DEBUG] openai._base_client: Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': 'You are Luna, a helpful assistant.'}, {'role': 'user', 'content': 'Hi'}], 'model': 'gpt-4', 'max_tokens': 300, 'temperature': 0.7}}
2025-01-09 20:19:33,876 [DEBUG] httpcore.http11: send_request_headers.started request=<Request [b'POST']>
2025-01-09 20:19:33,877 [DEBUG] httpcore.http11: send_request_headers.complete
2025-01-09 20:19:33,877 [DEBUG] httpcore.http11: send_request_body.started request=<Request [b'POST']>
2025-01-09 20:19:33,877 [DEBUG] httpcore.http11: send_request_body.complete
2025-01-09 20:19:33,877 [DEBUG] httpcore.http11: receive_response_headers.started request=<Request [b'POST']>
2025-01-09 20:19:34,419 [DEBUG] httpcore.http11: receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Fri, 10 Jan 2025 01:19:34 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-yzbp3micnvwwjimbcblinra3'), (b'openai-processing-ms', b'447'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'5000'), (b'x-ratelimit-limit-tokens', b'80000'), (b'x-ratelimit-remaining-requests', b'4999'), (b'x-ratelimit-remaining-tokens', b'79689'), (b'x-ratelimit-reset-requests', b'12ms'), (b'x-ratelimit-reset-tokens', b'233ms'), (b'x-request-id', b'req_e5ddc527ab949624173a711606a82a9c'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8ff8d6ed5c68d645-IAD'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2025-01-09 20:19:34,420 [INFO] httpx: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-09 20:19:34,421 [DEBUG] httpcore.http11: receive_response_body.started request=<Request [b'POST']>
2025-01-09 20:19:34,422 [DEBUG] httpcore.http11: receive_response_body.complete
2025-01-09 20:19:34,422 [DEBUG] httpcore.http11: response_closed.started
2025-01-09 20:19:34,422 [DEBUG] httpcore.http11: response_closed.complete
2025-01-09 20:19:34,423 [DEBUG] openai._base_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "200 OK"
2025-01-09 20:19:34,456 [INFO] src.luna_functions: Posted GPT reply to room !wksSOEXmjceGUTMkdv:localhost
2025-01-09 20:19:34,466 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:19:37,307 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:19:37,312 [DEBUG] openai._base_client: Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': 'You are Luna, a helpful assistant.'}, {'role': 'user', 'content': 'How are you'}], 'model': 'gpt-4', 'max_tokens': 300, 'temperature': 0.7}}
2025-01-09 20:19:37,312 [DEBUG] httpcore.http11: send_request_headers.started request=<Request [b'POST']>
2025-01-09 20:19:37,312 [DEBUG] httpcore.http11: send_request_headers.complete
2025-01-09 20:19:37,312 [DEBUG] httpcore.http11: send_request_body.started request=<Request [b'POST']>
2025-01-09 20:19:37,313 [DEBUG] httpcore.http11: send_request_body.complete
2025-01-09 20:19:37,313 [DEBUG] httpcore.http11: receive_response_headers.started request=<Request [b'POST']>
2025-01-09 20:19:39,151 [DEBUG] httpcore.http11: receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Fri, 10 Jan 2025 01:19:39 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-yzbp3micnvwwjimbcblinra3'), (b'openai-processing-ms', b'1748'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'5000'), (b'x-ratelimit-limit-tokens', b'80000'), (b'x-ratelimit-remaining-requests', b'4999'), (b'x-ratelimit-remaining-tokens', b'79686'), (b'x-ratelimit-reset-requests', b'12ms'), (b'x-ratelimit-reset-tokens', b'235ms'), (b'x-request-id', b'req_f6f6a0e1fc500d56af62f86acbe1431a'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8ff8d702ab0ad645-IAD'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2025-01-09 20:19:39,153 [INFO] httpx: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-09 20:19:39,153 [DEBUG] httpcore.http11: receive_response_body.started request=<Request [b'POST']>
2025-01-09 20:19:39,154 [DEBUG] httpcore.http11: receive_response_body.complete
2025-01-09 20:19:39,154 [DEBUG] httpcore.http11: response_closed.started
2025-01-09 20:19:39,154 [DEBUG] httpcore.http11: response_closed.complete
2025-01-09 20:19:39,155 [DEBUG] openai._base_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "200 OK"
2025-01-09 20:19:39,188 [INFO] src.luna_functions: Posted GPT reply to room !wksSOEXmjceGUTMkdv:localhost
2025-01-09 20:19:39,198 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:19:50,473 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:30:57,130 [INFO] src.console_functions: Console received 'exit' command; requesting shutdown.
2025-01-09 20:30:57,133 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 20:30:57,133 [ERROR] __main__: An unexpected exception occurred in main_logic: Event loop stopped before Future completed.
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 139, in luna
    loop.run_until_complete(main_logic())
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 718, in run_until_complete
    raise RuntimeError('Event loop stopped before Future completed.')
RuntimeError: Event loop stopped before Future completed.
2025-01-09 20:30:57,141 [DEBUG] __main__: Preparing to close the event loop.
2025-01-09 20:30:57,142 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-09 20:30:59,875 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-09 20:30:59,875 [DEBUG] __main__: Exiting configure_logging function.
2025-01-09 20:30:59,875 [DEBUG] __main__: Logging configuration complete.
2025-01-09 20:30:59,875 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-09 20:30:59,875 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 20:30:59,875 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-09 20:30:59,875 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-09 20:30:59,875 [DEBUG] __main__: Entering start_console_thread function.
2025-01-09 20:30:59,877 [INFO] __main__: Console thread started successfully.
2025-01-09 20:30:59,877 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-09 20:30:59,877 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-09 20:30:59,877 [INFO] __main__: Starting main_logic coroutine.
2025-01-09 20:30:59,877 [DEBUG] __main__: Entering main_logic function...
2025-01-09 20:30:59,877 [DEBUG] src.luna_functions: Found director_token.json; attempting token-based login.
2025-01-09 20:30:59,879 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-09 20:30:59,890 [INFO] src.luna_functions: Token-based login verified for user @lunabot:localhost.
2025-01-09 20:30:59,891 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-09 20:30:59,901 [INFO] src.console_functions: Console screen cleared.
2025-01-09 20:30:59,914 [INFO] nio.client.base_client: New joined room !fhmXoYxDdsImUkYUpf:localhost
2025-01-09 20:30:59,914 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomCreateEvent
2025-01-09 20:30:59,914 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type PowerLevelsEvent
2025-01-09 20:30:59,914 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-09 20:30:59,914 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomJoinRulesEvent
2025-01-09 20:30:59,914 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-09 20:30:59,914 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomNameEvent
2025-01-09 20:30:59,915 [INFO] nio.client.base_client: New joined room !wksSOEXmjceGUTMkdv:localhost
2025-01-09 20:30:59,915 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type PowerLevelsEvent
2025-01-09 20:30:59,915 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomGuestAccessEvent
2025-01-09 20:30:59,915 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomCreateEvent
2025-01-09 20:30:59,915 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-09 20:30:59,915 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomJoinRulesEvent
2025-01-09 20:30:59,915 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:30:59,915 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:30:59,917 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:30:59,918 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:30:59,918 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:30:59,918 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:30:59,919 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:30:59,919 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:30:59,919 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:30:59,919 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:31:00,018 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 20:31:26,080 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 20:31:41,028 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 20:31:48,661 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 20:32:34,534 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 20:33:22,919 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 20:40:28,233 [INFO] src.console_functions: Console received 'exit' command; requesting shutdown.
2025-01-09 20:40:28,236 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 20:40:28,236 [ERROR] __main__: An unexpected exception occurred in main_logic: Event loop stopped before Future completed.
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 139, in luna
    loop.run_until_complete(main_logic())
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 718, in run_until_complete
    raise RuntimeError('Event loop stopped before Future completed.')
RuntimeError: Event loop stopped before Future completed.
2025-01-09 20:40:28,245 [DEBUG] __main__: Preparing to close the event loop.
2025-01-09 20:40:28,245 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-09 20:40:30,906 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-09 20:40:30,906 [DEBUG] __main__: Exiting configure_logging function.
2025-01-09 20:40:30,906 [DEBUG] __main__: Logging configuration complete.
2025-01-09 20:40:30,906 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-09 20:40:30,906 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 20:40:30,907 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-09 20:40:30,907 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-09 20:40:30,907 [DEBUG] __main__: Entering start_console_thread function.
2025-01-09 20:40:30,910 [INFO] __main__: Console thread started successfully.
2025-01-09 20:40:30,910 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-09 20:40:30,910 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-09 20:40:30,910 [INFO] __main__: Starting main_logic coroutine.
2025-01-09 20:40:30,910 [DEBUG] __main__: Entering main_logic function...
2025-01-09 20:40:30,912 [DEBUG] src.luna_functions: Found director_token.json; attempting token-based login.
2025-01-09 20:40:30,912 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-09 20:40:30,922 [INFO] src.luna_functions: Token-based login verified for user @lunabot:localhost.
2025-01-09 20:40:30,922 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-09 20:40:30,932 [INFO] src.console_functions: Console screen cleared.
2025-01-09 20:40:30,945 [INFO] nio.client.base_client: New joined room !wksSOEXmjceGUTMkdv:localhost
2025-01-09 20:40:30,945 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type PowerLevelsEvent
2025-01-09 20:40:30,945 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomGuestAccessEvent
2025-01-09 20:40:30,945 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomCreateEvent
2025-01-09 20:40:30,945 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-09 20:40:30,945 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomJoinRulesEvent
2025-01-09 20:40:30,945 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:40:30,946 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:40:30,948 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:40:30,949 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:40:30,949 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:40:30,949 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:40:30,950 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:40:30,950 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:40:30,951 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:40:30,951 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:40:30,952 [INFO] nio.client.base_client: New joined room !fhmXoYxDdsImUkYUpf:localhost
2025-01-09 20:40:30,952 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomCreateEvent
2025-01-09 20:40:30,952 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type PowerLevelsEvent
2025-01-09 20:40:30,952 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-09 20:40:30,953 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomJoinRulesEvent
2025-01-09 20:40:30,953 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-09 20:40:30,953 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomNameEvent
2025-01-09 20:40:31,055 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 20:40:36,208 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 20:41:00,287 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 20:41:32,326 [INFO] src.luna_functions: Creating user @spyclops:localhost, admin=False via http://localhost:8008/_synapse/admin/v2/users/@spyclops:localhost
2025-01-09 20:41:32,598 [INFO] src.luna_functions: Created user @spyclops:localhost (HTTP 201)
2025-01-09 20:41:32,600 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 20:41:37,326 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 20:45:10,960 [INFO] src.console_functions: Console received 'exit' command; requesting shutdown.
2025-01-09 20:45:10,961 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 20:45:10,961 [ERROR] __main__: An unexpected exception occurred in main_logic: Event loop stopped before Future completed.
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 139, in luna
    loop.run_until_complete(main_logic())
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 718, in run_until_complete
    raise RuntimeError('Event loop stopped before Future completed.')
RuntimeError: Event loop stopped before Future completed.
2025-01-09 20:45:10,968 [DEBUG] __main__: Preparing to close the event loop.
2025-01-09 20:45:10,968 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-09 20:45:12,979 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-09 20:45:12,979 [DEBUG] __main__: Exiting configure_logging function.
2025-01-09 20:45:12,979 [DEBUG] __main__: Logging configuration complete.
2025-01-09 20:45:12,979 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-09 20:45:12,980 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 20:45:12,980 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-09 20:45:12,980 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-09 20:45:12,980 [DEBUG] __main__: Entering start_console_thread function.
2025-01-09 20:45:12,981 [INFO] __main__: Console thread started successfully.
2025-01-09 20:45:12,981 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-09 20:45:12,981 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-09 20:45:12,981 [INFO] __main__: Starting main_logic coroutine.
2025-01-09 20:45:12,981 [DEBUG] __main__: Entering main_logic function...
2025-01-09 20:45:12,982 [DEBUG] src.luna_functions: Found director_token.json; attempting token-based login.
2025-01-09 20:45:12,982 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-09 20:45:12,992 [INFO] src.luna_functions: Token-based login verified for user @lunabot:localhost.
2025-01-09 20:45:12,992 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-09 20:45:13,009 [INFO] src.console_functions: Console screen cleared.
2025-01-09 20:45:13,014 [INFO] nio.client.base_client: New joined room !wksSOEXmjceGUTMkdv:localhost
2025-01-09 20:45:13,014 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type PowerLevelsEvent
2025-01-09 20:45:13,014 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomGuestAccessEvent
2025-01-09 20:45:13,015 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomCreateEvent
2025-01-09 20:45:13,015 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-09 20:45:13,015 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomJoinRulesEvent
2025-01-09 20:45:13,015 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:45:13,015 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:45:13,017 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:45:13,018 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:45:13,018 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:45:13,018 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:45:13,019 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:45:13,019 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:45:13,021 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:45:13,021 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:45:13,022 [INFO] nio.client.base_client: New joined room !fhmXoYxDdsImUkYUpf:localhost
2025-01-09 20:45:13,022 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomCreateEvent
2025-01-09 20:45:13,022 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type PowerLevelsEvent
2025-01-09 20:45:13,022 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-09 20:45:13,022 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomJoinRulesEvent
2025-01-09 20:45:13,022 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-09 20:45:13,022 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomNameEvent
2025-01-09 20:45:13,167 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 20:45:18,468 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 20:46:29,805 [INFO] src.console_functions: Console received 'exit' command; requesting shutdown.
2025-01-09 20:46:29,805 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 20:46:29,805 [ERROR] __main__: An unexpected exception occurred in main_logic: Event loop stopped before Future completed.
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 139, in luna
    loop.run_until_complete(main_logic())
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 718, in run_until_complete
    raise RuntimeError('Event loop stopped before Future completed.')
RuntimeError: Event loop stopped before Future completed.
2025-01-09 20:46:29,814 [DEBUG] __main__: Preparing to close the event loop.
2025-01-09 20:46:29,814 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-09 20:46:31,931 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-09 20:46:31,931 [DEBUG] __main__: Exiting configure_logging function.
2025-01-09 20:46:31,931 [DEBUG] __main__: Logging configuration complete.
2025-01-09 20:46:31,931 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-09 20:46:31,931 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 20:46:31,931 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-09 20:46:31,931 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-09 20:46:31,931 [DEBUG] __main__: Entering start_console_thread function.
2025-01-09 20:46:31,932 [INFO] __main__: Console thread started successfully.
2025-01-09 20:46:31,932 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-09 20:46:31,932 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-09 20:46:31,933 [INFO] __main__: Starting main_logic coroutine.
2025-01-09 20:46:31,933 [DEBUG] __main__: Entering main_logic function...
2025-01-09 20:46:31,933 [DEBUG] src.luna_functions: Found director_token.json; attempting token-based login.
2025-01-09 20:46:31,934 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-09 20:46:31,945 [INFO] src.luna_functions: Token-based login verified for user @lunabot:localhost.
2025-01-09 20:46:31,945 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-09 20:46:31,951 [INFO] nio.client.base_client: New joined room !wksSOEXmjceGUTMkdv:localhost
2025-01-09 20:46:31,951 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type PowerLevelsEvent
2025-01-09 20:46:31,951 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomGuestAccessEvent
2025-01-09 20:46:31,951 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomCreateEvent
2025-01-09 20:46:31,951 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-09 20:46:31,951 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomJoinRulesEvent
2025-01-09 20:46:31,951 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:46:31,952 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:46:31,954 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:46:31,955 [INFO] src.console_functions: Console screen cleared.
2025-01-09 20:46:31,955 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:46:31,955 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:46:31,955 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:46:31,956 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:46:31,956 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:46:31,956 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:46:31,956 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:46:31,957 [INFO] nio.client.base_client: New joined room !fhmXoYxDdsImUkYUpf:localhost
2025-01-09 20:46:31,957 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomCreateEvent
2025-01-09 20:46:31,957 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type PowerLevelsEvent
2025-01-09 20:46:31,957 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-09 20:46:31,957 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomJoinRulesEvent
2025-01-09 20:46:31,957 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-09 20:46:31,957 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomNameEvent
2025-01-09 20:46:32,069 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 20:46:34,523 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 20:50:41,344 [INFO] src.console_functions: Console received 'exit' command; requesting shutdown.
2025-01-09 20:50:41,347 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 20:50:41,347 [ERROR] __main__: An unexpected exception occurred in main_logic: Event loop stopped before Future completed.
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 139, in luna
    loop.run_until_complete(main_logic())
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 718, in run_until_complete
    raise RuntimeError('Event loop stopped before Future completed.')
RuntimeError: Event loop stopped before Future completed.
2025-01-09 20:50:41,353 [DEBUG] __main__: Preparing to close the event loop.
2025-01-09 20:50:41,353 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-09 20:50:44,217 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-09 20:50:44,217 [DEBUG] __main__: Exiting configure_logging function.
2025-01-09 20:50:44,217 [DEBUG] __main__: Logging configuration complete.
2025-01-09 20:50:44,217 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-09 20:50:44,217 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 20:50:44,217 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-09 20:50:44,217 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-09 20:50:44,217 [DEBUG] __main__: Entering start_console_thread function.
2025-01-09 20:50:44,219 [INFO] __main__: Console thread started successfully.
2025-01-09 20:50:44,219 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-09 20:50:44,219 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-09 20:50:44,220 [INFO] __main__: Starting main_logic coroutine.
2025-01-09 20:50:44,220 [DEBUG] __main__: Entering main_logic function...
2025-01-09 20:50:44,220 [DEBUG] src.luna_functions: Found director_token.json; attempting token-based login.
2025-01-09 20:50:44,221 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-09 20:50:44,233 [INFO] src.luna_functions: Token-based login verified for user @lunabot:localhost.
2025-01-09 20:50:44,233 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-09 20:50:44,242 [INFO] src.console_functions: Console screen cleared.
2025-01-09 20:50:44,251 [INFO] nio.client.base_client: New joined room !wksSOEXmjceGUTMkdv:localhost
2025-01-09 20:50:44,251 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type PowerLevelsEvent
2025-01-09 20:50:44,252 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomGuestAccessEvent
2025-01-09 20:50:44,252 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomCreateEvent
2025-01-09 20:50:44,252 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-09 20:50:44,252 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomJoinRulesEvent
2025-01-09 20:50:44,252 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:50:44,252 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:50:44,254 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:50:44,255 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:50:44,255 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:50:44,255 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:50:44,256 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:50:44,256 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:50:44,257 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:50:44,257 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:50:44,257 [INFO] nio.client.base_client: New joined room !fhmXoYxDdsImUkYUpf:localhost
2025-01-09 20:50:44,257 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomCreateEvent
2025-01-09 20:50:44,257 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type PowerLevelsEvent
2025-01-09 20:50:44,257 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-09 20:50:44,257 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomJoinRulesEvent
2025-01-09 20:50:44,257 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-09 20:50:44,257 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomNameEvent
2025-01-09 20:50:44,362 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 20:54:15,246 [INFO] src.console_functions: Console received 'exit' command; requesting shutdown.
2025-01-09 20:54:15,247 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 20:54:15,247 [ERROR] __main__: An unexpected exception occurred in main_logic: Event loop stopped before Future completed.
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 139, in luna
    loop.run_until_complete(main_logic())
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 718, in run_until_complete
    raise RuntimeError('Event loop stopped before Future completed.')
RuntimeError: Event loop stopped before Future completed.
2025-01-09 20:54:15,254 [DEBUG] __main__: Preparing to close the event loop.
2025-01-09 20:54:15,254 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-09 20:54:17,058 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-09 20:54:17,058 [DEBUG] __main__: Exiting configure_logging function.
2025-01-09 20:54:17,058 [DEBUG] __main__: Logging configuration complete.
2025-01-09 20:54:17,058 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-09 20:54:17,058 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 20:54:17,058 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-09 20:54:17,058 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-09 20:54:17,058 [DEBUG] __main__: Entering start_console_thread function.
2025-01-09 20:54:17,059 [INFO] __main__: Console thread started successfully.
2025-01-09 20:54:17,059 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-09 20:54:17,059 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-09 20:54:17,060 [INFO] __main__: Starting main_logic coroutine.
2025-01-09 20:54:17,060 [DEBUG] __main__: Entering main_logic function...
2025-01-09 20:54:17,060 [DEBUG] src.luna_functions: Found director_token.json; attempting token-based login.
2025-01-09 20:54:17,062 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-09 20:54:17,069 [INFO] src.luna_functions: Token-based login verified for user @lunabot:localhost.
2025-01-09 20:54:17,069 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-09 20:54:17,089 [INFO] nio.client.base_client: New joined room !wksSOEXmjceGUTMkdv:localhost
2025-01-09 20:54:17,089 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type PowerLevelsEvent
2025-01-09 20:54:17,089 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomGuestAccessEvent
2025-01-09 20:54:17,089 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomCreateEvent
2025-01-09 20:54:17,089 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-09 20:54:17,089 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomJoinRulesEvent
2025-01-09 20:54:17,089 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:54:17,089 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:54:17,091 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:54:17,092 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:54:17,092 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:54:17,092 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:54:17,093 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:54:17,093 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:54:17,093 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:54:17,093 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:54:17,094 [INFO] nio.client.base_client: New joined room !fhmXoYxDdsImUkYUpf:localhost
2025-01-09 20:54:17,094 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomCreateEvent
2025-01-09 20:54:17,094 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type PowerLevelsEvent
2025-01-09 20:54:17,094 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-09 20:54:17,094 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomJoinRulesEvent
2025-01-09 20:54:17,094 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-09 20:54:17,094 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomNameEvent
2025-01-09 20:54:17,179 [INFO] src.console_functions: Console screen cleared.
2025-01-09 20:54:17,293 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 20:54:18,310 [DEBUG] src.console_functions: Showing help to user.
2025-01-09 20:54:18,313 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 20:54:47,134 [INFO] src.console_functions: Console received 'exit' command; requesting shutdown.
2025-01-09 20:54:47,134 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 20:54:47,135 [ERROR] __main__: An unexpected exception occurred in main_logic: Event loop stopped before Future completed.
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 139, in luna
    loop.run_until_complete(main_logic())
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 718, in run_until_complete
    raise RuntimeError('Event loop stopped before Future completed.')
RuntimeError: Event loop stopped before Future completed.
2025-01-09 20:54:47,140 [DEBUG] __main__: Preparing to close the event loop.
2025-01-09 20:54:47,141 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-09 20:54:52,674 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-09 20:54:52,674 [DEBUG] __main__: Exiting configure_logging function.
2025-01-09 20:54:52,674 [DEBUG] __main__: Logging configuration complete.
2025-01-09 20:54:52,674 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-09 20:54:52,674 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 20:54:52,674 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-09 20:54:52,674 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-09 20:54:52,674 [DEBUG] __main__: Entering start_console_thread function.
2025-01-09 20:54:52,675 [INFO] __main__: Console thread started successfully.
2025-01-09 20:54:52,675 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-09 20:54:52,675 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-09 20:54:52,675 [INFO] __main__: Starting main_logic coroutine.
2025-01-09 20:54:52,676 [DEBUG] __main__: Entering main_logic function...
2025-01-09 20:54:52,676 [DEBUG] src.luna_functions: Found director_token.json; attempting token-based login.
2025-01-09 20:54:52,677 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-09 20:54:52,684 [INFO] src.luna_functions: Token-based login verified for user @lunabot:localhost.
2025-01-09 20:54:52,685 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-09 20:54:52,693 [INFO] src.console_functions: Console screen cleared.
2025-01-09 20:54:52,698 [INFO] nio.client.base_client: New joined room !wksSOEXmjceGUTMkdv:localhost
2025-01-09 20:54:52,698 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type PowerLevelsEvent
2025-01-09 20:54:52,698 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomGuestAccessEvent
2025-01-09 20:54:52,698 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomCreateEvent
2025-01-09 20:54:52,698 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-09 20:54:52,698 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomJoinRulesEvent
2025-01-09 20:54:52,698 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:54:52,698 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:54:52,701 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:54:52,702 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:54:52,702 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:54:52,702 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:54:52,703 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:54:52,703 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:54:52,704 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:54:52,704 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:54:52,705 [INFO] nio.client.base_client: New joined room !fhmXoYxDdsImUkYUpf:localhost
2025-01-09 20:54:52,705 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomCreateEvent
2025-01-09 20:54:52,705 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type PowerLevelsEvent
2025-01-09 20:54:52,705 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-09 20:54:52,705 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomJoinRulesEvent
2025-01-09 20:54:52,705 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-09 20:54:52,705 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomNameEvent
2025-01-09 20:54:52,743 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 20:56:35,142 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-09 20:56:35,142 [DEBUG] __main__: Exiting configure_logging function.
2025-01-09 20:56:35,142 [DEBUG] __main__: Logging configuration complete.
2025-01-09 20:56:35,142 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-09 20:56:35,142 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 20:56:35,143 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-09 20:56:35,143 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-09 20:56:35,143 [DEBUG] __main__: Entering start_console_thread function.
2025-01-09 20:56:35,144 [INFO] __main__: Console thread started successfully.
2025-01-09 20:56:35,144 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-09 20:56:35,144 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-09 20:56:35,144 [INFO] __main__: Starting main_logic coroutine.
2025-01-09 20:56:35,144 [DEBUG] __main__: Entering main_logic function...
2025-01-09 20:56:35,144 [DEBUG] src.luna_functions: Found director_token.json; attempting token-based login.
2025-01-09 20:56:35,146 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-09 20:56:35,158 [INFO] src.luna_functions: Token-based login verified for user @lunabot:localhost.
2025-01-09 20:56:35,158 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-09 20:56:35,159 [INFO] src.console_functions: Console screen cleared.
2025-01-09 20:56:35,177 [INFO] nio.client.base_client: New joined room !wksSOEXmjceGUTMkdv:localhost
2025-01-09 20:56:35,177 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type PowerLevelsEvent
2025-01-09 20:56:35,177 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomGuestAccessEvent
2025-01-09 20:56:35,177 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomCreateEvent
2025-01-09 20:56:35,177 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-09 20:56:35,177 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomJoinRulesEvent
2025-01-09 20:56:35,177 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:56:35,177 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:56:35,179 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:56:35,180 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:56:35,180 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:56:35,180 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:56:35,181 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:56:35,181 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:56:35,182 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:56:35,182 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:56:35,182 [INFO] nio.client.base_client: New joined room !fhmXoYxDdsImUkYUpf:localhost
2025-01-09 20:56:35,182 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomCreateEvent
2025-01-09 20:56:35,182 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type PowerLevelsEvent
2025-01-09 20:56:35,182 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-09 20:56:35,182 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomJoinRulesEvent
2025-01-09 20:56:35,182 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-09 20:56:35,182 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomNameEvent
2025-01-09 20:56:35,207 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 20:56:43,284 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 20:56:47,028 [DEBUG] src.console_functions: Showing help to user.
2025-01-09 20:56:47,031 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 20:57:44,537 [WARNING] __main__: KeyboardInterrupt received. Shutting down Director.
2025-01-09 20:57:44,538 [DEBUG] __main__: Preparing to close the event loop.
2025-01-09 20:57:44,539 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-09 20:57:44,640 [ERROR] asyncio: Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x10e9e8440>
2025-01-09 20:57:47,095 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-09 20:57:47,095 [DEBUG] __main__: Exiting configure_logging function.
2025-01-09 20:57:47,095 [DEBUG] __main__: Logging configuration complete.
2025-01-09 20:57:47,095 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-09 20:57:47,095 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 20:57:47,095 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-09 20:57:47,095 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-09 20:57:47,095 [DEBUG] __main__: Entering start_console_thread function.
2025-01-09 20:57:47,097 [INFO] __main__: Console thread started successfully.
2025-01-09 20:57:47,097 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-09 20:57:47,097 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-09 20:57:47,097 [INFO] __main__: Starting main_logic coroutine.
2025-01-09 20:57:47,097 [DEBUG] __main__: Entering main_logic function...
2025-01-09 20:57:47,099 [DEBUG] src.luna_functions: Found director_token.json; attempting token-based login.
2025-01-09 20:57:47,099 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-09 20:57:47,106 [INFO] src.luna_functions: Token-based login verified for user @lunabot:localhost.
2025-01-09 20:57:47,106 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-09 20:57:47,116 [INFO] nio.client.base_client: New joined room !wksSOEXmjceGUTMkdv:localhost
2025-01-09 20:57:47,116 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type PowerLevelsEvent
2025-01-09 20:57:47,116 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomGuestAccessEvent
2025-01-09 20:57:47,116 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomCreateEvent
2025-01-09 20:57:47,116 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-09 20:57:47,116 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomJoinRulesEvent
2025-01-09 20:57:47,116 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:57:47,116 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:57:47,118 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:57:47,119 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:57:47,119 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:57:47,119 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:57:47,120 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:57:47,120 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:57:47,120 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:57:47,121 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:57:47,121 [INFO] src.console_functions: Console screen cleared.
2025-01-09 20:57:47,121 [INFO] nio.client.base_client: New joined room !fhmXoYxDdsImUkYUpf:localhost
2025-01-09 20:57:47,121 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomCreateEvent
2025-01-09 20:57:47,121 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type PowerLevelsEvent
2025-01-09 20:57:47,121 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-09 20:57:47,122 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomJoinRulesEvent
2025-01-09 20:57:47,122 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-09 20:57:47,122 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomNameEvent
2025-01-09 20:57:47,234 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 20:58:42,919 [WARNING] __main__: KeyboardInterrupt received. Shutting down Director.
2025-01-09 20:58:42,919 [DEBUG] __main__: Preparing to close the event loop.
2025-01-09 20:58:42,920 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-09 20:58:43,013 [ERROR] asyncio: Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x10fa9c440>
2025-01-09 20:58:44,829 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-09 20:58:44,830 [DEBUG] __main__: Exiting configure_logging function.
2025-01-09 20:58:44,830 [DEBUG] __main__: Logging configuration complete.
2025-01-09 20:58:44,830 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-09 20:58:44,830 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 20:58:44,830 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-09 20:58:44,830 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-09 20:58:44,830 [DEBUG] __main__: Entering start_console_thread function.
2025-01-09 20:58:44,831 [INFO] __main__: Console thread started successfully.
2025-01-09 20:58:44,831 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-09 20:58:44,831 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-09 20:58:44,831 [INFO] __main__: Starting main_logic coroutine.
2025-01-09 20:58:44,831 [DEBUG] __main__: Entering main_logic function...
2025-01-09 20:58:44,831 [DEBUG] src.luna_functions: Found director_token.json; attempting token-based login.
2025-01-09 20:58:44,832 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-09 20:58:44,845 [INFO] src.luna_functions: Token-based login verified for user @lunabot:localhost.
2025-01-09 20:58:44,845 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-09 20:58:44,848 [INFO] src.console_functions: Console screen cleared.
2025-01-09 20:58:44,865 [INFO] nio.client.base_client: New joined room !wksSOEXmjceGUTMkdv:localhost
2025-01-09 20:58:44,865 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type PowerLevelsEvent
2025-01-09 20:58:44,865 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomGuestAccessEvent
2025-01-09 20:58:44,865 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomCreateEvent
2025-01-09 20:58:44,865 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-09 20:58:44,865 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomJoinRulesEvent
2025-01-09 20:58:44,865 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:58:44,865 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:58:44,867 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:58:44,868 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:58:44,868 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:58:44,868 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:58:44,869 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:58:44,869 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:58:44,870 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:58:44,870 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 20:58:44,871 [INFO] nio.client.base_client: New joined room !fhmXoYxDdsImUkYUpf:localhost
2025-01-09 20:58:44,871 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomCreateEvent
2025-01-09 20:58:44,871 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type PowerLevelsEvent
2025-01-09 20:58:44,871 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-09 20:58:44,871 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomJoinRulesEvent
2025-01-09 20:58:44,871 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-09 20:58:44,871 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomNameEvent
2025-01-09 20:58:44,896 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 21:00:19,306 [WARNING] __main__: KeyboardInterrupt received. Shutting down Director.
2025-01-09 21:00:19,308 [DEBUG] __main__: Preparing to close the event loop.
2025-01-09 21:00:19,308 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-09 21:00:19,378 [ERROR] asyncio: Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x1228e8440>
2025-01-09 21:00:21,743 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-09 21:00:21,744 [DEBUG] __main__: Exiting configure_logging function.
2025-01-09 21:00:21,744 [DEBUG] __main__: Logging configuration complete.
2025-01-09 21:00:21,744 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-09 21:00:21,744 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 21:00:21,744 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-09 21:00:21,744 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-09 21:00:21,744 [DEBUG] __main__: Entering start_console_thread function.
2025-01-09 21:00:21,745 [INFO] __main__: Console thread started successfully.
2025-01-09 21:00:21,745 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-09 21:00:21,745 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-09 21:00:21,745 [INFO] __main__: Starting main_logic coroutine.
2025-01-09 21:00:21,745 [DEBUG] __main__: Entering main_logic function...
2025-01-09 21:00:21,745 [DEBUG] src.luna_functions: Found director_token.json; attempting token-based login.
2025-01-09 21:00:21,747 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-09 21:00:21,755 [INFO] src.luna_functions: Token-based login verified for user @lunabot:localhost.
2025-01-09 21:00:21,755 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-09 21:00:21,761 [INFO] nio.client.base_client: New joined room !wksSOEXmjceGUTMkdv:localhost
2025-01-09 21:00:21,762 [INFO] src.console_functions: Console screen cleared.
2025-01-09 21:00:21,762 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type PowerLevelsEvent
2025-01-09 21:00:21,762 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomGuestAccessEvent
2025-01-09 21:00:21,762 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomCreateEvent
2025-01-09 21:00:21,762 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-09 21:00:21,762 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomJoinRulesEvent
2025-01-09 21:00:21,762 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 21:00:21,762 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 21:00:21,764 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 21:00:21,765 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 21:00:21,765 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 21:00:21,765 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 21:00:21,766 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 21:00:21,766 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 21:00:21,766 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 21:00:21,766 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 21:00:21,767 [INFO] nio.client.base_client: New joined room !fhmXoYxDdsImUkYUpf:localhost
2025-01-09 21:00:21,767 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomCreateEvent
2025-01-09 21:00:21,767 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type PowerLevelsEvent
2025-01-09 21:00:21,767 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-09 21:00:21,767 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomJoinRulesEvent
2025-01-09 21:00:21,767 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-09 21:00:21,767 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomNameEvent
2025-01-09 21:00:21,807 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 21:01:52,651 [WARNING] __main__: KeyboardInterrupt received. Shutting down Director.
2025-01-09 21:01:52,652 [DEBUG] __main__: Preparing to close the event loop.
2025-01-09 21:01:52,652 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-09 21:01:52,740 [ERROR] asyncio: Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x10be68440>
2025-01-09 21:01:55,015 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-09 21:01:55,015 [DEBUG] __main__: Exiting configure_logging function.
2025-01-09 21:01:55,015 [DEBUG] __main__: Logging configuration complete.
2025-01-09 21:01:55,016 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-09 21:01:55,016 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 21:01:55,016 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-09 21:01:55,016 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-09 21:01:55,016 [DEBUG] __main__: Entering start_console_thread function.
2025-01-09 21:01:55,017 [INFO] __main__: Console thread started successfully.
2025-01-09 21:01:55,017 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-09 21:01:55,017 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-09 21:01:55,017 [INFO] __main__: Starting main_logic coroutine.
2025-01-09 21:01:55,017 [DEBUG] __main__: Entering main_logic function...
2025-01-09 21:01:55,017 [DEBUG] src.luna_functions: Found director_token.json; attempting token-based login.
2025-01-09 21:01:55,019 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-09 21:01:55,031 [INFO] src.luna_functions: Token-based login verified for user @lunabot:localhost.
2025-01-09 21:01:55,031 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-09 21:01:55,033 [INFO] src.console_functions: Console screen cleared.
2025-01-09 21:01:55,049 [INFO] nio.client.base_client: New joined room !wksSOEXmjceGUTMkdv:localhost
2025-01-09 21:01:55,049 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type PowerLevelsEvent
2025-01-09 21:01:55,049 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomGuestAccessEvent
2025-01-09 21:01:55,049 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomCreateEvent
2025-01-09 21:01:55,049 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-09 21:01:55,049 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomJoinRulesEvent
2025-01-09 21:01:55,049 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 21:01:55,049 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 21:01:55,052 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 21:01:55,052 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 21:01:55,052 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 21:01:55,052 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 21:01:55,053 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 21:01:55,053 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 21:01:55,054 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 21:01:55,054 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 21:01:55,055 [INFO] nio.client.base_client: New joined room !fhmXoYxDdsImUkYUpf:localhost
2025-01-09 21:01:55,055 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomCreateEvent
2025-01-09 21:01:55,055 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type PowerLevelsEvent
2025-01-09 21:01:55,055 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-09 21:01:55,055 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomJoinRulesEvent
2025-01-09 21:01:55,055 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-09 21:01:55,055 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomNameEvent
2025-01-09 21:01:55,080 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 21:02:00,989 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 21:03:44,744 [WARNING] __main__: KeyboardInterrupt received. Shutting down Director.
2025-01-09 21:03:44,746 [DEBUG] __main__: Preparing to close the event loop.
2025-01-09 21:03:44,747 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-09 21:03:44,832 [ERROR] asyncio: Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x119ee8440>
2025-01-09 21:03:47,137 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-09 21:03:47,137 [DEBUG] __main__: Exiting configure_logging function.
2025-01-09 21:03:47,137 [DEBUG] __main__: Logging configuration complete.
2025-01-09 21:03:47,137 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-09 21:03:47,137 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 21:03:47,137 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-09 21:03:47,137 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-09 21:03:47,137 [DEBUG] __main__: Entering start_console_thread function.
2025-01-09 21:03:47,140 [INFO] __main__: Console thread started successfully.
2025-01-09 21:03:47,140 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-09 21:03:47,140 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-09 21:03:47,140 [INFO] __main__: Starting main_logic coroutine.
2025-01-09 21:03:47,140 [DEBUG] __main__: Entering main_logic function...
2025-01-09 21:03:47,140 [DEBUG] src.luna_functions: Found director_token.json; attempting token-based login.
2025-01-09 21:03:47,142 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-09 21:03:47,152 [INFO] src.luna_functions: Token-based login verified for user @lunabot:localhost.
2025-01-09 21:03:47,153 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-09 21:03:47,160 [INFO] nio.client.base_client: New joined room !wksSOEXmjceGUTMkdv:localhost
2025-01-09 21:03:47,160 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type PowerLevelsEvent
2025-01-09 21:03:47,160 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomGuestAccessEvent
2025-01-09 21:03:47,160 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomCreateEvent
2025-01-09 21:03:47,160 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-09 21:03:47,160 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomJoinRulesEvent
2025-01-09 21:03:47,160 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 21:03:47,160 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 21:03:47,161 [INFO] src.console_functions: Console screen cleared.
2025-01-09 21:03:47,162 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 21:03:47,163 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 21:03:47,163 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 21:03:47,163 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 21:03:47,164 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 21:03:47,164 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 21:03:47,165 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 21:03:47,165 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 21:03:47,166 [INFO] nio.client.base_client: New joined room !fhmXoYxDdsImUkYUpf:localhost
2025-01-09 21:03:47,166 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomCreateEvent
2025-01-09 21:03:47,166 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type PowerLevelsEvent
2025-01-09 21:03:47,166 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-09 21:03:47,166 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomJoinRulesEvent
2025-01-09 21:03:47,166 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-09 21:03:47,166 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomNameEvent
2025-01-09 21:03:47,275 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 21:03:58,512 [DEBUG] openai._base_client: Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': "You are a helpful assistant that ONLY responds with valid JSON. Your JSON must include the fields: localpart, displayname, system_prompt, password, and traits. The 'traits' field should be a JSON object with zero or more fields. No extra text, no markdown formatting—just valid JSON."}, {'role': 'user', 'content': 'Generate a persona from this inspiration: \'"10 ton lovable robot"\'. The persona can be imaginative or grounded, but must be returned as raw JSON.'}], 'model': 'gpt-4', 'max_tokens': 300, 'temperature': 0.7}}
2025-01-09 21:03:58,518 [DEBUG] httpcore.connection: connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2025-01-09 21:03:58,594 [DEBUG] httpcore.connection: connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10bc2a270>
2025-01-09 21:03:58,594 [DEBUG] httpcore.connection: start_tls.started ssl_context=<ssl.SSLContext object at 0x103f87770> server_hostname='api.openai.com' timeout=5.0
2025-01-09 21:03:58,627 [DEBUG] httpcore.connection: start_tls.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10bc0d1d0>
2025-01-09 21:03:58,627 [DEBUG] httpcore.http11: send_request_headers.started request=<Request [b'POST']>
2025-01-09 21:03:58,627 [DEBUG] httpcore.http11: send_request_headers.complete
2025-01-09 21:03:58,627 [DEBUG] httpcore.http11: send_request_body.started request=<Request [b'POST']>
2025-01-09 21:03:58,627 [DEBUG] httpcore.http11: send_request_body.complete
2025-01-09 21:03:58,627 [DEBUG] httpcore.http11: receive_response_headers.started request=<Request [b'POST']>
2025-01-09 21:04:02,301 [DEBUG] httpcore.http11: receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Fri, 10 Jan 2025 02:04:02 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-yzbp3micnvwwjimbcblinra3'), (b'openai-processing-ms', b'3507'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'5000'), (b'x-ratelimit-limit-tokens', b'80000'), (b'x-ratelimit-remaining-requests', b'4999'), (b'x-ratelimit-remaining-tokens', b'79590'), (b'x-ratelimit-reset-requests', b'12ms'), (b'x-ratelimit-reset-tokens', b'307ms'), (b'x-request-id', b'req_d0041a4d29f836383408eb467b51ae68'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=MIiJj9.xbzBW9jTSdj3xMSt9IpqW_P81UrQIMSrkonI-1736474642-1.0.1.1-OY8i3Jo3xVhX6FFiuBDxLZCF4pbIusqe4SvnRn5zTjA6ExwygJfkOg0lXVoYsrsGeZb278qv_wJmNd1.CNE96A; path=/; expires=Fri, 10-Jan-25 02:34:02 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=ni5MF8WSf6HsYq9uSxNp1RAwYDd4XIn6gIuJA1Gkvi0-1736474642270-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8ff917fc0919388e-IAD'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2025-01-09 21:04:02,304 [INFO] httpx: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-09 21:04:02,304 [DEBUG] httpcore.http11: receive_response_body.started request=<Request [b'POST']>
2025-01-09 21:04:02,305 [DEBUG] httpcore.http11: receive_response_body.complete
2025-01-09 21:04:02,305 [DEBUG] httpcore.http11: response_closed.started
2025-01-09 21:04:02,306 [DEBUG] httpcore.http11: response_closed.complete
2025-01-09 21:04:02,306 [DEBUG] openai._base_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "200 OK"
2025-01-09 21:04:02,317 [INFO] src.luna_functions: Creating user @10ton_lovable_robot:localhost, admin=False via http://localhost:8008/_synapse/admin/v2/users/@10ton_lovable_robot:localhost
2025-01-09 21:04:02,596 [INFO] src.luna_functions: Created user @10ton_lovable_robot:localhost (HTTP 201)
2025-01-09 21:04:02,598 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 21:04:19,964 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 21:30:05,218 [INFO] src.console_functions: Console received 'exit' command; requesting shutdown.
2025-01-09 21:30:05,220 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 21:30:05,220 [ERROR] __main__: An unexpected exception occurred in main_logic: Event loop stopped before Future completed.
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 139, in luna
    loop.run_until_complete(main_logic())
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 718, in run_until_complete
    raise RuntimeError('Event loop stopped before Future completed.')
RuntimeError: Event loop stopped before Future completed.
2025-01-09 21:30:05,225 [DEBUG] __main__: Preparing to close the event loop.
2025-01-09 21:30:05,225 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-09 21:30:07,783 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-09 21:30:07,783 [DEBUG] __main__: Exiting configure_logging function.
2025-01-09 21:30:07,784 [DEBUG] __main__: Logging configuration complete.
2025-01-09 21:30:07,784 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-09 21:30:07,784 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 21:30:07,784 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-09 21:30:07,784 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-09 21:30:07,784 [DEBUG] __main__: Entering start_console_thread function.
2025-01-09 21:30:07,785 [INFO] __main__: Console thread started successfully.
2025-01-09 21:30:07,785 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-09 21:30:07,785 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-09 21:30:07,785 [INFO] __main__: Starting main_logic coroutine.
2025-01-09 21:30:07,785 [DEBUG] __main__: Entering main_logic function...
2025-01-09 21:30:07,785 [DEBUG] src.luna_functions: Found director_token.json; attempting token-based login.
2025-01-09 21:30:07,785 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-09 21:30:07,797 [INFO] src.luna_functions: Token-based login verified for user @lunabot:localhost.
2025-01-09 21:30:07,797 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-09 21:30:07,818 [INFO] nio.client.base_client: New joined room !wksSOEXmjceGUTMkdv:localhost
2025-01-09 21:30:07,818 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type PowerLevelsEvent
2025-01-09 21:30:07,818 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomGuestAccessEvent
2025-01-09 21:30:07,818 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomCreateEvent
2025-01-09 21:30:07,818 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-09 21:30:07,818 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomJoinRulesEvent
2025-01-09 21:30:07,819 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 21:30:07,819 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 21:30:07,820 [INFO] src.console_functions: Console screen cleared.
2025-01-09 21:30:07,825 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 21:30:07,826 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 21:30:07,826 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 21:30:07,826 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 21:30:07,827 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 21:30:07,827 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 21:30:07,828 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 21:30:07,828 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 21:30:07,829 [INFO] nio.client.base_client: New joined room !fhmXoYxDdsImUkYUpf:localhost
2025-01-09 21:30:07,829 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomCreateEvent
2025-01-09 21:30:07,829 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type PowerLevelsEvent
2025-01-09 21:30:07,829 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-09 21:30:07,829 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomJoinRulesEvent
2025-01-09 21:30:07,829 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-09 21:30:07,829 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomNameEvent
2025-01-09 21:30:07,933 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 21:30:26,157 [DEBUG] openai._base_client: Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': 'You are a helpful assistant that ONLY responds with valid JSON. You will create a small list of 4 persona objects, each must have fields: `localpart`, `displayname`, `system_prompt`, `password`, and `traits`. Output must be a JSON array of these persona objects—no extra text.'}, {'role': 'user', 'content': "Create 4 unique personas who are members of the 'pacman' team, stationed at 'gameParlor'. Return them as a JSON array. Each persona should include a localpart (no spaces), a displayname, a short system_prompt, a simple password, and any traits you think relevant."}], 'model': 'gpt-4', 'max_tokens': 600, 'temperature': 0.7}}
2025-01-09 21:30:26,163 [DEBUG] httpcore.connection: connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2025-01-09 21:30:26,262 [DEBUG] httpcore.connection: connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10f7f6270>
2025-01-09 21:30:26,262 [DEBUG] httpcore.connection: start_tls.started ssl_context=<ssl.SSLContext object at 0x107b53920> server_hostname='api.openai.com' timeout=5.0
2025-01-09 21:30:26,314 [DEBUG] httpcore.connection: start_tls.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10f7baad0>
2025-01-09 21:30:26,316 [DEBUG] httpcore.http11: send_request_headers.started request=<Request [b'POST']>
2025-01-09 21:30:26,316 [DEBUG] httpcore.http11: send_request_headers.complete
2025-01-09 21:30:26,316 [DEBUG] httpcore.http11: send_request_body.started request=<Request [b'POST']>
2025-01-09 21:30:26,317 [DEBUG] httpcore.http11: send_request_body.complete
2025-01-09 21:30:26,317 [DEBUG] httpcore.http11: receive_response_headers.started request=<Request [b'POST']>
2025-01-09 21:30:44,242 [DEBUG] httpcore.http11: receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Fri, 10 Jan 2025 02:30:44 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-yzbp3micnvwwjimbcblinra3'), (b'openai-processing-ms', b'17834'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'5000'), (b'x-ratelimit-limit-tokens', b'80000'), (b'x-ratelimit-remaining-requests', b'4999'), (b'x-ratelimit-remaining-tokens', b'79262'), (b'x-ratelimit-reset-requests', b'12ms'), (b'x-ratelimit-reset-tokens', b'553ms'), (b'x-request-id', b'req_269236a2d502a447c073644dd611964b'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=soF59t3M8gfRYRPiaJ1GDTj.EXAa4e2NanKewsr4gRo-1736476244-1.0.1.1-dLa5OuMpaO59nPj7rU5mFuaCIacxF52dgI.wmCBjkJckzhzi_qFOT8G2eh5ALn3tMvRh9glXDjfqZIQotm_uHg; path=/; expires=Fri, 10-Jan-25 03:00:44 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=hHp2Pld6WR.GjC0qhPoeJ0xaR1uH6MNzRIDSg3_Ik40-1736476244302-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8ff93ebf2d72c9bc-IAD'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2025-01-09 21:30:44,245 [INFO] httpx: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-09 21:30:44,246 [DEBUG] httpcore.http11: receive_response_body.started request=<Request [b'POST']>
2025-01-09 21:30:44,247 [DEBUG] httpcore.http11: receive_response_body.complete
2025-01-09 21:30:44,247 [DEBUG] httpcore.http11: response_closed.started
2025-01-09 21:30:44,247 [DEBUG] httpcore.http11: response_closed.complete
2025-01-09 21:30:44,248 [DEBUG] openai._base_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "200 OK"
2025-01-09 21:30:44,261 [INFO] src.luna_functions: Creating user @inky:localhost, admin=False via http://localhost:8008/_synapse/admin/v2/users/@inky:localhost
2025-01-09 21:30:44,536 [INFO] src.luna_functions: Created user @inky:localhost (HTTP 201)
2025-01-09 21:30:44,539 [INFO] src.luna_functions: Creating user @blinky:localhost, admin=False via http://localhost:8008/_synapse/admin/v2/users/@blinky:localhost
2025-01-09 21:30:44,777 [INFO] src.luna_functions: Created user @blinky:localhost (HTTP 201)
2025-01-09 21:30:44,780 [INFO] src.luna_functions: Creating user @pinky:localhost, admin=False via http://localhost:8008/_synapse/admin/v2/users/@pinky:localhost
2025-01-09 21:30:45,022 [INFO] src.luna_functions: Created user @pinky:localhost (HTTP 201)
2025-01-09 21:30:45,025 [INFO] src.luna_functions: Creating user @clyde:localhost, admin=False via http://localhost:8008/_synapse/admin/v2/users/@clyde:localhost
2025-01-09 21:30:45,269 [INFO] src.luna_functions: Created user @clyde:localhost (HTTP 201)
2025-01-09 21:30:45,273 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 21:31:39,925 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 21:35:15,430 [INFO] src.console_functions: Console received 'exit' command; requesting shutdown.
2025-01-09 21:35:15,432 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 21:35:15,432 [ERROR] __main__: An unexpected exception occurred in main_logic: Event loop stopped before Future completed.
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 139, in luna
    loop.run_until_complete(main_logic())
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 718, in run_until_complete
    raise RuntimeError('Event loop stopped before Future completed.')
RuntimeError: Event loop stopped before Future completed.
2025-01-09 21:35:15,441 [DEBUG] __main__: Preparing to close the event loop.
2025-01-09 21:35:15,442 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-09 22:34:26,751 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-09 22:34:26,751 [DEBUG] __main__: Exiting configure_logging function.
2025-01-09 22:34:26,751 [DEBUG] __main__: Logging configuration complete.
2025-01-09 22:34:26,751 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-09 22:34:26,751 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 22:34:26,751 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-09 22:34:26,751 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-09 22:34:26,751 [DEBUG] __main__: Entering start_console_thread function.
2025-01-09 22:34:26,754 [INFO] __main__: Console thread started successfully.
2025-01-09 22:34:26,754 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-09 22:34:26,754 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-09 22:34:26,754 [INFO] __main__: Starting main_logic coroutine.
2025-01-09 22:34:26,754 [DEBUG] __main__: Entering main_logic function...
2025-01-09 22:34:26,754 [DEBUG] src.luna_functions: Found director_token.json; attempting token-based login.
2025-01-09 22:34:26,754 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-09 22:34:26,773 [INFO] src.luna_functions: Token-based login verified for user @lunabot:localhost.
2025-01-09 22:34:26,773 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-09 22:34:26,792 [INFO] src.console_functions: Console screen cleared.
2025-01-09 22:34:26,814 [INFO] nio.client.base_client: New joined room !fhmXoYxDdsImUkYUpf:localhost
2025-01-09 22:34:26,814 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomCreateEvent
2025-01-09 22:34:26,814 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type PowerLevelsEvent
2025-01-09 22:34:26,814 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-09 22:34:26,814 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomJoinRulesEvent
2025-01-09 22:34:26,814 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-09 22:34:26,814 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomNameEvent
2025-01-09 22:34:26,814 [INFO] nio.client.base_client: New joined room !wksSOEXmjceGUTMkdv:localhost
2025-01-09 22:34:26,814 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type PowerLevelsEvent
2025-01-09 22:34:26,814 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomGuestAccessEvent
2025-01-09 22:34:26,814 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomCreateEvent
2025-01-09 22:34:26,814 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-09 22:34:26,814 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomJoinRulesEvent
2025-01-09 22:34:26,814 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 22:34:26,815 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 22:34:26,822 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 22:34:26,824 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 22:34:26,824 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 22:34:26,824 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 22:34:26,825 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 22:34:26,825 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 22:34:26,825 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 22:34:26,825 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 22:34:26,922 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 22:34:33,708 [DEBUG] src.console_functions: Showing help to user.
2025-01-09 22:34:33,710 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 22:38:39,577 [INFO] src.console_functions: Console received 'exit' command; requesting shutdown.
2025-01-09 22:38:39,578 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 22:38:39,578 [ERROR] __main__: An unexpected exception occurred in main_logic: Event loop stopped before Future completed.
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 139, in luna
    loop.run_until_complete(main_logic())
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 718, in run_until_complete
    raise RuntimeError('Event loop stopped before Future completed.')
RuntimeError: Event loop stopped before Future completed.
2025-01-09 22:38:39,586 [DEBUG] __main__: Preparing to close the event loop.
2025-01-09 22:38:39,586 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-09 22:38:41,366 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-09 22:38:41,366 [DEBUG] __main__: Exiting configure_logging function.
2025-01-09 22:38:41,366 [DEBUG] __main__: Logging configuration complete.
2025-01-09 22:38:41,366 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-09 22:38:41,366 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 22:38:41,366 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-09 22:38:41,366 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-09 22:38:41,366 [DEBUG] __main__: Entering start_console_thread function.
2025-01-09 22:38:41,369 [INFO] __main__: Console thread started successfully.
2025-01-09 22:38:41,369 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-09 22:38:41,369 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-09 22:38:41,369 [INFO] __main__: Starting main_logic coroutine.
2025-01-09 22:38:41,369 [DEBUG] __main__: Entering main_logic function...
2025-01-09 22:38:41,369 [DEBUG] src.luna_functions: Found director_token.json; attempting token-based login.
2025-01-09 22:38:41,371 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-09 22:38:41,382 [INFO] src.luna_functions: Token-based login verified for user @lunabot:localhost.
2025-01-09 22:38:41,382 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-09 22:38:41,396 [INFO] src.console_functions: Console screen cleared.
2025-01-09 22:38:41,403 [INFO] nio.client.base_client: New joined room !wksSOEXmjceGUTMkdv:localhost
2025-01-09 22:38:41,403 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type PowerLevelsEvent
2025-01-09 22:38:41,403 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomGuestAccessEvent
2025-01-09 22:38:41,403 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomCreateEvent
2025-01-09 22:38:41,403 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-09 22:38:41,403 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomJoinRulesEvent
2025-01-09 22:38:41,403 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 22:38:41,403 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 22:38:41,406 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 22:38:41,407 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 22:38:41,407 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 22:38:41,407 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 22:38:41,408 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 22:38:41,408 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 22:38:41,409 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 22:38:41,409 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 22:38:41,409 [INFO] nio.client.base_client: New joined room !fhmXoYxDdsImUkYUpf:localhost
2025-01-09 22:38:41,409 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomCreateEvent
2025-01-09 22:38:41,409 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type PowerLevelsEvent
2025-01-09 22:38:41,409 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-09 22:38:41,409 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomJoinRulesEvent
2025-01-09 22:38:41,409 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-09 22:38:41,409 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomNameEvent
2025-01-09 22:38:41,519 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 22:38:53,785 [DEBUG] openai._base_client: Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': 'You are a helpful assistant that ONLY responds with valid JSON. You will create a small list of 4 persona objects, each must have fields: `localpart`, `displayname`, `system_prompt`, `password`, and `traits`. Output must be a JSON array of these persona objects—no extra text.'}, {'role': 'user', 'content': 'Create 4 unique personas who are members of the \'"The\' team, stationed at \'most\'. Return them as a JSON array. Each persona should include a localpart (no spaces), a displayname, a short system_prompt, a simple password, and any traits you think relevant.'}], 'model': 'gpt-4', 'max_tokens': 600, 'temperature': 0.7}}
2025-01-09 22:38:53,791 [DEBUG] httpcore.connection: connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2025-01-09 22:38:53,863 [DEBUG] httpcore.connection: connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x110b9e120>
2025-01-09 22:38:53,863 [DEBUG] httpcore.connection: start_tls.started ssl_context=<ssl.SSLContext object at 0x105ab76e0> server_hostname='api.openai.com' timeout=5.0
2025-01-09 22:38:53,904 [DEBUG] httpcore.connection: start_tls.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x110b52ad0>
2025-01-09 22:38:53,904 [DEBUG] httpcore.http11: send_request_headers.started request=<Request [b'POST']>
2025-01-09 22:38:53,904 [DEBUG] httpcore.http11: send_request_headers.complete
2025-01-09 22:38:53,904 [DEBUG] httpcore.http11: send_request_body.started request=<Request [b'POST']>
2025-01-09 22:38:53,905 [DEBUG] httpcore.http11: send_request_body.complete
2025-01-09 22:38:53,905 [DEBUG] httpcore.http11: receive_response_headers.started request=<Request [b'POST']>
2025-01-09 22:39:05,896 [DEBUG] httpcore.http11: receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Fri, 10 Jan 2025 03:39:05 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-yzbp3micnvwwjimbcblinra3'), (b'openai-processing-ms', b'11886'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'5000'), (b'x-ratelimit-limit-tokens', b'80000'), (b'x-ratelimit-remaining-requests', b'4999'), (b'x-ratelimit-remaining-tokens', b'79264'), (b'x-ratelimit-reset-requests', b'12ms'), (b'x-ratelimit-reset-tokens', b'552ms'), (b'x-request-id', b'req_e6f84eb8849e4209e5b13823829f0107'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=kuIliPpX44jHlGvqs3OCpUADrV__qWOf1aKmTAERX.U-1736480345-1.0.1.1-2DCmTch.HcbBXsceHh2bdJFCcaKabFGuJyHw997cBj6fhTuS3J4.Xog4ROkVnb_X0yu8vhlBSnCRrSE3te2sIw; path=/; expires=Fri, 10-Jan-25 04:09:05 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=1nTFKEOv6K3qJHe.m8GWmp4zsw1LkP.eQgDCQKje6sA-1736480345871-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8ff9a307193a3afa-IAD'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2025-01-09 22:39:05,898 [INFO] httpx: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-09 22:39:05,899 [DEBUG] httpcore.http11: receive_response_body.started request=<Request [b'POST']>
2025-01-09 22:39:05,900 [DEBUG] httpcore.http11: receive_response_body.complete
2025-01-09 22:39:05,900 [DEBUG] httpcore.http11: response_closed.started
2025-01-09 22:39:05,900 [DEBUG] httpcore.http11: response_closed.complete
2025-01-09 22:39:05,900 [DEBUG] openai._base_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "200 OK"
2025-01-09 22:39:05,911 [INFO] src.luna_functions: Creating user @john_doe:localhost, admin=False via http://localhost:8008/_synapse/admin/v2/users/@john_doe:localhost
2025-01-09 22:39:06,186 [INFO] src.luna_functions: Created user @john_doe:localhost (HTTP 201)
2025-01-09 22:39:06,191 [INFO] src.luna_functions: Creating user @jane_doe:localhost, admin=False via http://localhost:8008/_synapse/admin/v2/users/@jane_doe:localhost
2025-01-09 22:39:06,429 [INFO] src.luna_functions: Created user @jane_doe:localhost (HTTP 201)
2025-01-09 22:39:06,433 [INFO] src.luna_functions: Creating user @mike_smith:localhost, admin=False via http://localhost:8008/_synapse/admin/v2/users/@mike_smith:localhost
2025-01-09 22:39:06,670 [INFO] src.luna_functions: Created user @mike_smith:localhost (HTTP 201)
2025-01-09 22:39:06,675 [INFO] src.luna_functions: Creating user @sarah_jones:localhost, admin=False via http://localhost:8008/_synapse/admin/v2/users/@sarah_jones:localhost
2025-01-09 22:39:06,913 [INFO] src.luna_functions: Created user @sarah_jones:localhost (HTTP 201)
2025-01-09 22:39:06,915 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 22:41:54,217 [INFO] src.console_functions: Console received 'exit' command; requesting shutdown.
2025-01-09 22:41:54,218 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 22:41:54,218 [ERROR] __main__: An unexpected exception occurred in main_logic: Event loop stopped before Future completed.
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 139, in luna
    loop.run_until_complete(main_logic())
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 718, in run_until_complete
    raise RuntimeError('Event loop stopped before Future completed.')
RuntimeError: Event loop stopped before Future completed.
2025-01-09 22:41:54,226 [DEBUG] __main__: Preparing to close the event loop.
2025-01-09 22:41:54,236 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-09 22:42:02,497 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-09 22:42:02,497 [DEBUG] __main__: Exiting configure_logging function.
2025-01-09 22:42:02,497 [DEBUG] __main__: Logging configuration complete.
2025-01-09 22:42:02,497 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-09 22:42:02,498 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 22:42:02,498 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-09 22:42:02,498 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-09 22:42:02,498 [DEBUG] __main__: Entering start_console_thread function.
2025-01-09 22:42:02,500 [INFO] __main__: Console thread started successfully.
2025-01-09 22:42:02,500 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-09 22:42:02,500 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-09 22:42:02,500 [INFO] __main__: Starting main_logic coroutine.
2025-01-09 22:42:02,500 [DEBUG] __main__: Entering main_logic function...
2025-01-09 22:42:02,500 [DEBUG] src.luna_functions: Found director_token.json; attempting token-based login.
2025-01-09 22:42:02,501 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-09 22:42:02,514 [INFO] src.luna_functions: Token-based login verified for user @lunabot:localhost.
2025-01-09 22:42:02,514 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-09 22:42:02,518 [INFO] src.console_functions: Console screen cleared.
2025-01-09 22:42:02,536 [INFO] nio.client.base_client: New joined room !wksSOEXmjceGUTMkdv:localhost
2025-01-09 22:42:02,536 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type PowerLevelsEvent
2025-01-09 22:42:02,536 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomGuestAccessEvent
2025-01-09 22:42:02,536 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomCreateEvent
2025-01-09 22:42:02,536 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-09 22:42:02,536 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomJoinRulesEvent
2025-01-09 22:42:02,536 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 22:42:02,536 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 22:42:02,539 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 22:42:02,539 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 22:42:02,539 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 22:42:02,540 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 22:42:02,540 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 22:42:02,540 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 22:42:02,541 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 22:42:02,541 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 22:42:02,542 [INFO] nio.client.base_client: New joined room !fhmXoYxDdsImUkYUpf:localhost
2025-01-09 22:42:02,542 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomCreateEvent
2025-01-09 22:42:02,542 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type PowerLevelsEvent
2025-01-09 22:42:02,542 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-09 22:42:02,542 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomJoinRulesEvent
2025-01-09 22:42:02,542 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-09 22:42:02,542 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomNameEvent
2025-01-09 22:42:02,569 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 22:42:07,515 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 22:42:22,749 [INFO] root: SYSTEM: usage => assemble_team TEAM_NAME LOCATION
2025-01-09 22:42:22,750 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 22:42:38,130 [DEBUG] openai._base_client: Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': 'You are a helpful assistant that ONLY responds with valid JSON. You will create a small list of 4 persona objects, each must have fields: `localpart`, `displayname`, `system_prompt`, `password`, and `traits`. Output must be a JSON array of these persona objects—no extra text.'}, {'role': 'user', 'content': 'Create 4 unique personas who are members of the \'"werewolves"\' team, stationed at \'"in\'. Return them as a JSON array. Each persona should include a localpart (no spaces), a displayname, a short system_prompt, a simple password, and any traits you think relevant.'}], 'model': 'gpt-4', 'max_tokens': 600, 'temperature': 0.7}}
2025-01-09 22:42:38,135 [DEBUG] httpcore.connection: connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2025-01-09 22:42:38,216 [DEBUG] httpcore.connection: connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x11a6a5fd0>
2025-01-09 22:42:38,217 [DEBUG] httpcore.connection: start_tls.started ssl_context=<ssl.SSLContext object at 0x1081df6e0> server_hostname='api.openai.com' timeout=5.0
2025-01-09 22:42:38,256 [DEBUG] httpcore.connection: start_tls.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x11a644a50>
2025-01-09 22:42:38,256 [DEBUG] httpcore.http11: send_request_headers.started request=<Request [b'POST']>
2025-01-09 22:42:38,257 [DEBUG] httpcore.http11: send_request_headers.complete
2025-01-09 22:42:38,257 [DEBUG] httpcore.http11: send_request_body.started request=<Request [b'POST']>
2025-01-09 22:42:38,257 [DEBUG] httpcore.http11: send_request_body.complete
2025-01-09 22:42:38,257 [DEBUG] httpcore.http11: receive_response_headers.started request=<Request [b'POST']>
2025-01-09 22:42:57,115 [DEBUG] httpcore.http11: receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Fri, 10 Jan 2025 03:42:57 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-yzbp3micnvwwjimbcblinra3'), (b'openai-processing-ms', b'18721'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'5000'), (b'x-ratelimit-limit-tokens', b'80000'), (b'x-ratelimit-remaining-requests', b'4999'), (b'x-ratelimit-remaining-tokens', b'79263'), (b'x-ratelimit-reset-requests', b'12ms'), (b'x-ratelimit-reset-tokens', b'552ms'), (b'x-request-id', b'req_63203b50af46e7c96415196dbb048190'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=1f0e6YPdT50hRNxAaaTDlJnV4l9nalEc5DEZ474pDqg-1736480577-1.0.1.1-gMSH7ccrjQLf7VxvGXRnabL7AJTYvqpHsGEQrbtot4kPKgN_MZrgCe5KphSvwHpeppHdQEmfBrug4IGjeV9rjQ; path=/; expires=Fri, 10-Jan-25 04:12:57 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=o5RRUny28vm.MiSzM1NLBNSqQMvp1kfd4KspHhQ_JcQ-1736480577056-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8ff9a8814a69d6b8-IAD'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2025-01-09 22:42:57,117 [INFO] httpx: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-09 22:42:57,117 [DEBUG] httpcore.http11: receive_response_body.started request=<Request [b'POST']>
2025-01-09 22:42:57,118 [DEBUG] httpcore.http11: receive_response_body.complete
2025-01-09 22:42:57,118 [DEBUG] httpcore.http11: response_closed.started
2025-01-09 22:42:57,118 [DEBUG] httpcore.http11: response_closed.complete
2025-01-09 22:42:57,118 [DEBUG] openai._base_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "200 OK"
2025-01-09 22:42:57,123 [INFO] root: SYSTEM: Local persona created => {'displayname': 'Moon Howler', 'system_prompt': "You're the leader of the werewolves team.", 'password': 'nightleader123', 'traits': ['strong', 'determined', 'loyal', 'team: werewolves', 'station: in'], 'creator_user_id': '@lunabot:localhost', 'created_at': '2025-01-10T03:42:57.123293Z', 'notes': ''}
2025-01-09 22:42:57,124 [INFO] src.luna_functions: Creating user @moonhowler:localhost, admin=False via http://localhost:8008/_synapse/admin/v2/users/@moonhowler:localhost
2025-01-09 22:42:57,392 [INFO] src.luna_functions: Created user @moonhowler:localhost (HTTP 201)
2025-01-09 22:42:57,392 [INFO] root: SYSTEM: Matrix user creation => Created user @moonhowler:localhost (admin=False).
2025-01-09 22:42:57,393 [INFO] root: SYSTEM: Local persona created => {'displayname': 'Luna Fang', 'system_prompt': "You're the spy of the werewolves team.", 'password': 'spylycan789', 'traits': ['stealthy', 'observant', 'cunning', 'team: werewolves', 'station: in'], 'creator_user_id': '@lunabot:localhost', 'created_at': '2025-01-10T03:42:57.392960Z', 'notes': ''}
2025-01-09 22:42:57,393 [INFO] src.luna_functions: Creating user @lunafang:localhost, admin=False via http://localhost:8008/_synapse/admin/v2/users/@lunafang:localhost
2025-01-09 22:42:57,638 [INFO] src.luna_functions: Created user @lunafang:localhost (HTTP 201)
2025-01-09 22:42:57,638 [INFO] root: SYSTEM: Matrix user creation => Created user @lunafang:localhost (admin=False).
2025-01-09 22:42:57,640 [INFO] root: SYSTEM: Local persona created => {'displayname': 'Shadow Paw', 'system_prompt': "You're the scout of the werewolves team.", 'password': 'scoutwolf456', 'traits': ['quick', 'alert', 'resourceful', 'team: werewolves', 'station: in'], 'creator_user_id': '@lunabot:localhost', 'created_at': '2025-01-10T03:42:57.639042Z', 'notes': ''}
2025-01-09 22:42:57,640 [INFO] src.luna_functions: Creating user @shadowpaw:localhost, admin=False via http://localhost:8008/_synapse/admin/v2/users/@shadowpaw:localhost
2025-01-09 22:42:57,886 [INFO] src.luna_functions: Created user @shadowpaw:localhost (HTTP 201)
2025-01-09 22:42:57,887 [INFO] root: SYSTEM: Matrix user creation => Created user @shadowpaw:localhost (admin=False).
2025-01-09 22:42:57,889 [INFO] root: SYSTEM: Local persona created => {'displayname': 'Silver Claw', 'system_prompt': "You're the warrior of the werewolves team.", 'password': 'warriorbeast321', 'traits': ['brave', 'fierce', 'protective', 'team: werewolves', 'station: in'], 'creator_user_id': '@lunabot:localhost', 'created_at': '2025-01-10T03:42:57.888010Z', 'notes': ''}
2025-01-09 22:42:57,889 [INFO] src.luna_functions: Creating user @silverclaw:localhost, admin=False via http://localhost:8008/_synapse/admin/v2/users/@silverclaw:localhost
2025-01-09 22:42:58,137 [INFO] src.luna_functions: Created user @silverclaw:localhost (HTTP 201)
2025-01-09 22:42:58,138 [INFO] root: SYSTEM: Matrix user creation => Created user @silverclaw:localhost (admin=False).
2025-01-09 22:42:58,138 [INFO] root: SYSTEM: Error creating team room => 'str' object has no attribute 'get'
2025-01-09 22:42:58,138 [INFO] root: SYSTEM: Failed to create room, skipping invites.
2025-01-09 22:42:58,139 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 22:43:15,295 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 22:44:16,944 [INFO] root: SYSTEM: usage => assemble_team TEAM_NAME LOCATION
2025-01-09 22:44:16,945 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 22:57:27,670 [INFO] src.console_functions: Console received 'exit' command; requesting shutdown.
2025-01-09 22:57:27,671 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 22:57:27,671 [ERROR] __main__: An unexpected exception occurred in main_logic: Event loop stopped before Future completed.
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 139, in luna
    loop.run_until_complete(main_logic())
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 718, in run_until_complete
    raise RuntimeError('Event loop stopped before Future completed.')
RuntimeError: Event loop stopped before Future completed.
2025-01-09 22:57:27,680 [DEBUG] __main__: Preparing to close the event loop.
2025-01-09 22:57:27,681 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-09 22:57:30,463 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-09 22:57:30,464 [DEBUG] __main__: Exiting configure_logging function.
2025-01-09 22:57:30,464 [DEBUG] __main__: Logging configuration complete.
2025-01-09 22:57:30,464 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-09 22:57:30,464 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 22:57:30,464 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-09 22:57:30,464 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-09 22:57:30,464 [DEBUG] __main__: Entering start_console_thread function.
2025-01-09 22:57:30,467 [INFO] __main__: Console thread started successfully.
2025-01-09 22:57:30,467 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-09 22:57:30,467 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-09 22:57:30,467 [INFO] __main__: Starting main_logic coroutine.
2025-01-09 22:57:30,467 [DEBUG] __main__: Entering main_logic function...
2025-01-09 22:57:30,469 [DEBUG] src.luna_functions: Found director_token.json; attempting token-based login.
2025-01-09 22:57:30,470 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-09 22:57:30,484 [INFO] src.luna_functions: Token-based login verified for user @lunabot:localhost.
2025-01-09 22:57:30,484 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-09 22:57:30,504 [INFO] nio.client.base_client: New joined room !wksSOEXmjceGUTMkdv:localhost
2025-01-09 22:57:30,504 [INFO] src.console_functions: Console screen cleared.
2025-01-09 22:57:30,504 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type PowerLevelsEvent
2025-01-09 22:57:30,504 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomGuestAccessEvent
2025-01-09 22:57:30,504 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomCreateEvent
2025-01-09 22:57:30,504 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-09 22:57:30,504 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomJoinRulesEvent
2025-01-09 22:57:30,504 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 22:57:30,505 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 22:57:30,508 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 22:57:30,509 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 22:57:30,509 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 22:57:30,509 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 22:57:30,510 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 22:57:30,510 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 22:57:30,511 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 22:57:30,511 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 22:57:30,512 [INFO] nio.client.base_client: New joined room !fhmXoYxDdsImUkYUpf:localhost
2025-01-09 22:57:30,512 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomCreateEvent
2025-01-09 22:57:30,512 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type PowerLevelsEvent
2025-01-09 22:57:30,512 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-09 22:57:30,512 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomJoinRulesEvent
2025-01-09 22:57:30,512 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-09 22:57:30,512 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomNameEvent
2025-01-09 22:57:30,615 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 22:57:48,685 [DEBUG] openai._base_client: Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': 'You are a helpful assistant that ONLY responds with valid JSON. You will create a small list of 4 persona objects, each must have fields: `localpart`, `displayname`, `system_prompt`, `password`, and `traits`. Output must be a JSON array of these persona objects—no extra text.'}, {'role': 'user', 'content': 'Create 4 unique personas who are members of the \'"GI\' team, stationed at \'Joes"\'. Return them as a JSON array. Each persona should include a localpart (no spaces), a displayname, a short system_prompt, a simple password, and any traits you think relevant.'}], 'model': 'gpt-4', 'max_tokens': 600, 'temperature': 0.7}}
2025-01-09 22:57:48,689 [DEBUG] httpcore.connection: connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2025-01-09 22:57:48,761 [DEBUG] httpcore.connection: connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10bf1a270>
2025-01-09 22:57:48,761 [DEBUG] httpcore.connection: start_tls.started ssl_context=<ssl.SSLContext object at 0x10429b6e0> server_hostname='api.openai.com' timeout=5.0
2025-01-09 22:57:48,796 [DEBUG] httpcore.connection: start_tls.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10bf016d0>
2025-01-09 22:57:48,796 [DEBUG] httpcore.http11: send_request_headers.started request=<Request [b'POST']>
2025-01-09 22:57:48,796 [DEBUG] httpcore.http11: send_request_headers.complete
2025-01-09 22:57:48,796 [DEBUG] httpcore.http11: send_request_body.started request=<Request [b'POST']>
2025-01-09 22:57:48,796 [DEBUG] httpcore.http11: send_request_body.complete
2025-01-09 22:57:48,796 [DEBUG] httpcore.http11: receive_response_headers.started request=<Request [b'POST']>
2025-01-09 22:57:58,504 [DEBUG] httpcore.http11: receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Fri, 10 Jan 2025 03:57:58 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-yzbp3micnvwwjimbcblinra3'), (b'openai-processing-ms', b'9594'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'5000'), (b'x-ratelimit-limit-tokens', b'80000'), (b'x-ratelimit-remaining-requests', b'4999'), (b'x-ratelimit-remaining-tokens', b'79264'), (b'x-ratelimit-reset-requests', b'12ms'), (b'x-ratelimit-reset-tokens', b'552ms'), (b'x-request-id', b'req_576d7dae584fd3239772313e52128152'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=UEhxL_zyGSiZnii0om_7jNxFhynQ_Gi09qfMxlXeOLg-1736481478-1.0.1.1-z6gHM3vr1anksluf4sr_TjDYmoGt2HsDXUekdsGwaRc3lVT93dstIHPPTkO13_hCKXbfqwhSL_3qGDJvz.2k3g; path=/; expires=Fri, 10-Jan-25 04:27:58 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=ly_5kHm0Z5iXHzruXmm_IPWEjNNMUaqTaDBZwrvc_YI-1736481478530-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8ff9bebc6d041fec-IAD'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2025-01-09 22:57:58,519 [INFO] httpx: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-09 22:57:58,524 [DEBUG] httpcore.http11: receive_response_body.started request=<Request [b'POST']>
2025-01-09 22:57:58,534 [DEBUG] httpcore.http11: receive_response_body.complete
2025-01-09 22:57:58,537 [DEBUG] httpcore.http11: response_closed.started
2025-01-09 22:57:58,538 [DEBUG] httpcore.http11: response_closed.complete
2025-01-09 22:57:58,538 [DEBUG] openai._base_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "200 OK"
2025-01-09 22:57:58,561 [INFO] root: SYSTEM: Local persona created => {'displayname': 'Joe Snake Eyes', 'system_prompt': 'You are Joe Snake Eyes, the silent ninja of the GI team.', 'password': 'silentninja123', 'traits': ['stealthy', 'mysterious', 'skilled in martial arts'], 'creator_user_id': '@lunabot:localhost', 'created_at': '2025-01-10T03:57:58.559875Z', 'notes': ''}
2025-01-09 22:57:58,561 [INFO] src.luna_functions: Creating user @GI_Joe1:localhost, admin=False via http://localhost:8008/_synapse/admin/v2/users/@GI_Joe1:localhost
2025-01-09 22:57:58,826 [ERROR] src.luna_functions: Error creating user @GI_Joe1:localhost: 400 => {"errcode":"M_INVALID_USERNAME","error":"User ID can only contain characters a-z, 0-9, or '=_-./+'"}
2025-01-09 22:57:58,827 [INFO] root: SYSTEM: Matrix user creation => HTTP 400: {"errcode":"M_INVALID_USERNAME","error":"User ID can only contain characters a-z, 0-9, or '=_-./+'"}
2025-01-09 22:57:58,829 [INFO] root: SYSTEM: Local persona created => {'displayname': 'Joe Duke', 'system_prompt': 'You are Joe Duke, the charismatic leader of the GI team.', 'password': 'leaderjoe321', 'traits': ['charismatic', 'strategic', 'brave'], 'creator_user_id': '@lunabot:localhost', 'created_at': '2025-01-10T03:57:58.828001Z', 'notes': ''}
2025-01-09 22:57:58,829 [INFO] src.luna_functions: Creating user @GI_Joe2:localhost, admin=False via http://localhost:8008/_synapse/admin/v2/users/@GI_Joe2:localhost
2025-01-09 22:57:59,071 [ERROR] src.luna_functions: Error creating user @GI_Joe2:localhost: 400 => {"errcode":"M_INVALID_USERNAME","error":"User ID can only contain characters a-z, 0-9, or '=_-./+'"}
2025-01-09 22:57:59,072 [INFO] root: SYSTEM: Matrix user creation => HTTP 400: {"errcode":"M_INVALID_USERNAME","error":"User ID can only contain characters a-z, 0-9, or '=_-./+'"}
2025-01-09 22:57:59,074 [INFO] root: SYSTEM: Local persona created => {'displayname': 'Joe Roadblock', 'system_prompt': "You are Joe Roadblock, the team's heavy artillery expert.", 'password': 'heavyartillery456', 'traits': ['strong', 'reliable', 'good with heavy weapons'], 'creator_user_id': '@lunabot:localhost', 'created_at': '2025-01-10T03:57:59.073091Z', 'notes': ''}
2025-01-09 22:57:59,075 [INFO] src.luna_functions: Creating user @GI_Joe3:localhost, admin=False via http://localhost:8008/_synapse/admin/v2/users/@GI_Joe3:localhost
2025-01-09 22:57:59,352 [ERROR] src.luna_functions: Error creating user @GI_Joe3:localhost: 400 => {"errcode":"M_INVALID_USERNAME","error":"User ID can only contain characters a-z, 0-9, or '=_-./+'"}
2025-01-09 22:57:59,354 [INFO] root: SYSTEM: Matrix user creation => HTTP 400: {"errcode":"M_INVALID_USERNAME","error":"User ID can only contain characters a-z, 0-9, or '=_-./+'"}
2025-01-09 22:57:59,360 [INFO] root: SYSTEM: Local persona created => {'displayname': 'Joe Scarlett', 'system_prompt': 'You are Joe Scarlett, the intelligent counter-intelligence officer.', 'password': 'intelligentscarlett789', 'traits': ['intelligent', 'resourceful', 'expert in counter-intelligence'], 'creator_user_id': '@lunabot:localhost', 'created_at': '2025-01-10T03:57:59.358164Z', 'notes': ''}
2025-01-09 22:57:59,361 [INFO] src.luna_functions: Creating user @GI_Joe4:localhost, admin=False via http://localhost:8008/_synapse/admin/v2/users/@GI_Joe4:localhost
2025-01-09 22:57:59,597 [ERROR] src.luna_functions: Error creating user @GI_Joe4:localhost: 400 => {"errcode":"M_INVALID_USERNAME","error":"User ID can only contain characters a-z, 0-9, or '=_-./+'"}
2025-01-09 22:57:59,597 [INFO] root: SYSTEM: Matrix user creation => HTTP 400: {"errcode":"M_INVALID_USERNAME","error":"User ID can only contain characters a-z, 0-9, or '=_-./+'"}
2025-01-09 23:07:57,926 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-09 23:07:57,926 [DEBUG] __main__: Exiting configure_logging function.
2025-01-09 23:07:57,926 [DEBUG] __main__: Logging configuration complete.
2025-01-09 23:07:57,926 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-09 23:07:57,926 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 23:07:57,926 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-09 23:07:57,927 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-09 23:07:57,927 [DEBUG] __main__: Entering start_console_thread function.
2025-01-09 23:07:57,930 [INFO] __main__: Console thread started successfully.
2025-01-09 23:07:57,930 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-09 23:07:57,930 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-09 23:07:57,930 [INFO] __main__: Starting main_logic coroutine.
2025-01-09 23:07:57,930 [DEBUG] __main__: Entering main_logic function...
2025-01-09 23:07:57,930 [DEBUG] src.luna_functions: Found director_token.json; attempting token-based login.
2025-01-09 23:07:57,932 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-09 23:07:57,942 [INFO] src.luna_functions: Token-based login verified for user @lunabot:localhost.
2025-01-09 23:07:57,942 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-09 23:07:57,953 [INFO] src.console_functions: Console screen cleared.
2025-01-09 23:07:57,968 [INFO] nio.client.base_client: New joined room !wksSOEXmjceGUTMkdv:localhost
2025-01-09 23:07:57,968 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type PowerLevelsEvent
2025-01-09 23:07:57,968 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomGuestAccessEvent
2025-01-09 23:07:57,968 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomCreateEvent
2025-01-09 23:07:57,968 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-09 23:07:57,968 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomJoinRulesEvent
2025-01-09 23:07:57,968 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 23:07:57,971 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 23:07:57,978 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 23:07:57,979 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 23:07:57,979 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 23:07:57,979 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 23:07:57,980 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 23:07:57,980 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 23:07:57,981 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 23:07:57,982 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 23:07:57,982 [INFO] nio.client.base_client: New joined room !fhmXoYxDdsImUkYUpf:localhost
2025-01-09 23:07:57,983 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomCreateEvent
2025-01-09 23:07:57,983 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type PowerLevelsEvent
2025-01-09 23:07:57,983 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-09 23:07:57,983 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomJoinRulesEvent
2025-01-09 23:07:57,983 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-09 23:07:57,983 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomNameEvent
2025-01-09 23:07:58,096 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 23:08:04,761 [INFO] src.luna_functions_assemble: SYSTEM: Starting the assemble process.
2025-01-09 23:08:04,761 [INFO] src.luna_functions_assemble: SYSTEM: Team name: "avengers", Location: "moonbase"
2025-01-09 23:08:04,798 [DEBUG] openai._base_client: Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': 'You are a helpful assistant that ONLY responds with valid JSON. You will create a small list of 4 persona objects, each must have fields: `localpart`, `displayname`, `system_prompt`, `password`, and `traits`. Output must be a JSON array of these persona objects—no extra text.'}, {'role': 'user', 'content': 'Create 4 unique personas who are members of the \'"avengers"\' team, stationed at \'"moonbase"\'. Return them as a JSON array. Each persona should include a localpart (no spaces), a displayname, a short system_prompt, a simple password, and any traits you think relevant.'}], 'model': 'gpt-4', 'max_tokens': 600, 'temperature': 0.7}}
2025-01-09 23:08:04,803 [DEBUG] httpcore.connection: connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2025-01-09 23:08:04,892 [DEBUG] httpcore.connection: connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10a09dfd0>
2025-01-09 23:08:04,892 [DEBUG] httpcore.connection: start_tls.started ssl_context=<ssl.SSLContext object at 0x1069976e0> server_hostname='api.openai.com' timeout=5.0
2025-01-09 23:08:04,923 [DEBUG] httpcore.connection: start_tls.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10a04d310>
2025-01-09 23:08:04,924 [DEBUG] httpcore.http11: send_request_headers.started request=<Request [b'POST']>
2025-01-09 23:08:04,925 [DEBUG] httpcore.http11: send_request_headers.complete
2025-01-09 23:08:04,925 [DEBUG] httpcore.http11: send_request_body.started request=<Request [b'POST']>
2025-01-09 23:08:04,925 [DEBUG] httpcore.http11: send_request_body.complete
2025-01-09 23:08:04,925 [DEBUG] httpcore.http11: receive_response_headers.started request=<Request [b'POST']>
2025-01-09 23:08:16,311 [DEBUG] httpcore.http11: receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Fri, 10 Jan 2025 04:08:16 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-yzbp3micnvwwjimbcblinra3'), (b'openai-processing-ms', b'11279'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'5000'), (b'x-ratelimit-limit-tokens', b'80000'), (b'x-ratelimit-remaining-requests', b'4999'), (b'x-ratelimit-remaining-tokens', b'79261'), (b'x-ratelimit-reset-requests', b'12ms'), (b'x-ratelimit-reset-tokens', b'554ms'), (b'x-request-id', b'req_24c33055fae1e378cd72ff96a2461480'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=zknFTpNjI901S6iArHRoXp4eecXssqJd759X2D7NeTA-1736482096-1.0.1.1-1MW2QCAVICdsXuLznn.TqWOWYJJIgM10eaMkadOgjPBdWYmIuOVWyMWyIlvECosqlAo0g7Njuqd48cqYEm_Bxw; path=/; expires=Fri, 10-Jan-25 04:38:16 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=dJ0X1JLZmFNiB7EvyzbNFtV3GhtXeGMTdc8P0YtWjxs-1736482096319-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8ff9cdc74d520610-IAD'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2025-01-09 23:08:16,315 [INFO] httpx: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-09 23:08:16,315 [DEBUG] httpcore.http11: receive_response_body.started request=<Request [b'POST']>
2025-01-09 23:08:16,316 [DEBUG] httpcore.http11: receive_response_body.complete
2025-01-09 23:08:16,316 [DEBUG] httpcore.http11: response_closed.started
2025-01-09 23:08:16,316 [DEBUG] httpcore.http11: response_closed.complete
2025-01-09 23:08:16,316 [DEBUG] openai._base_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "200 OK"
2025-01-09 23:08:16,324 [INFO] src.luna_functions_assemble: SYSTEM: Parsing GPT response.
2025-01-09 23:08:16,324 [INFO] src.luna_functions_assemble: SYSTEM: Successfully parsed GPT response. Generating users...
2025-01-09 23:08:16,324 [INFO] src.luna_functions_assemble: SYSTEM: Creating persona: @ironman:localhost
2025-01-09 23:08:16,327 [INFO] src.luna_functions_assemble: SYSTEM: Persona created and saved: @ironman:localhost
2025-01-09 23:08:16,327 [INFO] src.luna_functions: Creating user @ironman:localhost, admin=False via http://localhost:8008/_synapse/admin/v2/users/@ironman:localhost
2025-01-09 23:08:16,602 [INFO] src.luna_functions: Created user @ironman:localhost (HTTP 201)
2025-01-09 23:08:16,603 [INFO] src.luna_functions_assemble: SYSTEM: User registered in Synapse: @ironman:localhost
2025-01-09 23:08:16,603 [INFO] src.luna_functions_assemble: SYSTEM: Creating persona: @captainamerica:localhost
2025-01-09 23:08:16,606 [INFO] src.luna_functions_assemble: SYSTEM: Persona created and saved: @captainamerica:localhost
2025-01-09 23:08:16,606 [INFO] src.luna_functions: Creating user @captainamerica:localhost, admin=False via http://localhost:8008/_synapse/admin/v2/users/@captainamerica:localhost
2025-01-09 23:08:16,850 [INFO] src.luna_functions: Created user @captainamerica:localhost (HTTP 201)
2025-01-09 23:08:16,851 [INFO] src.luna_functions_assemble: SYSTEM: User registered in Synapse: @captainamerica:localhost
2025-01-09 23:08:16,851 [INFO] src.luna_functions_assemble: SYSTEM: Creating persona: @blackwidow:localhost
2025-01-09 23:08:16,853 [INFO] src.luna_functions_assemble: SYSTEM: Persona created and saved: @blackwidow:localhost
2025-01-09 23:08:16,853 [INFO] src.luna_functions: Creating user @blackwidow:localhost, admin=False via http://localhost:8008/_synapse/admin/v2/users/@blackwidow:localhost
2025-01-09 23:08:17,092 [INFO] src.luna_functions: Created user @blackwidow:localhost (HTTP 201)
2025-01-09 23:08:17,093 [INFO] src.luna_functions_assemble: SYSTEM: User registered in Synapse: @blackwidow:localhost
2025-01-09 23:08:17,093 [INFO] src.luna_functions_assemble: SYSTEM: Creating persona: @hulk:localhost
2025-01-09 23:08:17,096 [INFO] src.luna_functions_assemble: SYSTEM: Persona created and saved: @hulk:localhost
2025-01-09 23:08:17,096 [INFO] src.luna_functions: Creating user @hulk:localhost, admin=False via http://localhost:8008/_synapse/admin/v2/users/@hulk:localhost
2025-01-09 23:08:17,332 [INFO] src.luna_functions: Created user @hulk:localhost (HTTP 201)
2025-01-09 23:08:17,333 [INFO] src.luna_functions_assemble: SYSTEM: User registered in Synapse: @hulk:localhost
2025-01-09 23:08:17,333 [INFO] src.luna_functions_assemble: SYSTEM: Creating a room for the team...
2025-01-09 23:08:17,333 [INFO] src.luna_functions_assemble: SYSTEM: Room created successfully. Room ID: Exception while creating room => 'str' object has no attribute 'value'
2025-01-09 23:08:17,333 [INFO] src.luna_functions_assemble: SYSTEM: Inviting users to the room...
2025-01-09 23:08:17,340 [ERROR] src.luna_functions: Failed to invite @ironman:localhost to Exception while creating room => 'str' object has no attribute 'value': RoomInviteError: M_FORBIDDEN Unknown room
2025-01-09 23:08:17,340 [INFO] src.luna_functions_assemble: SYSTEM: Invited user: @ironman:localhost
2025-01-09 23:08:17,347 [ERROR] src.luna_functions: Failed to invite @captainamerica:localhost to Exception while creating room => 'str' object has no attribute 'value': RoomInviteError: M_FORBIDDEN Unknown room
2025-01-09 23:08:17,347 [INFO] src.luna_functions_assemble: SYSTEM: Invited user: @captainamerica:localhost
2025-01-09 23:08:17,350 [ERROR] src.luna_functions: Failed to invite @blackwidow:localhost to Exception while creating room => 'str' object has no attribute 'value': RoomInviteError: M_FORBIDDEN Unknown room
2025-01-09 23:08:17,350 [INFO] src.luna_functions_assemble: SYSTEM: Invited user: @blackwidow:localhost
2025-01-09 23:08:17,353 [ERROR] src.luna_functions: Failed to invite @hulk:localhost to Exception while creating room => 'str' object has no attribute 'value': RoomInviteError: M_FORBIDDEN Unknown room
2025-01-09 23:08:17,353 [INFO] src.luna_functions_assemble: SYSTEM: Invited user: @hulk:localhost
2025-01-09 23:08:17,356 [ERROR] src.luna_functions: Failed to invite @lunabot:localhost to Exception while creating room => 'str' object has no attribute 'value': RoomInviteError: M_FORBIDDEN Unknown room
2025-01-09 23:08:17,356 [INFO] src.luna_functions_assemble: SYSTEM: Invited user: @lunabot:localhost
2025-01-09 23:08:17,359 [ERROR] src.luna_functions: Failed to invite @evan:localhost to Exception while creating room => 'str' object has no attribute 'value': RoomInviteError: M_FORBIDDEN Unknown room
2025-01-09 23:08:17,359 [INFO] src.luna_functions_assemble: SYSTEM: Invited user: @evan:localhost
2025-01-09 23:08:17,359 [INFO] src.luna_functions_assemble: SYSTEM: Team assembly complete. Room created and users invited.
2025-01-09 23:08:17,359 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 23:13:47,241 [INFO] src.console_functions: Console received 'exit' command; requesting shutdown.
2025-01-09 23:13:47,242 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 23:13:47,243 [ERROR] __main__: An unexpected exception occurred in main_logic: Event loop stopped before Future completed.
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 139, in luna
    loop.run_until_complete(main_logic())
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 718, in run_until_complete
    raise RuntimeError('Event loop stopped before Future completed.')
RuntimeError: Event loop stopped before Future completed.
2025-01-09 23:13:47,250 [DEBUG] __main__: Preparing to close the event loop.
2025-01-09 23:13:47,251 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-09 23:26:46,920 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-09 23:26:46,920 [DEBUG] __main__: Exiting configure_logging function.
2025-01-09 23:26:46,920 [DEBUG] __main__: Logging configuration complete.
2025-01-09 23:26:46,920 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-09 23:26:46,920 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 23:26:46,920 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-09 23:26:46,920 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-09 23:26:46,920 [DEBUG] __main__: Entering start_console_thread function.
2025-01-09 23:26:46,923 [INFO] __main__: Console thread started successfully.
2025-01-09 23:26:46,923 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-09 23:26:46,923 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-09 23:26:46,923 [INFO] __main__: Starting main_logic coroutine.
2025-01-09 23:26:46,923 [DEBUG] __main__: Entering main_logic function...
2025-01-09 23:26:46,923 [DEBUG] src.luna_functions: Found director_token.json; attempting token-based login.
2025-01-09 23:26:46,923 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-09 23:26:46,932 [INFO] src.luna_functions: Token-based login verified for user @lunabot:localhost.
2025-01-09 23:26:46,932 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-09 23:26:46,956 [INFO] src.console_functions: Console screen cleared.
2025-01-09 23:26:46,967 [INFO] nio.client.base_client: New joined room !wksSOEXmjceGUTMkdv:localhost
2025-01-09 23:26:46,968 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type PowerLevelsEvent
2025-01-09 23:26:46,968 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomGuestAccessEvent
2025-01-09 23:26:46,968 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomCreateEvent
2025-01-09 23:26:46,968 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-09 23:26:46,968 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomJoinRulesEvent
2025-01-09 23:26:46,968 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 23:26:46,968 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 23:26:46,977 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 23:26:46,978 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 23:26:46,978 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 23:26:46,978 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 23:26:46,979 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 23:26:46,979 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 23:26:46,980 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 23:26:46,980 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 23:26:46,981 [INFO] nio.client.base_client: New joined room !fhmXoYxDdsImUkYUpf:localhost
2025-01-09 23:26:46,982 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomCreateEvent
2025-01-09 23:26:46,982 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type PowerLevelsEvent
2025-01-09 23:26:46,982 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-09 23:26:46,982 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomJoinRulesEvent
2025-01-09 23:26:46,982 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-09 23:26:46,982 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomNameEvent
2025-01-09 23:26:47,097 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 23:27:11,306 [INFO] src.luna_functions_assemble: cmd_assemble called with args='"marshmallows" "for the campfire"'
2025-01-09 23:27:11,307 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 23:27:11,349 [DEBUG] openai._base_client: Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': 'You are an AI that generates JSON describing a set of \'bot personalities\'. Each personality is a structured object with these keys:\n\n- localpart (string): The localpart for the Matrix user ID (no @ or :...)\n- displayname (string): The human-readable name\n- system_prompt (string): The persona\'s system message or instructions\n- password (string): A strong password for the bot\n- traits (object/dict): Additional traits or metadata\n\nOutput must be strictly valid JSON array, like:\n\n[\n  {\n    "localpart": "finance_assistant",\n    "displayname": "Finance Assistant",\n    "system_prompt": "You are a finance wizard...",\n    "password": "someStrongPass",\n    "traits": {"domain": "finance", "level": "expert"}\n  },\n  ...\n]'}, {'role': 'user', 'content': 'Please create a set of personalities inspired by \'"marshmallows"\' for a new chat channel \'"for the campfire"\'. No extra text. Return pure JSON array only.'}], 'model': 'gpt-4', 'max_tokens': 1000, 'temperature': 0.7}}
2025-01-09 23:27:11,355 [DEBUG] httpcore.connection: connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2025-01-09 23:27:11,431 [DEBUG] httpcore.connection: connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10e2a1fd0>
2025-01-09 23:27:11,431 [DEBUG] httpcore.connection: start_tls.started ssl_context=<ssl.SSLContext object at 0x10637b770> server_hostname='api.openai.com' timeout=5.0
2025-01-09 23:27:11,476 [DEBUG] httpcore.connection: start_tls.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10e270f50>
2025-01-09 23:27:11,476 [DEBUG] httpcore.http11: send_request_headers.started request=<Request [b'POST']>
2025-01-09 23:27:11,476 [DEBUG] httpcore.http11: send_request_headers.complete
2025-01-09 23:27:11,476 [DEBUG] httpcore.http11: send_request_body.started request=<Request [b'POST']>
2025-01-09 23:27:11,477 [DEBUG] httpcore.http11: send_request_body.complete
2025-01-09 23:27:11,477 [DEBUG] httpcore.http11: receive_response_headers.started request=<Request [b'POST']>
2025-01-09 23:27:17,442 [INFO] src.luna_functions_assemble: cmd_assemble called with args=''
2025-01-09 23:27:17,443 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 23:27:25,746 [INFO] src.luna_functions_assemble: cmd_assemble called with args='tuna ocean'
2025-01-09 23:27:25,747 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 23:27:25,748 [DEBUG] openai._base_client: Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': 'You are an AI that generates JSON describing a set of \'bot personalities\'. Each personality is a structured object with these keys:\n\n- localpart (string): The localpart for the Matrix user ID (no @ or :...)\n- displayname (string): The human-readable name\n- system_prompt (string): The persona\'s system message or instructions\n- password (string): A strong password for the bot\n- traits (object/dict): Additional traits or metadata\n\nOutput must be strictly valid JSON array, like:\n\n[\n  {\n    "localpart": "finance_assistant",\n    "displayname": "Finance Assistant",\n    "system_prompt": "You are a finance wizard...",\n    "password": "someStrongPass",\n    "traits": {"domain": "finance", "level": "expert"}\n  },\n  ...\n]'}, {'role': 'user', 'content': "Please create a set of personalities inspired by 'tuna' for a new chat channel 'ocean'. No extra text. Return pure JSON array only."}], 'model': 'gpt-4', 'max_tokens': 1000, 'temperature': 0.7}}
2025-01-09 23:27:25,749 [DEBUG] httpcore.connection: connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2025-01-09 23:27:25,783 [DEBUG] httpcore.connection: connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10e4987d0>
2025-01-09 23:27:25,783 [DEBUG] httpcore.connection: start_tls.started ssl_context=<ssl.SSLContext object at 0x10637b770> server_hostname='api.openai.com' timeout=5.0
2025-01-09 23:27:25,822 [DEBUG] httpcore.connection: start_tls.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10e21b100>
2025-01-09 23:27:25,822 [DEBUG] httpcore.http11: send_request_headers.started request=<Request [b'POST']>
2025-01-09 23:27:25,823 [DEBUG] httpcore.http11: send_request_headers.complete
2025-01-09 23:27:25,823 [DEBUG] httpcore.http11: send_request_body.started request=<Request [b'POST']>
2025-01-09 23:27:25,823 [DEBUG] httpcore.http11: send_request_body.complete
2025-01-09 23:27:25,823 [DEBUG] httpcore.http11: receive_response_headers.started request=<Request [b'POST']>
2025-01-09 23:27:29,062 [DEBUG] httpcore.http11: receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Fri, 10 Jan 2025 04:27:29 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-yzbp3micnvwwjimbcblinra3'), (b'openai-processing-ms', b'17477'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'5000'), (b'x-ratelimit-limit-tokens', b'80000'), (b'x-ratelimit-remaining-requests', b'4999'), (b'x-ratelimit-remaining-tokens', b'78780'), (b'x-ratelimit-reset-requests', b'12ms'), (b'x-ratelimit-reset-tokens', b'915ms'), (b'x-request-id', b'req_a82183c0a334e883a2d549197dc9ae45'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=QdQRtfKQTVRxFN0ntezvWaJ7cK3UpFrOznNlACsg1.k-1736483249-1.0.1.1-_isaPtZcGqizLsBhNpRSb4ZHiiLmraX23hEGgNpq0SgwjflITQFNIFxmsfARjW9pEgw.kqbsFqOVq0qQTV6TBQ; path=/; expires=Fri, 10-Jan-25 04:57:29 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=Ri3lqzLJTxZ21Bs.yxAdVpbE1PdG7pWLJoZKDumV5X0-1736483249075-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8ff9e9c52f1cc994-IAD'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2025-01-09 23:27:29,062 [INFO] httpx: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-09 23:27:29,062 [DEBUG] httpcore.http11: receive_response_body.started request=<Request [b'POST']>
2025-01-09 23:27:29,063 [DEBUG] httpcore.http11: receive_response_body.complete
2025-01-09 23:27:29,063 [DEBUG] httpcore.http11: response_closed.started
2025-01-09 23:27:29,063 [DEBUG] httpcore.http11: response_closed.complete
2025-01-09 23:27:29,063 [DEBUG] openai._base_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "200 OK"
2025-01-09 23:27:29,067 [INFO] src.luna_functions: Creating user @marshmallow_maven:localhost, admin=False via http://localhost:8008/_synapse/admin/v2/users/@marshmallow_maven:localhost
2025-01-09 23:27:29,344 [INFO] src.luna_functions: Created user @marshmallow_maven:localhost (HTTP 201)
2025-01-09 23:27:29,345 [INFO] src.luna_functions_assemble: User creation result => Created user @marshmallow_maven:localhost (admin=False).
2025-01-09 23:27:29,348 [INFO] src.luna_functions: Creating user @mallow_magic:localhost, admin=False via http://localhost:8008/_synapse/admin/v2/users/@mallow_magic:localhost
2025-01-09 23:27:29,592 [INFO] src.luna_functions: Created user @mallow_magic:localhost (HTTP 201)
2025-01-09 23:27:29,593 [INFO] src.luna_functions_assemble: User creation result => Created user @mallow_magic:localhost (admin=False).
2025-01-09 23:27:29,595 [INFO] src.luna_functions: Creating user @smores_scholar:localhost, admin=False via http://localhost:8008/_synapse/admin/v2/users/@smores_scholar:localhost
2025-01-09 23:27:29,839 [INFO] src.luna_functions: Created user @smores_scholar:localhost (HTTP 201)
2025-01-09 23:27:29,840 [INFO] src.luna_functions_assemble: User creation result => Created user @smores_scholar:localhost (admin=False).
2025-01-09 23:27:29,842 [INFO] src.luna_functions: Creating user @fluff_fanatic:localhost, admin=False via http://localhost:8008/_synapse/admin/v2/users/@fluff_fanatic:localhost
2025-01-09 23:27:30,087 [INFO] src.luna_functions: Created user @fluff_fanatic:localhost (HTTP 201)
2025-01-09 23:27:30,087 [INFO] src.luna_functions_assemble: User creation result => Created user @fluff_fanatic:localhost (admin=False).
2025-01-09 23:27:30,087 [INFO] src.luna_functions_assemble: Room create => Exception while creating room => 'str' object has no attribute 'value'
2025-01-09 23:27:36,723 [DEBUG] httpcore.http11: receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Fri, 10 Jan 2025 04:27:36 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-yzbp3micnvwwjimbcblinra3'), (b'openai-processing-ms', b'10750'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'5000'), (b'x-ratelimit-limit-tokens', b'80000'), (b'x-ratelimit-remaining-requests', b'4999'), (b'x-ratelimit-remaining-tokens', b'78785'), (b'x-ratelimit-reset-requests', b'12ms'), (b'x-ratelimit-reset-tokens', b'911ms'), (b'x-request-id', b'req_0d19bd2946a4eaf7ef66f90e5bbd8c6b'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=QMaOJ0DU58C9e0e5NWlWsv6pKGFWA09sLMD4kpfdyxU-1736483256-1.0.1.1-o35y2OPjPH8JOQhxtTfUHTpVsIw8_oupwH1JSfxi0HK6mRlXWQ_PyLfK47KxeFOuqwy7MpD45fj5XxblzOLWFg; path=/; expires=Fri, 10-Jan-25 04:57:36 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=qVb3gTGHgIrJz3VVOxDZ4Ek7eTqWAAeRl5aACLLX10I-1736483256686-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8ff9ea1eda7c8849-IAD'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2025-01-09 23:27:36,726 [INFO] httpx: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-09 23:27:36,726 [DEBUG] httpcore.http11: receive_response_body.started request=<Request [b'POST']>
2025-01-09 23:27:36,727 [DEBUG] httpcore.http11: receive_response_body.complete
2025-01-09 23:27:36,727 [DEBUG] httpcore.http11: response_closed.started
2025-01-09 23:27:36,727 [DEBUG] httpcore.http11: response_closed.complete
2025-01-09 23:27:36,728 [DEBUG] httpcore.connection: close.started
2025-01-09 23:27:36,728 [DEBUG] httpcore.connection: close.complete
2025-01-09 23:27:36,728 [DEBUG] openai._base_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "200 OK"
2025-01-09 23:27:36,730 [INFO] src.luna_functions: Creating user @tuna_talk:localhost, admin=False via http://localhost:8008/_synapse/admin/v2/users/@tuna_talk:localhost
2025-01-09 23:27:36,994 [INFO] src.luna_functions: Created user @tuna_talk:localhost (HTTP 201)
2025-01-09 23:27:36,995 [INFO] src.luna_functions_assemble: User creation result => Created user @tuna_talk:localhost (admin=False).
2025-01-09 23:27:36,998 [INFO] src.luna_functions: Creating user @tuna_trivia:localhost, admin=False via http://localhost:8008/_synapse/admin/v2/users/@tuna_trivia:localhost
2025-01-09 23:27:37,244 [INFO] src.luna_functions: Created user @tuna_trivia:localhost (HTTP 201)
2025-01-09 23:27:37,244 [INFO] src.luna_functions_assemble: User creation result => Created user @tuna_trivia:localhost (admin=False).
2025-01-09 23:27:37,247 [INFO] src.luna_functions: Creating user @tuna_tales:localhost, admin=False via http://localhost:8008/_synapse/admin/v2/users/@tuna_tales:localhost
2025-01-09 23:27:37,495 [INFO] src.luna_functions: Created user @tuna_tales:localhost (HTTP 201)
2025-01-09 23:27:37,495 [INFO] src.luna_functions_assemble: User creation result => Created user @tuna_tales:localhost (admin=False).
2025-01-09 23:27:37,495 [INFO] src.luna_functions_assemble: Room create => Exception while creating room => 'str' object has no attribute 'value'
2025-01-09 23:31:32,447 [INFO] src.console_functions: Console screen cleared.
2025-01-09 23:31:32,447 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 23:31:36,149 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 23:31:40,048 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 23:31:58,253 [DEBUG] src.console_functions: cmd_create_room called with args='"tunatalk"', loop=<_UnixSelectorEventLoop running=True closed=False debug=False>
2025-01-09 23:31:58,253 [INFO] src.console_functions: SYSTEM: Creating a new room named '"tunatalk"'...
2025-01-09 23:31:58,253 [DEBUG] src.console_functions: Attempting to load token from 'director_token.json'...
2025-01-09 23:31:58,254 [DEBUG] src.console_functions: Loaded token data. user_id=@lunabot:localhost, access_token=(redacted), device_id=WJIPDAYWIL
2025-01-09 23:31:58,254 [DEBUG] src.console_functions: Creating local AsyncClient for user_id='@lunabot:localhost' with homeserver='http://localhost:8008'
2025-01-09 23:31:58,254 [DEBUG] src.console_functions: Scheduling do_create_room() on the existing loop with run_coroutine_threadsafe.
2025-01-09 23:31:58,254 [DEBUG] src.console_functions: Blocking on future_create.result() to get the room_create response.
2025-01-09 23:31:58,255 [DEBUG] src.console_functions: do_create_room: about to call room_create(name='"tunatalk"', visibility='public')
2025-01-09 23:31:58,340 [INFO] nio.client.base_client: New joined room !vPFjZGGwOHwoODMQjc:localhost
2025-01-09 23:31:58,340 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomCreateEvent
2025-01-09 23:31:58,343 [DEBUG] src.console_functions: do_create_room: room_create call returned RoomCreateResponse(uuid='', start_time=None, end_time=None, timeout=0, transport_response=<ClientResponse(http://localhost:8008/_matrix/client/v3/createRoom) [200 OK]>
<CIMultiDictProxy('Server': 'Synapse/1.121.1', 'Date': 'Fri, 10 Jan 2025 04:31:58 GMT', 'Content-Type': 'application/json', 'Cache-Control': 'no-cache, no-store, must-revalidate', 'Access-Control-Allow-Origin': '*', 'Access-Control-Allow-Methods': 'GET, HEAD, POST, PUT, DELETE, OPTIONS', 'Access-Control-Allow-Headers': 'X-Requested-With, Content-Type, Authorization, Date', 'Access-Control-Expose-Headers': 'Synapse-Trace-Id, Server', 'Transfer-Encoding': 'chunked')>
, room_id='!vPFjZGGwOHwoODMQjc:localhost')
2025-01-09 23:31:58,343 [DEBUG] src.console_functions: future_create.result() returned => RoomCreateResponse(uuid='', start_time=None, end_time=None, timeout=0, transport_response=<ClientResponse(http://localhost:8008/_matrix/client/v3/createRoom) [200 OK]>
<CIMultiDictProxy('Server': 'Synapse/1.121.1', 'Date': 'Fri, 10 Jan 2025 04:31:58 GMT', 'Content-Type': 'application/json', 'Cache-Control': 'no-cache, no-store, must-revalidate', 'Access-Control-Allow-Origin': '*', 'Access-Control-Allow-Methods': 'GET, HEAD, POST, PUT, DELETE, OPTIONS', 'Access-Control-Allow-Headers': 'X-Requested-With, Content-Type, Authorization, Date', 'Access-Control-Expose-Headers': 'Synapse-Trace-Id, Server', 'Transfer-Encoding': 'chunked')>
, room_id='!vPFjZGGwOHwoODMQjc:localhost')
2025-01-09 23:31:58,343 [INFO] src.console_functions: SYSTEM: Created room '"tunatalk"' => !vPFjZGGwOHwoODMQjc:localhost
2025-01-09 23:31:58,343 [DEBUG] src.console_functions: Scheduling do_close_client() to gracefully close the AsyncClient.
2025-01-09 23:31:58,343 [DEBUG] src.console_functions: Blocking on future_close.result() to confirm the client is closed.
2025-01-09 23:31:58,343 [DEBUG] src.console_functions: do_close_client: closing the AsyncClient.
2025-01-09 23:31:58,344 [DEBUG] src.console_functions: do_close_client: client closed successfully.
2025-01-09 23:31:58,344 [DEBUG] src.console_functions: cmd_create_room: Done with final block.
2025-01-09 23:31:58,344 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 23:31:58,348 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type PowerLevelsEvent
2025-01-09 23:31:58,348 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-09 23:31:58,348 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomJoinRulesEvent
2025-01-09 23:31:58,348 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-09 23:31:58,348 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomNameEvent
2025-01-09 23:32:04,005 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 23:32:07,494 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 23:35:50,190 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomMessageText
2025-01-09 23:36:04,731 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 23:36:04,742 [DEBUG] openai._base_client: Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': 'You are Luna, a helpful assistant.'}, {'role': 'user', 'content': 'hello :luna:'}], 'model': 'gpt-4', 'max_tokens': 300, 'temperature': 0.7}}
2025-01-09 23:36:04,744 [DEBUG] httpcore.connection: close.started
2025-01-09 23:36:04,746 [DEBUG] httpcore.connection: close.complete
2025-01-09 23:36:04,748 [DEBUG] httpcore.connection: connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2025-01-09 23:36:04,873 [DEBUG] httpcore.connection: connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10e21be10>
2025-01-09 23:36:04,873 [DEBUG] httpcore.connection: start_tls.started ssl_context=<ssl.SSLContext object at 0x10637b770> server_hostname='api.openai.com' timeout=5.0
2025-01-09 23:36:04,911 [DEBUG] httpcore.connection: start_tls.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10e49d7f0>
2025-01-09 23:36:04,911 [DEBUG] httpcore.http11: send_request_headers.started request=<Request [b'POST']>
2025-01-09 23:36:04,912 [DEBUG] httpcore.http11: send_request_headers.complete
2025-01-09 23:36:04,912 [DEBUG] httpcore.http11: send_request_body.started request=<Request [b'POST']>
2025-01-09 23:36:04,912 [DEBUG] httpcore.http11: send_request_body.complete
2025-01-09 23:36:04,912 [DEBUG] httpcore.http11: receive_response_headers.started request=<Request [b'POST']>
2025-01-09 23:36:05,414 [DEBUG] httpcore.http11: receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Fri, 10 Jan 2025 04:36:05 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-yzbp3micnvwwjimbcblinra3'), (b'openai-processing-ms', b'435'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'5000'), (b'x-ratelimit-limit-tokens', b'80000'), (b'x-ratelimit-remaining-requests', b'4999'), (b'x-ratelimit-remaining-tokens', b'79686'), (b'x-ratelimit-reset-requests', b'12ms'), (b'x-ratelimit-reset-tokens', b'235ms'), (b'x-request-id', b'req_2db94950fdd9be5d1742d828840a1204'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8ff9f6cb1caad6ef-IAD'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2025-01-09 23:36:05,415 [INFO] httpx: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-09 23:36:05,415 [DEBUG] httpcore.http11: receive_response_body.started request=<Request [b'POST']>
2025-01-09 23:36:05,422 [DEBUG] httpcore.http11: receive_response_body.complete
2025-01-09 23:36:05,423 [DEBUG] httpcore.http11: response_closed.started
2025-01-09 23:36:05,423 [DEBUG] httpcore.http11: response_closed.complete
2025-01-09 23:36:05,424 [DEBUG] openai._base_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "200 OK"
2025-01-09 23:36:05,452 [INFO] src.luna_functions: Posted GPT reply to room !wksSOEXmjceGUTMkdv:localhost
2025-01-09 23:36:05,458 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 23:39:09,136 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 23:39:09,147 [DEBUG] openai._base_client: Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': 'You are Luna, a helpful assistant.'}, {'role': 'user', 'content': 'Do you talk'}], 'model': 'gpt-4', 'max_tokens': 300, 'temperature': 0.7}}
2025-01-09 23:39:09,148 [DEBUG] httpcore.connection: close.started
2025-01-09 23:39:09,149 [DEBUG] httpcore.connection: close.complete
2025-01-09 23:39:09,149 [DEBUG] httpcore.connection: connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2025-01-09 23:39:09,234 [DEBUG] httpcore.connection: connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10deeef10>
2025-01-09 23:39:09,235 [DEBUG] httpcore.connection: start_tls.started ssl_context=<ssl.SSLContext object at 0x10637b770> server_hostname='api.openai.com' timeout=5.0
2025-01-09 23:39:09,273 [DEBUG] httpcore.connection: start_tls.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10deef130>
2025-01-09 23:39:09,273 [DEBUG] httpcore.http11: send_request_headers.started request=<Request [b'POST']>
2025-01-09 23:39:09,274 [DEBUG] httpcore.http11: send_request_headers.complete
2025-01-09 23:39:09,274 [DEBUG] httpcore.http11: send_request_body.started request=<Request [b'POST']>
2025-01-09 23:39:09,274 [DEBUG] httpcore.http11: send_request_body.complete
2025-01-09 23:39:09,274 [DEBUG] httpcore.http11: receive_response_headers.started request=<Request [b'POST']>
2025-01-09 23:39:10,185 [DEBUG] httpcore.http11: receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Fri, 10 Jan 2025 04:39:10 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-yzbp3micnvwwjimbcblinra3'), (b'openai-processing-ms', b'746'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'5000'), (b'x-ratelimit-limit-tokens', b'80000'), (b'x-ratelimit-remaining-requests', b'4999'), (b'x-ratelimit-remaining-tokens', b'79686'), (b'x-ratelimit-reset-requests', b'12ms'), (b'x-ratelimit-reset-tokens', b'235ms'), (b'x-request-id', b'req_511aaf77e060a3646d3c3315e934239e'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8ff9fb4b6b20c98b-IAD'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2025-01-09 23:39:10,188 [INFO] httpx: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-09 23:39:10,189 [DEBUG] httpcore.http11: receive_response_body.started request=<Request [b'POST']>
2025-01-09 23:39:10,190 [DEBUG] httpcore.http11: receive_response_body.complete
2025-01-09 23:39:10,190 [DEBUG] httpcore.http11: response_closed.started
2025-01-09 23:39:10,190 [DEBUG] httpcore.http11: response_closed.complete
2025-01-09 23:39:10,190 [DEBUG] openai._base_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "200 OK"
2025-01-09 23:39:10,230 [INFO] src.luna_functions: Posted GPT reply to room !wksSOEXmjceGUTMkdv:localhost
2025-01-09 23:39:10,242 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 23:39:32,692 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 23:39:38,162 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 23:39:38,169 [DEBUG] openai._base_client: Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': 'You are Luna, a helpful assistant.'}, {'role': 'user', 'content': 'only untagged'}], 'model': 'gpt-4', 'max_tokens': 300, 'temperature': 0.7}}
2025-01-09 23:39:38,170 [DEBUG] httpcore.connection: close.started
2025-01-09 23:39:38,170 [DEBUG] httpcore.connection: close.complete
2025-01-09 23:39:38,170 [DEBUG] httpcore.connection: connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2025-01-09 23:39:38,242 [DEBUG] httpcore.connection: connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10e494a50>
2025-01-09 23:39:38,243 [DEBUG] httpcore.connection: start_tls.started ssl_context=<ssl.SSLContext object at 0x10637b770> server_hostname='api.openai.com' timeout=5.0
2025-01-09 23:39:38,281 [DEBUG] httpcore.connection: start_tls.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10e494e50>
2025-01-09 23:39:38,281 [DEBUG] httpcore.http11: send_request_headers.started request=<Request [b'POST']>
2025-01-09 23:39:38,282 [DEBUG] httpcore.http11: send_request_headers.complete
2025-01-09 23:39:38,282 [DEBUG] httpcore.http11: send_request_body.started request=<Request [b'POST']>
2025-01-09 23:39:38,282 [DEBUG] httpcore.http11: send_request_body.complete
2025-01-09 23:39:38,282 [DEBUG] httpcore.http11: receive_response_headers.started request=<Request [b'POST']>
2025-01-09 23:39:41,039 [DEBUG] httpcore.http11: receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Fri, 10 Jan 2025 04:39:41 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-yzbp3micnvwwjimbcblinra3'), (b'openai-processing-ms', b'2676'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'5000'), (b'x-ratelimit-limit-tokens', b'80000'), (b'x-ratelimit-remaining-requests', b'4999'), (b'x-ratelimit-remaining-tokens', b'79686'), (b'x-ratelimit-reset-requests', b'12ms'), (b'x-ratelimit-reset-tokens', b'235ms'), (b'x-request-id', b'req_6cda6ddd2631d990c52b97c619f4f44a'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8ff9fc00a807058e-IAD'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2025-01-09 23:39:41,041 [INFO] httpx: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-09 23:39:41,041 [DEBUG] httpcore.http11: receive_response_body.started request=<Request [b'POST']>
2025-01-09 23:39:41,042 [DEBUG] httpcore.http11: receive_response_body.complete
2025-01-09 23:39:41,043 [DEBUG] httpcore.http11: response_closed.started
2025-01-09 23:39:41,043 [DEBUG] httpcore.http11: response_closed.complete
2025-01-09 23:39:41,043 [DEBUG] openai._base_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "200 OK"
2025-01-09 23:39:41,084 [INFO] src.luna_functions: Posted GPT reply to room !wksSOEXmjceGUTMkdv:localhost
2025-01-09 23:39:41,090 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 23:42:37,748 [INFO] src.console_functions: Console received 'exit' command; requesting shutdown.
2025-01-09 23:42:37,751 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 23:42:37,751 [ERROR] __main__: An unexpected exception occurred in main_logic: Event loop stopped before Future completed.
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 139, in luna
    loop.run_until_complete(main_logic())
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 718, in run_until_complete
    raise RuntimeError('Event loop stopped before Future completed.')
RuntimeError: Event loop stopped before Future completed.
2025-01-09 23:42:37,758 [DEBUG] __main__: Preparing to close the event loop.
2025-01-09 23:42:37,758 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-09 23:42:40,522 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-09 23:42:40,522 [DEBUG] __main__: Exiting configure_logging function.
2025-01-09 23:42:40,523 [DEBUG] __main__: Logging configuration complete.
2025-01-09 23:42:40,523 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-09 23:42:40,523 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 23:42:40,523 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-09 23:42:40,523 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-09 23:42:40,523 [DEBUG] __main__: Entering start_console_thread function.
2025-01-09 23:42:40,526 [INFO] __main__: Console thread started successfully.
2025-01-09 23:42:40,526 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-09 23:42:40,526 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-09 23:42:40,526 [INFO] __main__: Starting main_logic coroutine.
2025-01-09 23:42:40,526 [DEBUG] __main__: Entering main_logic function...
2025-01-09 23:42:40,526 [DEBUG] src.luna_functions: Found director_token.json; attempting token-based login.
2025-01-09 23:42:40,528 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-09 23:42:40,538 [INFO] src.luna_functions: Token-based login verified for user @lunabot:localhost.
2025-01-09 23:42:40,538 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-09 23:42:40,558 [INFO] src.console_functions: Console screen cleared.
2025-01-09 23:42:40,568 [INFO] nio.client.base_client: New joined room !fhmXoYxDdsImUkYUpf:localhost
2025-01-09 23:42:40,568 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomCreateEvent
2025-01-09 23:42:40,568 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type PowerLevelsEvent
2025-01-09 23:42:40,568 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-09 23:42:40,568 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomJoinRulesEvent
2025-01-09 23:42:40,568 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-09 23:42:40,568 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomNameEvent
2025-01-09 23:42:40,568 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomMessageText
2025-01-09 23:42:40,571 [INFO] nio.client.base_client: New joined room !vPFjZGGwOHwoODMQjc:localhost
2025-01-09 23:42:40,571 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomCreateEvent
2025-01-09 23:42:40,571 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type PowerLevelsEvent
2025-01-09 23:42:40,571 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-09 23:42:40,571 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomJoinRulesEvent
2025-01-09 23:42:40,571 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-09 23:42:40,571 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomNameEvent
2025-01-09 23:42:40,571 [INFO] nio.client.base_client: New joined room !wksSOEXmjceGUTMkdv:localhost
2025-01-09 23:42:40,571 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type PowerLevelsEvent
2025-01-09 23:42:40,571 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomGuestAccessEvent
2025-01-09 23:42:40,571 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomCreateEvent
2025-01-09 23:42:40,571 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-09 23:42:40,571 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomJoinRulesEvent
2025-01-09 23:42:40,571 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 23:42:40,572 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 23:42:40,573 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 23:42:40,574 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 23:42:40,574 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 23:42:40,574 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 23:42:40,575 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 23:42:40,575 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 23:42:40,576 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 23:42:40,576 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-09 23:42:40,676 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-09 23:42:52,992 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 09:09:32,495 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-10 20:32:58,106 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-10 20:32:58,106 [DEBUG] __main__: Exiting configure_logging function.
2025-01-10 20:32:58,106 [DEBUG] __main__: Logging configuration complete.
2025-01-10 20:32:58,106 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-10 20:32:58,106 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 20:32:58,106 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-10 20:32:58,106 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-10 20:32:58,106 [DEBUG] __main__: Entering start_console_thread function.
2025-01-10 20:32:58,107 [INFO] __main__: Console thread started successfully.
2025-01-10 20:32:58,107 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-10 20:32:58,107 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-10 20:32:58,107 [INFO] __main__: Starting main_logic coroutine.
2025-01-10 20:32:58,108 [DEBUG] __main__: Entering main_logic function...
2025-01-10 20:32:58,108 [DEBUG] src.luna_functions: Found director_token.json; attempting token-based login.
2025-01-10 20:32:58,109 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-10 20:32:58,117 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-10 20:32:58,118 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-10 20:32:58,126 [INFO] src.console_functions: Console screen cleared.
2025-01-10 20:32:58,242 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 20:32:58,320 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-10 20:32:58,723 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-10 20:32:59,527 [WARNING] nio.client.async_client: Timed out, sleeping for 1s
2025-01-10 20:33:01,133 [WARNING] nio.client.async_client: Timed out, sleeping for 3s
2025-01-10 20:33:04,337 [WARNING] nio.client.async_client: Timed out, sleeping for 6s
2025-01-10 20:33:05,329 [ERROR] src.luna_functions: Error calling list_users admin API: Cannot connect to host localhost:8008 ssl:default [Multiple exceptions: [Errno 61] Connect call failed ('::1', 8008, 0, 0), [Errno 61] Connect call failed ('127.0.0.1', 8008)]
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/aiohttp/connector.py", line 1115, in _wrap_create_connection
    sock = await aiohappyeyeballs.start_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/aiohappyeyeballs/impl.py", line 123, in start_connection
    raise OSError(first_errno, msg)
ConnectionRefusedError: [Errno 61] Multiple exceptions: [Errno 61] Connect call failed ('::1', 8008, 0, 0), [Errno 61] Connect call failed ('127.0.0.1', 8008)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/src/luna_functions.py", line 571, in list_users
    async with session.get(url, headers=headers) as resp:
               ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/aiohttp/client.py", line 1425, in __aenter__
    self._resp: _RetType = await self._coro
                           ^^^^^^^^^^^^^^^^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/aiohttp/client.py", line 703, in _request
    conn = await self._connector.connect(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        req, traces=traces, timeout=real_timeout
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/aiohttp/connector.py", line 548, in connect
    proto = await self._create_connection(req, traces, timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/aiohttp/connector.py", line 1056, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/aiohttp/connector.py", line 1400, in _create_direct_connection
    raise last_exc
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/aiohttp/connector.py", line 1369, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
    )
    ^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/aiohttp/connector.py", line 1130, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host localhost:8008 ssl:default [Multiple exceptions: [Errno 61] Connect call failed ('::1', 8008, 0, 0), [Errno 61] Connect call failed ('127.0.0.1', 8008)]
2025-01-10 20:33:05,338 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 20:33:10,743 [WARNING] nio.client.async_client: Timed out, sleeping for 12s
2025-01-10 20:33:23,549 [WARNING] nio.client.async_client: Timed out, sleeping for 25s
2025-01-10 20:33:34,481 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 20:33:45,459 [WARNING] src.luna_functions: list_rooms called, but DIRECTOR_CLIENT is None.
2025-01-10 20:33:45,460 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 20:33:49,162 [INFO] src.luna_functions: Token-based login verified for user @lunabot:localhost.
2025-01-10 20:33:49,162 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-10 20:33:49,205 [INFO] nio.client.base_client: New joined room !vPFjZGGwOHwoODMQjc:localhost
2025-01-10 20:33:49,205 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomCreateEvent
2025-01-10 20:33:49,205 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type PowerLevelsEvent
2025-01-10 20:33:49,205 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-10 20:33:49,205 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomJoinRulesEvent
2025-01-10 20:33:49,205 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 20:33:49,205 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomNameEvent
2025-01-10 20:33:49,205 [INFO] nio.client.base_client: New joined room !fhmXoYxDdsImUkYUpf:localhost
2025-01-10 20:33:49,205 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomCreateEvent
2025-01-10 20:33:49,205 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type PowerLevelsEvent
2025-01-10 20:33:49,205 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-10 20:33:49,205 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomJoinRulesEvent
2025-01-10 20:33:49,205 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 20:33:49,205 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomNameEvent
2025-01-10 20:33:49,205 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomMessageText
2025-01-10 20:33:49,212 [INFO] nio.client.base_client: New joined room !wksSOEXmjceGUTMkdv:localhost
2025-01-10 20:33:49,212 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomCreateEvent
2025-01-10 20:33:49,212 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 20:33:49,212 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type PowerLevelsEvent
2025-01-10 20:33:49,213 [INFO] nio.rooms: Changing power level for user @evan:localhost from 0 to 100
2025-01-10 20:33:49,213 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomGuestAccessEvent
2025-01-10 20:33:49,213 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomJoinRulesEvent
2025-01-10 20:33:49,213 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 20:33:49,213 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 20:33:49,213 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 20:33:49,214 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 20:33:49,215 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 20:33:49,215 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 20:33:49,215 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 20:33:49,215 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 20:33:49,216 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 20:33:49,216 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 20:34:03,417 [INFO] src.console_functions: Console received 'exit' command; requesting shutdown.
2025-01-10 20:34:03,418 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 20:34:03,418 [ERROR] __main__: An unexpected exception occurred in main_logic: Event loop stopped before Future completed.
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 139, in luna
    loop.run_until_complete(main_logic())
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 718, in run_until_complete
    raise RuntimeError('Event loop stopped before Future completed.')
RuntimeError: Event loop stopped before Future completed.
2025-01-10 20:34:03,423 [DEBUG] __main__: Preparing to close the event loop.
2025-01-10 20:34:03,424 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-10 20:34:05,706 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-10 20:34:05,706 [DEBUG] __main__: Exiting configure_logging function.
2025-01-10 20:34:05,706 [DEBUG] __main__: Logging configuration complete.
2025-01-10 20:34:05,706 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-10 20:34:05,706 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 20:34:05,707 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-10 20:34:05,707 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-10 20:34:05,707 [DEBUG] __main__: Entering start_console_thread function.
2025-01-10 20:34:05,709 [INFO] __main__: Console thread started successfully.
2025-01-10 20:34:05,709 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-10 20:34:05,709 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-10 20:34:05,709 [INFO] __main__: Starting main_logic coroutine.
2025-01-10 20:34:05,709 [DEBUG] __main__: Entering main_logic function...
2025-01-10 20:34:05,709 [DEBUG] src.luna_functions: Found director_token.json; attempting token-based login.
2025-01-10 20:34:05,711 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-10 20:34:05,719 [INFO] src.luna_functions: Token-based login verified for user @lunabot:localhost.
2025-01-10 20:34:05,720 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-10 20:34:05,725 [INFO] nio.client.base_client: New joined room !vPFjZGGwOHwoODMQjc:localhost
2025-01-10 20:34:05,725 [INFO] src.console_functions: Console screen cleared.
2025-01-10 20:34:05,725 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomCreateEvent
2025-01-10 20:34:05,725 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type PowerLevelsEvent
2025-01-10 20:34:05,725 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-10 20:34:05,725 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomJoinRulesEvent
2025-01-10 20:34:05,725 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 20:34:05,725 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomNameEvent
2025-01-10 20:34:05,725 [INFO] nio.client.base_client: New joined room !fhmXoYxDdsImUkYUpf:localhost
2025-01-10 20:34:05,725 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomCreateEvent
2025-01-10 20:34:05,726 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type PowerLevelsEvent
2025-01-10 20:34:05,726 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-10 20:34:05,726 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomJoinRulesEvent
2025-01-10 20:34:05,726 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 20:34:05,726 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomNameEvent
2025-01-10 20:34:05,726 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomMessageText
2025-01-10 20:34:05,728 [INFO] nio.client.base_client: New joined room !wksSOEXmjceGUTMkdv:localhost
2025-01-10 20:34:05,728 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomCreateEvent
2025-01-10 20:34:05,728 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 20:34:05,728 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type PowerLevelsEvent
2025-01-10 20:34:05,728 [INFO] nio.rooms: Changing power level for user @evan:localhost from 0 to 100
2025-01-10 20:34:05,728 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomGuestAccessEvent
2025-01-10 20:34:05,728 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomJoinRulesEvent
2025-01-10 20:34:05,728 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 20:34:05,728 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 20:34:05,729 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 20:34:05,729 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 20:34:05,730 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 20:34:05,730 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 20:34:05,731 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 20:34:05,731 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 20:34:05,732 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 20:34:05,732 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 20:34:05,768 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 20:34:07,456 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 20:34:13,635 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 20:34:44,849 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-10 20:34:44,849 [DEBUG] __main__: Exiting configure_logging function.
2025-01-10 20:34:44,849 [DEBUG] __main__: Logging configuration complete.
2025-01-10 20:34:44,849 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-10 20:34:44,849 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 20:34:44,849 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-10 20:34:44,849 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-10 20:34:44,849 [DEBUG] __main__: Entering start_console_thread function.
2025-01-10 20:34:44,851 [INFO] __main__: Console thread started successfully.
2025-01-10 20:34:44,851 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-10 20:34:44,851 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-10 20:34:44,851 [INFO] __main__: Starting main_logic coroutine.
2025-01-10 20:34:44,851 [DEBUG] __main__: Entering main_logic function...
2025-01-10 20:34:44,851 [DEBUG] src.luna_functions: Found director_token.json; attempting token-based login.
2025-01-10 20:34:44,853 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-10 20:34:44,863 [INFO] src.luna_functions: Token-based login verified for user @lunabot:localhost.
2025-01-10 20:34:44,863 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-10 20:34:44,870 [INFO] nio.client.base_client: New joined room !vPFjZGGwOHwoODMQjc:localhost
2025-01-10 20:34:44,870 [INFO] src.console_functions: Console screen cleared.
2025-01-10 20:34:44,870 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomCreateEvent
2025-01-10 20:34:44,870 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type PowerLevelsEvent
2025-01-10 20:34:44,870 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-10 20:34:44,870 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomJoinRulesEvent
2025-01-10 20:34:44,871 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 20:34:44,871 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomNameEvent
2025-01-10 20:34:44,871 [INFO] nio.client.base_client: New joined room !fhmXoYxDdsImUkYUpf:localhost
2025-01-10 20:34:44,871 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomCreateEvent
2025-01-10 20:34:44,871 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type PowerLevelsEvent
2025-01-10 20:34:44,871 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-10 20:34:44,871 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomJoinRulesEvent
2025-01-10 20:34:44,871 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 20:34:44,871 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomNameEvent
2025-01-10 20:34:44,871 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomMessageText
2025-01-10 20:34:44,873 [INFO] nio.client.base_client: New joined room !wksSOEXmjceGUTMkdv:localhost
2025-01-10 20:34:44,873 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomCreateEvent
2025-01-10 20:34:44,873 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 20:34:44,873 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type PowerLevelsEvent
2025-01-10 20:34:44,873 [INFO] nio.rooms: Changing power level for user @evan:localhost from 0 to 100
2025-01-10 20:34:44,873 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomGuestAccessEvent
2025-01-10 20:34:44,873 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomJoinRulesEvent
2025-01-10 20:34:44,873 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 20:34:44,874 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 20:34:44,874 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 20:34:44,876 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 20:34:44,877 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 20:34:44,877 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 20:34:44,878 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 20:34:44,878 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 20:34:44,878 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 20:34:44,879 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 20:34:44,914 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 20:35:00,038 [INFO] root: Received create_room_luna command.
2025-01-10 20:35:00,038 [INFO] root: Calling luna_functions.create_room.
2025-01-10 20:35:00,039 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 20:35:14,598 [INFO] root: Received create_room_luna command.
2025-01-10 20:35:14,598 [INFO] root: Calling luna_functions.create_room.
2025-01-10 20:35:14,598 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 20:38:49,191 [INFO] src.console_functions: Console received 'exit' command; requesting shutdown.
2025-01-10 20:38:49,193 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 20:38:49,194 [ERROR] __main__: An unexpected exception occurred in main_logic: Event loop stopped before Future completed.
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 139, in luna
    loop.run_until_complete(main_logic())
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 718, in run_until_complete
    raise RuntimeError('Event loop stopped before Future completed.')
RuntimeError: Event loop stopped before Future completed.
2025-01-10 20:38:49,200 [DEBUG] __main__: Preparing to close the event loop.
2025-01-10 20:38:49,201 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-10 20:38:51,177 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-10 20:38:51,178 [DEBUG] __main__: Exiting configure_logging function.
2025-01-10 20:38:51,178 [DEBUG] __main__: Logging configuration complete.
2025-01-10 20:38:51,178 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-10 20:38:51,178 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 20:38:51,178 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-10 20:38:51,178 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-10 20:38:51,178 [DEBUG] __main__: Entering start_console_thread function.
2025-01-10 20:38:51,180 [INFO] __main__: Console thread started successfully.
2025-01-10 20:38:51,180 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-10 20:38:51,180 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-10 20:38:51,180 [INFO] __main__: Starting main_logic coroutine.
2025-01-10 20:38:51,181 [DEBUG] __main__: Entering main_logic function...
2025-01-10 20:38:51,181 [DEBUG] src.luna_functions: Found director_token.json; attempting token-based login.
2025-01-10 20:38:51,182 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-10 20:38:51,190 [INFO] src.luna_functions: Token-based login verified for user @lunabot:localhost.
2025-01-10 20:38:51,190 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-10 20:38:51,213 [INFO] nio.client.base_client: New joined room !wksSOEXmjceGUTMkdv:localhost
2025-01-10 20:38:51,213 [INFO] src.console_functions: Console screen cleared.
2025-01-10 20:38:51,213 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomCreateEvent
2025-01-10 20:38:51,213 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 20:38:51,213 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type PowerLevelsEvent
2025-01-10 20:38:51,213 [INFO] nio.rooms: Changing power level for user @evan:localhost from 0 to 100
2025-01-10 20:38:51,213 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomGuestAccessEvent
2025-01-10 20:38:51,213 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomJoinRulesEvent
2025-01-10 20:38:51,213 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 20:38:51,216 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 20:38:51,216 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 20:38:51,218 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 20:38:51,219 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 20:38:51,219 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 20:38:51,220 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 20:38:51,220 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 20:38:51,221 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 20:38:51,222 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 20:38:51,222 [INFO] nio.client.base_client: New joined room !fhmXoYxDdsImUkYUpf:localhost
2025-01-10 20:38:51,222 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomCreateEvent
2025-01-10 20:38:51,222 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type PowerLevelsEvent
2025-01-10 20:38:51,222 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-10 20:38:51,222 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomJoinRulesEvent
2025-01-10 20:38:51,222 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 20:38:51,222 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomNameEvent
2025-01-10 20:38:51,223 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomMessageText
2025-01-10 20:38:51,223 [INFO] nio.client.base_client: New joined room !vPFjZGGwOHwoODMQjc:localhost
2025-01-10 20:38:51,223 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomCreateEvent
2025-01-10 20:38:51,223 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type PowerLevelsEvent
2025-01-10 20:38:51,224 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-10 20:38:51,224 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomJoinRulesEvent
2025-01-10 20:38:51,224 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 20:38:51,224 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomNameEvent
2025-01-10 20:38:51,331 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 20:39:01,932 [INFO] root: Received create_room_luna command.
2025-01-10 20:39:01,933 [INFO] root: Calling luna_functions.create_room.
2025-01-10 20:39:01,933 [DEBUG] src.luna_functions: Entering create_room() with room_name='test', is_public=True
2025-01-10 20:39:01,933 [DEBUG] src.luna_functions: Room visibility determined: 'public'
2025-01-10 20:39:01,933 [DEBUG] src.luna_functions: Calling DIRECTOR_CLIENT.room_create(name='test', visibility='public')
2025-01-10 20:39:01,934 [ERROR] src.luna_functions: Caught an exception while creating room 'test':
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/src/luna_functions.py", line 141, in create_room
    response = await DIRECTOR_CLIENT.room_create(name=room_name, visibility=visibility)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/base_client.py", line 116, in wrapper
    return await func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 2519, in room_create
    method, path, data = Api.room_create(
                         ~~~~~~~~~~~~~~~^
        self.access_token,
        ^^^^^^^^^^^^^^^^^^
    ...<13 lines>...
        space=space,
        ^^^^^^^^^^^^
    )
    ^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/api.py", line 1085, in room_create
    "visibility": visibility.value,
                  ^^^^^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'value'
2025-01-10 20:39:01,938 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 20:47:30,001 [INFO] src.console_functions: Console received 'exit' command; requesting shutdown.
2025-01-10 20:47:30,003 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 20:47:30,003 [ERROR] __main__: An unexpected exception occurred in main_logic: Event loop stopped before Future completed.
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 139, in luna
    loop.run_until_complete(main_logic())
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 718, in run_until_complete
    raise RuntimeError('Event loop stopped before Future completed.')
RuntimeError: Event loop stopped before Future completed.
2025-01-10 20:47:30,005 [DEBUG] __main__: Preparing to close the event loop.
2025-01-10 20:47:30,005 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-10 20:47:31,717 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-10 20:47:31,717 [DEBUG] __main__: Exiting configure_logging function.
2025-01-10 20:47:31,717 [DEBUG] __main__: Logging configuration complete.
2025-01-10 20:47:31,717 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-10 20:47:31,717 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 20:47:31,717 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-10 20:47:31,717 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-10 20:47:31,717 [DEBUG] __main__: Entering start_console_thread function.
2025-01-10 20:47:31,719 [INFO] __main__: Console thread started successfully.
2025-01-10 20:47:31,719 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-10 20:47:31,719 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-10 20:47:31,719 [INFO] __main__: Starting main_logic coroutine.
2025-01-10 20:47:31,719 [DEBUG] __main__: Entering main_logic function...
2025-01-10 20:47:31,719 [DEBUG] src.luna_functions: Found director_token.json; attempting token-based login.
2025-01-10 20:47:31,721 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-10 20:47:31,729 [INFO] src.luna_functions: Token-based login verified for user @lunabot:localhost.
2025-01-10 20:47:31,729 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-10 20:47:31,739 [INFO] src.console_functions: Console screen cleared.
2025-01-10 20:47:31,752 [INFO] nio.client.base_client: New joined room !wksSOEXmjceGUTMkdv:localhost
2025-01-10 20:47:31,752 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomCreateEvent
2025-01-10 20:47:31,752 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 20:47:31,752 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type PowerLevelsEvent
2025-01-10 20:47:31,752 [INFO] nio.rooms: Changing power level for user @evan:localhost from 0 to 100
2025-01-10 20:47:31,752 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomGuestAccessEvent
2025-01-10 20:47:31,752 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomJoinRulesEvent
2025-01-10 20:47:31,752 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 20:47:31,754 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 20:47:31,754 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 20:47:31,755 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 20:47:31,756 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 20:47:31,756 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 20:47:31,757 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 20:47:31,757 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 20:47:31,758 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 20:47:31,758 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 20:47:31,758 [INFO] nio.client.base_client: New joined room !fhmXoYxDdsImUkYUpf:localhost
2025-01-10 20:47:31,758 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomCreateEvent
2025-01-10 20:47:31,758 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type PowerLevelsEvent
2025-01-10 20:47:31,759 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-10 20:47:31,759 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomJoinRulesEvent
2025-01-10 20:47:31,759 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 20:47:31,759 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomNameEvent
2025-01-10 20:47:31,759 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomMessageText
2025-01-10 20:47:31,759 [INFO] nio.client.base_client: New joined room !vPFjZGGwOHwoODMQjc:localhost
2025-01-10 20:47:31,759 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomCreateEvent
2025-01-10 20:47:31,759 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type PowerLevelsEvent
2025-01-10 20:47:31,759 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-10 20:47:31,759 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomJoinRulesEvent
2025-01-10 20:47:31,759 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 20:47:31,759 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomNameEvent
2025-01-10 20:47:31,864 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 20:47:44,652 [INFO] root: Received create_room_luna command.
2025-01-10 20:47:44,652 [INFO] root: Calling luna_functions.create_room.
2025-01-10 20:47:44,653 [DEBUG] src.luna_functions: Entering create_room() with room_name='fiveMunchyCrocs', is_public=True
2025-01-10 20:47:44,653 [DEBUG] src.luna_functions: Room visibility determined: 'public'
2025-01-10 20:47:44,653 [DEBUG] src.luna_functions: Calling DIRECTOR_CLIENT.room_create(name='fiveMunchyCrocs', visibility='public')
2025-01-10 20:47:44,653 [ERROR] src.luna_functions: Caught an exception while creating room 'fiveMunchyCrocs':
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/src/luna_functions.py", line 141, in create_room
    response = await DIRECTOR_CLIENT.room_create(name=room_name, visibility=visibility)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/base_client.py", line 116, in wrapper
    return await func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 2519, in room_create
    method, path, data = Api.room_create(
                         ~~~~~~~~~~~~~~~^
        self.access_token,
        ^^^^^^^^^^^^^^^^^^
    ...<13 lines>...
        space=space,
        ^^^^^^^^^^^^
    )
    ^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/api.py", line 1085, in room_create
    "visibility": visibility.value,
                  ^^^^^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'value'
2025-01-10 20:47:44,655 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 20:49:27,295 [INFO] src.console_functions: Console received 'exit' command; requesting shutdown.
2025-01-10 20:49:27,297 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 20:49:27,297 [ERROR] __main__: An unexpected exception occurred in main_logic: Event loop stopped before Future completed.
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 139, in luna
    loop.run_until_complete(main_logic())
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 718, in run_until_complete
    raise RuntimeError('Event loop stopped before Future completed.')
RuntimeError: Event loop stopped before Future completed.
2025-01-10 20:49:27,303 [DEBUG] __main__: Preparing to close the event loop.
2025-01-10 20:49:27,303 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-10 20:49:29,432 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-10 20:49:29,432 [DEBUG] __main__: Exiting configure_logging function.
2025-01-10 20:49:29,432 [DEBUG] __main__: Logging configuration complete.
2025-01-10 20:49:29,432 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-10 20:49:29,432 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 20:49:29,432 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-10 20:49:29,432 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-10 20:49:29,432 [DEBUG] __main__: Entering start_console_thread function.
2025-01-10 20:49:29,434 [INFO] __main__: Console thread started successfully.
2025-01-10 20:49:29,435 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-10 20:49:29,435 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-10 20:49:29,435 [INFO] __main__: Starting main_logic coroutine.
2025-01-10 20:49:29,435 [DEBUG] __main__: Entering main_logic function...
2025-01-10 20:49:29,435 [DEBUG] src.luna_functions: Found director_token.json; attempting token-based login.
2025-01-10 20:49:29,436 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-10 20:49:29,444 [INFO] src.luna_functions: Token-based login verified for user @lunabot:localhost.
2025-01-10 20:49:29,444 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-10 20:49:29,451 [INFO] nio.client.base_client: New joined room !wksSOEXmjceGUTMkdv:localhost
2025-01-10 20:49:29,451 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomCreateEvent
2025-01-10 20:49:29,451 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 20:49:29,451 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type PowerLevelsEvent
2025-01-10 20:49:29,451 [INFO] nio.rooms: Changing power level for user @evan:localhost from 0 to 100
2025-01-10 20:49:29,451 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomGuestAccessEvent
2025-01-10 20:49:29,452 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomJoinRulesEvent
2025-01-10 20:49:29,452 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 20:49:29,454 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 20:49:29,454 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 20:49:29,455 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 20:49:29,455 [INFO] src.console_functions: Console screen cleared.
2025-01-10 20:49:29,455 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 20:49:29,455 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 20:49:29,456 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 20:49:29,456 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 20:49:29,457 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 20:49:29,458 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 20:49:29,458 [INFO] nio.client.base_client: New joined room !fhmXoYxDdsImUkYUpf:localhost
2025-01-10 20:49:29,458 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomCreateEvent
2025-01-10 20:49:29,458 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type PowerLevelsEvent
2025-01-10 20:49:29,458 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-10 20:49:29,458 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomJoinRulesEvent
2025-01-10 20:49:29,458 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 20:49:29,458 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomNameEvent
2025-01-10 20:49:29,458 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomMessageText
2025-01-10 20:49:29,459 [INFO] nio.client.base_client: New joined room !vPFjZGGwOHwoODMQjc:localhost
2025-01-10 20:49:29,459 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomCreateEvent
2025-01-10 20:49:29,459 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type PowerLevelsEvent
2025-01-10 20:49:29,459 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-10 20:49:29,459 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomJoinRulesEvent
2025-01-10 20:49:29,459 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 20:49:29,459 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomNameEvent
2025-01-10 20:49:29,573 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 20:49:41,873 [INFO] root: Received create_room_luna command.
2025-01-10 20:49:41,874 [INFO] root: Calling luna_functions.create_room.
2025-01-10 20:49:41,874 [DEBUG] src.luna_functions: Entering create_room() with room_name='testy', is_public=True
2025-01-10 20:49:41,874 [DEBUG] src.luna_functions: Room visibility determined: 'public'
2025-01-10 20:49:41,874 [DEBUG] src.luna_functions: Calling DIRECTOR_CLIENT.room_create(name='testy', visibility='public')
2025-01-10 20:49:41,874 [ERROR] src.luna_functions: Caught an exception while creating room 'testy':
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/src/luna_functions.py", line 141, in create_room
    response = await DIRECTOR_CLIENT.room_create(name=room_name, visibility=visibility)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/base_client.py", line 116, in wrapper
    return await func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 2519, in room_create
    method, path, data = Api.room_create(
                         ~~~~~~~~~~~~~~~^
        self.access_token,
        ^^^^^^^^^^^^^^^^^^
    ...<13 lines>...
        space=space,
        ^^^^^^^^^^^^
    )
    ^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/api.py", line 1085, in room_create
    "visibility": visibility.value,
                  ^^^^^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'value'
2025-01-10 20:49:41,880 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 20:53:41,295 [INFO] src.console_functions: Console received 'exit' command; requesting shutdown.
2025-01-10 20:53:41,296 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 20:53:41,296 [ERROR] __main__: An unexpected exception occurred in main_logic: Event loop stopped before Future completed.
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 139, in luna
    loop.run_until_complete(main_logic())
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 718, in run_until_complete
    raise RuntimeError('Event loop stopped before Future completed.')
RuntimeError: Event loop stopped before Future completed.
2025-01-10 20:53:41,299 [DEBUG] __main__: Preparing to close the event loop.
2025-01-10 20:53:41,300 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-10 20:53:43,410 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-10 20:53:43,410 [DEBUG] __main__: Exiting configure_logging function.
2025-01-10 20:53:43,410 [DEBUG] __main__: Logging configuration complete.
2025-01-10 20:53:43,410 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-10 20:53:43,410 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 20:53:43,411 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-10 20:53:43,411 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-10 20:53:43,411 [DEBUG] __main__: Entering start_console_thread function.
2025-01-10 20:53:43,413 [INFO] __main__: Console thread started successfully.
2025-01-10 20:53:43,413 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-10 20:53:43,413 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-10 20:53:43,413 [INFO] __main__: Starting main_logic coroutine.
2025-01-10 20:53:43,413 [DEBUG] __main__: Entering main_logic function...
2025-01-10 20:53:43,415 [DEBUG] src.luna_functions: Found director_token.json; attempting token-based login.
2025-01-10 20:53:43,415 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-10 20:53:43,426 [INFO] src.luna_functions: Token-based login verified for user @lunabot:localhost.
2025-01-10 20:53:43,426 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-10 20:53:43,435 [INFO] src.console_functions: Console screen cleared.
2025-01-10 20:53:43,449 [INFO] nio.client.base_client: New joined room !wksSOEXmjceGUTMkdv:localhost
2025-01-10 20:53:43,449 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomCreateEvent
2025-01-10 20:53:43,449 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 20:53:43,449 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type PowerLevelsEvent
2025-01-10 20:53:43,449 [INFO] nio.rooms: Changing power level for user @evan:localhost from 0 to 100
2025-01-10 20:53:43,449 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomGuestAccessEvent
2025-01-10 20:53:43,449 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomJoinRulesEvent
2025-01-10 20:53:43,449 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 20:53:43,451 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 20:53:43,451 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 20:53:43,452 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 20:53:43,453 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 20:53:43,453 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 20:53:43,454 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 20:53:43,454 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 20:53:43,454 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 20:53:43,455 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 20:53:43,455 [INFO] nio.client.base_client: New joined room !fhmXoYxDdsImUkYUpf:localhost
2025-01-10 20:53:43,455 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomCreateEvent
2025-01-10 20:53:43,455 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type PowerLevelsEvent
2025-01-10 20:53:43,455 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-10 20:53:43,455 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomJoinRulesEvent
2025-01-10 20:53:43,455 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 20:53:43,455 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomNameEvent
2025-01-10 20:53:43,455 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomMessageText
2025-01-10 20:53:43,456 [INFO] nio.client.base_client: New joined room !vPFjZGGwOHwoODMQjc:localhost
2025-01-10 20:53:43,456 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomCreateEvent
2025-01-10 20:53:43,456 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type PowerLevelsEvent
2025-01-10 20:53:43,456 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-10 20:53:43,456 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomJoinRulesEvent
2025-01-10 20:53:43,456 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 20:53:43,456 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomNameEvent
2025-01-10 20:53:43,553 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 20:53:46,870 [INFO] root: Received create_room_luna command.
2025-01-10 20:53:46,870 [INFO] root: Calling luna_functions.create_room.
2025-01-10 20:53:46,870 [DEBUG] src.luna_functions: Entering create_room() with room_name='test33232', is_public=True
2025-01-10 20:53:46,870 [DEBUG] src.luna_functions: Room visibility determined: 'public'
2025-01-10 20:53:46,870 [DEBUG] src.luna_functions: Calling DIRECTOR_CLIENT.room_create(name='test33232', visibility='public')
2025-01-10 20:53:46,870 [ERROR] src.luna_functions: Caught an exception while creating room 'test33232':
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/src/luna_functions.py", line 141, in create_room
    response = await DIRECTOR_CLIENT.room_create(name=room_name, visibility=visibility)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/base_client.py", line 116, in wrapper
    return await func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 2519, in room_create
    method, path, data = Api.room_create(
                         ~~~~~~~~~~~~~~~^
        self.access_token,
        ^^^^^^^^^^^^^^^^^^
    ...<13 lines>...
        space=space,
        ^^^^^^^^^^^^
    )
    ^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/api.py", line 1085, in room_create
    "visibility": visibility.value,
                  ^^^^^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'value'
2025-01-10 20:53:46,874 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 20:55:52,292 [INFO] src.console_functions: Console received 'exit' command; requesting shutdown.
2025-01-10 20:55:52,294 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 20:55:52,294 [ERROR] __main__: An unexpected exception occurred in main_logic: Event loop stopped before Future completed.
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 139, in luna
    loop.run_until_complete(main_logic())
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 718, in run_until_complete
    raise RuntimeError('Event loop stopped before Future completed.')
RuntimeError: Event loop stopped before Future completed.
2025-01-10 20:55:52,301 [DEBUG] __main__: Preparing to close the event loop.
2025-01-10 20:55:52,301 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-10 20:55:54,374 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-10 20:55:54,374 [DEBUG] __main__: Exiting configure_logging function.
2025-01-10 20:55:54,374 [DEBUG] __main__: Logging configuration complete.
2025-01-10 20:55:54,374 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-10 20:55:54,374 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 20:55:54,375 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-10 20:55:54,375 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-10 20:55:54,375 [DEBUG] __main__: Entering start_console_thread function.
2025-01-10 20:55:54,376 [INFO] __main__: Console thread started successfully.
2025-01-10 20:55:54,376 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-10 20:55:54,376 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-10 20:55:54,376 [INFO] __main__: Starting main_logic coroutine.
2025-01-10 20:55:54,376 [DEBUG] __main__: Entering main_logic function...
2025-01-10 20:55:54,376 [DEBUG] src.luna_functions: Found director_token.json; attempting token-based login.
2025-01-10 20:55:54,378 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-10 20:55:54,385 [INFO] src.luna_functions: Token-based login verified for user @lunabot:localhost.
2025-01-10 20:55:54,385 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-10 20:55:54,396 [INFO] src.console_functions: Console screen cleared.
2025-01-10 20:55:54,410 [INFO] nio.client.base_client: New joined room !wksSOEXmjceGUTMkdv:localhost
2025-01-10 20:55:54,410 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomCreateEvent
2025-01-10 20:55:54,410 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 20:55:54,410 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type PowerLevelsEvent
2025-01-10 20:55:54,410 [INFO] nio.rooms: Changing power level for user @evan:localhost from 0 to 100
2025-01-10 20:55:54,410 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomGuestAccessEvent
2025-01-10 20:55:54,410 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomJoinRulesEvent
2025-01-10 20:55:54,410 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 20:55:54,415 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 20:55:54,415 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 20:55:54,416 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 20:55:54,417 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 20:55:54,417 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 20:55:54,418 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 20:55:54,418 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 20:55:54,419 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 20:55:54,420 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 20:55:54,420 [INFO] nio.client.base_client: New joined room !fhmXoYxDdsImUkYUpf:localhost
2025-01-10 20:55:54,420 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomCreateEvent
2025-01-10 20:55:54,420 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type PowerLevelsEvent
2025-01-10 20:55:54,420 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-10 20:55:54,420 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomJoinRulesEvent
2025-01-10 20:55:54,420 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 20:55:54,420 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomNameEvent
2025-01-10 20:55:54,420 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomMessageText
2025-01-10 20:55:54,421 [INFO] nio.client.base_client: New joined room !vPFjZGGwOHwoODMQjc:localhost
2025-01-10 20:55:54,421 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomCreateEvent
2025-01-10 20:55:54,421 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type PowerLevelsEvent
2025-01-10 20:55:54,421 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-10 20:55:54,421 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomJoinRulesEvent
2025-01-10 20:55:54,421 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 20:55:54,421 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomNameEvent
2025-01-10 20:55:54,536 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 20:55:58,143 [DEBUG] src.console_functions: cmd_create_room called with args='test333', loop=<_UnixSelectorEventLoop running=True closed=False debug=False>
2025-01-10 20:55:58,143 [INFO] src.console_functions: SYSTEM: Creating a new room named 'test333'...
2025-01-10 20:55:58,143 [DEBUG] src.console_functions: Attempting to load token from 'director_token.json'...
2025-01-10 20:55:58,144 [DEBUG] src.console_functions: Loaded token data. user_id=@lunabot:localhost, access_token=(redacted), device_id=WJIPDAYWIL
2025-01-10 20:55:58,144 [DEBUG] src.console_functions: Creating local AsyncClient for user_id='@lunabot:localhost' with homeserver='http://localhost:8008'
2025-01-10 20:55:58,144 [DEBUG] src.console_functions: Scheduling do_create_room() on the existing loop with run_coroutine_threadsafe.
2025-01-10 20:55:58,144 [DEBUG] src.console_functions: Blocking on future_create.result() to get the room_create response.
2025-01-10 20:55:58,144 [DEBUG] src.console_functions: do_create_room: about to call room_create(name='test333', visibility='public')
2025-01-10 20:55:58,227 [INFO] nio.client.base_client: New joined room !EQpubOIZLWzrGBSBYb:localhost
2025-01-10 20:55:58,227 [INFO] nio.rooms: Room !EQpubOIZLWzrGBSBYb:localhost handling event of type RoomCreateEvent
2025-01-10 20:55:58,228 [INFO] nio.client.base_client: New joined room !EQpubOIZLWzrGBSBYb:localhost
2025-01-10 20:55:58,229 [INFO] nio.rooms: Room !EQpubOIZLWzrGBSBYb:localhost handling event of type RoomCreateEvent
2025-01-10 20:55:58,234 [DEBUG] src.console_functions: do_create_room: room_create call returned RoomCreateResponse(uuid='', start_time=None, end_time=None, timeout=0, transport_response=<ClientResponse(http://localhost:8008/_matrix/client/v3/createRoom) [200 OK]>
<CIMultiDictProxy('Server': 'Synapse/1.121.1', 'Date': 'Sat, 11 Jan 2025 01:55:58 GMT', 'Content-Type': 'application/json', 'Cache-Control': 'no-cache, no-store, must-revalidate', 'Access-Control-Allow-Origin': '*', 'Access-Control-Allow-Methods': 'GET, HEAD, POST, PUT, DELETE, OPTIONS', 'Access-Control-Allow-Headers': 'X-Requested-With, Content-Type, Authorization, Date', 'Access-Control-Expose-Headers': 'Synapse-Trace-Id, Server', 'Transfer-Encoding': 'chunked')>
, room_id='!EQpubOIZLWzrGBSBYb:localhost')
2025-01-10 20:55:58,234 [DEBUG] src.console_functions: future_create.result() returned => RoomCreateResponse(uuid='', start_time=None, end_time=None, timeout=0, transport_response=<ClientResponse(http://localhost:8008/_matrix/client/v3/createRoom) [200 OK]>
<CIMultiDictProxy('Server': 'Synapse/1.121.1', 'Date': 'Sat, 11 Jan 2025 01:55:58 GMT', 'Content-Type': 'application/json', 'Cache-Control': 'no-cache, no-store, must-revalidate', 'Access-Control-Allow-Origin': '*', 'Access-Control-Allow-Methods': 'GET, HEAD, POST, PUT, DELETE, OPTIONS', 'Access-Control-Allow-Headers': 'X-Requested-With, Content-Type, Authorization, Date', 'Access-Control-Expose-Headers': 'Synapse-Trace-Id, Server', 'Transfer-Encoding': 'chunked')>
, room_id='!EQpubOIZLWzrGBSBYb:localhost')
2025-01-10 20:55:58,234 [INFO] src.console_functions: SYSTEM: Created room 'test333' => !EQpubOIZLWzrGBSBYb:localhost
2025-01-10 20:55:58,234 [DEBUG] src.console_functions: Scheduling do_close_client() to gracefully close the AsyncClient.
2025-01-10 20:55:58,235 [DEBUG] src.console_functions: Blocking on future_close.result() to confirm the client is closed.
2025-01-10 20:55:58,235 [DEBUG] src.console_functions: do_close_client: closing the AsyncClient.
2025-01-10 20:55:58,235 [DEBUG] src.console_functions: do_close_client: client closed successfully.
2025-01-10 20:55:58,235 [DEBUG] src.console_functions: cmd_create_room: Done with final block.
2025-01-10 20:55:58,236 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 20:55:58,238 [INFO] nio.rooms: Room !EQpubOIZLWzrGBSBYb:localhost handling event of type PowerLevelsEvent
2025-01-10 20:55:58,238 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-10 20:55:58,238 [INFO] nio.rooms: Room !EQpubOIZLWzrGBSBYb:localhost handling event of type RoomJoinRulesEvent
2025-01-10 20:55:58,238 [INFO] nio.rooms: Room !EQpubOIZLWzrGBSBYb:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 20:55:58,238 [INFO] nio.rooms: Room !EQpubOIZLWzrGBSBYb:localhost handling event of type RoomNameEvent
2025-01-10 20:55:58,239 [INFO] nio.rooms: Room !EQpubOIZLWzrGBSBYb:localhost handling event of type PowerLevelsEvent
2025-01-10 20:55:58,239 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-10 20:55:58,239 [INFO] nio.rooms: Room !EQpubOIZLWzrGBSBYb:localhost handling event of type RoomJoinRulesEvent
2025-01-10 20:55:58,239 [INFO] nio.rooms: Room !EQpubOIZLWzrGBSBYb:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 20:55:58,239 [INFO] nio.rooms: Room !EQpubOIZLWzrGBSBYb:localhost handling event of type RoomNameEvent
2025-01-10 20:56:03,746 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 20:57:31,182 [INFO] src.console_functions: Console received 'exit' command; requesting shutdown.
2025-01-10 20:57:31,184 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 20:57:31,184 [ERROR] __main__: An unexpected exception occurred in main_logic: Event loop stopped before Future completed.
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 139, in luna
    loop.run_until_complete(main_logic())
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 718, in run_until_complete
    raise RuntimeError('Event loop stopped before Future completed.')
RuntimeError: Event loop stopped before Future completed.
2025-01-10 20:57:31,190 [DEBUG] __main__: Preparing to close the event loop.
2025-01-10 20:57:31,191 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-10 20:57:56,420 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-10 20:57:56,420 [DEBUG] __main__: Exiting configure_logging function.
2025-01-10 20:57:56,420 [DEBUG] __main__: Logging configuration complete.
2025-01-10 20:57:56,420 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-10 20:57:56,420 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 20:57:56,420 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-10 20:57:56,420 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-10 20:57:56,420 [DEBUG] __main__: Entering start_console_thread function.
2025-01-10 20:57:56,424 [INFO] __main__: Console thread started successfully.
2025-01-10 20:57:56,424 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-10 20:57:56,424 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-10 20:57:56,424 [INFO] __main__: Starting main_logic coroutine.
2025-01-10 20:57:56,424 [DEBUG] __main__: Entering main_logic function...
2025-01-10 20:57:56,424 [DEBUG] src.luna_functions: Found director_token.json; attempting token-based login.
2025-01-10 20:57:56,424 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-10 20:57:56,441 [INFO] src.luna_functions: Token-based login verified for user @lunabot:localhost.
2025-01-10 20:57:56,441 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-10 20:57:56,447 [INFO] src.console_functions: Console screen cleared.
2025-01-10 20:57:56,477 [INFO] nio.client.base_client: New joined room !wksSOEXmjceGUTMkdv:localhost
2025-01-10 20:57:56,477 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomCreateEvent
2025-01-10 20:57:56,477 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 20:57:56,477 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type PowerLevelsEvent
2025-01-10 20:57:56,477 [INFO] nio.rooms: Changing power level for user @evan:localhost from 0 to 100
2025-01-10 20:57:56,477 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomGuestAccessEvent
2025-01-10 20:57:56,477 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomJoinRulesEvent
2025-01-10 20:57:56,477 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 20:57:56,480 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 20:57:56,480 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 20:57:56,481 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 20:57:56,482 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 20:57:56,482 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 20:57:56,483 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 20:57:56,483 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 20:57:56,483 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 20:57:56,484 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 20:57:56,484 [INFO] nio.client.base_client: New joined room !fhmXoYxDdsImUkYUpf:localhost
2025-01-10 20:57:56,484 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomCreateEvent
2025-01-10 20:57:56,484 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type PowerLevelsEvent
2025-01-10 20:57:56,484 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-10 20:57:56,484 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomJoinRulesEvent
2025-01-10 20:57:56,484 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 20:57:56,485 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomNameEvent
2025-01-10 20:57:56,485 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomMessageText
2025-01-10 20:57:56,485 [INFO] nio.client.base_client: New joined room !vPFjZGGwOHwoODMQjc:localhost
2025-01-10 20:57:56,485 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomCreateEvent
2025-01-10 20:57:56,485 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type PowerLevelsEvent
2025-01-10 20:57:56,485 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-10 20:57:56,485 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomJoinRulesEvent
2025-01-10 20:57:56,485 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 20:57:56,485 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomNameEvent
2025-01-10 20:57:56,485 [INFO] nio.client.base_client: New joined room !EQpubOIZLWzrGBSBYb:localhost
2025-01-10 20:57:56,485 [INFO] nio.rooms: Room !EQpubOIZLWzrGBSBYb:localhost handling event of type RoomCreateEvent
2025-01-10 20:57:56,485 [INFO] nio.rooms: Room !EQpubOIZLWzrGBSBYb:localhost handling event of type PowerLevelsEvent
2025-01-10 20:57:56,485 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-10 20:57:56,485 [INFO] nio.rooms: Room !EQpubOIZLWzrGBSBYb:localhost handling event of type RoomJoinRulesEvent
2025-01-10 20:57:56,485 [INFO] nio.rooms: Room !EQpubOIZLWzrGBSBYb:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 20:57:56,485 [INFO] nio.rooms: Room !EQpubOIZLWzrGBSBYb:localhost handling event of type RoomNameEvent
2025-01-10 20:57:56,502 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 20:59:27,137 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-10 20:59:27,150 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-10 20:59:27,355 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-10 20:59:27,759 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-10 20:59:28,562 [WARNING] nio.client.async_client: Timed out, sleeping for 1s
2025-01-10 20:59:30,167 [WARNING] nio.client.async_client: Timed out, sleeping for 3s
2025-01-10 20:59:33,370 [WARNING] nio.client.async_client: Timed out, sleeping for 6s
2025-01-10 20:59:39,774 [WARNING] nio.client.async_client: Timed out, sleeping for 12s
2025-01-10 20:59:42,886 [INFO] src.console_functions: Console received 'exit' command; requesting shutdown.
2025-01-10 20:59:42,886 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 20:59:42,886 [ERROR] __main__: An unexpected exception occurred in main_logic: Event loop stopped before Future completed.
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 139, in luna
    loop.run_until_complete(main_logic())
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 718, in run_until_complete
    raise RuntimeError('Event loop stopped before Future completed.')
RuntimeError: Event loop stopped before Future completed.
2025-01-10 20:59:42,890 [DEBUG] __main__: Preparing to close the event loop.
2025-01-10 20:59:42,891 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-10 20:59:44,769 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-10 20:59:44,769 [DEBUG] __main__: Exiting configure_logging function.
2025-01-10 20:59:44,769 [DEBUG] __main__: Logging configuration complete.
2025-01-10 20:59:44,769 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-10 20:59:44,769 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 20:59:44,769 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-10 20:59:44,769 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-10 20:59:44,769 [DEBUG] __main__: Entering start_console_thread function.
2025-01-10 20:59:44,772 [INFO] __main__: Console thread started successfully.
2025-01-10 20:59:44,772 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-10 20:59:44,772 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-10 20:59:44,772 [INFO] __main__: Starting main_logic coroutine.
2025-01-10 20:59:44,772 [DEBUG] __main__: Entering main_logic function...
2025-01-10 20:59:44,772 [DEBUG] src.luna_functions: Found director_token.json; attempting token-based login.
2025-01-10 20:59:44,774 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-10 20:59:44,779 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-10 20:59:44,780 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-10 20:59:44,795 [INFO] src.console_functions: Console screen cleared.
2025-01-10 20:59:44,907 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 20:59:44,982 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-10 20:59:45,386 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-10 20:59:46,189 [WARNING] nio.client.async_client: Timed out, sleeping for 1s
2025-01-10 20:59:47,792 [WARNING] nio.client.async_client: Timed out, sleeping for 3s
2025-01-10 20:59:50,997 [WARNING] nio.client.async_client: Timed out, sleeping for 6s
2025-01-10 20:59:57,403 [WARNING] nio.client.async_client: Timed out, sleeping for 12s
2025-01-10 21:00:10,209 [WARNING] nio.client.async_client: Timed out, sleeping for 25s
2025-01-10 21:00:35,819 [WARNING] nio.client.async_client: Timed out, sleeping for 51s
2025-01-10 21:10:22,372 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-10 21:10:22,373 [DEBUG] __main__: Exiting configure_logging function.
2025-01-10 21:10:22,373 [DEBUG] __main__: Logging configuration complete.
2025-01-10 21:10:22,373 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-10 21:10:22,373 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 21:10:22,373 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-10 21:10:22,373 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-10 21:10:22,373 [DEBUG] __main__: Entering start_console_thread function.
2025-01-10 21:10:22,376 [INFO] __main__: Console thread started successfully.
2025-01-10 21:10:22,376 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-10 21:10:22,376 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-10 21:10:22,376 [INFO] __main__: Starting main_logic coroutine.
2025-01-10 21:10:22,376 [DEBUG] __main__: Entering main_logic function...
2025-01-10 21:10:22,376 [DEBUG] src.luna_functions: Found director_token.json; attempting token-based login.
2025-01-10 21:10:22,376 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-10 21:10:22,385 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-10 21:10:22,386 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-10 21:10:22,392 [INFO] src.console_functions: Console screen cleared.
2025-01-10 21:10:22,508 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 21:10:22,588 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-10 21:10:22,991 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-10 21:10:23,794 [WARNING] nio.client.async_client: Timed out, sleeping for 1s
2025-01-10 21:10:25,410 [WARNING] nio.client.async_client: Timed out, sleeping for 3s
2025-01-10 21:10:28,613 [WARNING] nio.client.async_client: Timed out, sleeping for 6s
2025-01-10 21:10:31,179 [INFO] root: Received create_room_luna command.
2025-01-10 21:10:31,179 [INFO] root: Calling luna_functions.create_room.
2025-01-10 21:10:31,179 [DEBUG] src.luna_functions_create_room: Entering create_room() with room_name='toastyposty', is_public=True
2025-01-10 21:10:31,179 [DEBUG] src.luna_functions_create_room: No DIRECTOR_CLIENT found. Exiting early with error message.
2025-01-10 21:10:31,179 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 21:10:35,018 [WARNING] nio.client.async_client: Timed out, sleeping for 12s
2025-01-10 21:10:43,914 [INFO] src.console_functions: Console received 'exit' command; requesting shutdown.
2025-01-10 21:10:43,914 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 21:10:43,914 [ERROR] __main__: An unexpected exception occurred in main_logic: Event loop stopped before Future completed.
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 139, in luna
    loop.run_until_complete(main_logic())
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 718, in run_until_complete
    raise RuntimeError('Event loop stopped before Future completed.')
RuntimeError: Event loop stopped before Future completed.
2025-01-10 21:10:43,918 [DEBUG] __main__: Preparing to close the event loop.
2025-01-10 21:10:43,918 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-10 21:10:43,947 [ERROR] asyncio: Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x125ce8440>
2025-01-10 21:10:46,011 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-10 21:10:46,011 [DEBUG] __main__: Exiting configure_logging function.
2025-01-10 21:10:46,011 [DEBUG] __main__: Logging configuration complete.
2025-01-10 21:10:46,011 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-10 21:10:46,011 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 21:10:46,011 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-10 21:10:46,011 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-10 21:10:46,011 [DEBUG] __main__: Entering start_console_thread function.
2025-01-10 21:10:46,014 [INFO] __main__: Console thread started successfully.
2025-01-10 21:10:46,014 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-10 21:10:46,014 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-10 21:10:46,014 [INFO] __main__: Starting main_logic coroutine.
2025-01-10 21:10:46,014 [DEBUG] __main__: Entering main_logic function...
2025-01-10 21:10:46,014 [DEBUG] src.luna_functions: Found director_token.json; attempting token-based login.
2025-01-10 21:10:46,016 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-10 21:10:46,030 [INFO] src.luna_functions: Token-based login verified for user @lunabot:localhost.
2025-01-10 21:10:46,030 [INFO] src.console_functions: Console screen cleared.
2025-01-10 21:10:46,030 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-10 21:10:46,069 [INFO] nio.client.base_client: New joined room !vPFjZGGwOHwoODMQjc:localhost
2025-01-10 21:10:46,069 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomCreateEvent
2025-01-10 21:10:46,069 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type PowerLevelsEvent
2025-01-10 21:10:46,069 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-10 21:10:46,069 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomJoinRulesEvent
2025-01-10 21:10:46,069 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 21:10:46,069 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomNameEvent
2025-01-10 21:10:46,070 [INFO] nio.client.base_client: New joined room !EQpubOIZLWzrGBSBYb:localhost
2025-01-10 21:10:46,070 [INFO] nio.rooms: Room !EQpubOIZLWzrGBSBYb:localhost handling event of type RoomCreateEvent
2025-01-10 21:10:46,070 [INFO] nio.rooms: Room !EQpubOIZLWzrGBSBYb:localhost handling event of type PowerLevelsEvent
2025-01-10 21:10:46,070 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-10 21:10:46,070 [INFO] nio.rooms: Room !EQpubOIZLWzrGBSBYb:localhost handling event of type RoomJoinRulesEvent
2025-01-10 21:10:46,070 [INFO] nio.rooms: Room !EQpubOIZLWzrGBSBYb:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 21:10:46,070 [INFO] nio.rooms: Room !EQpubOIZLWzrGBSBYb:localhost handling event of type RoomNameEvent
2025-01-10 21:10:46,070 [INFO] nio.client.base_client: New joined room !fhmXoYxDdsImUkYUpf:localhost
2025-01-10 21:10:46,070 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomCreateEvent
2025-01-10 21:10:46,070 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type PowerLevelsEvent
2025-01-10 21:10:46,070 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-10 21:10:46,070 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomJoinRulesEvent
2025-01-10 21:10:46,070 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 21:10:46,070 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomNameEvent
2025-01-10 21:10:46,070 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomMessageText
2025-01-10 21:10:46,076 [INFO] nio.client.base_client: New joined room !wksSOEXmjceGUTMkdv:localhost
2025-01-10 21:10:46,077 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type PowerLevelsEvent
2025-01-10 21:10:46,077 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomJoinRulesEvent
2025-01-10 21:10:46,077 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomGuestAccessEvent
2025-01-10 21:10:46,077 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 21:10:46,077 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomCreateEvent
2025-01-10 21:10:46,077 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 21:10:46,078 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 21:10:46,078 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 21:10:46,078 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 21:10:46,079 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 21:10:46,079 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 21:10:46,080 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 21:10:46,080 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 21:10:46,081 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 21:10:46,081 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 21:10:46,083 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 21:10:50,992 [INFO] root: Received create_room_luna command.
2025-01-10 21:10:50,992 [INFO] root: Calling luna_functions.create_room.
2025-01-10 21:10:50,992 [DEBUG] src.luna_functions_create_room: Entering create_room() with room_name='testyytoasty', is_public=True
2025-01-10 21:10:50,993 [DEBUG] src.luna_functions_create_room: No DIRECTOR_CLIENT found. Exiting early with error message.
2025-01-10 21:10:50,993 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 21:12:53,041 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 21:15:06,371 [INFO] src.console_functions: Console received 'exit' command; requesting shutdown.
2025-01-10 21:15:06,373 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 21:15:06,373 [ERROR] __main__: An unexpected exception occurred in main_logic: Event loop stopped before Future completed.
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 139, in luna
    loop.run_until_complete(main_logic())
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 718, in run_until_complete
    raise RuntimeError('Event loop stopped before Future completed.')
RuntimeError: Event loop stopped before Future completed.
2025-01-10 21:15:06,382 [DEBUG] __main__: Preparing to close the event loop.
2025-01-10 21:15:06,382 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-10 21:16:56,419 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-10 21:16:56,419 [DEBUG] __main__: Exiting configure_logging function.
2025-01-10 21:16:56,419 [DEBUG] __main__: Logging configuration complete.
2025-01-10 21:16:56,419 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-10 21:16:56,419 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 21:16:56,419 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-10 21:16:56,420 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-10 21:16:56,420 [DEBUG] __main__: Entering start_console_thread function.
2025-01-10 21:16:56,423 [INFO] __main__: Console thread started successfully.
2025-01-10 21:16:56,423 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-10 21:16:56,423 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-10 21:16:56,423 [INFO] __main__: Starting main_logic coroutine.
2025-01-10 21:16:56,423 [DEBUG] __main__: Entering main_logic function...
2025-01-10 21:16:56,423 [DEBUG] src.luna_functions: Found director_token.json; attempting token-based login.
2025-01-10 21:16:56,425 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-10 21:16:56,435 [INFO] src.luna_functions: Token-based login verified for user @lunabot:localhost.
2025-01-10 21:16:56,435 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-10 21:16:56,457 [INFO] src.console_functions: Console screen cleared.
2025-01-10 21:16:56,466 [INFO] nio.client.base_client: New joined room !wksSOEXmjceGUTMkdv:localhost
2025-01-10 21:16:56,466 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type PowerLevelsEvent
2025-01-10 21:16:56,466 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomJoinRulesEvent
2025-01-10 21:16:56,466 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomGuestAccessEvent
2025-01-10 21:16:56,466 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 21:16:56,466 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomCreateEvent
2025-01-10 21:16:56,466 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 21:16:56,475 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 21:16:56,475 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 21:16:56,476 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 21:16:56,477 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 21:16:56,477 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 21:16:56,478 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 21:16:56,479 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 21:16:56,479 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 21:16:56,480 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 21:16:56,480 [INFO] nio.client.base_client: New joined room !EQpubOIZLWzrGBSBYb:localhost
2025-01-10 21:16:56,480 [INFO] nio.rooms: Room !EQpubOIZLWzrGBSBYb:localhost handling event of type RoomCreateEvent
2025-01-10 21:16:56,480 [INFO] nio.rooms: Room !EQpubOIZLWzrGBSBYb:localhost handling event of type PowerLevelsEvent
2025-01-10 21:16:56,481 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-10 21:16:56,481 [INFO] nio.rooms: Room !EQpubOIZLWzrGBSBYb:localhost handling event of type RoomJoinRulesEvent
2025-01-10 21:16:56,481 [INFO] nio.rooms: Room !EQpubOIZLWzrGBSBYb:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 21:16:56,481 [INFO] nio.rooms: Room !EQpubOIZLWzrGBSBYb:localhost handling event of type RoomNameEvent
2025-01-10 21:16:56,481 [INFO] nio.client.base_client: New joined room !fhmXoYxDdsImUkYUpf:localhost
2025-01-10 21:16:56,481 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomCreateEvent
2025-01-10 21:16:56,481 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type PowerLevelsEvent
2025-01-10 21:16:56,481 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-10 21:16:56,481 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomJoinRulesEvent
2025-01-10 21:16:56,481 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 21:16:56,481 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomNameEvent
2025-01-10 21:16:56,481 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomMessageText
2025-01-10 21:16:56,482 [INFO] nio.client.base_client: New joined room !vPFjZGGwOHwoODMQjc:localhost
2025-01-10 21:16:56,482 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomCreateEvent
2025-01-10 21:16:56,482 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type PowerLevelsEvent
2025-01-10 21:16:56,482 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-10 21:16:56,482 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomJoinRulesEvent
2025-01-10 21:16:56,482 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 21:16:56,482 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomNameEvent
2025-01-10 21:16:56,600 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 21:16:59,034 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 21:17:01,687 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 21:17:07,182 [INFO] root: Received create_room_luna command.
2025-01-10 21:17:07,182 [INFO] root: Calling luna_functions.create_room.
2025-01-10 21:17:07,182 [DEBUG] src.luna_functions_create_room: Entering create_room() with room_name='kadlsjnfkladsjfn', is_public=True
2025-01-10 21:17:07,183 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 21:18:54,330 [INFO] src.console_functions: Console received 'exit' command; requesting shutdown.
2025-01-10 21:18:54,331 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 21:18:54,331 [ERROR] __main__: An unexpected exception occurred in main_logic: Event loop stopped before Future completed.
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 139, in luna
    loop.run_until_complete(main_logic())
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 718, in run_until_complete
    raise RuntimeError('Event loop stopped before Future completed.')
RuntimeError: Event loop stopped before Future completed.
2025-01-10 21:18:54,337 [DEBUG] __main__: Preparing to close the event loop.
2025-01-10 21:18:54,338 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-10 21:19:00,829 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-10 21:19:00,829 [DEBUG] __main__: Exiting configure_logging function.
2025-01-10 21:19:00,829 [DEBUG] __main__: Logging configuration complete.
2025-01-10 21:19:00,829 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-10 21:19:00,829 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 21:19:00,829 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-10 21:19:00,829 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-10 21:19:00,829 [DEBUG] __main__: Entering start_console_thread function.
2025-01-10 21:19:00,832 [INFO] __main__: Console thread started successfully.
2025-01-10 21:19:00,832 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-10 21:19:00,832 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-10 21:19:00,832 [INFO] __main__: Starting main_logic coroutine.
2025-01-10 21:19:00,832 [DEBUG] __main__: Entering main_logic function...
2025-01-10 21:19:00,832 [DEBUG] src.luna_functions: Found director_token.json; attempting token-based login.
2025-01-10 21:19:00,832 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-10 21:19:00,841 [INFO] src.luna_functions: Token-based login verified for user @lunabot:localhost.
2025-01-10 21:19:00,842 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-10 21:19:00,845 [INFO] src.console_functions: Console screen cleared.
2025-01-10 21:19:00,867 [INFO] nio.client.base_client: New joined room !wksSOEXmjceGUTMkdv:localhost
2025-01-10 21:19:00,867 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type PowerLevelsEvent
2025-01-10 21:19:00,867 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomJoinRulesEvent
2025-01-10 21:19:00,867 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomGuestAccessEvent
2025-01-10 21:19:00,867 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 21:19:00,867 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomCreateEvent
2025-01-10 21:19:00,867 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 21:19:00,869 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 21:19:00,869 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 21:19:00,870 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 21:19:00,871 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 21:19:00,871 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 21:19:00,872 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 21:19:00,872 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 21:19:00,872 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 21:19:00,873 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 21:19:00,873 [INFO] nio.client.base_client: New joined room !EQpubOIZLWzrGBSBYb:localhost
2025-01-10 21:19:00,873 [INFO] nio.rooms: Room !EQpubOIZLWzrGBSBYb:localhost handling event of type RoomCreateEvent
2025-01-10 21:19:00,873 [INFO] nio.rooms: Room !EQpubOIZLWzrGBSBYb:localhost handling event of type PowerLevelsEvent
2025-01-10 21:19:00,873 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-10 21:19:00,873 [INFO] nio.rooms: Room !EQpubOIZLWzrGBSBYb:localhost handling event of type RoomJoinRulesEvent
2025-01-10 21:19:00,873 [INFO] nio.rooms: Room !EQpubOIZLWzrGBSBYb:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 21:19:00,873 [INFO] nio.rooms: Room !EQpubOIZLWzrGBSBYb:localhost handling event of type RoomNameEvent
2025-01-10 21:19:00,873 [INFO] nio.client.base_client: New joined room !fhmXoYxDdsImUkYUpf:localhost
2025-01-10 21:19:00,873 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomCreateEvent
2025-01-10 21:19:00,873 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type PowerLevelsEvent
2025-01-10 21:19:00,873 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-10 21:19:00,873 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomJoinRulesEvent
2025-01-10 21:19:00,873 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 21:19:00,873 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomNameEvent
2025-01-10 21:19:00,873 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomMessageText
2025-01-10 21:19:00,874 [INFO] nio.client.base_client: New joined room !vPFjZGGwOHwoODMQjc:localhost
2025-01-10 21:19:00,874 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomCreateEvent
2025-01-10 21:19:00,874 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type PowerLevelsEvent
2025-01-10 21:19:00,874 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-10 21:19:00,874 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomJoinRulesEvent
2025-01-10 21:19:00,874 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 21:19:00,874 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomNameEvent
2025-01-10 21:19:00,963 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 21:19:06,030 [INFO] root: Received create_room_luna command.
2025-01-10 21:19:06,030 [INFO] root: Calling luna_functions.create_room.
2025-01-10 21:19:06,031 [DEBUG] src.luna_functions_create_room: Entering create_room() with room_name='dskfnakljdfn', is_public=True
2025-01-10 21:19:06,031 [DEBUG] src.luna_functions_create_room: Setting room_visibility to RoomVisibility.public
2025-01-10 21:19:06,031 [DEBUG] src.luna_functions_create_room: Calling DIRECTOR_CLIENT.room_create(name='dskfnakljdfn', visibility=<RoomVisibility.public: 'public'>)
2025-01-10 21:19:06,109 [INFO] nio.client.base_client: New joined room !AdQHUmAdpfqWIWULNM:localhost
2025-01-10 21:19:06,109 [INFO] nio.rooms: Room !AdQHUmAdpfqWIWULNM:localhost handling event of type RoomCreateEvent
2025-01-10 21:19:06,116 [DEBUG] src.luna_functions_create_room: RoomCreateResponse received. room_id='!AdQHUmAdpfqWIWULNM:localhost'
2025-01-10 21:19:06,116 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 21:19:06,122 [INFO] nio.rooms: Room !AdQHUmAdpfqWIWULNM:localhost handling event of type PowerLevelsEvent
2025-01-10 21:19:06,122 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-10 21:19:06,122 [INFO] nio.rooms: Room !AdQHUmAdpfqWIWULNM:localhost handling event of type RoomJoinRulesEvent
2025-01-10 21:19:06,122 [INFO] nio.rooms: Room !AdQHUmAdpfqWIWULNM:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 21:19:06,122 [INFO] nio.rooms: Room !AdQHUmAdpfqWIWULNM:localhost handling event of type RoomNameEvent
2025-01-10 21:19:09,983 [INFO] src.console_functions: Console received 'exit' command; requesting shutdown.
2025-01-10 21:19:09,983 [ERROR] __main__: An unexpected exception occurred in main_logic: Event loop stopped before Future completed.
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 139, in luna
    loop.run_until_complete(main_logic())
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 718, in run_until_complete
    raise RuntimeError('Event loop stopped before Future completed.')
RuntimeError: Event loop stopped before Future completed.
2025-01-10 21:19:09,983 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 21:19:09,984 [DEBUG] __main__: Preparing to close the event loop.
2025-01-10 21:19:09,984 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-10 21:41:57,748 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-10 21:41:57,748 [DEBUG] __main__: Exiting configure_logging function.
2025-01-10 21:41:57,748 [DEBUG] __main__: Logging configuration complete.
2025-01-10 21:41:57,748 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-10 21:41:57,748 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 21:41:57,748 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-10 21:41:57,748 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-10 21:41:57,748 [DEBUG] __main__: Entering start_console_thread function.
2025-01-10 21:41:57,751 [INFO] __main__: Console thread started successfully.
2025-01-10 21:41:57,751 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-10 21:41:57,751 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-10 21:41:57,751 [INFO] __main__: Starting main_logic coroutine.
2025-01-10 21:41:57,751 [DEBUG] __main__: Entering main_logic function...
2025-01-10 21:41:57,751 [DEBUG] src.luna_functions: Found director_token.json; attempting token-based login.
2025-01-10 21:41:57,753 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-10 21:41:57,765 [INFO] src.luna_functions: Token-based login verified for user @lunabot:localhost.
2025-01-10 21:41:57,765 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-10 21:41:57,782 [INFO] src.console_functions: Console screen cleared.
2025-01-10 21:41:57,797 [INFO] nio.client.base_client: New joined room !wksSOEXmjceGUTMkdv:localhost
2025-01-10 21:41:57,797 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type PowerLevelsEvent
2025-01-10 21:41:57,797 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomJoinRulesEvent
2025-01-10 21:41:57,797 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomGuestAccessEvent
2025-01-10 21:41:57,797 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 21:41:57,797 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomCreateEvent
2025-01-10 21:41:57,797 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 21:41:57,803 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 21:41:57,803 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 21:41:57,803 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 21:41:57,804 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 21:41:57,804 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 21:41:57,805 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 21:41:57,805 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 21:41:57,806 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 21:41:57,806 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 21:41:57,806 [INFO] nio.client.base_client: New joined room !EQpubOIZLWzrGBSBYb:localhost
2025-01-10 21:41:57,806 [INFO] nio.rooms: Room !EQpubOIZLWzrGBSBYb:localhost handling event of type RoomCreateEvent
2025-01-10 21:41:57,806 [INFO] nio.rooms: Room !EQpubOIZLWzrGBSBYb:localhost handling event of type PowerLevelsEvent
2025-01-10 21:41:57,806 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-10 21:41:57,806 [INFO] nio.rooms: Room !EQpubOIZLWzrGBSBYb:localhost handling event of type RoomJoinRulesEvent
2025-01-10 21:41:57,806 [INFO] nio.rooms: Room !EQpubOIZLWzrGBSBYb:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 21:41:57,807 [INFO] nio.rooms: Room !EQpubOIZLWzrGBSBYb:localhost handling event of type RoomNameEvent
2025-01-10 21:41:57,807 [INFO] nio.client.base_client: New joined room !fhmXoYxDdsImUkYUpf:localhost
2025-01-10 21:41:57,807 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomCreateEvent
2025-01-10 21:41:57,807 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type PowerLevelsEvent
2025-01-10 21:41:57,807 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-10 21:41:57,807 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomJoinRulesEvent
2025-01-10 21:41:57,807 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 21:41:57,807 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomNameEvent
2025-01-10 21:41:57,807 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomMessageText
2025-01-10 21:41:57,807 [INFO] nio.client.base_client: New joined room !vPFjZGGwOHwoODMQjc:localhost
2025-01-10 21:41:57,807 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomCreateEvent
2025-01-10 21:41:57,807 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type PowerLevelsEvent
2025-01-10 21:41:57,807 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-10 21:41:57,807 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomJoinRulesEvent
2025-01-10 21:41:57,807 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 21:41:57,807 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomNameEvent
2025-01-10 21:41:57,807 [INFO] nio.client.base_client: New joined room !AdQHUmAdpfqWIWULNM:localhost
2025-01-10 21:41:57,807 [INFO] nio.rooms: Room !AdQHUmAdpfqWIWULNM:localhost handling event of type RoomCreateEvent
2025-01-10 21:41:57,807 [INFO] nio.rooms: Room !AdQHUmAdpfqWIWULNM:localhost handling event of type PowerLevelsEvent
2025-01-10 21:41:57,807 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-10 21:41:57,807 [INFO] nio.rooms: Room !AdQHUmAdpfqWIWULNM:localhost handling event of type RoomJoinRulesEvent
2025-01-10 21:41:57,807 [INFO] nio.rooms: Room !AdQHUmAdpfqWIWULNM:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 21:41:57,807 [INFO] nio.rooms: Room !AdQHUmAdpfqWIWULNM:localhost handling event of type RoomNameEvent
2025-01-10 21:41:57,901 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 21:42:20,430 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 21:42:20,471 [DEBUG] openai._base_client: Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': 'You are Luna, a helpful assistant.'}, {'role': 'user', 'content': 'hello luna'}], 'model': 'gpt-4', 'max_tokens': 300, 'temperature': 0.7}}
2025-01-10 21:42:20,476 [DEBUG] httpcore.connection: connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2025-01-10 21:42:20,548 [DEBUG] httpcore.connection: connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x1104467b0>
2025-01-10 21:42:20,548 [DEBUG] httpcore.connection: start_tls.started ssl_context=<ssl.SSLContext object at 0x10877f770> server_hostname='api.openai.com' timeout=5.0
2025-01-10 21:42:20,585 [DEBUG] httpcore.connection: start_tls.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x1103e51d0>
2025-01-10 21:42:20,585 [DEBUG] httpcore.http11: send_request_headers.started request=<Request [b'POST']>
2025-01-10 21:42:20,586 [DEBUG] httpcore.http11: send_request_headers.complete
2025-01-10 21:42:20,586 [DEBUG] httpcore.http11: send_request_body.started request=<Request [b'POST']>
2025-01-10 21:42:20,586 [DEBUG] httpcore.http11: send_request_body.complete
2025-01-10 21:42:20,586 [DEBUG] httpcore.http11: receive_response_headers.started request=<Request [b'POST']>
2025-01-10 21:42:21,118 [DEBUG] httpcore.http11: receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Sat, 11 Jan 2025 02:42:21 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-yzbp3micnvwwjimbcblinra3'), (b'openai-processing-ms', b'364'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'5000'), (b'x-ratelimit-limit-tokens', b'80000'), (b'x-ratelimit-remaining-requests', b'4999'), (b'x-ratelimit-remaining-tokens', b'79687'), (b'x-ratelimit-reset-requests', b'12ms'), (b'x-ratelimit-reset-tokens', b'234ms'), (b'x-request-id', b'req_db740e4a8477484a02384a199e299d28'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=1P_KMiMHtky_072akHkJYyF2CCjtvbhhLWhr.MrtIxQ-1736563341-1.0.1.1-MefVc40aTX.Cu.AwMQ9KGdmaC2OYgGQcxcsKBURNtt2aMsU3DI9z2Ks9IcJSRAU3HB3adeMUfUMa6rwa4cOGzA; path=/; expires=Sat, 11-Jan-25 03:12:21 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=aq._XKMncgooCoCfPyONg5xXMFPDVrDM7JFpFUEYPXI-1736563341002-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'90018d8ecd11c9a0-IAD'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2025-01-10 21:42:21,121 [INFO] httpx: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-10 21:42:21,121 [DEBUG] httpcore.http11: receive_response_body.started request=<Request [b'POST']>
2025-01-10 21:42:21,122 [DEBUG] httpcore.http11: receive_response_body.complete
2025-01-10 21:42:21,122 [DEBUG] httpcore.http11: response_closed.started
2025-01-10 21:42:21,122 [DEBUG] httpcore.http11: response_closed.complete
2025-01-10 21:42:21,122 [DEBUG] openai._base_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "200 OK"
2025-01-10 21:42:21,165 [INFO] src.luna_functions: Posted GPT reply to room !wksSOEXmjceGUTMkdv:localhost
2025-01-10 21:42:21,174 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 21:43:35,134 [INFO] src.console_functions: Console received 'exit' command; requesting shutdown.
2025-01-10 21:43:35,136 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 21:43:35,136 [ERROR] __main__: An unexpected exception occurred in main_logic: Event loop stopped before Future completed.
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 139, in luna
    logger.debug("Console thread has been initiated. Returning to main thread.")
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 718, in run_until_complete
    raise RuntimeError('Event loop stopped before Future completed.')
RuntimeError: Event loop stopped before Future completed.
2025-01-10 21:43:35,141 [DEBUG] __main__: Preparing to close the event loop.
2025-01-10 21:43:35,142 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-10 21:48:20,131 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-10 21:48:20,131 [DEBUG] __main__: Exiting configure_logging function.
2025-01-10 21:48:20,131 [DEBUG] __main__: Logging configuration complete.
2025-01-10 21:48:20,131 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-10 21:48:20,131 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 21:48:20,131 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-10 21:48:20,131 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-10 21:48:20,132 [DEBUG] __main__: Entering start_console_thread function.
2025-01-10 21:48:20,134 [INFO] __main__: Console thread started successfully.
2025-01-10 21:48:20,134 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-10 21:48:20,134 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-10 21:48:20,134 [INFO] __main__: Starting main_logic coroutine.
2025-01-10 21:48:20,134 [DEBUG] __main__: Entering main_logic function...
2025-01-10 21:48:20,134 [DEBUG] src.luna_functions: Found director_token.json; attempting token-based login.
2025-01-10 21:48:20,136 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-10 21:48:20,151 [INFO] src.console_functions: Console screen cleared.
2025-01-10 21:48:20,154 [INFO] src.luna_functions: Token-based login verified for user @lunabot:localhost.
2025-01-10 21:48:20,154 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-10 21:48:20,192 [INFO] nio.client.base_client: New joined room !AdQHUmAdpfqWIWULNM:localhost
2025-01-10 21:48:20,192 [INFO] nio.rooms: Room !AdQHUmAdpfqWIWULNM:localhost handling event of type RoomCreateEvent
2025-01-10 21:48:20,192 [INFO] nio.rooms: Room !AdQHUmAdpfqWIWULNM:localhost handling event of type PowerLevelsEvent
2025-01-10 21:48:20,192 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-10 21:48:20,192 [INFO] nio.rooms: Room !AdQHUmAdpfqWIWULNM:localhost handling event of type RoomJoinRulesEvent
2025-01-10 21:48:20,192 [INFO] nio.rooms: Room !AdQHUmAdpfqWIWULNM:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 21:48:20,192 [INFO] nio.rooms: Room !AdQHUmAdpfqWIWULNM:localhost handling event of type RoomNameEvent
2025-01-10 21:48:20,192 [INFO] nio.client.base_client: New joined room !EQpubOIZLWzrGBSBYb:localhost
2025-01-10 21:48:20,192 [INFO] nio.rooms: Room !EQpubOIZLWzrGBSBYb:localhost handling event of type RoomCreateEvent
2025-01-10 21:48:20,192 [INFO] nio.rooms: Room !EQpubOIZLWzrGBSBYb:localhost handling event of type PowerLevelsEvent
2025-01-10 21:48:20,192 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-10 21:48:20,192 [INFO] nio.rooms: Room !EQpubOIZLWzrGBSBYb:localhost handling event of type RoomJoinRulesEvent
2025-01-10 21:48:20,192 [INFO] nio.rooms: Room !EQpubOIZLWzrGBSBYb:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 21:48:20,192 [INFO] nio.rooms: Room !EQpubOIZLWzrGBSBYb:localhost handling event of type RoomNameEvent
2025-01-10 21:48:20,192 [INFO] nio.client.base_client: New joined room !fhmXoYxDdsImUkYUpf:localhost
2025-01-10 21:48:20,192 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomCreateEvent
2025-01-10 21:48:20,192 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type PowerLevelsEvent
2025-01-10 21:48:20,192 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-10 21:48:20,192 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomJoinRulesEvent
2025-01-10 21:48:20,192 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 21:48:20,192 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomNameEvent
2025-01-10 21:48:20,193 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomMessageText
2025-01-10 21:48:20,193 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!fhmXoYxDdsImUkYUpf:localhost, event_id=$mKck7AUPntqhnCUEyglff8bl2IZ5n_t32cQQPcciKi8, sender=@evan:localhost, body=':lunabot: hello'
2025-01-10 21:48:20,193 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 21:48:20,193 [INFO] src.luna_command_extensions.handle_dispatch2: Room !fhmXoYxDdsImUkYUpf:localhost has 2 participants.
2025-01-10 21:48:20,193 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 21:48:20,193 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 1 (no enforcement yet).
2025-01-10 21:48:20,193 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 21:48:20,193 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$mKck7AUPntqhnCUEyglff8bl2IZ5n_t32cQQPcciKi8.
2025-01-10 21:48:20,193 [INFO] nio.client.base_client: New joined room !vPFjZGGwOHwoODMQjc:localhost
2025-01-10 21:48:20,193 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomCreateEvent
2025-01-10 21:48:20,193 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type PowerLevelsEvent
2025-01-10 21:48:20,193 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-10 21:48:20,193 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomJoinRulesEvent
2025-01-10 21:48:20,193 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 21:48:20,193 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomNameEvent
2025-01-10 21:48:20,193 [INFO] nio.client.base_client: New joined room !wksSOEXmjceGUTMkdv:localhost
2025-01-10 21:48:20,193 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type PowerLevelsEvent
2025-01-10 21:48:20,193 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomJoinRulesEvent
2025-01-10 21:48:20,193 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomGuestAccessEvent
2025-01-10 21:48:20,193 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 21:48:20,193 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomCreateEvent
2025-01-10 21:48:20,193 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 21:48:20,193 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$xKycW4OcJ7FgyfXgDgHvynpJPC1CbeIcS2rLkGG4CN4, sender=@evan:localhost, body='Well do you know much about metamaterials lunabot '
2025-01-10 21:48:20,193 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 21:48:20,193 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 21:48:20,193 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 21:48:20,193 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 2 (no enforcement yet).
2025-01-10 21:48:20,193 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 21:48:20,193 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$xKycW4OcJ7FgyfXgDgHvynpJPC1CbeIcS2rLkGG4CN4.
2025-01-10 21:48:20,193 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 21:48:20,193 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$2ZLCJQQPbvCY3UeMS2YxydCT2zHmMj_M2aEhkU0LdAE, sender=@evan:localhost, body='hello :luna:'
2025-01-10 21:48:20,193 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 21:48:20,193 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 21:48:20,193 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 21:48:20,193 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 3 (no enforcement yet).
2025-01-10 21:48:20,193 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 21:48:20,193 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$2ZLCJQQPbvCY3UeMS2YxydCT2zHmMj_M2aEhkU0LdAE.
2025-01-10 21:48:20,193 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 21:48:20,194 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$kIVMdgr0cQrrIPbHs_HGy9-ehkF8d1WtgF2JezjXeQQ, sender=@lunabot:localhost, body='Hello! How can I assist you today?'
2025-01-10 21:48:20,194 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 21:48:20,194 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 21:48:20,194 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 21:48:20,194 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 4 (no enforcement yet).
2025-01-10 21:48:20,194 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 21:48:20,194 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$kIVMdgr0cQrrIPbHs_HGy9-ehkF8d1WtgF2JezjXeQQ.
2025-01-10 21:48:20,194 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 21:48:20,194 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$SxwxiUQgktvUwljSyA1n7r_HCarpYQcFPlMtEAY3CEk, sender=@evan:localhost, body='Do you talk'
2025-01-10 21:48:20,194 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 21:48:20,194 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 21:48:20,194 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 21:48:20,194 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 5 (no enforcement yet).
2025-01-10 21:48:20,194 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 21:48:20,194 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$SxwxiUQgktvUwljSyA1n7r_HCarpYQcFPlMtEAY3CEk.
2025-01-10 21:48:20,194 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 21:48:20,194 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$DqAkRJkn-EF5oE0izNwSf23s-qx9tEZcBjCMgd0_r3Q, sender=@lunabot:localhost, body='Yes, I can communicate through text-based responses to assist with your queries and tasks.'
2025-01-10 21:48:20,194 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 21:48:20,194 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 21:48:20,194 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 21:48:20,194 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 6 (no enforcement yet).
2025-01-10 21:48:20,194 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 21:48:20,194 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$DqAkRJkn-EF5oE0izNwSf23s-qx9tEZcBjCMgd0_r3Q.
2025-01-10 21:48:20,194 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 21:48:20,194 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$-cYLqrWk74kz0pQ0xEBT5U1Xd_chpCGd-6eDv0VmpRU, sender=@evan:localhost, body="but you don't respond to lunabot "
2025-01-10 21:48:20,194 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 21:48:20,194 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 21:48:20,194 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 21:48:20,194 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 7 (no enforcement yet).
2025-01-10 21:48:20,194 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 21:48:20,194 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$-cYLqrWk74kz0pQ0xEBT5U1Xd_chpCGd-6eDv0VmpRU.
2025-01-10 21:48:20,194 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 21:48:20,194 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$jFIdqWc4NjcFdBommSRYh-yJjk6A9vUBlOOAUV-EEOs, sender=@evan:localhost, body='only untagged'
2025-01-10 21:48:20,194 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 21:48:20,194 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 21:48:20,194 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 21:48:20,194 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 8 (no enforcement yet).
2025-01-10 21:48:20,194 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 21:48:20,194 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$jFIdqWc4NjcFdBommSRYh-yJjk6A9vUBlOOAUV-EEOs.
2025-01-10 21:48:20,194 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 21:48:20,194 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$epknto4MCqSSIFGlWNTNwtwVDxwtCiMAHm4rWzWQUUc, sender=@lunabot:localhost, body="I'm sorry, but your request is a bit unclear. Could you please provide more details or context so I can assist you in the best way possible?"
2025-01-10 21:48:20,194 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 21:48:20,195 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 21:48:20,195 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 21:48:20,195 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 9 (no enforcement yet).
2025-01-10 21:48:20,195 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 21:48:20,195 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$epknto4MCqSSIFGlWNTNwtwVDxwtCiMAHm4rWzWQUUc.
2025-01-10 21:48:20,195 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 21:48:20,195 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$lBU7IQLaAxhN3yO3DXc4Q06kqmEMmZEH1CrrhxuFR0A, sender=@evan:localhost, body='hello luna'
2025-01-10 21:48:20,195 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 21:48:20,195 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 21:48:20,195 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 21:48:20,195 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 10 (no enforcement yet).
2025-01-10 21:48:20,195 [WARNING] src.luna_command_extensions.handle_dispatch2: **Route count is 10 => 'final message' would be posted here in real code.**
2025-01-10 21:48:20,195 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 21:48:20,195 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$lBU7IQLaAxhN3yO3DXc4Q06kqmEMmZEH1CrrhxuFR0A.
2025-01-10 21:48:20,195 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 21:48:20,195 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$gGKxyJeH24fsxhKjziv27wJDWskV7bFBz78yhUYbC3Q, sender=@lunabot:localhost, body='Hello! How can I assist you today?'
2025-01-10 21:48:20,195 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 21:48:20,195 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 21:48:20,195 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 21:48:20,195 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 11 (no enforcement yet).
2025-01-10 21:48:20,195 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 21:48:20,195 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$gGKxyJeH24fsxhKjziv27wJDWskV7bFBz78yhUYbC3Q.
2025-01-10 21:48:20,271 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 21:48:24,540 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 21:48:24,540 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$cgWI0aWm_Swyy7Fbin3lhJp0wd-_PfcH0Exi-LYQMKs, sender=@evan:localhost, body='hello luna'
2025-01-10 21:48:24,540 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 21:48:24,540 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 21:48:24,540 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 21:48:24,540 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 12 (no enforcement yet).
2025-01-10 21:48:24,541 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 21:48:24,541 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$cgWI0aWm_Swyy7Fbin3lhJp0wd-_PfcH0Exi-LYQMKs.
2025-01-10 21:50:32,550 [INFO] src.console_functions: Console received 'exit' command; requesting shutdown.
2025-01-10 21:50:32,550 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 21:50:32,551 [ERROR] __main__: An unexpected exception occurred in main_logic: Event loop stopped before Future completed.
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 145, in luna
    loop.run_until_complete(main_logic())
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 718, in run_until_complete
    raise RuntimeError('Event loop stopped before Future completed.')
RuntimeError: Event loop stopped before Future completed.
2025-01-10 21:50:32,557 [DEBUG] __main__: Preparing to close the event loop.
2025-01-10 21:50:32,558 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-10 21:50:34,167 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-10 21:50:34,167 [DEBUG] __main__: Exiting configure_logging function.
2025-01-10 21:50:34,167 [DEBUG] __main__: Logging configuration complete.
2025-01-10 21:50:34,167 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-10 21:50:34,167 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 21:50:34,167 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-10 21:50:34,167 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-10 21:50:34,167 [DEBUG] __main__: Entering start_console_thread function.
2025-01-10 21:50:34,171 [INFO] __main__: Console thread started successfully.
2025-01-10 21:50:34,171 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-10 21:50:34,171 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-10 21:50:34,171 [INFO] __main__: Starting main_logic coroutine.
2025-01-10 21:50:34,171 [DEBUG] __main__: Entering main_logic function...
2025-01-10 21:50:34,171 [DEBUG] src.luna_functions: Found director_token.json; attempting token-based login.
2025-01-10 21:50:34,173 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-10 21:50:34,180 [INFO] src.luna_functions: Token-based login verified for user @lunabot:localhost.
2025-01-10 21:50:34,180 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-10 21:50:34,185 [INFO] src.console_functions: Console screen cleared.
2025-01-10 21:50:34,211 [INFO] nio.client.base_client: New joined room !AdQHUmAdpfqWIWULNM:localhost
2025-01-10 21:50:34,211 [INFO] nio.rooms: Room !AdQHUmAdpfqWIWULNM:localhost handling event of type RoomCreateEvent
2025-01-10 21:50:34,211 [INFO] nio.rooms: Room !AdQHUmAdpfqWIWULNM:localhost handling event of type PowerLevelsEvent
2025-01-10 21:50:34,211 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-10 21:50:34,211 [INFO] nio.rooms: Room !AdQHUmAdpfqWIWULNM:localhost handling event of type RoomJoinRulesEvent
2025-01-10 21:50:34,211 [INFO] nio.rooms: Room !AdQHUmAdpfqWIWULNM:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 21:50:34,212 [INFO] nio.rooms: Room !AdQHUmAdpfqWIWULNM:localhost handling event of type RoomNameEvent
2025-01-10 21:50:34,212 [INFO] nio.client.base_client: New joined room !EQpubOIZLWzrGBSBYb:localhost
2025-01-10 21:50:34,212 [INFO] nio.rooms: Room !EQpubOIZLWzrGBSBYb:localhost handling event of type RoomCreateEvent
2025-01-10 21:50:34,212 [INFO] nio.rooms: Room !EQpubOIZLWzrGBSBYb:localhost handling event of type PowerLevelsEvent
2025-01-10 21:50:34,212 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-10 21:50:34,212 [INFO] nio.rooms: Room !EQpubOIZLWzrGBSBYb:localhost handling event of type RoomJoinRulesEvent
2025-01-10 21:50:34,212 [INFO] nio.rooms: Room !EQpubOIZLWzrGBSBYb:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 21:50:34,212 [INFO] nio.rooms: Room !EQpubOIZLWzrGBSBYb:localhost handling event of type RoomNameEvent
2025-01-10 21:50:34,212 [INFO] nio.client.base_client: New joined room !fhmXoYxDdsImUkYUpf:localhost
2025-01-10 21:50:34,212 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomCreateEvent
2025-01-10 21:50:34,212 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type PowerLevelsEvent
2025-01-10 21:50:34,212 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-10 21:50:34,212 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomJoinRulesEvent
2025-01-10 21:50:34,212 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 21:50:34,212 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomNameEvent
2025-01-10 21:50:34,212 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomMessageText
2025-01-10 21:50:34,212 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!fhmXoYxDdsImUkYUpf:localhost, event_id=$mKck7AUPntqhnCUEyglff8bl2IZ5n_t32cQQPcciKi8, sender=@evan:localhost, body=':lunabot: hello'
2025-01-10 21:50:34,212 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 21:50:34,212 [INFO] src.luna_command_extensions.handle_dispatch2: Room !fhmXoYxDdsImUkYUpf:localhost has 2 participants.
2025-01-10 21:50:34,212 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 21:50:34,212 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 1 (no enforcement yet).
2025-01-10 21:50:34,212 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 21:50:34,212 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$mKck7AUPntqhnCUEyglff8bl2IZ5n_t32cQQPcciKi8.
2025-01-10 21:50:34,212 [INFO] nio.client.base_client: New joined room !vPFjZGGwOHwoODMQjc:localhost
2025-01-10 21:50:34,212 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomCreateEvent
2025-01-10 21:50:34,212 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type PowerLevelsEvent
2025-01-10 21:50:34,212 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-10 21:50:34,212 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomJoinRulesEvent
2025-01-10 21:50:34,212 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 21:50:34,212 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomNameEvent
2025-01-10 21:50:34,212 [INFO] nio.client.base_client: New joined room !wksSOEXmjceGUTMkdv:localhost
2025-01-10 21:50:34,212 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type PowerLevelsEvent
2025-01-10 21:50:34,212 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomJoinRulesEvent
2025-01-10 21:50:34,212 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomGuestAccessEvent
2025-01-10 21:50:34,213 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 21:50:34,213 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomCreateEvent
2025-01-10 21:50:34,213 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 21:50:34,213 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$2ZLCJQQPbvCY3UeMS2YxydCT2zHmMj_M2aEhkU0LdAE, sender=@evan:localhost, body='hello :luna:'
2025-01-10 21:50:34,213 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 21:50:34,213 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 21:50:34,213 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 21:50:34,213 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 2 (no enforcement yet).
2025-01-10 21:50:34,213 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 21:50:34,213 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$2ZLCJQQPbvCY3UeMS2YxydCT2zHmMj_M2aEhkU0LdAE.
2025-01-10 21:50:34,213 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 21:50:34,213 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$kIVMdgr0cQrrIPbHs_HGy9-ehkF8d1WtgF2JezjXeQQ, sender=@lunabot:localhost, body='Hello! How can I assist you today?'
2025-01-10 21:50:34,213 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 21:50:34,213 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 21:50:34,213 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 21:50:34,213 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 3 (no enforcement yet).
2025-01-10 21:50:34,213 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 21:50:34,213 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$kIVMdgr0cQrrIPbHs_HGy9-ehkF8d1WtgF2JezjXeQQ.
2025-01-10 21:50:34,213 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 21:50:34,213 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$SxwxiUQgktvUwljSyA1n7r_HCarpYQcFPlMtEAY3CEk, sender=@evan:localhost, body='Do you talk'
2025-01-10 21:50:34,213 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 21:50:34,213 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 21:50:34,213 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 21:50:34,213 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 4 (no enforcement yet).
2025-01-10 21:50:34,213 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 21:50:34,213 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$SxwxiUQgktvUwljSyA1n7r_HCarpYQcFPlMtEAY3CEk.
2025-01-10 21:50:34,213 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 21:50:34,213 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$DqAkRJkn-EF5oE0izNwSf23s-qx9tEZcBjCMgd0_r3Q, sender=@lunabot:localhost, body='Yes, I can communicate through text-based responses to assist with your queries and tasks.'
2025-01-10 21:50:34,213 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 21:50:34,213 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 21:50:34,213 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 21:50:34,213 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 5 (no enforcement yet).
2025-01-10 21:50:34,213 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 21:50:34,213 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$DqAkRJkn-EF5oE0izNwSf23s-qx9tEZcBjCMgd0_r3Q.
2025-01-10 21:50:34,213 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 21:50:34,213 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$-cYLqrWk74kz0pQ0xEBT5U1Xd_chpCGd-6eDv0VmpRU, sender=@evan:localhost, body="but you don't respond to lunabot "
2025-01-10 21:50:34,213 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 21:50:34,213 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 21:50:34,213 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 21:50:34,213 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 6 (no enforcement yet).
2025-01-10 21:50:34,213 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 21:50:34,213 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$-cYLqrWk74kz0pQ0xEBT5U1Xd_chpCGd-6eDv0VmpRU.
2025-01-10 21:50:34,213 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 21:50:34,213 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$jFIdqWc4NjcFdBommSRYh-yJjk6A9vUBlOOAUV-EEOs, sender=@evan:localhost, body='only untagged'
2025-01-10 21:50:34,213 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 21:50:34,213 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 21:50:34,213 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 21:50:34,213 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 7 (no enforcement yet).
2025-01-10 21:50:34,213 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 21:50:34,213 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$jFIdqWc4NjcFdBommSRYh-yJjk6A9vUBlOOAUV-EEOs.
2025-01-10 21:50:34,213 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 21:50:34,213 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$epknto4MCqSSIFGlWNTNwtwVDxwtCiMAHm4rWzWQUUc, sender=@lunabot:localhost, body="I'm sorry, but your request is a bit unclear. Could you please provide more details or context so I can assist you in the best way possible?"
2025-01-10 21:50:34,213 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 21:50:34,214 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 21:50:34,214 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 21:50:34,214 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 8 (no enforcement yet).
2025-01-10 21:50:34,214 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 21:50:34,214 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$epknto4MCqSSIFGlWNTNwtwVDxwtCiMAHm4rWzWQUUc.
2025-01-10 21:50:34,214 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 21:50:34,214 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$lBU7IQLaAxhN3yO3DXc4Q06kqmEMmZEH1CrrhxuFR0A, sender=@evan:localhost, body='hello luna'
2025-01-10 21:50:34,214 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 21:50:34,214 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 21:50:34,214 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 21:50:34,214 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 9 (no enforcement yet).
2025-01-10 21:50:34,214 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 21:50:34,214 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$lBU7IQLaAxhN3yO3DXc4Q06kqmEMmZEH1CrrhxuFR0A.
2025-01-10 21:50:34,214 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 21:50:34,214 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$gGKxyJeH24fsxhKjziv27wJDWskV7bFBz78yhUYbC3Q, sender=@lunabot:localhost, body='Hello! How can I assist you today?'
2025-01-10 21:50:34,214 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 21:50:34,214 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 21:50:34,214 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 21:50:34,214 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 10 (no enforcement yet).
2025-01-10 21:50:34,214 [WARNING] src.luna_command_extensions.handle_dispatch2: **Route count is 10 => 'final message' would be posted here in real code.**
2025-01-10 21:50:34,214 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 21:50:34,214 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$gGKxyJeH24fsxhKjziv27wJDWskV7bFBz78yhUYbC3Q.
2025-01-10 21:50:34,214 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 21:50:34,214 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$cgWI0aWm_Swyy7Fbin3lhJp0wd-_PfcH0Exi-LYQMKs, sender=@evan:localhost, body='hello luna'
2025-01-10 21:50:34,214 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 21:50:34,214 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 21:50:34,214 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 21:50:34,214 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 11 (no enforcement yet).
2025-01-10 21:50:34,214 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 21:50:34,214 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$cgWI0aWm_Swyy7Fbin3lhJp0wd-_PfcH0Exi-LYQMKs.
2025-01-10 21:50:34,232 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 21:50:39,816 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 21:50:39,816 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$vl-3Ov3Cs8qqWknJZOzO-hZrWL28bwNafoqD4O8jRio, sender=@evan:localhost, body='hello luna'
2025-01-10 21:50:39,816 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 21:50:39,816 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 21:50:39,816 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 21:50:39,817 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 12 (no enforcement yet).
2025-01-10 21:50:39,817 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 21:50:39,817 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$vl-3Ov3Cs8qqWknJZOzO-hZrWL28bwNafoqD4O8jRio.
2025-01-10 21:52:13,842 [INFO] nio.client.base_client: New invited room !XBwtDVQGRLVcaKcUbm:localhost
2025-01-10 21:52:13,844 [INFO] nio.rooms: Room !XBwtDVQGRLVcaKcUbm:localhost handling event of type InviteAliasEvent
2025-01-10 21:52:13,844 [INFO] nio.rooms: Room !XBwtDVQGRLVcaKcUbm:localhost handling event of type InviteNameEvent
2025-01-10 21:52:13,844 [INFO] nio.rooms: Room !XBwtDVQGRLVcaKcUbm:localhost handling event of type InviteMemberEvent
2025-01-10 21:52:13,844 [INFO] src.luna_functions: Received invite to !XBwtDVQGRLVcaKcUbm:localhost, joining now.
2025-01-10 21:52:13,863 [INFO] nio.rooms: Room !XBwtDVQGRLVcaKcUbm:localhost handling event of type InviteMemberEvent
2025-01-10 21:52:13,864 [INFO] src.luna_functions: Received invite to !XBwtDVQGRLVcaKcUbm:localhost, joining now.
2025-01-10 21:52:13,884 [INFO] nio.client.base_client: New joined room !XBwtDVQGRLVcaKcUbm:localhost
2025-01-10 21:52:13,884 [INFO] nio.rooms: Room !XBwtDVQGRLVcaKcUbm:localhost handling event of type RoomCreateEvent
2025-01-10 21:52:13,885 [INFO] nio.rooms: Room !XBwtDVQGRLVcaKcUbm:localhost handling event of type PowerLevelsEvent
2025-01-10 21:52:13,885 [INFO] nio.rooms: Changing power level for user @evan:localhost from 0 to 100
2025-01-10 21:52:13,885 [INFO] nio.rooms: Room !XBwtDVQGRLVcaKcUbm:localhost handling event of type RoomAliasEvent
2025-01-10 21:52:13,885 [INFO] nio.rooms: Room !XBwtDVQGRLVcaKcUbm:localhost handling event of type RoomJoinRulesEvent
2025-01-10 21:52:13,885 [INFO] nio.rooms: Room !XBwtDVQGRLVcaKcUbm:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 21:52:13,885 [INFO] nio.rooms: Room !XBwtDVQGRLVcaKcUbm:localhost handling event of type RoomNameEvent
2025-01-10 21:52:20,947 [INFO] nio.rooms: Room !XBwtDVQGRLVcaKcUbm:localhost handling event of type RoomMessageText
2025-01-10 21:52:20,948 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!XBwtDVQGRLVcaKcUbm:localhost, event_id=$pEyxRI5FtH0XVpcwlyUiudNn6Mm-_MJ2ReBs19iY7K8, sender=@evan:localhost, body='Hello lunabot '
2025-01-10 21:52:20,948 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 21:52:20,948 [INFO] src.luna_command_extensions.handle_dispatch2: Room !XBwtDVQGRLVcaKcUbm:localhost has 2 participants.
2025-01-10 21:52:20,948 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 21:52:20,948 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 13 (no enforcement yet).
2025-01-10 21:52:20,948 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 21:52:20,948 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$pEyxRI5FtH0XVpcwlyUiudNn6Mm-_MJ2ReBs19iY7K8.
2025-01-10 21:53:17,901 [DEBUG] src.console_functions: Showing help to user.
2025-01-10 21:53:17,903 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 21:53:37,313 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 21:53:49,828 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 21:53:49,833 [ERROR] src.luna_functions: Failed to invite @captainamerica to @test:localhost: RoomInviteError: M_INVALID_PARAM Expected UserID of the form '@localname:domain'
2025-01-10 21:53:59,808 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 21:53:59,825 [ERROR] src.luna_functions: Failed to invite @captainamerica:localhost to @test:localhost: RoomInviteError: M_FORBIDDEN Unknown room
2025-01-10 21:54:10,999 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 21:54:11,014 [ERROR] src.luna_functions: Failed to invite @captainamerica:localhost to @test:localhost: RoomInviteError: M_FORBIDDEN Unknown room
2025-01-10 21:54:41,117 [INFO] src.console_functions: Console screen cleared.
2025-01-10 21:54:41,117 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 21:54:58,807 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 21:54:58,827 [ERROR] src.luna_functions: Failed to invite @captainamerica:localhost to !XBwtDVQGRLVcaKcUbm:localhost: RoomInviteError: M_FORBIDDEN You don't have permission to invite users
2025-01-10 21:55:28,177 [INFO] nio.rooms: Room !XBwtDVQGRLVcaKcUbm:localhost handling event of type PowerLevelsEvent
2025-01-10 21:55:28,177 [INFO] nio.rooms: Changing power level for user @evan:localhost from 100 to 100
2025-01-10 21:55:28,177 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-10 21:55:35,535 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 21:55:35,578 [INFO] src.luna_functions: Successfully invited @captainamerica:localhost to !XBwtDVQGRLVcaKcUbm:localhost.
2025-01-10 21:58:06,569 [INFO] src.console_functions: Console received 'exit' command; requesting shutdown.
2025-01-10 21:58:06,571 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 21:58:06,571 [ERROR] __main__: An unexpected exception occurred in main_logic: Event loop stopped before Future completed.
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 145, in luna
    loop.run_until_complete(main_logic())
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 718, in run_until_complete
    raise RuntimeError('Event loop stopped before Future completed.')
RuntimeError: Event loop stopped before Future completed.
2025-01-10 21:58:06,578 [DEBUG] __main__: Preparing to close the event loop.
2025-01-10 21:58:06,579 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-10 21:58:23,694 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-10 21:58:23,694 [DEBUG] __main__: Exiting configure_logging function.
2025-01-10 21:58:23,694 [DEBUG] __main__: Logging configuration complete.
2025-01-10 21:58:23,694 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-10 21:58:23,694 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 21:58:23,695 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-10 21:58:23,695 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-10 21:58:23,695 [DEBUG] __main__: Entering start_console_thread function.
2025-01-10 21:58:23,697 [INFO] __main__: Console thread started successfully.
2025-01-10 21:58:23,697 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-10 21:58:23,697 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-10 21:58:23,697 [INFO] __main__: Starting main_logic coroutine.
2025-01-10 21:58:23,697 [DEBUG] __main__: Entering main_logic function...
2025-01-10 21:58:23,697 [DEBUG] src.luna_functions: Found director_token.json; attempting token-based login.
2025-01-10 21:58:23,699 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-10 21:58:23,707 [INFO] src.luna_functions: Token-based login verified for user @lunabot:localhost.
2025-01-10 21:58:23,708 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-10 21:58:23,715 [INFO] src.console_functions: Console screen cleared.
2025-01-10 21:58:23,740 [INFO] nio.client.base_client: New joined room !AdQHUmAdpfqWIWULNM:localhost
2025-01-10 21:58:23,740 [INFO] nio.rooms: Room !AdQHUmAdpfqWIWULNM:localhost handling event of type RoomCreateEvent
2025-01-10 21:58:23,741 [INFO] nio.rooms: Room !AdQHUmAdpfqWIWULNM:localhost handling event of type PowerLevelsEvent
2025-01-10 21:58:23,741 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-10 21:58:23,741 [INFO] nio.rooms: Room !AdQHUmAdpfqWIWULNM:localhost handling event of type RoomJoinRulesEvent
2025-01-10 21:58:23,741 [INFO] nio.rooms: Room !AdQHUmAdpfqWIWULNM:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 21:58:23,741 [INFO] nio.rooms: Room !AdQHUmAdpfqWIWULNM:localhost handling event of type RoomNameEvent
2025-01-10 21:58:23,741 [INFO] nio.client.base_client: New joined room !EQpubOIZLWzrGBSBYb:localhost
2025-01-10 21:58:23,741 [INFO] nio.rooms: Room !EQpubOIZLWzrGBSBYb:localhost handling event of type RoomCreateEvent
2025-01-10 21:58:23,741 [INFO] nio.rooms: Room !EQpubOIZLWzrGBSBYb:localhost handling event of type PowerLevelsEvent
2025-01-10 21:58:23,741 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-10 21:58:23,741 [INFO] nio.rooms: Room !EQpubOIZLWzrGBSBYb:localhost handling event of type RoomJoinRulesEvent
2025-01-10 21:58:23,741 [INFO] nio.rooms: Room !EQpubOIZLWzrGBSBYb:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 21:58:23,741 [INFO] nio.rooms: Room !EQpubOIZLWzrGBSBYb:localhost handling event of type RoomNameEvent
2025-01-10 21:58:23,741 [INFO] nio.client.base_client: New joined room !fhmXoYxDdsImUkYUpf:localhost
2025-01-10 21:58:23,741 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomCreateEvent
2025-01-10 21:58:23,741 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type PowerLevelsEvent
2025-01-10 21:58:23,741 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-10 21:58:23,741 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomJoinRulesEvent
2025-01-10 21:58:23,741 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 21:58:23,741 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomNameEvent
2025-01-10 21:58:23,741 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomMessageText
2025-01-10 21:58:23,741 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!fhmXoYxDdsImUkYUpf:localhost, event_id=$mKck7AUPntqhnCUEyglff8bl2IZ5n_t32cQQPcciKi8, sender=@evan:localhost, body=':lunabot: hello'
2025-01-10 21:58:23,741 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 21:58:23,741 [INFO] src.luna_command_extensions.handle_dispatch2: Room !fhmXoYxDdsImUkYUpf:localhost has 2 participants.
2025-01-10 21:58:23,741 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 21:58:23,741 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 1 (no enforcement yet).
2025-01-10 21:58:23,741 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 21:58:23,741 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$mKck7AUPntqhnCUEyglff8bl2IZ5n_t32cQQPcciKi8.
2025-01-10 21:58:23,741 [INFO] nio.client.base_client: New joined room !vPFjZGGwOHwoODMQjc:localhost
2025-01-10 21:58:23,741 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomCreateEvent
2025-01-10 21:58:23,741 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type PowerLevelsEvent
2025-01-10 21:58:23,741 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-10 21:58:23,741 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomJoinRulesEvent
2025-01-10 21:58:23,741 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 21:58:23,741 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomNameEvent
2025-01-10 21:58:23,741 [INFO] nio.client.base_client: New joined room !wksSOEXmjceGUTMkdv:localhost
2025-01-10 21:58:23,741 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type PowerLevelsEvent
2025-01-10 21:58:23,741 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomJoinRulesEvent
2025-01-10 21:58:23,741 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomGuestAccessEvent
2025-01-10 21:58:23,741 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 21:58:23,741 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomCreateEvent
2025-01-10 21:58:23,741 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 21:58:23,741 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$kIVMdgr0cQrrIPbHs_HGy9-ehkF8d1WtgF2JezjXeQQ, sender=@lunabot:localhost, body='Hello! How can I assist you today?'
2025-01-10 21:58:23,741 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 21:58:23,741 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 21:58:23,742 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 21:58:23,742 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 2 (no enforcement yet).
2025-01-10 21:58:23,742 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 21:58:23,742 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$kIVMdgr0cQrrIPbHs_HGy9-ehkF8d1WtgF2JezjXeQQ.
2025-01-10 21:58:23,742 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 21:58:23,742 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$SxwxiUQgktvUwljSyA1n7r_HCarpYQcFPlMtEAY3CEk, sender=@evan:localhost, body='Do you talk'
2025-01-10 21:58:23,742 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 21:58:23,742 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 21:58:23,742 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 21:58:23,742 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 3 (no enforcement yet).
2025-01-10 21:58:23,742 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 21:58:23,742 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$SxwxiUQgktvUwljSyA1n7r_HCarpYQcFPlMtEAY3CEk.
2025-01-10 21:58:23,742 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 21:58:23,742 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$DqAkRJkn-EF5oE0izNwSf23s-qx9tEZcBjCMgd0_r3Q, sender=@lunabot:localhost, body='Yes, I can communicate through text-based responses to assist with your queries and tasks.'
2025-01-10 21:58:23,742 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 21:58:23,742 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 21:58:23,742 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 21:58:23,742 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 4 (no enforcement yet).
2025-01-10 21:58:23,742 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 21:58:23,742 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$DqAkRJkn-EF5oE0izNwSf23s-qx9tEZcBjCMgd0_r3Q.
2025-01-10 21:58:23,742 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 21:58:23,742 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$-cYLqrWk74kz0pQ0xEBT5U1Xd_chpCGd-6eDv0VmpRU, sender=@evan:localhost, body="but you don't respond to lunabot "
2025-01-10 21:58:23,742 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 21:58:23,742 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 21:58:23,742 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 21:58:23,742 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 5 (no enforcement yet).
2025-01-10 21:58:23,742 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 21:58:23,742 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$-cYLqrWk74kz0pQ0xEBT5U1Xd_chpCGd-6eDv0VmpRU.
2025-01-10 21:58:23,742 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 21:58:23,742 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$jFIdqWc4NjcFdBommSRYh-yJjk6A9vUBlOOAUV-EEOs, sender=@evan:localhost, body='only untagged'
2025-01-10 21:58:23,742 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 21:58:23,742 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 21:58:23,742 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 21:58:23,742 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 6 (no enforcement yet).
2025-01-10 21:58:23,742 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 21:58:23,742 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$jFIdqWc4NjcFdBommSRYh-yJjk6A9vUBlOOAUV-EEOs.
2025-01-10 21:58:23,742 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 21:58:23,742 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$epknto4MCqSSIFGlWNTNwtwVDxwtCiMAHm4rWzWQUUc, sender=@lunabot:localhost, body="I'm sorry, but your request is a bit unclear. Could you please provide more details or context so I can assist you in the best way possible?"
2025-01-10 21:58:23,742 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 21:58:23,742 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 21:58:23,742 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 21:58:23,742 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 7 (no enforcement yet).
2025-01-10 21:58:23,742 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 21:58:23,742 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$epknto4MCqSSIFGlWNTNwtwVDxwtCiMAHm4rWzWQUUc.
2025-01-10 21:58:23,742 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 21:58:23,742 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$lBU7IQLaAxhN3yO3DXc4Q06kqmEMmZEH1CrrhxuFR0A, sender=@evan:localhost, body='hello luna'
2025-01-10 21:58:23,742 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 21:58:23,742 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 21:58:23,742 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 21:58:23,742 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 8 (no enforcement yet).
2025-01-10 21:58:23,742 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 21:58:23,743 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$lBU7IQLaAxhN3yO3DXc4Q06kqmEMmZEH1CrrhxuFR0A.
2025-01-10 21:58:23,743 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 21:58:23,743 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$gGKxyJeH24fsxhKjziv27wJDWskV7bFBz78yhUYbC3Q, sender=@lunabot:localhost, body='Hello! How can I assist you today?'
2025-01-10 21:58:23,743 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 21:58:23,743 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 21:58:23,743 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 21:58:23,743 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 9 (no enforcement yet).
2025-01-10 21:58:23,743 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 21:58:23,743 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$gGKxyJeH24fsxhKjziv27wJDWskV7bFBz78yhUYbC3Q.
2025-01-10 21:58:23,743 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 21:58:23,743 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$cgWI0aWm_Swyy7Fbin3lhJp0wd-_PfcH0Exi-LYQMKs, sender=@evan:localhost, body='hello luna'
2025-01-10 21:58:23,743 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 21:58:23,743 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 21:58:23,743 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 21:58:23,743 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 10 (no enforcement yet).
2025-01-10 21:58:23,743 [WARNING] src.luna_command_extensions.handle_dispatch2: **Route count is 10 => 'final message' would be posted here in real code.**
2025-01-10 21:58:23,743 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 21:58:23,743 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$cgWI0aWm_Swyy7Fbin3lhJp0wd-_PfcH0Exi-LYQMKs.
2025-01-10 21:58:23,743 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 21:58:23,743 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$vl-3Ov3Cs8qqWknJZOzO-hZrWL28bwNafoqD4O8jRio, sender=@evan:localhost, body='hello luna'
2025-01-10 21:58:23,743 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 21:58:23,743 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 21:58:23,743 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 21:58:23,743 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 11 (no enforcement yet).
2025-01-10 21:58:23,743 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 21:58:23,743 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$vl-3Ov3Cs8qqWknJZOzO-hZrWL28bwNafoqD4O8jRio.
2025-01-10 21:58:23,743 [INFO] nio.client.base_client: New joined room !XBwtDVQGRLVcaKcUbm:localhost
2025-01-10 21:58:23,743 [INFO] nio.rooms: Room !XBwtDVQGRLVcaKcUbm:localhost handling event of type PowerLevelsEvent
2025-01-10 21:58:23,743 [INFO] nio.rooms: Changing power level for user @evan:localhost from 0 to 100
2025-01-10 21:58:23,743 [INFO] nio.rooms: Room !XBwtDVQGRLVcaKcUbm:localhost handling event of type RoomCreateEvent
2025-01-10 21:58:23,743 [INFO] nio.rooms: Room !XBwtDVQGRLVcaKcUbm:localhost handling event of type RoomAliasEvent
2025-01-10 21:58:23,743 [INFO] nio.rooms: Room !XBwtDVQGRLVcaKcUbm:localhost handling event of type RoomJoinRulesEvent
2025-01-10 21:58:23,743 [INFO] nio.rooms: Room !XBwtDVQGRLVcaKcUbm:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 21:58:23,743 [INFO] nio.rooms: Room !XBwtDVQGRLVcaKcUbm:localhost handling event of type RoomNameEvent
2025-01-10 21:58:23,743 [INFO] nio.rooms: Room !XBwtDVQGRLVcaKcUbm:localhost handling event of type RoomMessageText
2025-01-10 21:58:23,743 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!XBwtDVQGRLVcaKcUbm:localhost, event_id=$pEyxRI5FtH0XVpcwlyUiudNn6Mm-_MJ2ReBs19iY7K8, sender=@evan:localhost, body='Hello lunabot '
2025-01-10 21:58:23,743 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 21:58:23,743 [INFO] src.luna_command_extensions.handle_dispatch2: Room !XBwtDVQGRLVcaKcUbm:localhost has 2 participants.
2025-01-10 21:58:23,743 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 21:58:23,743 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 12 (no enforcement yet).
2025-01-10 21:58:23,743 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 21:58:23,743 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$pEyxRI5FtH0XVpcwlyUiudNn6Mm-_MJ2ReBs19iY7K8.
2025-01-10 21:58:23,743 [INFO] nio.rooms: Room !XBwtDVQGRLVcaKcUbm:localhost handling event of type PowerLevelsEvent
2025-01-10 21:58:23,744 [INFO] nio.rooms: Changing power level for user @evan:localhost from 100 to 100
2025-01-10 21:58:23,744 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-10 21:58:23,836 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 21:59:03,365 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 21:59:06,843 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 22:05:23,439 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-10 22:05:23,440 [DEBUG] __main__: Exiting configure_logging function.
2025-01-10 22:05:23,440 [DEBUG] __main__: Logging configuration complete.
2025-01-10 22:05:23,440 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-10 22:05:23,440 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 22:05:23,440 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-10 22:05:23,440 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-10 22:05:23,440 [DEBUG] __main__: Entering start_console_thread function.
2025-01-10 22:05:23,441 [INFO] __main__: Console thread started successfully.
2025-01-10 22:05:23,441 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-10 22:05:23,441 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-10 22:05:23,441 [INFO] __main__: Starting main_logic coroutine.
2025-01-10 22:05:23,442 [DEBUG] __main__: Entering main_logic function...
2025-01-10 22:05:23,442 [DEBUG] src.luna_functions: Found director_token.json; attempting token-based login.
2025-01-10 22:05:23,444 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-10 22:05:23,448 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-10 22:05:23,448 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-10 22:05:23,469 [INFO] src.console_functions: Console screen cleared.
2025-01-10 22:05:23,576 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 22:05:23,650 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-10 22:05:24,054 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-10 22:05:24,858 [WARNING] nio.client.async_client: Timed out, sleeping for 1s
2025-01-10 22:05:26,463 [WARNING] nio.client.async_client: Timed out, sleeping for 3s
2025-01-10 22:05:29,668 [WARNING] nio.client.async_client: Timed out, sleeping for 6s
2025-01-10 22:05:36,073 [WARNING] nio.client.async_client: Timed out, sleeping for 12s
2025-01-10 22:05:43,265 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 22:05:48,878 [WARNING] nio.client.async_client: Timed out, sleeping for 25s
2025-01-10 22:05:54,830 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 22:06:14,483 [WARNING] nio.client.async_client: Timed out, sleeping for 51s
2025-01-10 22:06:38,864 [INFO] src.console_functions: Console received 'exit' command; requesting shutdown.
2025-01-10 22:06:38,864 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 22:06:38,865 [ERROR] __main__: An unexpected exception occurred in main_logic: Event loop stopped before Future completed.
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 145, in luna
    loop.run_until_complete(main_logic())
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 718, in run_until_complete
    raise RuntimeError('Event loop stopped before Future completed.')
RuntimeError: Event loop stopped before Future completed.
2025-01-10 22:06:38,871 [DEBUG] __main__: Preparing to close the event loop.
2025-01-10 22:06:38,871 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-10 22:06:56,722 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-10 22:06:56,722 [DEBUG] __main__: Exiting configure_logging function.
2025-01-10 22:06:56,722 [DEBUG] __main__: Logging configuration complete.
2025-01-10 22:06:56,722 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-10 22:06:56,722 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 22:06:56,722 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-10 22:06:56,722 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-10 22:06:56,722 [DEBUG] __main__: Entering start_console_thread function.
2025-01-10 22:06:56,725 [INFO] __main__: Console thread started successfully.
2025-01-10 22:06:56,725 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-10 22:06:56,725 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-10 22:06:56,725 [INFO] __main__: Starting main_logic coroutine.
2025-01-10 22:06:56,725 [DEBUG] __main__: Entering main_logic function...
2025-01-10 22:06:56,725 [DEBUG] src.luna_functions: Found director_token.json; attempting token-based login.
2025-01-10 22:06:56,727 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-10 22:06:56,731 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-10 22:06:56,732 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-10 22:06:56,742 [INFO] src.console_functions: Console screen cleared.
2025-01-10 22:06:56,781 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 22:06:56,933 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-10 22:06:57,336 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-10 22:06:58,139 [WARNING] nio.client.async_client: Timed out, sleeping for 1s
2025-01-10 22:06:59,744 [WARNING] nio.client.async_client: Timed out, sleeping for 3s
2025-01-10 22:07:02,949 [WARNING] nio.client.async_client: Timed out, sleeping for 6s
2025-01-10 22:07:09,356 [WARNING] nio.client.async_client: Timed out, sleeping for 12s
2025-01-10 22:07:22,172 [INFO] src.luna_functions: Token-based login verified for user @lunabot:localhost.
2025-01-10 22:07:22,172 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-10 22:07:22,264 [INFO] nio.client.base_client: New joined room !EQpubOIZLWzrGBSBYb:localhost
2025-01-10 22:07:22,264 [INFO] nio.rooms: Room !EQpubOIZLWzrGBSBYb:localhost handling event of type RoomCreateEvent
2025-01-10 22:07:22,264 [INFO] nio.rooms: Room !EQpubOIZLWzrGBSBYb:localhost handling event of type PowerLevelsEvent
2025-01-10 22:07:22,264 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-10 22:07:22,264 [INFO] nio.rooms: Room !EQpubOIZLWzrGBSBYb:localhost handling event of type RoomJoinRulesEvent
2025-01-10 22:07:22,264 [INFO] nio.rooms: Room !EQpubOIZLWzrGBSBYb:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 22:07:22,264 [INFO] nio.rooms: Room !EQpubOIZLWzrGBSBYb:localhost handling event of type RoomNameEvent
2025-01-10 22:07:22,264 [INFO] nio.client.base_client: New joined room !vPFjZGGwOHwoODMQjc:localhost
2025-01-10 22:07:22,264 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomCreateEvent
2025-01-10 22:07:22,264 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type PowerLevelsEvent
2025-01-10 22:07:22,264 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-10 22:07:22,264 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomJoinRulesEvent
2025-01-10 22:07:22,264 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 22:07:22,264 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomNameEvent
2025-01-10 22:07:22,264 [INFO] nio.client.base_client: New joined room !AdQHUmAdpfqWIWULNM:localhost
2025-01-10 22:07:22,264 [INFO] nio.rooms: Room !AdQHUmAdpfqWIWULNM:localhost handling event of type RoomCreateEvent
2025-01-10 22:07:22,264 [INFO] nio.rooms: Room !AdQHUmAdpfqWIWULNM:localhost handling event of type PowerLevelsEvent
2025-01-10 22:07:22,264 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-10 22:07:22,264 [INFO] nio.rooms: Room !AdQHUmAdpfqWIWULNM:localhost handling event of type RoomJoinRulesEvent
2025-01-10 22:07:22,264 [INFO] nio.rooms: Room !AdQHUmAdpfqWIWULNM:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 22:07:22,264 [INFO] nio.rooms: Room !AdQHUmAdpfqWIWULNM:localhost handling event of type RoomNameEvent
2025-01-10 22:07:22,264 [INFO] nio.client.base_client: New joined room !fhmXoYxDdsImUkYUpf:localhost
2025-01-10 22:07:22,264 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomCreateEvent
2025-01-10 22:07:22,264 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type PowerLevelsEvent
2025-01-10 22:07:22,265 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-10 22:07:22,265 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomJoinRulesEvent
2025-01-10 22:07:22,265 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 22:07:22,265 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomNameEvent
2025-01-10 22:07:22,265 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomMessageText
2025-01-10 22:07:22,265 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!fhmXoYxDdsImUkYUpf:localhost, event_id=$mKck7AUPntqhnCUEyglff8bl2IZ5n_t32cQQPcciKi8, sender=@evan:localhost, body=':lunabot: hello'
2025-01-10 22:07:22,265 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 22:07:22,265 [INFO] src.luna_command_extensions.handle_dispatch2: Room !fhmXoYxDdsImUkYUpf:localhost has 2 participants.
2025-01-10 22:07:22,265 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 22:07:22,265 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 1 (no enforcement yet).
2025-01-10 22:07:22,265 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 22:07:22,265 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$mKck7AUPntqhnCUEyglff8bl2IZ5n_t32cQQPcciKi8.
2025-01-10 22:07:22,265 [INFO] nio.client.base_client: New joined room !wksSOEXmjceGUTMkdv:localhost
2025-01-10 22:07:22,265 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomCreateEvent
2025-01-10 22:07:22,265 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 22:07:22,265 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomGuestAccessEvent
2025-01-10 22:07:22,265 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type PowerLevelsEvent
2025-01-10 22:07:22,265 [INFO] nio.rooms: Changing power level for user @evan:localhost from 0 to 100
2025-01-10 22:07:22,265 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomJoinRulesEvent
2025-01-10 22:07:22,265 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 22:07:22,265 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$kIVMdgr0cQrrIPbHs_HGy9-ehkF8d1WtgF2JezjXeQQ, sender=@lunabot:localhost, body='Hello! How can I assist you today?'
2025-01-10 22:07:22,265 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 22:07:22,265 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 22:07:22,265 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 22:07:22,265 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 2 (no enforcement yet).
2025-01-10 22:07:22,265 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 22:07:22,265 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$kIVMdgr0cQrrIPbHs_HGy9-ehkF8d1WtgF2JezjXeQQ.
2025-01-10 22:07:22,265 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 22:07:22,265 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$SxwxiUQgktvUwljSyA1n7r_HCarpYQcFPlMtEAY3CEk, sender=@evan:localhost, body='Do you talk'
2025-01-10 22:07:22,265 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 22:07:22,265 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 22:07:22,265 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 22:07:22,265 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 3 (no enforcement yet).
2025-01-10 22:07:22,266 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 22:07:22,266 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$SxwxiUQgktvUwljSyA1n7r_HCarpYQcFPlMtEAY3CEk.
2025-01-10 22:07:22,266 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 22:07:22,266 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$DqAkRJkn-EF5oE0izNwSf23s-qx9tEZcBjCMgd0_r3Q, sender=@lunabot:localhost, body='Yes, I can communicate through text-based responses to assist with your queries and tasks.'
2025-01-10 22:07:22,266 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 22:07:22,266 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 22:07:22,266 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 22:07:22,266 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 4 (no enforcement yet).
2025-01-10 22:07:22,266 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 22:07:22,266 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$DqAkRJkn-EF5oE0izNwSf23s-qx9tEZcBjCMgd0_r3Q.
2025-01-10 22:07:22,266 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 22:07:22,266 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$-cYLqrWk74kz0pQ0xEBT5U1Xd_chpCGd-6eDv0VmpRU, sender=@evan:localhost, body="but you don't respond to lunabot "
2025-01-10 22:07:22,266 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 22:07:22,266 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 22:07:22,266 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 22:07:22,266 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 5 (no enforcement yet).
2025-01-10 22:07:22,266 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 22:07:22,266 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$-cYLqrWk74kz0pQ0xEBT5U1Xd_chpCGd-6eDv0VmpRU.
2025-01-10 22:07:22,266 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 22:07:22,266 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$jFIdqWc4NjcFdBommSRYh-yJjk6A9vUBlOOAUV-EEOs, sender=@evan:localhost, body='only untagged'
2025-01-10 22:07:22,266 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 22:07:22,266 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 22:07:22,266 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 22:07:22,266 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 6 (no enforcement yet).
2025-01-10 22:07:22,266 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 22:07:22,266 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$jFIdqWc4NjcFdBommSRYh-yJjk6A9vUBlOOAUV-EEOs.
2025-01-10 22:07:22,266 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 22:07:22,266 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$epknto4MCqSSIFGlWNTNwtwVDxwtCiMAHm4rWzWQUUc, sender=@lunabot:localhost, body="I'm sorry, but your request is a bit unclear. Could you please provide more details or context so I can assist you in the best way possible?"
2025-01-10 22:07:22,266 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 22:07:22,266 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 22:07:22,266 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 22:07:22,266 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 7 (no enforcement yet).
2025-01-10 22:07:22,266 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 22:07:22,266 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$epknto4MCqSSIFGlWNTNwtwVDxwtCiMAHm4rWzWQUUc.
2025-01-10 22:07:22,266 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 22:07:22,266 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$lBU7IQLaAxhN3yO3DXc4Q06kqmEMmZEH1CrrhxuFR0A, sender=@evan:localhost, body='hello luna'
2025-01-10 22:07:22,266 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 22:07:22,266 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 22:07:22,266 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 22:07:22,266 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 8 (no enforcement yet).
2025-01-10 22:07:22,267 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 22:07:22,267 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$lBU7IQLaAxhN3yO3DXc4Q06kqmEMmZEH1CrrhxuFR0A.
2025-01-10 22:07:22,267 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 22:07:22,267 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$gGKxyJeH24fsxhKjziv27wJDWskV7bFBz78yhUYbC3Q, sender=@lunabot:localhost, body='Hello! How can I assist you today?'
2025-01-10 22:07:22,267 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 22:07:22,267 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 22:07:22,267 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 22:07:22,267 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 9 (no enforcement yet).
2025-01-10 22:07:22,267 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 22:07:22,267 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$gGKxyJeH24fsxhKjziv27wJDWskV7bFBz78yhUYbC3Q.
2025-01-10 22:07:22,267 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 22:07:22,267 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$cgWI0aWm_Swyy7Fbin3lhJp0wd-_PfcH0Exi-LYQMKs, sender=@evan:localhost, body='hello luna'
2025-01-10 22:07:22,267 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 22:07:22,267 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 22:07:22,267 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 22:07:22,267 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 10 (no enforcement yet).
2025-01-10 22:07:22,267 [WARNING] src.luna_command_extensions.handle_dispatch2: **Route count is 10 => 'final message' would be posted here in real code.**
2025-01-10 22:07:22,267 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 22:07:22,267 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$cgWI0aWm_Swyy7Fbin3lhJp0wd-_PfcH0Exi-LYQMKs.
2025-01-10 22:07:22,267 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 22:07:22,267 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$vl-3Ov3Cs8qqWknJZOzO-hZrWL28bwNafoqD4O8jRio, sender=@evan:localhost, body='hello luna'
2025-01-10 22:07:22,267 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 22:07:22,267 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 22:07:22,267 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 22:07:22,267 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 11 (no enforcement yet).
2025-01-10 22:07:22,267 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 22:07:22,267 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$vl-3Ov3Cs8qqWknJZOzO-hZrWL28bwNafoqD4O8jRio.
2025-01-10 22:07:22,267 [INFO] nio.client.base_client: New joined room !XBwtDVQGRLVcaKcUbm:localhost
2025-01-10 22:07:22,267 [INFO] nio.rooms: Room !XBwtDVQGRLVcaKcUbm:localhost handling event of type PowerLevelsEvent
2025-01-10 22:07:22,267 [INFO] nio.rooms: Room !XBwtDVQGRLVcaKcUbm:localhost handling event of type RoomCreateEvent
2025-01-10 22:07:22,267 [INFO] nio.rooms: Room !XBwtDVQGRLVcaKcUbm:localhost handling event of type RoomAliasEvent
2025-01-10 22:07:22,267 [INFO] nio.rooms: Room !XBwtDVQGRLVcaKcUbm:localhost handling event of type RoomJoinRulesEvent
2025-01-10 22:07:22,267 [INFO] nio.rooms: Room !XBwtDVQGRLVcaKcUbm:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 22:07:22,267 [INFO] nio.rooms: Room !XBwtDVQGRLVcaKcUbm:localhost handling event of type RoomNameEvent
2025-01-10 22:07:22,267 [INFO] nio.rooms: Room !XBwtDVQGRLVcaKcUbm:localhost handling event of type RoomMessageText
2025-01-10 22:07:22,267 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!XBwtDVQGRLVcaKcUbm:localhost, event_id=$pEyxRI5FtH0XVpcwlyUiudNn6Mm-_MJ2ReBs19iY7K8, sender=@evan:localhost, body='Hello lunabot '
2025-01-10 22:07:22,267 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 22:07:22,267 [INFO] src.luna_command_extensions.handle_dispatch2: Room !XBwtDVQGRLVcaKcUbm:localhost has 2 participants.
2025-01-10 22:07:22,268 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 22:07:22,268 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 12 (no enforcement yet).
2025-01-10 22:07:22,268 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 22:07:22,268 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$pEyxRI5FtH0XVpcwlyUiudNn6Mm-_MJ2ReBs19iY7K8.
2025-01-10 22:07:22,268 [INFO] nio.rooms: Room !XBwtDVQGRLVcaKcUbm:localhost handling event of type PowerLevelsEvent
2025-01-10 22:07:22,268 [INFO] nio.rooms: Changing power level for user @evan:localhost from 100 to 100
2025-01-10 22:07:22,268 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-10 22:07:57,726 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 22:07:57,727 [DEBUG] src.console_functions: Forcing @captainamerica:localhost to join !XBwtDVQGRLVcaKcUbm:localhost via http://localhost:8008/_synapse/admin/v1/join/!XBwtDVQGRLVcaKcUbm:localhost
2025-01-10 22:07:57,727 [ERROR] src.console_functions: Exception in do_force_join:
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/src/console_functions.py", line 550, in do_force_join
    async with aiohttp.ClientSession() as session:
               ^^^^^^^
NameError: name 'aiohttp' is not defined
2025-01-10 22:08:22,841 [INFO] src.console_functions: Console received 'exit' command; requesting shutdown.
2025-01-10 22:08:22,843 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 22:08:22,843 [ERROR] __main__: An unexpected exception occurred in main_logic: Event loop stopped before Future completed.
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 145, in luna
    loop.run_until_complete(main_logic())
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 718, in run_until_complete
    raise RuntimeError('Event loop stopped before Future completed.')
RuntimeError: Event loop stopped before Future completed.
2025-01-10 22:08:22,849 [DEBUG] __main__: Preparing to close the event loop.
2025-01-10 22:08:22,849 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-10 22:08:25,302 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-10 22:08:25,302 [DEBUG] __main__: Exiting configure_logging function.
2025-01-10 22:08:25,302 [DEBUG] __main__: Logging configuration complete.
2025-01-10 22:08:25,302 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-10 22:08:25,302 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 22:08:25,302 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-10 22:08:25,302 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-10 22:08:25,302 [DEBUG] __main__: Entering start_console_thread function.
2025-01-10 22:08:25,303 [INFO] __main__: Console thread started successfully.
2025-01-10 22:08:25,303 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-10 22:08:25,303 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-10 22:08:25,303 [INFO] __main__: Starting main_logic coroutine.
2025-01-10 22:08:25,304 [DEBUG] __main__: Entering main_logic function...
2025-01-10 22:08:25,304 [DEBUG] src.luna_functions: Found director_token.json; attempting token-based login.
2025-01-10 22:08:25,306 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-10 22:08:25,318 [INFO] src.luna_functions: Token-based login verified for user @lunabot:localhost.
2025-01-10 22:08:25,318 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-10 22:08:25,320 [INFO] src.console_functions: Console screen cleared.
2025-01-10 22:08:25,328 [INFO] nio.client.base_client: New joined room !EQpubOIZLWzrGBSBYb:localhost
2025-01-10 22:08:25,328 [INFO] nio.rooms: Room !EQpubOIZLWzrGBSBYb:localhost handling event of type RoomCreateEvent
2025-01-10 22:08:25,328 [INFO] nio.rooms: Room !EQpubOIZLWzrGBSBYb:localhost handling event of type PowerLevelsEvent
2025-01-10 22:08:25,328 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-10 22:08:25,328 [INFO] nio.rooms: Room !EQpubOIZLWzrGBSBYb:localhost handling event of type RoomJoinRulesEvent
2025-01-10 22:08:25,328 [INFO] nio.rooms: Room !EQpubOIZLWzrGBSBYb:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 22:08:25,328 [INFO] nio.rooms: Room !EQpubOIZLWzrGBSBYb:localhost handling event of type RoomNameEvent
2025-01-10 22:08:25,328 [INFO] nio.client.base_client: New joined room !vPFjZGGwOHwoODMQjc:localhost
2025-01-10 22:08:25,328 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomCreateEvent
2025-01-10 22:08:25,328 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type PowerLevelsEvent
2025-01-10 22:08:25,328 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-10 22:08:25,329 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomJoinRulesEvent
2025-01-10 22:08:25,329 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 22:08:25,329 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomNameEvent
2025-01-10 22:08:25,329 [INFO] nio.client.base_client: New joined room !AdQHUmAdpfqWIWULNM:localhost
2025-01-10 22:08:25,329 [INFO] nio.rooms: Room !AdQHUmAdpfqWIWULNM:localhost handling event of type RoomCreateEvent
2025-01-10 22:08:25,329 [INFO] nio.rooms: Room !AdQHUmAdpfqWIWULNM:localhost handling event of type PowerLevelsEvent
2025-01-10 22:08:25,329 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-10 22:08:25,329 [INFO] nio.rooms: Room !AdQHUmAdpfqWIWULNM:localhost handling event of type RoomJoinRulesEvent
2025-01-10 22:08:25,329 [INFO] nio.rooms: Room !AdQHUmAdpfqWIWULNM:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 22:08:25,329 [INFO] nio.rooms: Room !AdQHUmAdpfqWIWULNM:localhost handling event of type RoomNameEvent
2025-01-10 22:08:25,329 [INFO] nio.client.base_client: New joined room !fhmXoYxDdsImUkYUpf:localhost
2025-01-10 22:08:25,329 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomCreateEvent
2025-01-10 22:08:25,329 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type PowerLevelsEvent
2025-01-10 22:08:25,329 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-10 22:08:25,329 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomJoinRulesEvent
2025-01-10 22:08:25,329 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 22:08:25,329 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomNameEvent
2025-01-10 22:08:25,329 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomMessageText
2025-01-10 22:08:25,329 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!fhmXoYxDdsImUkYUpf:localhost, event_id=$mKck7AUPntqhnCUEyglff8bl2IZ5n_t32cQQPcciKi8, sender=@evan:localhost, body=':lunabot: hello'
2025-01-10 22:08:25,329 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 22:08:25,329 [INFO] src.luna_command_extensions.handle_dispatch2: Room !fhmXoYxDdsImUkYUpf:localhost has 2 participants.
2025-01-10 22:08:25,330 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 22:08:25,330 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 1 (no enforcement yet).
2025-01-10 22:08:25,330 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 22:08:25,330 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$mKck7AUPntqhnCUEyglff8bl2IZ5n_t32cQQPcciKi8.
2025-01-10 22:08:25,330 [INFO] nio.client.base_client: New joined room !wksSOEXmjceGUTMkdv:localhost
2025-01-10 22:08:25,330 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomCreateEvent
2025-01-10 22:08:25,330 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 22:08:25,330 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomGuestAccessEvent
2025-01-10 22:08:25,330 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type PowerLevelsEvent
2025-01-10 22:08:25,330 [INFO] nio.rooms: Changing power level for user @evan:localhost from 0 to 100
2025-01-10 22:08:25,330 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomJoinRulesEvent
2025-01-10 22:08:25,330 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 22:08:25,330 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$kIVMdgr0cQrrIPbHs_HGy9-ehkF8d1WtgF2JezjXeQQ, sender=@lunabot:localhost, body='Hello! How can I assist you today?'
2025-01-10 22:08:25,330 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 22:08:25,330 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 22:08:25,330 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 22:08:25,330 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 2 (no enforcement yet).
2025-01-10 22:08:25,330 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 22:08:25,330 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$kIVMdgr0cQrrIPbHs_HGy9-ehkF8d1WtgF2JezjXeQQ.
2025-01-10 22:08:25,330 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 22:08:25,330 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$SxwxiUQgktvUwljSyA1n7r_HCarpYQcFPlMtEAY3CEk, sender=@evan:localhost, body='Do you talk'
2025-01-10 22:08:25,330 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 22:08:25,330 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 22:08:25,330 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 22:08:25,330 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 3 (no enforcement yet).
2025-01-10 22:08:25,330 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 22:08:25,330 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$SxwxiUQgktvUwljSyA1n7r_HCarpYQcFPlMtEAY3CEk.
2025-01-10 22:08:25,330 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 22:08:25,330 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$DqAkRJkn-EF5oE0izNwSf23s-qx9tEZcBjCMgd0_r3Q, sender=@lunabot:localhost, body='Yes, I can communicate through text-based responses to assist with your queries and tasks.'
2025-01-10 22:08:25,330 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 22:08:25,330 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 22:08:25,330 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 22:08:25,330 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 4 (no enforcement yet).
2025-01-10 22:08:25,330 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 22:08:25,330 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$DqAkRJkn-EF5oE0izNwSf23s-qx9tEZcBjCMgd0_r3Q.
2025-01-10 22:08:25,330 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 22:08:25,330 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$-cYLqrWk74kz0pQ0xEBT5U1Xd_chpCGd-6eDv0VmpRU, sender=@evan:localhost, body="but you don't respond to lunabot "
2025-01-10 22:08:25,330 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 22:08:25,331 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 22:08:25,331 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 22:08:25,331 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 5 (no enforcement yet).
2025-01-10 22:08:25,331 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 22:08:25,331 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$-cYLqrWk74kz0pQ0xEBT5U1Xd_chpCGd-6eDv0VmpRU.
2025-01-10 22:08:25,331 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 22:08:25,331 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$jFIdqWc4NjcFdBommSRYh-yJjk6A9vUBlOOAUV-EEOs, sender=@evan:localhost, body='only untagged'
2025-01-10 22:08:25,331 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 22:08:25,331 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 22:08:25,331 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 22:08:25,331 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 6 (no enforcement yet).
2025-01-10 22:08:25,331 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 22:08:25,331 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$jFIdqWc4NjcFdBommSRYh-yJjk6A9vUBlOOAUV-EEOs.
2025-01-10 22:08:25,331 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 22:08:25,331 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$epknto4MCqSSIFGlWNTNwtwVDxwtCiMAHm4rWzWQUUc, sender=@lunabot:localhost, body="I'm sorry, but your request is a bit unclear. Could you please provide more details or context so I can assist you in the best way possible?"
2025-01-10 22:08:25,331 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 22:08:25,331 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 22:08:25,331 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 22:08:25,331 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 7 (no enforcement yet).
2025-01-10 22:08:25,331 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 22:08:25,331 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$epknto4MCqSSIFGlWNTNwtwVDxwtCiMAHm4rWzWQUUc.
2025-01-10 22:08:25,331 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 22:08:25,331 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$lBU7IQLaAxhN3yO3DXc4Q06kqmEMmZEH1CrrhxuFR0A, sender=@evan:localhost, body='hello luna'
2025-01-10 22:08:25,331 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 22:08:25,331 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 22:08:25,331 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 22:08:25,331 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 8 (no enforcement yet).
2025-01-10 22:08:25,331 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 22:08:25,331 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$lBU7IQLaAxhN3yO3DXc4Q06kqmEMmZEH1CrrhxuFR0A.
2025-01-10 22:08:25,331 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 22:08:25,331 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$gGKxyJeH24fsxhKjziv27wJDWskV7bFBz78yhUYbC3Q, sender=@lunabot:localhost, body='Hello! How can I assist you today?'
2025-01-10 22:08:25,331 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 22:08:25,331 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 22:08:25,331 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 22:08:25,331 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 9 (no enforcement yet).
2025-01-10 22:08:25,331 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 22:08:25,331 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$gGKxyJeH24fsxhKjziv27wJDWskV7bFBz78yhUYbC3Q.
2025-01-10 22:08:25,331 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 22:08:25,331 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$cgWI0aWm_Swyy7Fbin3lhJp0wd-_PfcH0Exi-LYQMKs, sender=@evan:localhost, body='hello luna'
2025-01-10 22:08:25,331 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 22:08:25,331 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 22:08:25,331 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 22:08:25,331 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 10 (no enforcement yet).
2025-01-10 22:08:25,331 [WARNING] src.luna_command_extensions.handle_dispatch2: **Route count is 10 => 'final message' would be posted here in real code.**
2025-01-10 22:08:25,331 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 22:08:25,332 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$cgWI0aWm_Swyy7Fbin3lhJp0wd-_PfcH0Exi-LYQMKs.
2025-01-10 22:08:25,332 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 22:08:25,332 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$vl-3Ov3Cs8qqWknJZOzO-hZrWL28bwNafoqD4O8jRio, sender=@evan:localhost, body='hello luna'
2025-01-10 22:08:25,332 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 22:08:25,332 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 22:08:25,332 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 22:08:25,332 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 11 (no enforcement yet).
2025-01-10 22:08:25,332 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 22:08:25,332 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$vl-3Ov3Cs8qqWknJZOzO-hZrWL28bwNafoqD4O8jRio.
2025-01-10 22:08:25,332 [INFO] nio.client.base_client: New joined room !XBwtDVQGRLVcaKcUbm:localhost
2025-01-10 22:08:25,332 [INFO] nio.rooms: Room !XBwtDVQGRLVcaKcUbm:localhost handling event of type PowerLevelsEvent
2025-01-10 22:08:25,332 [INFO] nio.rooms: Room !XBwtDVQGRLVcaKcUbm:localhost handling event of type RoomCreateEvent
2025-01-10 22:08:25,332 [INFO] nio.rooms: Room !XBwtDVQGRLVcaKcUbm:localhost handling event of type RoomAliasEvent
2025-01-10 22:08:25,332 [INFO] nio.rooms: Room !XBwtDVQGRLVcaKcUbm:localhost handling event of type RoomJoinRulesEvent
2025-01-10 22:08:25,332 [INFO] nio.rooms: Room !XBwtDVQGRLVcaKcUbm:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 22:08:25,332 [INFO] nio.rooms: Room !XBwtDVQGRLVcaKcUbm:localhost handling event of type RoomNameEvent
2025-01-10 22:08:25,332 [INFO] nio.rooms: Room !XBwtDVQGRLVcaKcUbm:localhost handling event of type RoomMessageText
2025-01-10 22:08:25,332 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!XBwtDVQGRLVcaKcUbm:localhost, event_id=$pEyxRI5FtH0XVpcwlyUiudNn6Mm-_MJ2ReBs19iY7K8, sender=@evan:localhost, body='Hello lunabot '
2025-01-10 22:08:25,332 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 22:08:25,332 [INFO] src.luna_command_extensions.handle_dispatch2: Room !XBwtDVQGRLVcaKcUbm:localhost has 2 participants.
2025-01-10 22:08:25,332 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 22:08:25,332 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 12 (no enforcement yet).
2025-01-10 22:08:25,332 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 22:08:25,332 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$pEyxRI5FtH0XVpcwlyUiudNn6Mm-_MJ2ReBs19iY7K8.
2025-01-10 22:08:25,332 [INFO] nio.rooms: Room !XBwtDVQGRLVcaKcUbm:localhost handling event of type PowerLevelsEvent
2025-01-10 22:08:25,332 [INFO] nio.rooms: Changing power level for user @evan:localhost from 100 to 100
2025-01-10 22:08:25,332 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-10 22:08:25,366 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 22:08:43,909 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 22:08:43,909 [DEBUG] src.console_functions: Forcing @captainamerica:localhost to join !XBwtDVQGRLVcaKcUbm:localhost via http://localhost:8008/_synapse/admin/v1/join/!XBwtDVQGRLVcaKcUbm:localhost
2025-01-10 22:12:01,610 [INFO] src.console_functions: Console received 'exit' command; requesting shutdown.
2025-01-10 22:12:01,613 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 22:12:01,613 [ERROR] __main__: An unexpected exception occurred in main_logic: Event loop stopped before Future completed.
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 145, in luna
    loop.run_until_complete(main_logic())
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 718, in run_until_complete
    raise RuntimeError('Event loop stopped before Future completed.')
RuntimeError: Event loop stopped before Future completed.
2025-01-10 22:12:01,620 [DEBUG] __main__: Preparing to close the event loop.
2025-01-10 22:12:01,621 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-10 22:12:03,730 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-10 22:12:03,730 [DEBUG] __main__: Exiting configure_logging function.
2025-01-10 22:12:03,731 [DEBUG] __main__: Logging configuration complete.
2025-01-10 22:12:03,731 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-10 22:12:03,731 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 22:12:03,731 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-10 22:12:03,731 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-10 22:12:03,731 [DEBUG] __main__: Entering start_console_thread function.
2025-01-10 22:12:03,732 [INFO] __main__: Console thread started successfully.
2025-01-10 22:12:03,732 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-10 22:12:03,732 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-10 22:12:03,732 [INFO] __main__: Starting main_logic coroutine.
2025-01-10 22:12:03,732 [DEBUG] __main__: Entering main_logic function...
2025-01-10 22:12:03,732 [DEBUG] src.luna_functions: Found director_token.json; attempting token-based login.
2025-01-10 22:12:03,734 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-10 22:12:03,744 [INFO] src.luna_functions: Token-based login verified for user @lunabot:localhost.
2025-01-10 22:12:03,744 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-10 22:12:03,778 [INFO] nio.client.base_client: New joined room !wksSOEXmjceGUTMkdv:localhost
2025-01-10 22:12:03,778 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomCreateEvent
2025-01-10 22:12:03,778 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 22:12:03,778 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomGuestAccessEvent
2025-01-10 22:12:03,778 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type PowerLevelsEvent
2025-01-10 22:12:03,778 [INFO] nio.rooms: Changing power level for user @evan:localhost from 0 to 100
2025-01-10 22:12:03,778 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomJoinRulesEvent
2025-01-10 22:12:03,778 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 22:12:03,778 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$kIVMdgr0cQrrIPbHs_HGy9-ehkF8d1WtgF2JezjXeQQ, sender=@lunabot:localhost, body='Hello! How can I assist you today?'
2025-01-10 22:12:03,778 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 22:12:03,778 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 22:12:03,778 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 22:12:03,778 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 1 (no enforcement yet).
2025-01-10 22:12:03,778 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 22:12:03,778 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$kIVMdgr0cQrrIPbHs_HGy9-ehkF8d1WtgF2JezjXeQQ.
2025-01-10 22:12:03,778 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 22:12:03,778 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$SxwxiUQgktvUwljSyA1n7r_HCarpYQcFPlMtEAY3CEk, sender=@evan:localhost, body='Do you talk'
2025-01-10 22:12:03,778 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 22:12:03,778 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 22:12:03,778 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 22:12:03,778 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 2 (no enforcement yet).
2025-01-10 22:12:03,778 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 22:12:03,778 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$SxwxiUQgktvUwljSyA1n7r_HCarpYQcFPlMtEAY3CEk.
2025-01-10 22:12:03,778 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 22:12:03,778 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$DqAkRJkn-EF5oE0izNwSf23s-qx9tEZcBjCMgd0_r3Q, sender=@lunabot:localhost, body='Yes, I can communicate through text-based responses to assist with your queries and tasks.'
2025-01-10 22:12:03,778 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 22:12:03,778 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 22:12:03,778 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 22:12:03,778 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 3 (no enforcement yet).
2025-01-10 22:12:03,778 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 22:12:03,778 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$DqAkRJkn-EF5oE0izNwSf23s-qx9tEZcBjCMgd0_r3Q.
2025-01-10 22:12:03,778 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 22:12:03,778 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$-cYLqrWk74kz0pQ0xEBT5U1Xd_chpCGd-6eDv0VmpRU, sender=@evan:localhost, body="but you don't respond to lunabot "
2025-01-10 22:12:03,778 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 22:12:03,779 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 22:12:03,779 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 22:12:03,779 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 4 (no enforcement yet).
2025-01-10 22:12:03,779 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 22:12:03,779 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$-cYLqrWk74kz0pQ0xEBT5U1Xd_chpCGd-6eDv0VmpRU.
2025-01-10 22:12:03,779 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 22:12:03,779 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$jFIdqWc4NjcFdBommSRYh-yJjk6A9vUBlOOAUV-EEOs, sender=@evan:localhost, body='only untagged'
2025-01-10 22:12:03,779 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 22:12:03,779 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 22:12:03,779 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 22:12:03,779 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 5 (no enforcement yet).
2025-01-10 22:12:03,779 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 22:12:03,779 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$jFIdqWc4NjcFdBommSRYh-yJjk6A9vUBlOOAUV-EEOs.
2025-01-10 22:12:03,779 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 22:12:03,779 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$epknto4MCqSSIFGlWNTNwtwVDxwtCiMAHm4rWzWQUUc, sender=@lunabot:localhost, body="I'm sorry, but your request is a bit unclear. Could you please provide more details or context so I can assist you in the best way possible?"
2025-01-10 22:12:03,779 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 22:12:03,779 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 22:12:03,779 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 22:12:03,779 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 6 (no enforcement yet).
2025-01-10 22:12:03,779 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 22:12:03,779 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$epknto4MCqSSIFGlWNTNwtwVDxwtCiMAHm4rWzWQUUc.
2025-01-10 22:12:03,779 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 22:12:03,779 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$lBU7IQLaAxhN3yO3DXc4Q06kqmEMmZEH1CrrhxuFR0A, sender=@evan:localhost, body='hello luna'
2025-01-10 22:12:03,779 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 22:12:03,779 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 22:12:03,779 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 22:12:03,779 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 7 (no enforcement yet).
2025-01-10 22:12:03,779 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 22:12:03,779 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$lBU7IQLaAxhN3yO3DXc4Q06kqmEMmZEH1CrrhxuFR0A.
2025-01-10 22:12:03,779 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 22:12:03,779 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$gGKxyJeH24fsxhKjziv27wJDWskV7bFBz78yhUYbC3Q, sender=@lunabot:localhost, body='Hello! How can I assist you today?'
2025-01-10 22:12:03,779 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 22:12:03,779 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 22:12:03,779 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 22:12:03,779 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 8 (no enforcement yet).
2025-01-10 22:12:03,779 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 22:12:03,779 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$gGKxyJeH24fsxhKjziv27wJDWskV7bFBz78yhUYbC3Q.
2025-01-10 22:12:03,779 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 22:12:03,779 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$cgWI0aWm_Swyy7Fbin3lhJp0wd-_PfcH0Exi-LYQMKs, sender=@evan:localhost, body='hello luna'
2025-01-10 22:12:03,779 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 22:12:03,779 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 22:12:03,779 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 22:12:03,779 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 9 (no enforcement yet).
2025-01-10 22:12:03,779 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 22:12:03,779 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$cgWI0aWm_Swyy7Fbin3lhJp0wd-_PfcH0Exi-LYQMKs.
2025-01-10 22:12:03,779 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 22:12:03,780 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$vl-3Ov3Cs8qqWknJZOzO-hZrWL28bwNafoqD4O8jRio, sender=@evan:localhost, body='hello luna'
2025-01-10 22:12:03,780 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 22:12:03,780 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 22:12:03,780 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 22:12:03,780 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 10 (no enforcement yet).
2025-01-10 22:12:03,780 [WARNING] src.luna_command_extensions.handle_dispatch2: **Route count is 10 => 'final message' would be posted here in real code.**
2025-01-10 22:12:03,780 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 22:12:03,780 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$vl-3Ov3Cs8qqWknJZOzO-hZrWL28bwNafoqD4O8jRio.
2025-01-10 22:12:03,780 [INFO] nio.client.base_client: New joined room !AdQHUmAdpfqWIWULNM:localhost
2025-01-10 22:12:03,780 [INFO] nio.rooms: Room !AdQHUmAdpfqWIWULNM:localhost handling event of type RoomCreateEvent
2025-01-10 22:12:03,780 [INFO] nio.rooms: Room !AdQHUmAdpfqWIWULNM:localhost handling event of type PowerLevelsEvent
2025-01-10 22:12:03,780 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-10 22:12:03,780 [INFO] nio.rooms: Room !AdQHUmAdpfqWIWULNM:localhost handling event of type RoomJoinRulesEvent
2025-01-10 22:12:03,780 [INFO] nio.rooms: Room !AdQHUmAdpfqWIWULNM:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 22:12:03,780 [INFO] nio.rooms: Room !AdQHUmAdpfqWIWULNM:localhost handling event of type RoomNameEvent
2025-01-10 22:12:03,780 [INFO] nio.client.base_client: New joined room !EQpubOIZLWzrGBSBYb:localhost
2025-01-10 22:12:03,780 [INFO] nio.rooms: Room !EQpubOIZLWzrGBSBYb:localhost handling event of type RoomCreateEvent
2025-01-10 22:12:03,780 [INFO] nio.rooms: Room !EQpubOIZLWzrGBSBYb:localhost handling event of type PowerLevelsEvent
2025-01-10 22:12:03,780 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-10 22:12:03,780 [INFO] nio.rooms: Room !EQpubOIZLWzrGBSBYb:localhost handling event of type RoomJoinRulesEvent
2025-01-10 22:12:03,780 [INFO] nio.rooms: Room !EQpubOIZLWzrGBSBYb:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 22:12:03,780 [INFO] nio.rooms: Room !EQpubOIZLWzrGBSBYb:localhost handling event of type RoomNameEvent
2025-01-10 22:12:03,780 [INFO] nio.client.base_client: New joined room !XBwtDVQGRLVcaKcUbm:localhost
2025-01-10 22:12:03,780 [INFO] nio.rooms: Room !XBwtDVQGRLVcaKcUbm:localhost handling event of type PowerLevelsEvent
2025-01-10 22:12:03,780 [INFO] nio.rooms: Room !XBwtDVQGRLVcaKcUbm:localhost handling event of type RoomCreateEvent
2025-01-10 22:12:03,780 [INFO] nio.rooms: Room !XBwtDVQGRLVcaKcUbm:localhost handling event of type RoomAliasEvent
2025-01-10 22:12:03,780 [INFO] nio.rooms: Room !XBwtDVQGRLVcaKcUbm:localhost handling event of type RoomJoinRulesEvent
2025-01-10 22:12:03,780 [INFO] nio.rooms: Room !XBwtDVQGRLVcaKcUbm:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 22:12:03,780 [INFO] nio.rooms: Room !XBwtDVQGRLVcaKcUbm:localhost handling event of type RoomNameEvent
2025-01-10 22:12:03,780 [INFO] nio.rooms: Room !XBwtDVQGRLVcaKcUbm:localhost handling event of type RoomMessageText
2025-01-10 22:12:03,780 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!XBwtDVQGRLVcaKcUbm:localhost, event_id=$pEyxRI5FtH0XVpcwlyUiudNn6Mm-_MJ2ReBs19iY7K8, sender=@evan:localhost, body='Hello lunabot '
2025-01-10 22:12:03,780 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 22:12:03,780 [INFO] src.luna_command_extensions.handle_dispatch2: Room !XBwtDVQGRLVcaKcUbm:localhost has 2 participants.
2025-01-10 22:12:03,780 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 22:12:03,780 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 11 (no enforcement yet).
2025-01-10 22:12:03,780 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 22:12:03,780 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$pEyxRI5FtH0XVpcwlyUiudNn6Mm-_MJ2ReBs19iY7K8.
2025-01-10 22:12:03,780 [INFO] nio.rooms: Room !XBwtDVQGRLVcaKcUbm:localhost handling event of type PowerLevelsEvent
2025-01-10 22:12:03,780 [INFO] src.console_functions: Console screen cleared.
2025-01-10 22:12:03,780 [INFO] nio.rooms: Changing power level for user @evan:localhost from 100 to 100
2025-01-10 22:12:03,781 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-10 22:12:03,781 [INFO] nio.client.base_client: New joined room !fhmXoYxDdsImUkYUpf:localhost
2025-01-10 22:12:03,781 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomCreateEvent
2025-01-10 22:12:03,781 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type PowerLevelsEvent
2025-01-10 22:12:03,781 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-10 22:12:03,781 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomJoinRulesEvent
2025-01-10 22:12:03,781 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 22:12:03,781 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomNameEvent
2025-01-10 22:12:03,781 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomMessageText
2025-01-10 22:12:03,781 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!fhmXoYxDdsImUkYUpf:localhost, event_id=$mKck7AUPntqhnCUEyglff8bl2IZ5n_t32cQQPcciKi8, sender=@evan:localhost, body=':lunabot: hello'
2025-01-10 22:12:03,781 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 22:12:03,781 [INFO] src.luna_command_extensions.handle_dispatch2: Room !fhmXoYxDdsImUkYUpf:localhost has 2 participants.
2025-01-10 22:12:03,781 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 22:12:03,781 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 12 (no enforcement yet).
2025-01-10 22:12:03,781 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 22:12:03,781 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$mKck7AUPntqhnCUEyglff8bl2IZ5n_t32cQQPcciKi8.
2025-01-10 22:12:03,781 [INFO] nio.client.base_client: New joined room !vPFjZGGwOHwoODMQjc:localhost
2025-01-10 22:12:03,781 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomCreateEvent
2025-01-10 22:12:03,781 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type PowerLevelsEvent
2025-01-10 22:12:03,781 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-10 22:12:03,781 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomJoinRulesEvent
2025-01-10 22:12:03,781 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 22:12:03,781 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomNameEvent
2025-01-10 22:12:03,897 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 22:12:27,476 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 22:12:43,009 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 22:12:43,010 [DEBUG] src.console_functions: Forcing @captainamerica:localhost to join !XBwtDVQGRLVcaKcUbm:localhost via http://localhost:8008/_synapse/admin/v1/join/!XBwtDVQGRLVcaKcUbm:localhost
2025-01-10 22:18:03,588 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-10 22:18:03,589 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-10 22:18:03,791 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-10 22:18:04,195 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-10 22:18:04,997 [WARNING] nio.client.async_client: Timed out, sleeping for 1s
2025-01-10 22:18:06,599 [WARNING] nio.client.async_client: Timed out, sleeping for 3s
2025-01-10 22:18:09,803 [WARNING] nio.client.async_client: Timed out, sleeping for 6s
2025-01-10 22:18:16,210 [WARNING] nio.client.async_client: Timed out, sleeping for 12s
2025-01-10 22:18:29,015 [WARNING] nio.client.async_client: Timed out, sleeping for 25s
2025-01-10 22:18:54,620 [WARNING] nio.client.async_client: Timed out, sleeping for 51s
2025-01-10 22:19:45,827 [WARNING] nio.client.async_client: Timed out, sleeping for 60s
2025-01-10 22:20:45,830 [WARNING] nio.client.async_client: Timed out, sleeping for 60s
2025-01-10 22:21:45,841 [WARNING] nio.client.async_client: Timed out, sleeping for 60s
2025-01-10 22:22:45,846 [WARNING] nio.client.async_client: Timed out, sleeping for 60s
2025-01-10 22:23:45,851 [WARNING] nio.client.async_client: Timed out, sleeping for 60s
2025-01-10 22:24:45,941 [WARNING] nio.client.async_client: Timed out, sleeping for 60s
2025-01-10 22:25:45,948 [WARNING] nio.client.async_client: Timed out, sleeping for 60s
2025-01-10 22:26:45,962 [WARNING] nio.client.async_client: Timed out, sleeping for 60s
2025-01-10 22:27:45,973 [WARNING] nio.client.async_client: Timed out, sleeping for 60s
2025-01-10 22:28:45,980 [WARNING] nio.client.async_client: Timed out, sleeping for 60s
2025-01-10 22:29:45,988 [WARNING] nio.client.async_client: Timed out, sleeping for 60s
2025-01-10 22:30:45,993 [WARNING] nio.client.async_client: Timed out, sleeping for 60s
2025-01-10 22:30:48,770 [INFO] src.console_functions: Console received 'exit' command; requesting shutdown.
2025-01-10 22:30:48,771 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 22:30:48,771 [ERROR] __main__: An unexpected exception occurred in main_logic: Event loop stopped before Future completed.
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 145, in luna
    loop.run_until_complete(main_logic())
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 718, in run_until_complete
    raise RuntimeError('Event loop stopped before Future completed.')
RuntimeError: Event loop stopped before Future completed.
2025-01-10 22:30:48,778 [DEBUG] __main__: Preparing to close the event loop.
2025-01-10 22:30:48,779 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-10 22:33:09,144 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-10 22:33:09,144 [DEBUG] __main__: Exiting configure_logging function.
2025-01-10 22:33:09,144 [DEBUG] __main__: Logging configuration complete.
2025-01-10 22:33:09,144 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-10 22:33:09,144 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 22:33:09,145 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-10 22:33:09,145 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-10 22:33:09,145 [DEBUG] __main__: Entering start_console_thread function.
2025-01-10 22:33:09,146 [INFO] __main__: Console thread started successfully.
2025-01-10 22:33:09,146 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-10 22:33:09,146 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-10 22:33:09,146 [INFO] __main__: Starting main_logic coroutine.
2025-01-10 22:33:09,146 [DEBUG] __main__: Entering main_logic function...
2025-01-10 22:33:09,146 [DEBUG] src.luna_functions: Found director_token.json; attempting token-based login.
2025-01-10 22:33:09,148 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-10 22:33:09,153 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-10 22:33:09,153 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-10 22:33:09,182 [INFO] src.console_functions: Console screen cleared.
2025-01-10 22:33:09,289 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 22:33:09,355 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-10 22:33:09,759 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-10 22:33:10,562 [WARNING] nio.client.async_client: Timed out, sleeping for 1s
2025-01-10 22:33:12,166 [WARNING] nio.client.async_client: Timed out, sleeping for 3s
2025-01-10 22:33:15,371 [WARNING] nio.client.async_client: Timed out, sleeping for 6s
2025-01-10 22:33:21,778 [WARNING] nio.client.async_client: Timed out, sleeping for 12s
2025-01-10 22:33:31,245 [INFO] src.console_functions: Console received 'exit' command; requesting shutdown.
2025-01-10 22:33:31,245 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 22:33:31,245 [ERROR] __main__: An unexpected exception occurred in main_logic: Event loop stopped before Future completed.
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 145, in luna
    loop.run_until_complete(main_logic())
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 718, in run_until_complete
    raise RuntimeError('Event loop stopped before Future completed.')
RuntimeError: Event loop stopped before Future completed.
2025-01-10 22:33:31,252 [DEBUG] __main__: Preparing to close the event loop.
2025-01-10 22:33:31,252 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-10 22:33:31,305 [ERROR] asyncio: Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x10dad06e0>
2025-01-10 22:33:36,591 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-10 22:33:36,591 [DEBUG] __main__: Exiting configure_logging function.
2025-01-10 22:33:36,591 [DEBUG] __main__: Logging configuration complete.
2025-01-10 22:33:36,591 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-10 22:33:36,591 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 22:33:36,591 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-10 22:33:36,591 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-10 22:33:36,591 [DEBUG] __main__: Entering start_console_thread function.
2025-01-10 22:33:36,592 [INFO] __main__: Console thread started successfully.
2025-01-10 22:33:36,593 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-10 22:33:36,593 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-10 22:33:36,593 [INFO] __main__: Starting main_logic coroutine.
2025-01-10 22:33:36,593 [DEBUG] __main__: Entering main_logic function...
2025-01-10 22:33:36,595 [DEBUG] src.luna_functions: Found director_token.json; attempting token-based login.
2025-01-10 22:33:36,595 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-10 22:33:36,610 [INFO] src.console_functions: Console screen cleared.
2025-01-10 22:33:36,615 [INFO] src.luna_functions: Token-based login verified for user @lunabot:localhost.
2025-01-10 22:33:36,616 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-10 22:33:36,653 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 22:33:36,675 [INFO] nio.client.base_client: New joined room !EQpubOIZLWzrGBSBYb:localhost
2025-01-10 22:33:36,675 [INFO] nio.rooms: Room !EQpubOIZLWzrGBSBYb:localhost handling event of type RoomCreateEvent
2025-01-10 22:33:36,675 [INFO] nio.rooms: Room !EQpubOIZLWzrGBSBYb:localhost handling event of type PowerLevelsEvent
2025-01-10 22:33:36,675 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-10 22:33:36,675 [INFO] nio.rooms: Room !EQpubOIZLWzrGBSBYb:localhost handling event of type RoomJoinRulesEvent
2025-01-10 22:33:36,675 [INFO] nio.rooms: Room !EQpubOIZLWzrGBSBYb:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 22:33:36,675 [INFO] nio.rooms: Room !EQpubOIZLWzrGBSBYb:localhost handling event of type RoomNameEvent
2025-01-10 22:33:36,675 [INFO] nio.client.base_client: New joined room !vPFjZGGwOHwoODMQjc:localhost
2025-01-10 22:33:36,675 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomCreateEvent
2025-01-10 22:33:36,675 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type PowerLevelsEvent
2025-01-10 22:33:36,675 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-10 22:33:36,675 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomJoinRulesEvent
2025-01-10 22:33:36,675 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 22:33:36,675 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomNameEvent
2025-01-10 22:33:36,675 [INFO] nio.client.base_client: New joined room !AdQHUmAdpfqWIWULNM:localhost
2025-01-10 22:33:36,675 [INFO] nio.rooms: Room !AdQHUmAdpfqWIWULNM:localhost handling event of type RoomCreateEvent
2025-01-10 22:33:36,675 [INFO] nio.rooms: Room !AdQHUmAdpfqWIWULNM:localhost handling event of type PowerLevelsEvent
2025-01-10 22:33:36,675 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-10 22:33:36,675 [INFO] nio.rooms: Room !AdQHUmAdpfqWIWULNM:localhost handling event of type RoomJoinRulesEvent
2025-01-10 22:33:36,675 [INFO] nio.rooms: Room !AdQHUmAdpfqWIWULNM:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 22:33:36,675 [INFO] nio.rooms: Room !AdQHUmAdpfqWIWULNM:localhost handling event of type RoomNameEvent
2025-01-10 22:33:36,675 [INFO] nio.client.base_client: New joined room !fhmXoYxDdsImUkYUpf:localhost
2025-01-10 22:33:36,675 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomCreateEvent
2025-01-10 22:33:36,675 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type PowerLevelsEvent
2025-01-10 22:33:36,675 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-10 22:33:36,675 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomJoinRulesEvent
2025-01-10 22:33:36,675 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 22:33:36,675 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomNameEvent
2025-01-10 22:33:36,675 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomMessageText
2025-01-10 22:33:36,675 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!fhmXoYxDdsImUkYUpf:localhost, event_id=$mKck7AUPntqhnCUEyglff8bl2IZ5n_t32cQQPcciKi8, sender=@evan:localhost, body=':lunabot: hello'
2025-01-10 22:33:36,675 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 22:33:36,675 [INFO] src.luna_command_extensions.handle_dispatch2: Room !fhmXoYxDdsImUkYUpf:localhost has 2 participants.
2025-01-10 22:33:36,675 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 22:33:36,675 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 1 (no enforcement yet).
2025-01-10 22:33:36,675 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 22:33:36,675 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$mKck7AUPntqhnCUEyglff8bl2IZ5n_t32cQQPcciKi8.
2025-01-10 22:33:36,675 [INFO] nio.client.base_client: New joined room !wksSOEXmjceGUTMkdv:localhost
2025-01-10 22:33:36,675 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomGuestAccessEvent
2025-01-10 22:33:36,675 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 22:33:36,675 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomCreateEvent
2025-01-10 22:33:36,675 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type PowerLevelsEvent
2025-01-10 22:33:36,675 [INFO] nio.rooms: Changing power level for user @evan:localhost from 0 to 100
2025-01-10 22:33:36,675 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomJoinRulesEvent
2025-01-10 22:33:36,675 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 22:33:36,675 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$kIVMdgr0cQrrIPbHs_HGy9-ehkF8d1WtgF2JezjXeQQ, sender=@lunabot:localhost, body='Hello! How can I assist you today?'
2025-01-10 22:33:36,675 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 22:33:36,675 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 22:33:36,675 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 22:33:36,676 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 2 (no enforcement yet).
2025-01-10 22:33:36,676 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 22:33:36,676 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$kIVMdgr0cQrrIPbHs_HGy9-ehkF8d1WtgF2JezjXeQQ.
2025-01-10 22:33:36,676 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 22:33:36,676 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$SxwxiUQgktvUwljSyA1n7r_HCarpYQcFPlMtEAY3CEk, sender=@evan:localhost, body='Do you talk'
2025-01-10 22:33:36,676 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 22:33:36,676 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 22:33:36,676 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 22:33:36,676 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 3 (no enforcement yet).
2025-01-10 22:33:36,676 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 22:33:36,676 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$SxwxiUQgktvUwljSyA1n7r_HCarpYQcFPlMtEAY3CEk.
2025-01-10 22:33:36,676 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 22:33:36,676 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$DqAkRJkn-EF5oE0izNwSf23s-qx9tEZcBjCMgd0_r3Q, sender=@lunabot:localhost, body='Yes, I can communicate through text-based responses to assist with your queries and tasks.'
2025-01-10 22:33:36,676 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 22:33:36,676 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 22:33:36,676 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 22:33:36,676 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 4 (no enforcement yet).
2025-01-10 22:33:36,676 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 22:33:36,676 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$DqAkRJkn-EF5oE0izNwSf23s-qx9tEZcBjCMgd0_r3Q.
2025-01-10 22:33:36,676 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 22:33:36,676 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$-cYLqrWk74kz0pQ0xEBT5U1Xd_chpCGd-6eDv0VmpRU, sender=@evan:localhost, body="but you don't respond to lunabot "
2025-01-10 22:33:36,676 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 22:33:36,676 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 22:33:36,676 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 22:33:36,676 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 5 (no enforcement yet).
2025-01-10 22:33:36,676 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 22:33:36,676 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$-cYLqrWk74kz0pQ0xEBT5U1Xd_chpCGd-6eDv0VmpRU.
2025-01-10 22:33:36,676 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 22:33:36,676 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$jFIdqWc4NjcFdBommSRYh-yJjk6A9vUBlOOAUV-EEOs, sender=@evan:localhost, body='only untagged'
2025-01-10 22:33:36,676 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 22:33:36,676 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 22:33:36,676 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 22:33:36,676 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 6 (no enforcement yet).
2025-01-10 22:33:36,676 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 22:33:36,676 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$jFIdqWc4NjcFdBommSRYh-yJjk6A9vUBlOOAUV-EEOs.
2025-01-10 22:33:36,676 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 22:33:36,676 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$epknto4MCqSSIFGlWNTNwtwVDxwtCiMAHm4rWzWQUUc, sender=@lunabot:localhost, body="I'm sorry, but your request is a bit unclear. Could you please provide more details or context so I can assist you in the best way possible?"
2025-01-10 22:33:36,676 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 22:33:36,676 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 22:33:36,676 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 22:33:36,676 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 7 (no enforcement yet).
2025-01-10 22:33:36,676 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 22:33:36,676 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$epknto4MCqSSIFGlWNTNwtwVDxwtCiMAHm4rWzWQUUc.
2025-01-10 22:33:36,676 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 22:33:36,676 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$lBU7IQLaAxhN3yO3DXc4Q06kqmEMmZEH1CrrhxuFR0A, sender=@evan:localhost, body='hello luna'
2025-01-10 22:33:36,676 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 22:33:36,676 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 22:33:36,676 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 22:33:36,676 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 8 (no enforcement yet).
2025-01-10 22:33:36,676 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 22:33:36,676 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$lBU7IQLaAxhN3yO3DXc4Q06kqmEMmZEH1CrrhxuFR0A.
2025-01-10 22:33:36,676 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 22:33:36,676 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$gGKxyJeH24fsxhKjziv27wJDWskV7bFBz78yhUYbC3Q, sender=@lunabot:localhost, body='Hello! How can I assist you today?'
2025-01-10 22:33:36,676 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 22:33:36,676 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 22:33:36,676 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 22:33:36,676 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 9 (no enforcement yet).
2025-01-10 22:33:36,676 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 22:33:36,676 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$gGKxyJeH24fsxhKjziv27wJDWskV7bFBz78yhUYbC3Q.
2025-01-10 22:33:36,676 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 22:33:36,676 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$cgWI0aWm_Swyy7Fbin3lhJp0wd-_PfcH0Exi-LYQMKs, sender=@evan:localhost, body='hello luna'
2025-01-10 22:33:36,676 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 22:33:36,676 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 22:33:36,676 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 22:33:36,676 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 10 (no enforcement yet).
2025-01-10 22:33:36,676 [WARNING] src.luna_command_extensions.handle_dispatch2: **Route count is 10 => 'final message' would be posted here in real code.**
2025-01-10 22:33:36,676 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 22:33:36,677 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$cgWI0aWm_Swyy7Fbin3lhJp0wd-_PfcH0Exi-LYQMKs.
2025-01-10 22:33:36,677 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 22:33:36,677 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$vl-3Ov3Cs8qqWknJZOzO-hZrWL28bwNafoqD4O8jRio, sender=@evan:localhost, body='hello luna'
2025-01-10 22:33:36,677 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 22:33:36,677 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 22:33:36,677 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 22:33:36,677 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 11 (no enforcement yet).
2025-01-10 22:33:36,677 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 22:33:36,677 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$vl-3Ov3Cs8qqWknJZOzO-hZrWL28bwNafoqD4O8jRio.
2025-01-10 22:33:36,677 [INFO] nio.client.base_client: New joined room !XBwtDVQGRLVcaKcUbm:localhost
2025-01-10 22:33:36,677 [INFO] nio.rooms: Room !XBwtDVQGRLVcaKcUbm:localhost handling event of type PowerLevelsEvent
2025-01-10 22:33:36,677 [INFO] nio.rooms: Changing power level for user @evan:localhost from 0 to 100
2025-01-10 22:33:36,677 [INFO] nio.rooms: Room !XBwtDVQGRLVcaKcUbm:localhost handling event of type RoomCreateEvent
2025-01-10 22:33:36,677 [INFO] nio.rooms: Room !XBwtDVQGRLVcaKcUbm:localhost handling event of type RoomAliasEvent
2025-01-10 22:33:36,677 [INFO] nio.rooms: Room !XBwtDVQGRLVcaKcUbm:localhost handling event of type RoomJoinRulesEvent
2025-01-10 22:33:36,677 [INFO] nio.rooms: Room !XBwtDVQGRLVcaKcUbm:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 22:33:36,677 [INFO] nio.rooms: Room !XBwtDVQGRLVcaKcUbm:localhost handling event of type RoomNameEvent
2025-01-10 22:33:36,677 [INFO] nio.rooms: Room !XBwtDVQGRLVcaKcUbm:localhost handling event of type RoomMessageText
2025-01-10 22:33:36,677 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!XBwtDVQGRLVcaKcUbm:localhost, event_id=$pEyxRI5FtH0XVpcwlyUiudNn6Mm-_MJ2ReBs19iY7K8, sender=@evan:localhost, body='Hello lunabot '
2025-01-10 22:33:36,677 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 22:33:36,677 [INFO] src.luna_command_extensions.handle_dispatch2: Room !XBwtDVQGRLVcaKcUbm:localhost has 2 participants.
2025-01-10 22:33:36,677 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 22:33:36,677 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 12 (no enforcement yet).
2025-01-10 22:33:36,677 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 22:33:36,677 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$pEyxRI5FtH0XVpcwlyUiudNn6Mm-_MJ2ReBs19iY7K8.
2025-01-10 22:33:36,677 [INFO] nio.rooms: Room !XBwtDVQGRLVcaKcUbm:localhost handling event of type PowerLevelsEvent
2025-01-10 22:33:36,677 [INFO] nio.rooms: Changing power level for user @evan:localhost from 100 to 100
2025-01-10 22:33:36,677 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-10 22:37:00,593 [INFO] nio.client.base_client: New invited room !kzXdTMnUUelFEFHQIX:localhost
2025-01-10 22:37:00,593 [INFO] nio.rooms: Room !kzXdTMnUUelFEFHQIX:localhost handling event of type InviteAliasEvent
2025-01-10 22:37:00,593 [INFO] nio.rooms: Room !kzXdTMnUUelFEFHQIX:localhost handling event of type InviteNameEvent
2025-01-10 22:37:00,593 [INFO] nio.rooms: Room !kzXdTMnUUelFEFHQIX:localhost handling event of type InviteMemberEvent
2025-01-10 22:37:00,594 [INFO] src.luna_functions: Received invite to !kzXdTMnUUelFEFHQIX:localhost, joining now.
2025-01-10 22:37:00,617 [ERROR] __main__: Error in client.sync: name 'room_id' is not defined
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 101, in main_logic
    await client.sync(timeout=5000)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/base_client.py", line 116, in wrapper
    return await func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 1232, in sync
    response = await self._send(
               ^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 880, in _send
    await self.receive_response(resp)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 770, in receive_response
    await self._handle_sync(response)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 735, in _handle_sync
    await self._handle_invited_rooms(response)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 615, in _handle_invited_rooms
    await self._on_invited_rooms(event, room)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 693, in _on_invited_rooms
    await cb.async_execute(event, room)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/base_client.py", line 160, in async_execute
    await result
  File "/Users/evanrobinson/Documents/Luna2/luna/src/luna_functions.py", line 344, in on_invite_event
    cmd_auto_join_personas()
    ~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/evanrobinson/Documents/Luna2/luna/src/luna_functions.py", line 392, in cmd_auto_join_personas
    future = asyncio.run_coroutine_threadsafe(do_force_join_all(room_id), loop)
                                                                ^^^^^^^
NameError: name 'room_id' is not defined
2025-01-10 22:37:00,639 [INFO] nio.client.base_client: New joined room !kzXdTMnUUelFEFHQIX:localhost
2025-01-10 22:37:00,639 [INFO] nio.rooms: Room !kzXdTMnUUelFEFHQIX:localhost handling event of type RoomCreateEvent
2025-01-10 22:37:00,639 [INFO] nio.rooms: Room !kzXdTMnUUelFEFHQIX:localhost handling event of type PowerLevelsEvent
2025-01-10 22:37:00,639 [INFO] nio.rooms: Changing power level for user @evan:localhost from 0 to 100
2025-01-10 22:37:00,639 [INFO] nio.rooms: Room !kzXdTMnUUelFEFHQIX:localhost handling event of type RoomAliasEvent
2025-01-10 22:37:00,639 [INFO] nio.rooms: Room !kzXdTMnUUelFEFHQIX:localhost handling event of type RoomJoinRulesEvent
2025-01-10 22:37:00,639 [INFO] nio.rooms: Room !kzXdTMnUUelFEFHQIX:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 22:37:00,640 [INFO] nio.rooms: Room !kzXdTMnUUelFEFHQIX:localhost handling event of type RoomNameEvent
2025-01-10 22:37:15,783 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 22:40:40,960 [INFO] src.console_functions: Console received 'exit' command; requesting shutdown.
2025-01-10 22:40:40,963 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 22:40:40,963 [ERROR] __main__: An unexpected exception occurred in main_logic: Event loop stopped before Future completed.
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 145, in luna
    loop.run_until_complete(main_logic())
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 718, in run_until_complete
    raise RuntimeError('Event loop stopped before Future completed.')
RuntimeError: Event loop stopped before Future completed.
2025-01-10 22:40:40,969 [DEBUG] __main__: Preparing to close the event loop.
2025-01-10 22:40:40,969 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-10 22:40:43,602 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-10 22:40:43,602 [DEBUG] __main__: Exiting configure_logging function.
2025-01-10 22:40:43,602 [DEBUG] __main__: Logging configuration complete.
2025-01-10 22:40:43,602 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-10 22:40:43,602 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 22:40:43,602 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-10 22:40:43,602 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-10 22:40:43,602 [DEBUG] __main__: Entering start_console_thread function.
2025-01-10 22:40:43,603 [INFO] __main__: Console thread started successfully.
2025-01-10 22:40:43,603 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-10 22:40:43,603 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-10 22:40:43,603 [INFO] __main__: Starting main_logic coroutine.
2025-01-10 22:40:43,603 [DEBUG] __main__: Entering main_logic function...
2025-01-10 22:40:43,603 [DEBUG] src.luna_functions: Found director_token.json; attempting token-based login.
2025-01-10 22:40:43,606 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-10 22:40:43,626 [INFO] src.luna_functions: Token-based login verified for user @lunabot:localhost.
2025-01-10 22:40:43,627 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-10 22:40:43,645 [INFO] src.console_functions: Console screen cleared.
2025-01-10 22:40:43,655 [INFO] nio.client.base_client: New joined room !wksSOEXmjceGUTMkdv:localhost
2025-01-10 22:40:43,655 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomGuestAccessEvent
2025-01-10 22:40:43,655 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 22:40:43,655 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomCreateEvent
2025-01-10 22:40:43,655 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type PowerLevelsEvent
2025-01-10 22:40:43,655 [INFO] nio.rooms: Changing power level for user @evan:localhost from 0 to 100
2025-01-10 22:40:43,655 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomJoinRulesEvent
2025-01-10 22:40:43,655 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 22:40:43,655 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$kIVMdgr0cQrrIPbHs_HGy9-ehkF8d1WtgF2JezjXeQQ, sender=@lunabot:localhost, body='Hello! How can I assist you today?'
2025-01-10 22:40:43,655 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 22:40:43,655 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 22:40:43,655 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 22:40:43,655 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 1 (no enforcement yet).
2025-01-10 22:40:43,656 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 22:40:43,656 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$kIVMdgr0cQrrIPbHs_HGy9-ehkF8d1WtgF2JezjXeQQ.
2025-01-10 22:40:43,656 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 22:40:43,656 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$SxwxiUQgktvUwljSyA1n7r_HCarpYQcFPlMtEAY3CEk, sender=@evan:localhost, body='Do you talk'
2025-01-10 22:40:43,656 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 22:40:43,656 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 22:40:43,656 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 22:40:43,656 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 2 (no enforcement yet).
2025-01-10 22:40:43,656 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 22:40:43,656 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$SxwxiUQgktvUwljSyA1n7r_HCarpYQcFPlMtEAY3CEk.
2025-01-10 22:40:43,656 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 22:40:43,656 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$DqAkRJkn-EF5oE0izNwSf23s-qx9tEZcBjCMgd0_r3Q, sender=@lunabot:localhost, body='Yes, I can communicate through text-based responses to assist with your queries and tasks.'
2025-01-10 22:40:43,656 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 22:40:43,656 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 22:40:43,656 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 22:40:43,656 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 3 (no enforcement yet).
2025-01-10 22:40:43,656 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 22:40:43,656 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$DqAkRJkn-EF5oE0izNwSf23s-qx9tEZcBjCMgd0_r3Q.
2025-01-10 22:40:43,656 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 22:40:43,656 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$-cYLqrWk74kz0pQ0xEBT5U1Xd_chpCGd-6eDv0VmpRU, sender=@evan:localhost, body="but you don't respond to lunabot "
2025-01-10 22:40:43,656 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 22:40:43,656 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 22:40:43,656 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 22:40:43,656 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 4 (no enforcement yet).
2025-01-10 22:40:43,656 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 22:40:43,656 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$-cYLqrWk74kz0pQ0xEBT5U1Xd_chpCGd-6eDv0VmpRU.
2025-01-10 22:40:43,656 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 22:40:43,656 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$jFIdqWc4NjcFdBommSRYh-yJjk6A9vUBlOOAUV-EEOs, sender=@evan:localhost, body='only untagged'
2025-01-10 22:40:43,656 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 22:40:43,656 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 22:40:43,656 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 22:40:43,656 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 5 (no enforcement yet).
2025-01-10 22:40:43,656 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 22:40:43,656 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$jFIdqWc4NjcFdBommSRYh-yJjk6A9vUBlOOAUV-EEOs.
2025-01-10 22:40:43,656 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 22:40:43,656 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$epknto4MCqSSIFGlWNTNwtwVDxwtCiMAHm4rWzWQUUc, sender=@lunabot:localhost, body="I'm sorry, but your request is a bit unclear. Could you please provide more details or context so I can assist you in the best way possible?"
2025-01-10 22:40:43,656 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 22:40:43,656 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 22:40:43,656 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 22:40:43,656 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 6 (no enforcement yet).
2025-01-10 22:40:43,656 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 22:40:43,656 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$epknto4MCqSSIFGlWNTNwtwVDxwtCiMAHm4rWzWQUUc.
2025-01-10 22:40:43,656 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 22:40:43,656 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$lBU7IQLaAxhN3yO3DXc4Q06kqmEMmZEH1CrrhxuFR0A, sender=@evan:localhost, body='hello luna'
2025-01-10 22:40:43,656 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 22:40:43,656 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 22:40:43,656 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 22:40:43,656 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 7 (no enforcement yet).
2025-01-10 22:40:43,656 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 22:40:43,656 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$lBU7IQLaAxhN3yO3DXc4Q06kqmEMmZEH1CrrhxuFR0A.
2025-01-10 22:40:43,657 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 22:40:43,657 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$gGKxyJeH24fsxhKjziv27wJDWskV7bFBz78yhUYbC3Q, sender=@lunabot:localhost, body='Hello! How can I assist you today?'
2025-01-10 22:40:43,657 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 22:40:43,657 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 22:40:43,657 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 22:40:43,657 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 8 (no enforcement yet).
2025-01-10 22:40:43,657 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 22:40:43,657 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$gGKxyJeH24fsxhKjziv27wJDWskV7bFBz78yhUYbC3Q.
2025-01-10 22:40:43,657 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 22:40:43,657 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$cgWI0aWm_Swyy7Fbin3lhJp0wd-_PfcH0Exi-LYQMKs, sender=@evan:localhost, body='hello luna'
2025-01-10 22:40:43,657 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 22:40:43,657 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 22:40:43,657 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 22:40:43,657 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 9 (no enforcement yet).
2025-01-10 22:40:43,657 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 22:40:43,657 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$cgWI0aWm_Swyy7Fbin3lhJp0wd-_PfcH0Exi-LYQMKs.
2025-01-10 22:40:43,657 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 22:40:43,657 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$vl-3Ov3Cs8qqWknJZOzO-hZrWL28bwNafoqD4O8jRio, sender=@evan:localhost, body='hello luna'
2025-01-10 22:40:43,657 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 22:40:43,657 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 22:40:43,657 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 22:40:43,657 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 10 (no enforcement yet).
2025-01-10 22:40:43,657 [WARNING] src.luna_command_extensions.handle_dispatch2: **Route count is 10 => 'final message' would be posted here in real code.**
2025-01-10 22:40:43,657 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 22:40:43,657 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$vl-3Ov3Cs8qqWknJZOzO-hZrWL28bwNafoqD4O8jRio.
2025-01-10 22:40:43,657 [INFO] nio.client.base_client: New joined room !AdQHUmAdpfqWIWULNM:localhost
2025-01-10 22:40:43,657 [INFO] nio.rooms: Room !AdQHUmAdpfqWIWULNM:localhost handling event of type RoomCreateEvent
2025-01-10 22:40:43,657 [INFO] nio.rooms: Room !AdQHUmAdpfqWIWULNM:localhost handling event of type PowerLevelsEvent
2025-01-10 22:40:43,657 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-10 22:40:43,657 [INFO] nio.rooms: Room !AdQHUmAdpfqWIWULNM:localhost handling event of type RoomJoinRulesEvent
2025-01-10 22:40:43,657 [INFO] nio.rooms: Room !AdQHUmAdpfqWIWULNM:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 22:40:43,657 [INFO] nio.rooms: Room !AdQHUmAdpfqWIWULNM:localhost handling event of type RoomNameEvent
2025-01-10 22:40:43,657 [INFO] nio.client.base_client: New joined room !EQpubOIZLWzrGBSBYb:localhost
2025-01-10 22:40:43,657 [INFO] nio.rooms: Room !EQpubOIZLWzrGBSBYb:localhost handling event of type RoomCreateEvent
2025-01-10 22:40:43,657 [INFO] nio.rooms: Room !EQpubOIZLWzrGBSBYb:localhost handling event of type PowerLevelsEvent
2025-01-10 22:40:43,657 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-10 22:40:43,657 [INFO] nio.rooms: Room !EQpubOIZLWzrGBSBYb:localhost handling event of type RoomJoinRulesEvent
2025-01-10 22:40:43,657 [INFO] nio.rooms: Room !EQpubOIZLWzrGBSBYb:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 22:40:43,657 [INFO] nio.rooms: Room !EQpubOIZLWzrGBSBYb:localhost handling event of type RoomNameEvent
2025-01-10 22:40:43,657 [INFO] nio.client.base_client: New joined room !fhmXoYxDdsImUkYUpf:localhost
2025-01-10 22:40:43,658 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomCreateEvent
2025-01-10 22:40:43,658 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type PowerLevelsEvent
2025-01-10 22:40:43,658 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-10 22:40:43,658 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomJoinRulesEvent
2025-01-10 22:40:43,658 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 22:40:43,658 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomNameEvent
2025-01-10 22:40:43,658 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomMessageText
2025-01-10 22:40:43,658 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!fhmXoYxDdsImUkYUpf:localhost, event_id=$mKck7AUPntqhnCUEyglff8bl2IZ5n_t32cQQPcciKi8, sender=@evan:localhost, body=':lunabot: hello'
2025-01-10 22:40:43,658 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 22:40:43,658 [INFO] src.luna_command_extensions.handle_dispatch2: Room !fhmXoYxDdsImUkYUpf:localhost has 2 participants.
2025-01-10 22:40:43,658 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 22:40:43,658 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 11 (no enforcement yet).
2025-01-10 22:40:43,658 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 22:40:43,658 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$mKck7AUPntqhnCUEyglff8bl2IZ5n_t32cQQPcciKi8.
2025-01-10 22:40:43,658 [INFO] nio.client.base_client: New joined room !vPFjZGGwOHwoODMQjc:localhost
2025-01-10 22:40:43,658 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomCreateEvent
2025-01-10 22:40:43,658 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type PowerLevelsEvent
2025-01-10 22:40:43,658 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-10 22:40:43,658 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomJoinRulesEvent
2025-01-10 22:40:43,658 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 22:40:43,658 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomNameEvent
2025-01-10 22:40:43,658 [INFO] nio.client.base_client: New joined room !kzXdTMnUUelFEFHQIX:localhost
2025-01-10 22:40:43,658 [INFO] nio.rooms: Room !kzXdTMnUUelFEFHQIX:localhost handling event of type RoomCreateEvent
2025-01-10 22:40:43,658 [INFO] nio.rooms: Room !kzXdTMnUUelFEFHQIX:localhost handling event of type PowerLevelsEvent
2025-01-10 22:40:43,658 [INFO] nio.rooms: Changing power level for user @evan:localhost from 0 to 100
2025-01-10 22:40:43,658 [INFO] nio.rooms: Room !kzXdTMnUUelFEFHQIX:localhost handling event of type RoomAliasEvent
2025-01-10 22:40:43,658 [INFO] nio.rooms: Room !kzXdTMnUUelFEFHQIX:localhost handling event of type RoomJoinRulesEvent
2025-01-10 22:40:43,658 [INFO] nio.rooms: Room !kzXdTMnUUelFEFHQIX:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 22:40:43,658 [INFO] nio.rooms: Room !kzXdTMnUUelFEFHQIX:localhost handling event of type RoomNameEvent
2025-01-10 22:40:43,658 [INFO] nio.client.base_client: New joined room !XBwtDVQGRLVcaKcUbm:localhost
2025-01-10 22:40:43,658 [INFO] nio.rooms: Room !XBwtDVQGRLVcaKcUbm:localhost handling event of type PowerLevelsEvent
2025-01-10 22:40:43,658 [INFO] nio.rooms: Changing power level for user @evan:localhost from 0 to 100
2025-01-10 22:40:43,659 [INFO] nio.rooms: Room !XBwtDVQGRLVcaKcUbm:localhost handling event of type RoomAliasEvent
2025-01-10 22:40:43,659 [INFO] nio.rooms: Room !XBwtDVQGRLVcaKcUbm:localhost handling event of type RoomCreateEvent
2025-01-10 22:40:43,659 [INFO] nio.rooms: Room !XBwtDVQGRLVcaKcUbm:localhost handling event of type RoomJoinRulesEvent
2025-01-10 22:40:43,659 [INFO] nio.rooms: Room !XBwtDVQGRLVcaKcUbm:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 22:40:43,659 [INFO] nio.rooms: Room !XBwtDVQGRLVcaKcUbm:localhost handling event of type RoomNameEvent
2025-01-10 22:40:43,659 [INFO] nio.rooms: Room !XBwtDVQGRLVcaKcUbm:localhost handling event of type RoomMessageText
2025-01-10 22:40:43,659 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!XBwtDVQGRLVcaKcUbm:localhost, event_id=$pEyxRI5FtH0XVpcwlyUiudNn6Mm-_MJ2ReBs19iY7K8, sender=@evan:localhost, body='Hello lunabot '
2025-01-10 22:40:43,659 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 22:40:43,659 [INFO] src.luna_command_extensions.handle_dispatch2: Room !XBwtDVQGRLVcaKcUbm:localhost has 2 participants.
2025-01-10 22:40:43,659 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 22:40:43,659 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 12 (no enforcement yet).
2025-01-10 22:40:43,659 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 22:40:43,659 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$pEyxRI5FtH0XVpcwlyUiudNn6Mm-_MJ2ReBs19iY7K8.
2025-01-10 22:40:43,659 [INFO] nio.rooms: Room !XBwtDVQGRLVcaKcUbm:localhost handling event of type PowerLevelsEvent
2025-01-10 22:40:43,659 [INFO] nio.rooms: Changing power level for user @evan:localhost from 100 to 100
2025-01-10 22:40:43,659 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-10 22:40:43,774 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 22:41:03,846 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 22:42:18,144 [INFO] src.console_functions: Console received 'exit' command; requesting shutdown.
2025-01-10 22:42:18,144 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 22:42:18,144 [ERROR] __main__: An unexpected exception occurred in main_logic: Event loop stopped before Future completed.
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 145, in luna
    loop.run_until_complete(main_logic())
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 718, in run_until_complete
    raise RuntimeError('Event loop stopped before Future completed.')
RuntimeError: Event loop stopped before Future completed.
2025-01-10 22:42:18,147 [DEBUG] __main__: Preparing to close the event loop.
2025-01-10 22:42:18,147 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-10 22:42:20,802 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-10 22:42:20,802 [DEBUG] __main__: Exiting configure_logging function.
2025-01-10 22:42:20,802 [DEBUG] __main__: Logging configuration complete.
2025-01-10 22:42:20,802 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-10 22:42:20,802 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 22:42:20,802 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-10 22:42:20,802 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-10 22:42:20,802 [DEBUG] __main__: Entering start_console_thread function.
2025-01-10 22:42:20,804 [INFO] __main__: Console thread started successfully.
2025-01-10 22:42:20,804 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-10 22:42:20,804 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-10 22:42:20,804 [INFO] __main__: Starting main_logic coroutine.
2025-01-10 22:42:20,804 [DEBUG] __main__: Entering main_logic function...
2025-01-10 22:42:20,804 [DEBUG] src.luna_functions: Found director_token.json; attempting token-based login.
2025-01-10 22:42:20,806 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-10 22:42:20,815 [INFO] src.luna_functions: Token-based login verified for user @lunabot:localhost.
2025-01-10 22:42:20,815 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-10 22:42:20,818 [INFO] src.console_functions: Console screen cleared.
2025-01-10 22:42:20,827 [INFO] nio.client.base_client: New joined room !wksSOEXmjceGUTMkdv:localhost
2025-01-10 22:42:20,828 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomGuestAccessEvent
2025-01-10 22:42:20,828 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 22:42:20,828 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomCreateEvent
2025-01-10 22:42:20,828 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type PowerLevelsEvent
2025-01-10 22:42:20,828 [INFO] nio.rooms: Changing power level for user @evan:localhost from 0 to 100
2025-01-10 22:42:20,828 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomJoinRulesEvent
2025-01-10 22:42:20,828 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 22:42:20,828 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$kIVMdgr0cQrrIPbHs_HGy9-ehkF8d1WtgF2JezjXeQQ, sender=@lunabot:localhost, body='Hello! How can I assist you today?'
2025-01-10 22:42:20,828 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 22:42:20,828 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 22:42:20,828 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 22:42:20,828 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 1 (no enforcement yet).
2025-01-10 22:42:20,828 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 22:42:20,828 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$kIVMdgr0cQrrIPbHs_HGy9-ehkF8d1WtgF2JezjXeQQ.
2025-01-10 22:42:20,828 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 22:42:20,828 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$SxwxiUQgktvUwljSyA1n7r_HCarpYQcFPlMtEAY3CEk, sender=@evan:localhost, body='Do you talk'
2025-01-10 22:42:20,828 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 22:42:20,829 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 22:42:20,829 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 22:42:20,829 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 2 (no enforcement yet).
2025-01-10 22:42:20,829 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 22:42:20,829 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$SxwxiUQgktvUwljSyA1n7r_HCarpYQcFPlMtEAY3CEk.
2025-01-10 22:42:20,829 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 22:42:20,829 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$DqAkRJkn-EF5oE0izNwSf23s-qx9tEZcBjCMgd0_r3Q, sender=@lunabot:localhost, body='Yes, I can communicate through text-based responses to assist with your queries and tasks.'
2025-01-10 22:42:20,829 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 22:42:20,829 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 22:42:20,829 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 22:42:20,829 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 3 (no enforcement yet).
2025-01-10 22:42:20,829 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 22:42:20,829 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$DqAkRJkn-EF5oE0izNwSf23s-qx9tEZcBjCMgd0_r3Q.
2025-01-10 22:42:20,829 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 22:42:20,829 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$-cYLqrWk74kz0pQ0xEBT5U1Xd_chpCGd-6eDv0VmpRU, sender=@evan:localhost, body="but you don't respond to lunabot "
2025-01-10 22:42:20,829 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 22:42:20,829 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 22:42:20,829 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 22:42:20,829 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 4 (no enforcement yet).
2025-01-10 22:42:20,829 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 22:42:20,829 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$-cYLqrWk74kz0pQ0xEBT5U1Xd_chpCGd-6eDv0VmpRU.
2025-01-10 22:42:20,829 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 22:42:20,829 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$jFIdqWc4NjcFdBommSRYh-yJjk6A9vUBlOOAUV-EEOs, sender=@evan:localhost, body='only untagged'
2025-01-10 22:42:20,829 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 22:42:20,829 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 22:42:20,829 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 22:42:20,830 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 5 (no enforcement yet).
2025-01-10 22:42:20,830 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 22:42:20,830 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$jFIdqWc4NjcFdBommSRYh-yJjk6A9vUBlOOAUV-EEOs.
2025-01-10 22:42:20,830 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 22:42:20,830 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$epknto4MCqSSIFGlWNTNwtwVDxwtCiMAHm4rWzWQUUc, sender=@lunabot:localhost, body="I'm sorry, but your request is a bit unclear. Could you please provide more details or context so I can assist you in the best way possible?"
2025-01-10 22:42:20,830 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 22:42:20,830 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 22:42:20,830 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 22:42:20,830 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 6 (no enforcement yet).
2025-01-10 22:42:20,830 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 22:42:20,830 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$epknto4MCqSSIFGlWNTNwtwVDxwtCiMAHm4rWzWQUUc.
2025-01-10 22:42:20,830 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 22:42:20,830 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$lBU7IQLaAxhN3yO3DXc4Q06kqmEMmZEH1CrrhxuFR0A, sender=@evan:localhost, body='hello luna'
2025-01-10 22:42:20,830 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 22:42:20,830 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 22:42:20,830 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 22:42:20,830 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 7 (no enforcement yet).
2025-01-10 22:42:20,830 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 22:42:20,830 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$lBU7IQLaAxhN3yO3DXc4Q06kqmEMmZEH1CrrhxuFR0A.
2025-01-10 22:42:20,830 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 22:42:20,830 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$gGKxyJeH24fsxhKjziv27wJDWskV7bFBz78yhUYbC3Q, sender=@lunabot:localhost, body='Hello! How can I assist you today?'
2025-01-10 22:42:20,830 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 22:42:20,830 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 22:42:20,830 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 22:42:20,830 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 8 (no enforcement yet).
2025-01-10 22:42:20,830 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 22:42:20,830 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$gGKxyJeH24fsxhKjziv27wJDWskV7bFBz78yhUYbC3Q.
2025-01-10 22:42:20,830 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 22:42:20,830 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$cgWI0aWm_Swyy7Fbin3lhJp0wd-_PfcH0Exi-LYQMKs, sender=@evan:localhost, body='hello luna'
2025-01-10 22:42:20,830 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 22:42:20,830 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 22:42:20,831 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 22:42:20,831 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 9 (no enforcement yet).
2025-01-10 22:42:20,831 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 22:42:20,831 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$cgWI0aWm_Swyy7Fbin3lhJp0wd-_PfcH0Exi-LYQMKs.
2025-01-10 22:42:20,831 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 22:42:20,831 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$vl-3Ov3Cs8qqWknJZOzO-hZrWL28bwNafoqD4O8jRio, sender=@evan:localhost, body='hello luna'
2025-01-10 22:42:20,831 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 22:42:20,831 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 22:42:20,831 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 22:42:20,831 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 10 (no enforcement yet).
2025-01-10 22:42:20,831 [WARNING] src.luna_command_extensions.handle_dispatch2: **Route count is 10 => 'final message' would be posted here in real code.**
2025-01-10 22:42:20,831 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 22:42:20,831 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$vl-3Ov3Cs8qqWknJZOzO-hZrWL28bwNafoqD4O8jRio.
2025-01-10 22:42:20,831 [INFO] nio.client.base_client: New joined room !AdQHUmAdpfqWIWULNM:localhost
2025-01-10 22:42:20,831 [INFO] nio.rooms: Room !AdQHUmAdpfqWIWULNM:localhost handling event of type RoomCreateEvent
2025-01-10 22:42:20,831 [INFO] nio.rooms: Room !AdQHUmAdpfqWIWULNM:localhost handling event of type PowerLevelsEvent
2025-01-10 22:42:20,831 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-10 22:42:20,831 [INFO] nio.rooms: Room !AdQHUmAdpfqWIWULNM:localhost handling event of type RoomJoinRulesEvent
2025-01-10 22:42:20,831 [INFO] nio.rooms: Room !AdQHUmAdpfqWIWULNM:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 22:42:20,831 [INFO] nio.rooms: Room !AdQHUmAdpfqWIWULNM:localhost handling event of type RoomNameEvent
2025-01-10 22:42:20,831 [INFO] nio.client.base_client: New joined room !EQpubOIZLWzrGBSBYb:localhost
2025-01-10 22:42:20,831 [INFO] nio.rooms: Room !EQpubOIZLWzrGBSBYb:localhost handling event of type RoomCreateEvent
2025-01-10 22:42:20,831 [INFO] nio.rooms: Room !EQpubOIZLWzrGBSBYb:localhost handling event of type PowerLevelsEvent
2025-01-10 22:42:20,831 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-10 22:42:20,832 [INFO] nio.rooms: Room !EQpubOIZLWzrGBSBYb:localhost handling event of type RoomJoinRulesEvent
2025-01-10 22:42:20,832 [INFO] nio.rooms: Room !EQpubOIZLWzrGBSBYb:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 22:42:20,832 [INFO] nio.rooms: Room !EQpubOIZLWzrGBSBYb:localhost handling event of type RoomNameEvent
2025-01-10 22:42:20,832 [INFO] nio.client.base_client: New joined room !fhmXoYxDdsImUkYUpf:localhost
2025-01-10 22:42:20,832 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomCreateEvent
2025-01-10 22:42:20,832 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type PowerLevelsEvent
2025-01-10 22:42:20,832 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-10 22:42:20,832 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomJoinRulesEvent
2025-01-10 22:42:20,832 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 22:42:20,832 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomNameEvent
2025-01-10 22:42:20,832 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomMessageText
2025-01-10 22:42:20,832 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!fhmXoYxDdsImUkYUpf:localhost, event_id=$mKck7AUPntqhnCUEyglff8bl2IZ5n_t32cQQPcciKi8, sender=@evan:localhost, body=':lunabot: hello'
2025-01-10 22:42:20,832 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 22:42:20,832 [INFO] src.luna_command_extensions.handle_dispatch2: Room !fhmXoYxDdsImUkYUpf:localhost has 2 participants.
2025-01-10 22:42:20,832 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 22:42:20,832 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 11 (no enforcement yet).
2025-01-10 22:42:20,832 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 22:42:20,832 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$mKck7AUPntqhnCUEyglff8bl2IZ5n_t32cQQPcciKi8.
2025-01-10 22:42:20,832 [INFO] nio.client.base_client: New joined room !vPFjZGGwOHwoODMQjc:localhost
2025-01-10 22:42:20,832 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomCreateEvent
2025-01-10 22:42:20,832 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type PowerLevelsEvent
2025-01-10 22:42:20,832 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-10 22:42:20,833 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomJoinRulesEvent
2025-01-10 22:42:20,833 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 22:42:20,833 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomNameEvent
2025-01-10 22:42:20,833 [INFO] nio.client.base_client: New joined room !kzXdTMnUUelFEFHQIX:localhost
2025-01-10 22:42:20,833 [INFO] nio.rooms: Room !kzXdTMnUUelFEFHQIX:localhost handling event of type RoomCreateEvent
2025-01-10 22:42:20,833 [INFO] nio.rooms: Room !kzXdTMnUUelFEFHQIX:localhost handling event of type PowerLevelsEvent
2025-01-10 22:42:20,833 [INFO] nio.rooms: Changing power level for user @evan:localhost from 0 to 100
2025-01-10 22:42:20,833 [INFO] nio.rooms: Room !kzXdTMnUUelFEFHQIX:localhost handling event of type RoomAliasEvent
2025-01-10 22:42:20,833 [INFO] nio.rooms: Room !kzXdTMnUUelFEFHQIX:localhost handling event of type RoomJoinRulesEvent
2025-01-10 22:42:20,833 [INFO] nio.rooms: Room !kzXdTMnUUelFEFHQIX:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 22:42:20,833 [INFO] nio.rooms: Room !kzXdTMnUUelFEFHQIX:localhost handling event of type RoomNameEvent
2025-01-10 22:42:20,833 [INFO] nio.client.base_client: New joined room !XBwtDVQGRLVcaKcUbm:localhost
2025-01-10 22:42:20,833 [INFO] nio.rooms: Room !XBwtDVQGRLVcaKcUbm:localhost handling event of type PowerLevelsEvent
2025-01-10 22:42:20,833 [INFO] nio.rooms: Changing power level for user @evan:localhost from 0 to 100
2025-01-10 22:42:20,833 [INFO] nio.rooms: Room !XBwtDVQGRLVcaKcUbm:localhost handling event of type RoomAliasEvent
2025-01-10 22:42:20,833 [INFO] nio.rooms: Room !XBwtDVQGRLVcaKcUbm:localhost handling event of type RoomCreateEvent
2025-01-10 22:42:20,833 [INFO] nio.rooms: Room !XBwtDVQGRLVcaKcUbm:localhost handling event of type RoomJoinRulesEvent
2025-01-10 22:42:20,833 [INFO] nio.rooms: Room !XBwtDVQGRLVcaKcUbm:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 22:42:20,833 [INFO] nio.rooms: Room !XBwtDVQGRLVcaKcUbm:localhost handling event of type RoomNameEvent
2025-01-10 22:42:20,834 [INFO] nio.rooms: Room !XBwtDVQGRLVcaKcUbm:localhost handling event of type RoomMessageText
2025-01-10 22:42:20,834 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!XBwtDVQGRLVcaKcUbm:localhost, event_id=$pEyxRI5FtH0XVpcwlyUiudNn6Mm-_MJ2ReBs19iY7K8, sender=@evan:localhost, body='Hello lunabot '
2025-01-10 22:42:20,834 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 22:42:20,834 [INFO] src.luna_command_extensions.handle_dispatch2: Room !XBwtDVQGRLVcaKcUbm:localhost has 2 participants.
2025-01-10 22:42:20,834 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 22:42:20,834 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 12 (no enforcement yet).
2025-01-10 22:42:20,834 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 22:42:20,834 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$pEyxRI5FtH0XVpcwlyUiudNn6Mm-_MJ2ReBs19iY7K8.
2025-01-10 22:42:20,834 [INFO] nio.rooms: Room !XBwtDVQGRLVcaKcUbm:localhost handling event of type PowerLevelsEvent
2025-01-10 22:42:20,834 [INFO] nio.rooms: Changing power level for user @evan:localhost from 100 to 100
2025-01-10 22:42:20,834 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-10 22:42:20,877 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 22:47:21,518 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-10 22:47:21,519 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-10 22:47:21,721 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-10 22:47:22,126 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-10 22:47:22,931 [WARNING] nio.client.async_client: Timed out, sleeping for 1s
2025-01-10 22:47:24,535 [WARNING] nio.client.async_client: Timed out, sleeping for 3s
2025-01-10 22:47:27,740 [WARNING] nio.client.async_client: Timed out, sleeping for 6s
2025-01-10 22:47:34,144 [WARNING] nio.client.async_client: Timed out, sleeping for 12s
2025-01-10 22:47:46,955 [WARNING] nio.client.async_client: Timed out, sleeping for 25s
2025-01-10 22:48:12,564 [WARNING] nio.client.async_client: Timed out, sleeping for 51s
2025-01-10 22:49:03,769 [WARNING] nio.client.async_client: Timed out, sleeping for 60s
2025-01-10 22:50:03,776 [WARNING] nio.client.async_client: Timed out, sleeping for 60s
2025-01-10 22:51:03,783 [WARNING] nio.client.async_client: Timed out, sleeping for 60s
2025-01-10 22:52:03,794 [WARNING] nio.client.async_client: Timed out, sleeping for 60s
2025-01-10 22:53:03,798 [WARNING] nio.client.async_client: Timed out, sleeping for 60s
2025-01-10 22:54:03,801 [WARNING] nio.client.async_client: Timed out, sleeping for 60s
2025-01-10 22:55:03,807 [WARNING] nio.client.async_client: Timed out, sleeping for 60s
2025-01-10 22:56:03,811 [WARNING] nio.client.async_client: Timed out, sleeping for 60s
2025-01-10 22:57:03,795 [WARNING] nio.client.async_client: Timed out, sleeping for 60s
2025-01-10 22:58:03,800 [WARNING] nio.client.async_client: Timed out, sleeping for 60s
2025-01-10 22:59:03,807 [WARNING] nio.client.async_client: Timed out, sleeping for 60s
2025-01-10 23:00:03,813 [WARNING] nio.client.async_client: Timed out, sleeping for 60s
2025-01-10 23:01:03,817 [WARNING] nio.client.async_client: Timed out, sleeping for 60s
2025-01-10 23:13:14,349 [INFO] src.console_functions: Console received 'exit' command; requesting shutdown.
2025-01-10 23:13:14,349 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 23:13:14,350 [ERROR] __main__: An unexpected exception occurred in main_logic: Event loop stopped before Future completed.
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 145, in luna
    loop.run_until_complete(main_logic())
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 718, in run_until_complete
    raise RuntimeError('Event loop stopped before Future completed.')
RuntimeError: Event loop stopped before Future completed.
2025-01-10 23:13:14,354 [DEBUG] __main__: Preparing to close the event loop.
2025-01-10 23:13:14,355 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-10 23:47:44,086 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-10 23:47:44,086 [DEBUG] __main__: Exiting configure_logging function.
2025-01-10 23:47:44,086 [DEBUG] __main__: Logging configuration complete.
2025-01-10 23:47:44,086 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-10 23:47:44,086 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 23:47:44,086 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-10 23:47:44,086 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-10 23:47:44,086 [DEBUG] __main__: Entering start_console_thread function.
2025-01-10 23:47:44,088 [INFO] __main__: Console thread started successfully.
2025-01-10 23:47:44,088 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-10 23:47:44,088 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-10 23:47:44,088 [INFO] __main__: Starting main_logic coroutine.
2025-01-10 23:47:44,088 [DEBUG] __main__: Entering main_logic function...
2025-01-10 23:47:44,088 [DEBUG] src.luna_functions: Found director_token.json; attempting token-based login.
2025-01-10 23:47:44,090 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-10 23:47:44,095 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-10 23:47:44,096 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-10 23:47:44,121 [INFO] src.console_functions: Console screen cleared.
2025-01-10 23:47:44,236 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 23:47:44,297 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-10 23:47:44,702 [WARNING] nio.client.async_client: Timed out, sleeping for 0s
2025-01-10 23:47:45,506 [WARNING] nio.client.async_client: Timed out, sleeping for 1s
2025-01-10 23:47:47,111 [WARNING] nio.client.async_client: Timed out, sleeping for 3s
2025-01-10 23:47:50,313 [WARNING] nio.client.async_client: Timed out, sleeping for 6s
2025-01-10 23:47:56,720 [WARNING] nio.client.async_client: Timed out, sleeping for 12s
2025-01-10 23:48:09,527 [WARNING] nio.client.async_client: Timed out, sleeping for 25s
2025-01-10 23:48:35,133 [WARNING] nio.client.async_client: Timed out, sleeping for 51s
2025-01-10 23:49:26,348 [INFO] src.luna_functions: Token-based login verified for user @lunabot:localhost.
2025-01-10 23:49:26,348 [DEBUG] __main__: Starting short sync loop; will exit when SHOULD_SHUT_DOWN = True.
2025-01-10 23:49:26,425 [INFO] nio.client.base_client: New joined room !EQpubOIZLWzrGBSBYb:localhost
2025-01-10 23:49:26,425 [INFO] nio.rooms: Room !EQpubOIZLWzrGBSBYb:localhost handling event of type RoomCreateEvent
2025-01-10 23:49:26,425 [INFO] nio.rooms: Room !EQpubOIZLWzrGBSBYb:localhost handling event of type PowerLevelsEvent
2025-01-10 23:49:26,425 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-10 23:49:26,425 [INFO] nio.rooms: Room !EQpubOIZLWzrGBSBYb:localhost handling event of type RoomJoinRulesEvent
2025-01-10 23:49:26,425 [INFO] nio.rooms: Room !EQpubOIZLWzrGBSBYb:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 23:49:26,425 [INFO] nio.rooms: Room !EQpubOIZLWzrGBSBYb:localhost handling event of type RoomNameEvent
2025-01-10 23:49:26,425 [INFO] nio.client.base_client: New joined room !fhmXoYxDdsImUkYUpf:localhost
2025-01-10 23:49:26,425 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomCreateEvent
2025-01-10 23:49:26,425 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type PowerLevelsEvent
2025-01-10 23:49:26,425 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-10 23:49:26,426 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomJoinRulesEvent
2025-01-10 23:49:26,426 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 23:49:26,426 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomNameEvent
2025-01-10 23:49:26,426 [INFO] nio.rooms: Room !fhmXoYxDdsImUkYUpf:localhost handling event of type RoomMessageText
2025-01-10 23:49:26,426 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!fhmXoYxDdsImUkYUpf:localhost, event_id=$mKck7AUPntqhnCUEyglff8bl2IZ5n_t32cQQPcciKi8, sender=@evan:localhost, body=':lunabot: hello'
2025-01-10 23:49:26,426 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 23:49:26,426 [INFO] src.luna_command_extensions.handle_dispatch2: Room !fhmXoYxDdsImUkYUpf:localhost has 2 participants.
2025-01-10 23:49:26,426 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 23:49:26,426 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 1 (no enforcement yet).
2025-01-10 23:49:26,426 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 23:49:26,426 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$mKck7AUPntqhnCUEyglff8bl2IZ5n_t32cQQPcciKi8.
2025-01-10 23:49:26,426 [INFO] nio.client.base_client: New joined room !kzXdTMnUUelFEFHQIX:localhost
2025-01-10 23:49:26,426 [INFO] nio.rooms: Room !kzXdTMnUUelFEFHQIX:localhost handling event of type RoomCreateEvent
2025-01-10 23:49:26,426 [INFO] nio.rooms: Room !kzXdTMnUUelFEFHQIX:localhost handling event of type PowerLevelsEvent
2025-01-10 23:49:26,426 [INFO] nio.rooms: Changing power level for user @evan:localhost from 0 to 100
2025-01-10 23:49:26,426 [INFO] nio.rooms: Room !kzXdTMnUUelFEFHQIX:localhost handling event of type RoomAliasEvent
2025-01-10 23:49:26,426 [INFO] nio.rooms: Room !kzXdTMnUUelFEFHQIX:localhost handling event of type RoomJoinRulesEvent
2025-01-10 23:49:26,426 [INFO] nio.rooms: Room !kzXdTMnUUelFEFHQIX:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 23:49:26,426 [INFO] nio.rooms: Room !kzXdTMnUUelFEFHQIX:localhost handling event of type RoomNameEvent
2025-01-10 23:49:26,426 [INFO] nio.client.base_client: New joined room !vPFjZGGwOHwoODMQjc:localhost
2025-01-10 23:49:26,426 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomCreateEvent
2025-01-10 23:49:26,426 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type PowerLevelsEvent
2025-01-10 23:49:26,426 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-10 23:49:26,426 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomJoinRulesEvent
2025-01-10 23:49:26,426 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 23:49:26,426 [INFO] nio.rooms: Room !vPFjZGGwOHwoODMQjc:localhost handling event of type RoomNameEvent
2025-01-10 23:49:26,426 [INFO] nio.client.base_client: New joined room !AdQHUmAdpfqWIWULNM:localhost
2025-01-10 23:49:26,426 [INFO] nio.rooms: Room !AdQHUmAdpfqWIWULNM:localhost handling event of type RoomCreateEvent
2025-01-10 23:49:26,426 [INFO] nio.rooms: Room !AdQHUmAdpfqWIWULNM:localhost handling event of type PowerLevelsEvent
2025-01-10 23:49:26,426 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-10 23:49:26,426 [INFO] nio.rooms: Room !AdQHUmAdpfqWIWULNM:localhost handling event of type RoomJoinRulesEvent
2025-01-10 23:49:26,427 [INFO] nio.rooms: Room !AdQHUmAdpfqWIWULNM:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 23:49:26,427 [INFO] nio.rooms: Room !AdQHUmAdpfqWIWULNM:localhost handling event of type RoomNameEvent
2025-01-10 23:49:26,427 [INFO] nio.client.base_client: New joined room !XBwtDVQGRLVcaKcUbm:localhost
2025-01-10 23:49:26,427 [INFO] nio.rooms: Room !XBwtDVQGRLVcaKcUbm:localhost handling event of type RoomAliasEvent
2025-01-10 23:49:26,427 [INFO] nio.rooms: Room !XBwtDVQGRLVcaKcUbm:localhost handling event of type RoomCreateEvent
2025-01-10 23:49:26,427 [INFO] nio.rooms: Room !XBwtDVQGRLVcaKcUbm:localhost handling event of type PowerLevelsEvent
2025-01-10 23:49:26,427 [INFO] nio.rooms: Changing power level for user @evan:localhost from 0 to 100
2025-01-10 23:49:26,427 [INFO] nio.rooms: Room !XBwtDVQGRLVcaKcUbm:localhost handling event of type RoomJoinRulesEvent
2025-01-10 23:49:26,427 [INFO] nio.rooms: Room !XBwtDVQGRLVcaKcUbm:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 23:49:26,427 [INFO] nio.rooms: Room !XBwtDVQGRLVcaKcUbm:localhost handling event of type RoomNameEvent
2025-01-10 23:49:26,427 [INFO] nio.rooms: Room !XBwtDVQGRLVcaKcUbm:localhost handling event of type RoomMessageText
2025-01-10 23:49:26,427 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!XBwtDVQGRLVcaKcUbm:localhost, event_id=$pEyxRI5FtH0XVpcwlyUiudNn6Mm-_MJ2ReBs19iY7K8, sender=@evan:localhost, body='Hello lunabot '
2025-01-10 23:49:26,427 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 23:49:26,427 [INFO] src.luna_command_extensions.handle_dispatch2: Room !XBwtDVQGRLVcaKcUbm:localhost has 2 participants.
2025-01-10 23:49:26,427 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 23:49:26,427 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 2 (no enforcement yet).
2025-01-10 23:49:26,427 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 23:49:26,427 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$pEyxRI5FtH0XVpcwlyUiudNn6Mm-_MJ2ReBs19iY7K8.
2025-01-10 23:49:26,427 [INFO] nio.rooms: Room !XBwtDVQGRLVcaKcUbm:localhost handling event of type PowerLevelsEvent
2025-01-10 23:49:26,427 [INFO] nio.rooms: Changing power level for user @evan:localhost from 100 to 100
2025-01-10 23:49:26,427 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-10 23:49:26,427 [INFO] nio.client.base_client: New joined room !wksSOEXmjceGUTMkdv:localhost
2025-01-10 23:49:26,427 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomGuestAccessEvent
2025-01-10 23:49:26,427 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-10 23:49:26,427 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomJoinRulesEvent
2025-01-10 23:49:26,427 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomCreateEvent
2025-01-10 23:49:26,427 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type PowerLevelsEvent
2025-01-10 23:49:26,427 [INFO] nio.rooms: Changing power level for user @evan:localhost from 0 to 100
2025-01-10 23:49:26,427 [INFO] nio.rooms: Changing power level for user @lunabot:localhost from 0 to 100
2025-01-10 23:49:26,427 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 23:49:26,427 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$kIVMdgr0cQrrIPbHs_HGy9-ehkF8d1WtgF2JezjXeQQ, sender=@lunabot:localhost, body='Hello! How can I assist you today?'
2025-01-10 23:49:26,427 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 23:49:26,427 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 23:49:26,427 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 23:49:26,427 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 3 (no enforcement yet).
2025-01-10 23:49:26,427 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 23:49:26,427 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$kIVMdgr0cQrrIPbHs_HGy9-ehkF8d1WtgF2JezjXeQQ.
2025-01-10 23:49:26,427 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 23:49:26,427 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$SxwxiUQgktvUwljSyA1n7r_HCarpYQcFPlMtEAY3CEk, sender=@evan:localhost, body='Do you talk'
2025-01-10 23:49:26,427 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 23:49:26,427 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 23:49:26,427 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 23:49:26,427 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 4 (no enforcement yet).
2025-01-10 23:49:26,427 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 23:49:26,427 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$SxwxiUQgktvUwljSyA1n7r_HCarpYQcFPlMtEAY3CEk.
2025-01-10 23:49:26,427 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 23:49:26,427 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$DqAkRJkn-EF5oE0izNwSf23s-qx9tEZcBjCMgd0_r3Q, sender=@lunabot:localhost, body='Yes, I can communicate through text-based responses to assist with your queries and tasks.'
2025-01-10 23:49:26,427 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 23:49:26,427 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 23:49:26,427 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 23:49:26,427 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 5 (no enforcement yet).
2025-01-10 23:49:26,427 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 23:49:26,427 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$DqAkRJkn-EF5oE0izNwSf23s-qx9tEZcBjCMgd0_r3Q.
2025-01-10 23:49:26,427 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 23:49:26,427 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$-cYLqrWk74kz0pQ0xEBT5U1Xd_chpCGd-6eDv0VmpRU, sender=@evan:localhost, body="but you don't respond to lunabot "
2025-01-10 23:49:26,427 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 23:49:26,427 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 23:49:26,427 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 23:49:26,428 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 6 (no enforcement yet).
2025-01-10 23:49:26,428 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 23:49:26,428 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$-cYLqrWk74kz0pQ0xEBT5U1Xd_chpCGd-6eDv0VmpRU.
2025-01-10 23:49:26,428 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 23:49:26,428 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$jFIdqWc4NjcFdBommSRYh-yJjk6A9vUBlOOAUV-EEOs, sender=@evan:localhost, body='only untagged'
2025-01-10 23:49:26,428 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 23:49:26,428 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 23:49:26,428 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 23:49:26,428 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 7 (no enforcement yet).
2025-01-10 23:49:26,428 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 23:49:26,428 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$jFIdqWc4NjcFdBommSRYh-yJjk6A9vUBlOOAUV-EEOs.
2025-01-10 23:49:26,428 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 23:49:26,428 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$epknto4MCqSSIFGlWNTNwtwVDxwtCiMAHm4rWzWQUUc, sender=@lunabot:localhost, body="I'm sorry, but your request is a bit unclear. Could you please provide more details or context so I can assist you in the best way possible?"
2025-01-10 23:49:26,428 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 23:49:26,428 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 23:49:26,428 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 23:49:26,428 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 8 (no enforcement yet).
2025-01-10 23:49:26,428 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 23:49:26,428 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$epknto4MCqSSIFGlWNTNwtwVDxwtCiMAHm4rWzWQUUc.
2025-01-10 23:49:26,428 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 23:49:26,428 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$lBU7IQLaAxhN3yO3DXc4Q06kqmEMmZEH1CrrhxuFR0A, sender=@evan:localhost, body='hello luna'
2025-01-10 23:49:26,428 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 23:49:26,428 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 23:49:26,428 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 23:49:26,428 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 9 (no enforcement yet).
2025-01-10 23:49:26,428 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 23:49:26,428 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$lBU7IQLaAxhN3yO3DXc4Q06kqmEMmZEH1CrrhxuFR0A.
2025-01-10 23:49:26,428 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 23:49:26,428 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$gGKxyJeH24fsxhKjziv27wJDWskV7bFBz78yhUYbC3Q, sender=@lunabot:localhost, body='Hello! How can I assist you today?'
2025-01-10 23:49:26,428 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 23:49:26,428 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 23:49:26,428 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 23:49:26,428 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 10 (no enforcement yet).
2025-01-10 23:49:26,428 [WARNING] src.luna_command_extensions.handle_dispatch2: **Route count is 10 => 'final message' would be posted here in real code.**
2025-01-10 23:49:26,428 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 23:49:26,428 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$gGKxyJeH24fsxhKjziv27wJDWskV7bFBz78yhUYbC3Q.
2025-01-10 23:49:26,428 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 23:49:26,428 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$cgWI0aWm_Swyy7Fbin3lhJp0wd-_PfcH0Exi-LYQMKs, sender=@evan:localhost, body='hello luna'
2025-01-10 23:49:26,428 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 23:49:26,428 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 23:49:26,428 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 23:49:26,428 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 11 (no enforcement yet).
2025-01-10 23:49:26,428 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 23:49:26,428 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$cgWI0aWm_Swyy7Fbin3lhJp0wd-_PfcH0Exi-LYQMKs.
2025-01-10 23:49:26,428 [INFO] nio.rooms: Room !wksSOEXmjceGUTMkdv:localhost handling event of type RoomMessageText
2025-01-10 23:49:26,428 [INFO] src.luna_command_extensions.handle_dispatch2: Received text event: room_id=!wksSOEXmjceGUTMkdv:localhost, event_id=$vl-3Ov3Cs8qqWknJZOzO-hZrWL28bwNafoqD4O8jRio, sender=@evan:localhost, body='hello luna'
2025-01-10 23:49:26,428 [DEBUG] src.luna_command_extensions.handle_dispatch2: Pretending to write this message to CSV... (no real I/O)
2025-01-10 23:49:26,428 [INFO] src.luna_command_extensions.handle_dispatch2: Room !wksSOEXmjceGUTMkdv:localhost has 2 participants.
2025-01-10 23:49:26,428 [INFO] src.luna_command_extensions.handle_dispatch2: 2-participant channel => Luna automatically responds (stub).
2025-01-10 23:49:26,428 [DEBUG] src.luna_command_extensions.handle_dispatch2: Incremented MAX_USERS_TO_ROUTE to 12 (no enforcement yet).
2025-01-10 23:49:26,428 [INFO] src.luna_command_extensions.handle_dispatch2: Pretending to generate a GPT-based reply and post it to the channel... Done.
2025-01-10 23:49:26,428 [DEBUG] src.luna_command_extensions.handle_dispatch2: Finished on_room_message_stub_logonly for event_id=$vl-3Ov3Cs8qqWknJZOzO-hZrWL28bwNafoqD4O8jRio.
2025-01-10 23:49:52,285 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 23:49:52,285 [DEBUG] src.console_functions: Forcing @captainamerica:localhost to join !OBacxAuPnRsRfxSrnF:localhost via http://localhost:8008/_synapse/admin/v1/join/!OBacxAuPnRsRfxSrnF:localhost
2025-01-10 23:50:14,510 [INFO] src.console_functions: Console received 'exit' command; requesting shutdown.
2025-01-10 23:50:14,512 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-10 23:50:14,512 [ERROR] __main__: An unexpected exception occurred in main_logic: Event loop stopped before Future completed.
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 145, in luna
    loop.run_until_complete(main_logic())
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 718, in run_until_complete
    raise RuntimeError('Event loop stopped before Future completed.')
RuntimeError: Event loop stopped before Future completed.
2025-01-10 23:50:14,519 [DEBUG] __main__: Preparing to close the event loop.
2025-01-10 23:50:14,519 [INFO] __main__: Event loop closed. Exiting main function.
