2025-01-05 01:45:19,105 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-05 01:45:19,105 [DEBUG] __main__: Exiting configure_logging function.
2025-01-05 01:45:19,105 [DEBUG] __main__: Logging configuration complete.
2025-01-05 01:45:19,105 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-05 01:45:19,105 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 01:45:19,105 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-05 01:45:19,105 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-05 01:45:19,105 [DEBUG] __main__: Entering start_console_thread function.
2025-01-05 01:45:19,105 [INFO] __main__: Console thread started successfully.
2025-01-05 01:45:19,105 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-05 01:45:19,105 [DEBUG] __main__: Console thread started. Returning to main thread.
2025-01-05 01:45:19,105 [INFO] __main__: Starting main_logic coroutine.
2025-01-05 01:45:19,105 [DEBUG] __main__: Entering main_logic function...
2025-01-05 01:45:19,105 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-05 01:45:19,106 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-05 01:45:19,106 [INFO] src.luna_functions: Using saved token for user @luna:localhost.
2025-01-05 01:45:19,106 [DEBUG] __main__: Callbacks registered successfully.
2025-01-05 01:45:19,106 [INFO] __main__: Starting manual sync loop (resume from token=s83_151_6_29_49_1_1_17_0_1).
2025-01-05 01:45:36,792 [DEBUG] __main__: sync() returned a response.
2025-01-05 01:45:36,794 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 01:45:36,806 [DEBUG] __main__: sync() returned a response.
2025-01-05 01:45:36,808 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 01:45:58,756 [INFO] nio.client.base_client: New joined room !roKWYbjbZOVUoYPFtD:localhost
2025-01-05 01:45:58,757 [DEBUG] __main__: sync() returned a response.
2025-01-05 01:45:58,757 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 01:46:01,445 [DEBUG] __main__: sync() returned a response.
2025-01-05 01:46:01,446 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 01:46:01,507 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type MegolmEvent
2025-01-05 01:46:01,508 [DEBUG] __main__: sync() returned a response.
2025-01-05 01:46:01,508 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 01:46:31,524 [DEBUG] __main__: sync() returned a response.
2025-01-05 01:46:31,525 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 01:46:52,445 [DEBUG] __main__: sync() returned a response.
2025-01-05 01:46:52,445 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 01:46:53,099 [DEBUG] __main__: sync() returned a response.
2025-01-05 01:46:53,100 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 01:46:53,165 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type MegolmEvent
2025-01-05 01:46:53,166 [DEBUG] __main__: sync() returned a response.
2025-01-05 01:46:53,166 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 01:46:56,344 [INFO] nio.client.base_client: New joined room !IQTJHuSCcTLlkCZzzF:localhost
2025-01-05 01:46:56,345 [DEBUG] __main__: sync() returned a response.
2025-01-05 01:46:56,345 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 01:46:56,861 [DEBUG] __main__: sync() returned a response.
2025-01-05 01:46:56,862 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 01:46:56,896 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 01:46:56,896 [INFO] src.luna_functions: Received message in !IQTJHuSCcTLlkCZzzF:localhost from @evan:localhost: test
2025-01-05 01:46:56,896 [DEBUG] src.luna_functions: Sending response: Hello @evan:localhost, you said 'test' (auto-respond).
2025-01-05 01:46:56,907 [DEBUG] __main__: sync() returned a response.
2025-01-05 01:46:56,908 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 01:46:56,912 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 01:46:56,912 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 01:46:56,912 [DEBUG] __main__: sync() returned a response.
2025-01-05 01:46:56,913 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 01:46:56,946 [DEBUG] __main__: sync() returned a response.
2025-01-05 01:46:56,948 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 01:47:26,972 [DEBUG] __main__: sync() returned a response.
2025-01-05 01:47:26,973 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 01:47:56,986 [DEBUG] __main__: sync() returned a response.
2025-01-05 01:47:56,989 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 01:48:27,000 [DEBUG] __main__: sync() returned a response.
2025-01-05 01:48:27,002 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 01:48:27,014 [DEBUG] __main__: sync() returned a response.
2025-01-05 01:48:27,016 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 01:48:45,039 [INFO] nio.client.base_client: New invited room !vqsQaVVLtsvWxIoJwV:localhost
2025-01-05 01:48:45,039 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type InviteNameEvent
2025-01-05 01:48:45,039 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type InviteMemberEvent
2025-01-05 01:48:45,039 [INFO] src.luna_functions: Received invite to !vqsQaVVLtsvWxIoJwV:localhost, joining now.
2025-01-05 01:48:45,063 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type InviteMemberEvent
2025-01-05 01:48:45,063 [INFO] src.luna_functions: Received invite to !vqsQaVVLtsvWxIoJwV:localhost, joining now.
2025-01-05 01:48:45,070 [DEBUG] __main__: sync() returned a response.
2025-01-05 01:48:45,071 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 01:48:45,090 [INFO] nio.client.base_client: New joined room !vqsQaVVLtsvWxIoJwV:localhost
2025-01-05 01:48:45,090 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomCreateEvent
2025-01-05 01:48:45,090 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type PowerLevelsEvent
2025-01-05 01:48:45,093 [INFO] nio.rooms: Changing power level for user @evan:localhost from 0 to 100
2025-01-05 01:48:45,093 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomJoinRulesEvent
2025-01-05 01:48:45,093 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-05 01:48:45,094 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomGuestAccessEvent
2025-01-05 01:48:45,094 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomEncryptionEvent
2025-01-05 01:48:45,094 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomNameEvent
2025-01-05 01:48:45,094 [DEBUG] __main__: sync() returned a response.
2025-01-05 01:48:45,094 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 01:48:45,198 [DEBUG] __main__: sync() returned a response.
2025-01-05 01:48:45,199 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 01:49:15,220 [DEBUG] __main__: sync() returned a response.
2025-01-05 01:49:15,221 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 01:49:32,178 [DEBUG] __main__: sync() returned a response.
2025-01-05 01:49:32,180 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 01:49:33,361 [DEBUG] __main__: sync() returned a response.
2025-01-05 01:49:33,362 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 01:49:33,590 [DEBUG] __main__: sync() returned a response.
2025-01-05 01:49:33,591 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 01:49:36,871 [DEBUG] __main__: sync() returned a response.
2025-01-05 01:49:36,873 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 01:49:36,924 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type MegolmEvent
2025-01-05 01:49:36,925 [DEBUG] __main__: sync() returned a response.
2025-01-05 01:49:36,925 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 01:50:06,940 [DEBUG] __main__: sync() returned a response.
2025-01-05 01:50:06,942 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 01:50:36,950 [DEBUG] __main__: sync() returned a response.
2025-01-05 01:50:36,951 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 01:51:06,959 [DEBUG] __main__: sync() returned a response.
2025-01-05 01:51:06,960 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 01:51:36,975 [DEBUG] __main__: sync() returned a response.
2025-01-05 01:51:36,975 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 01:51:36,981 [DEBUG] __main__: sync() returned a response.
2025-01-05 01:51:36,982 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 01:52:06,998 [DEBUG] __main__: sync() returned a response.
2025-01-05 01:52:07,000 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 01:52:10,376 [INFO] src.console_functions: Console received 'restart' command; restarting now.
2025-01-05 01:52:10,786 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-05 01:52:10,786 [DEBUG] __main__: Exiting configure_logging function.
2025-01-05 01:52:10,786 [DEBUG] __main__: Logging configuration complete.
2025-01-05 01:52:10,786 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-05 01:52:10,786 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 01:52:10,786 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-05 01:52:10,786 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-05 01:52:10,786 [DEBUG] __main__: Entering start_console_thread function.
2025-01-05 01:52:10,786 [INFO] __main__: Console thread started successfully.
2025-01-05 01:52:10,787 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-05 01:52:10,787 [DEBUG] __main__: Console thread started. Returning to main thread.
2025-01-05 01:52:10,787 [INFO] __main__: Starting main_logic coroutine.
2025-01-05 01:52:10,787 [DEBUG] __main__: Entering main_logic function...
2025-01-05 01:52:10,787 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-05 01:52:10,787 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-05 01:52:10,787 [INFO] src.luna_functions: Using saved token for user @luna:localhost.
2025-01-05 01:52:10,787 [DEBUG] __main__: Callbacks registered successfully.
2025-01-05 01:52:10,787 [INFO] __main__: Starting manual sync loop (resume from token=s98_165_16_33_55_1_1_17_0_1).
2025-01-05 01:52:15,110 [INFO] nio.client.base_client: New joined room !vqsQaVVLtsvWxIoJwV:localhost
2025-01-05 01:52:15,110 [DEBUG] __main__: sync() returned a response.
2025-01-05 01:52:15,111 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 01:52:16,387 [DEBUG] __main__: sync() returned a response.
2025-01-05 01:52:16,389 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 01:52:16,448 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type MegolmEvent
2025-01-05 01:52:16,449 [DEBUG] __main__: sync() returned a response.
2025-01-05 01:52:16,449 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 01:52:19,362 [INFO] nio.client.base_client: New joined room !roKWYbjbZOVUoYPFtD:localhost
2025-01-05 01:52:19,362 [DEBUG] __main__: sync() returned a response.
2025-01-05 01:52:19,363 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 01:52:20,141 [DEBUG] __main__: sync() returned a response.
2025-01-05 01:52:20,142 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 01:52:20,200 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type MegolmEvent
2025-01-05 01:52:20,201 [DEBUG] __main__: sync() returned a response.
2025-01-05 01:52:20,201 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 01:52:22,995 [INFO] nio.client.base_client: New joined room !IQTJHuSCcTLlkCZzzF:localhost
2025-01-05 01:52:22,995 [DEBUG] __main__: sync() returned a response.
2025-01-05 01:52:22,996 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 01:52:25,666 [DEBUG] __main__: sync() returned a response.
2025-01-05 01:52:25,667 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 01:52:25,706 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 01:52:25,707 [DEBUG] src.luna_functions: Got an event of type: <class 'nio.events.room_events.RoomMessageText'>, content: {'type': 'm.room.message', 'sender': '@evan:localhost', 'content': {'msgtype': 'm.text', 'body': 'hi privately', 'm.mentions': {}}, 'origin_server_ts': 1736059945689, 'unsigned': {'membership': 'join', 'age': 13}, 'event_id': '$BNRZdQHwlHN-A-IrkZUQFuwhaJ5rMAjTW9YovngPJxs'}
2025-01-05 01:52:25,707 [INFO] src.luna_functions: Received message in !IQTJHuSCcTLlkCZzzF:localhost from @evan:localhost: hi privately
2025-01-05 01:52:25,707 [DEBUG] src.luna_functions: Sending response: Hello @evan:localhost, you said 'hi privately' (auto-respond).
2025-01-05 01:52:25,719 [DEBUG] __main__: sync() returned a response.
2025-01-05 01:52:25,720 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 01:52:25,724 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 01:52:25,725 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 01:52:25,725 [DEBUG] __main__: sync() returned a response.
2025-01-05 01:52:25,725 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 01:52:26,270 [DEBUG] __main__: sync() returned a response.
2025-01-05 01:52:26,271 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 01:52:56,288 [DEBUG] __main__: sync() returned a response.
2025-01-05 01:52:56,289 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 01:53:25,352 [DEBUG] __main__: sync() returned a response.
2025-01-05 01:53:25,354 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 01:53:55,364 [DEBUG] __main__: sync() returned a response.
2025-01-05 01:53:55,365 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 01:54:25,378 [DEBUG] __main__: sync() returned a response.
2025-01-05 01:54:25,382 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 01:54:25,395 [DEBUG] __main__: sync() returned a response.
2025-01-05 01:54:25,395 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 01:54:55,408 [DEBUG] __main__: sync() returned a response.
2025-01-05 01:54:55,409 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 01:54:58,588 [DEBUG] __main__: sync() returned a response.
2025-01-05 01:54:58,588 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 01:55:01,733 [DEBUG] __main__: sync() returned a response.
2025-01-05 01:55:01,734 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 01:55:31,772 [DEBUG] __main__: sync() returned a response.
2025-01-05 01:55:31,778 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 01:55:45,527 [INFO] nio.client.base_client: New invited room !ZhsKXLoMEydpudauIE:localhost
2025-01-05 01:55:45,528 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type InviteAliasEvent
2025-01-05 01:55:45,528 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type InviteNameEvent
2025-01-05 01:55:45,528 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type InviteMemberEvent
2025-01-05 01:55:45,528 [INFO] src.luna_functions: Received invite to !ZhsKXLoMEydpudauIE:localhost, joining now.
2025-01-05 01:55:45,544 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type InviteMemberEvent
2025-01-05 01:55:45,545 [INFO] src.luna_functions: Received invite to !ZhsKXLoMEydpudauIE:localhost, joining now.
2025-01-05 01:55:45,555 [DEBUG] __main__: sync() returned a response.
2025-01-05 01:55:45,556 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 01:55:45,568 [INFO] nio.client.base_client: New joined room !ZhsKXLoMEydpudauIE:localhost
2025-01-05 01:55:45,568 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomCreateEvent
2025-01-05 01:55:45,568 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type PowerLevelsEvent
2025-01-05 01:55:45,568 [INFO] nio.rooms: Changing power level for user @evan:localhost from 0 to 100
2025-01-05 01:55:45,568 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomAliasEvent
2025-01-05 01:55:45,568 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomJoinRulesEvent
2025-01-05 01:55:45,568 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-05 01:55:45,568 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomNameEvent
2025-01-05 01:55:45,568 [DEBUG] __main__: sync() returned a response.
2025-01-05 01:55:45,569 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 01:55:45,880 [DEBUG] __main__: sync() returned a response.
2025-01-05 01:55:45,883 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 01:55:57,777 [DEBUG] __main__: sync() returned a response.
2025-01-05 01:55:57,778 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 01:55:58,209 [DEBUG] __main__: sync() returned a response.
2025-01-05 01:55:58,210 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 01:55:58,244 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 01:55:58,244 [DEBUG] src.luna_functions: Got an event of type: <class 'nio.events.room_events.RoomMessageText'>, content: {'type': 'm.room.message', 'sender': '@evan:localhost', 'content': {'msgtype': 'm.text', 'body': 'test', 'm.mentions': {}}, 'origin_server_ts': 1736060158220, 'unsigned': {'membership': 'join', 'age': 20}, 'event_id': '$WLq3cuXrs3AJInxcvYVOz_swjqYzmtviCKNXOeTcKHk'}
2025-01-05 01:55:58,244 [INFO] src.luna_functions: Received message in !ZhsKXLoMEydpudauIE:localhost from @evan:localhost: test
2025-01-05 01:55:58,244 [DEBUG] src.luna_functions: Sending response: Hello @evan:localhost, you said 'test' (auto-respond).
2025-01-05 01:55:58,258 [DEBUG] __main__: sync() returned a response.
2025-01-05 01:55:58,259 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 01:55:58,265 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 01:55:58,265 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 01:55:58,265 [DEBUG] __main__: sync() returned a response.
2025-01-05 01:55:58,266 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 01:55:58,354 [DEBUG] __main__: sync() returned a response.
2025-01-05 01:55:58,354 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 01:56:28,371 [DEBUG] __main__: sync() returned a response.
2025-01-05 01:56:28,373 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 01:56:58,385 [DEBUG] __main__: sync() returned a response.
2025-01-05 01:56:58,387 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 01:57:28,411 [DEBUG] __main__: sync() returned a response.
2025-01-05 01:57:28,412 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 01:57:28,425 [DEBUG] __main__: sync() returned a response.
2025-01-05 01:57:28,433 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 01:57:58,443 [DEBUG] __main__: sync() returned a response.
2025-01-05 01:57:58,445 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 01:58:26,504 [INFO] src.console_functions: Console received 'restart' command; restarting now.
2025-01-05 01:58:27,193 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-05 01:58:27,193 [DEBUG] __main__: Exiting configure_logging function.
2025-01-05 01:58:27,193 [DEBUG] __main__: Logging configuration complete.
2025-01-05 01:58:27,193 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-05 01:58:27,193 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 01:58:27,194 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-05 01:58:27,194 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-05 01:58:27,194 [DEBUG] __main__: Entering start_console_thread function.
2025-01-05 01:58:27,194 [INFO] __main__: Console thread started successfully.
2025-01-05 01:58:27,194 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-05 01:58:27,194 [DEBUG] __main__: Console thread started. Returning to main thread.
2025-01-05 01:58:27,194 [INFO] __main__: Starting main_logic coroutine.
2025-01-05 01:58:27,194 [DEBUG] __main__: Entering main_logic function...
2025-01-05 01:58:27,194 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-05 01:58:27,194 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-05 01:58:27,194 [INFO] src.luna_functions: Using saved token for user @luna:localhost.
2025-01-05 01:58:27,194 [DEBUG] __main__: Callbacks registered successfully.
2025-01-05 01:58:27,194 [INFO] __main__: Starting manual sync loop (resume from token=s115_177_24_40_64_1_1_17_0_1).
2025-01-05 01:58:28,462 [DEBUG] __main__: sync() returned a response.
2025-01-05 01:58:28,465 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 01:58:28,484 [DEBUG] __main__: sync() returned a response.
2025-01-05 01:58:28,488 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 01:58:58,503 [DEBUG] __main__: sync() returned a response.
2025-01-05 01:58:58,504 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 01:59:28,515 [DEBUG] __main__: sync() returned a response.
2025-01-05 01:59:28,517 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 01:59:28,527 [DEBUG] __main__: sync() returned a response.
2025-01-05 01:59:28,528 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 01:59:58,538 [DEBUG] __main__: sync() returned a response.
2025-01-05 01:59:58,540 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 02:00:28,547 [DEBUG] __main__: sync() returned a response.
2025-01-05 02:00:28,549 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 02:00:28,557 [DEBUG] __main__: sync() returned a response.
2025-01-05 02:00:28,558 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 02:00:58,569 [DEBUG] __main__: sync() returned a response.
2025-01-05 02:00:58,570 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 02:01:28,582 [DEBUG] __main__: sync() returned a response.
2025-01-05 02:01:28,584 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 02:01:28,594 [DEBUG] __main__: sync() returned a response.
2025-01-05 02:01:28,596 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 02:01:58,610 [DEBUG] __main__: sync() returned a response.
2025-01-05 02:01:58,612 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 02:02:09,280 [INFO] src.console_functions: Console screen cleared.
2025-01-05 02:02:10,996 [DEBUG] src.console_functions: Showing help to user.
2025-01-05 02:02:14,869 [INFO] nio.client.base_client: New joined room !ZhsKXLoMEydpudauIE:localhost
2025-01-05 02:02:14,869 [DEBUG] __main__: sync() returned a response.
2025-01-05 02:02:14,870 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 02:02:15,262 [DEBUG] __main__: sync() returned a response.
2025-01-05 02:02:15,264 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 02:02:15,293 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:02:15,293 [DEBUG] src.luna_functions: Got an event of type: <class 'nio.events.room_events.RoomMessageText'>, content: {'type': 'm.room.message', 'sender': '@evan:localhost', 'content': {'msgtype': 'm.text', 'body': 'test', 'm.mentions': {}}, 'origin_server_ts': 1736060535275, 'unsigned': {'membership': 'join', 'age': 15}, 'event_id': '$CBZRYNkgZOQ5FGBuAigkLdNUgzyOKXKaPelA5OvGA0E'}
2025-01-05 02:02:15,293 [INFO] src.luna_functions: Received message in !ZhsKXLoMEydpudauIE:localhost from @evan:localhost: test
2025-01-05 02:02:15,293 [DEBUG] src.luna_functions: Sending response: Hello @evan:localhost, you said 'test' (auto-respond).
2025-01-05 02:02:15,311 [DEBUG] __main__: sync() returned a response.
2025-01-05 02:02:15,312 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 02:02:15,322 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:02:15,322 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:02:15,322 [DEBUG] __main__: sync() returned a response.
2025-01-05 02:02:15,322 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 02:02:15,409 [DEBUG] __main__: sync() returned a response.
2025-01-05 02:02:15,409 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 02:02:32,662 [WARNING] __main__: KeyboardInterrupt received. Shutting down Director.
2025-01-05 02:02:32,662 [DEBUG] __main__: Preparing to close the event loop.
2025-01-05 02:02:32,662 [INFO] __main__: Event loop closed. Exiting luna().
2025-01-05 02:02:33,978 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-05 02:02:33,978 [DEBUG] __main__: Exiting configure_logging function.
2025-01-05 02:02:33,978 [DEBUG] __main__: Logging configuration complete.
2025-01-05 02:02:33,978 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-05 02:02:33,979 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 02:02:33,979 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-05 02:02:33,979 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-05 02:02:33,979 [DEBUG] __main__: Entering start_console_thread function.
2025-01-05 02:02:33,979 [INFO] __main__: Console thread started successfully.
2025-01-05 02:02:33,979 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-05 02:02:33,979 [DEBUG] __main__: Console thread started. Returning to main thread.
2025-01-05 02:02:33,979 [INFO] __main__: Starting main_logic coroutine.
2025-01-05 02:02:33,979 [DEBUG] __main__: Entering main_logic function...
2025-01-05 02:02:33,979 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-05 02:02:33,979 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-05 02:02:33,979 [INFO] src.luna_functions: Using saved token for user @luna:localhost.
2025-01-05 02:02:33,979 [DEBUG] __main__: Callbacks registered successfully.
2025-01-05 02:02:33,979 [INFO] __main__: Starting manual sync loop (resume from token=s117_185_26_41_64_1_1_17_0_1).
2025-01-05 02:02:36,902 [INFO] src.console_functions: Console screen cleared.
2025-01-05 02:02:42,467 [INFO] nio.client.base_client: New joined room !ZhsKXLoMEydpudauIE:localhost
2025-01-05 02:02:42,468 [DEBUG] __main__: sync() returned a response.
2025-01-05 02:02:42,469 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 02:02:42,976 [DEBUG] __main__: sync() returned a response.
2025-01-05 02:02:42,976 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 02:02:43,020 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:02:43,020 [DEBUG] src.luna_functions: Got an event of type: <class 'nio.events.room_events.RoomMessageText'>, content: {'type': 'm.room.message', 'sender': '@evan:localhost', 'content': {'msgtype': 'm.text', 'body': 'test', 'm.mentions': {}}, 'origin_server_ts': 1736060562994, 'unsigned': {'membership': 'join', 'age': 24}, 'event_id': '$A8Dhrt8h9fPbsAJYbpe0WM5QSW69P_JO7WLO_9Kn7gc'}
2025-01-05 02:02:43,020 [INFO] src.luna_functions: Received message in !ZhsKXLoMEydpudauIE:localhost from @evan:localhost: test
2025-01-05 02:02:43,021 [DEBUG] src.luna_functions: Sending response: Hello @evan:localhost, you said 'test' (auto-respond).
2025-01-05 02:02:43,036 [DEBUG] __main__: sync() returned a response.
2025-01-05 02:02:43,036 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 02:02:43,041 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:02:43,041 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:02:43,041 [DEBUG] __main__: sync() returned a response.
2025-01-05 02:02:43,041 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 02:02:43,497 [DEBUG] __main__: sync() returned a response.
2025-01-05 02:02:43,499 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 02:03:13,513 [DEBUG] __main__: sync() returned a response.
2025-01-05 02:03:13,515 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 02:03:43,544 [DEBUG] __main__: sync() returned a response.
2025-01-05 02:03:43,547 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 02:03:53,810 [INFO] src.console_functions: Console received 'restart' command; restarting now.
2025-01-05 02:03:54,371 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-05 02:03:54,371 [DEBUG] __main__: Exiting configure_logging function.
2025-01-05 02:03:54,371 [DEBUG] __main__: Logging configuration complete.
2025-01-05 02:03:54,371 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-05 02:03:54,371 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 02:03:54,371 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-05 02:03:54,371 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-05 02:03:54,371 [DEBUG] __main__: Entering start_console_thread function.
2025-01-05 02:03:54,371 [INFO] __main__: Console thread started successfully.
2025-01-05 02:03:54,371 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-05 02:03:54,371 [DEBUG] __main__: Console thread started. Returning to main thread.
2025-01-05 02:03:54,371 [INFO] __main__: Starting main_logic coroutine.
2025-01-05 02:03:54,371 [DEBUG] __main__: Entering main_logic function...
2025-01-05 02:03:54,371 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-05 02:03:54,371 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-05 02:03:54,371 [INFO] src.luna_functions: Using saved token for user @luna:localhost.
2025-01-05 02:03:54,371 [DEBUG] __main__: Callbacks registered successfully.
2025-01-05 02:03:54,372 [INFO] __main__: Starting manual sync loop (resume from token=s119_189_28_42_64_1_1_17_0_1).
2025-01-05 02:03:56,620 [INFO] nio.client.base_client: New joined room !ZhsKXLoMEydpudauIE:localhost
2025-01-05 02:03:56,620 [DEBUG] __main__: sync() returned a response.
2025-01-05 02:03:56,621 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 02:03:57,020 [DEBUG] __main__: sync() returned a response.
2025-01-05 02:03:57,023 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 02:03:57,057 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:03:57,058 [DEBUG] src.luna_functions: Got an event of type: <class 'nio.events.room_events.RoomMessageText'>, content: {'type': 'm.room.message', 'sender': '@evan:localhost', 'content': {'msgtype': 'm.text', 'body': 'test', 'm.mentions': {}}, 'origin_server_ts': 1736060637036, 'unsigned': {'membership': 'join', 'age': 17}, 'event_id': '$AOYmZ841VNVxuXMF_cfPhYtI4bGC43XHukLkGcGKpoY'}
2025-01-05 02:03:57,058 [INFO] src.luna_functions: Received message in !ZhsKXLoMEydpudauIE:localhost from @evan:localhost: test
2025-01-05 02:03:57,058 [INFO] root: Pretending to prompt GPT!
2025-01-05 02:03:57,058 [DEBUG] src.luna_functions: Sending response: Hello @evan:localhost, you said 'test' (auto-respond).
2025-01-05 02:03:57,074 [DEBUG] __main__: sync() returned a response.
2025-01-05 02:03:57,074 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 02:03:57,079 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:03:57,079 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:03:57,079 [DEBUG] __main__: sync() returned a response.
2025-01-05 02:03:57,080 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 02:03:57,113 [DEBUG] __main__: sync() returned a response.
2025-01-05 02:03:57,114 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 02:04:00,739 [DEBUG] __main__: sync() returned a response.
2025-01-05 02:04:00,741 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 02:04:01,170 [DEBUG] __main__: sync() returned a response.
2025-01-05 02:04:01,171 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 02:04:01,203 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:04:01,203 [DEBUG] src.luna_functions: Got an event of type: <class 'nio.events.room_events.RoomMessageText'>, content: {'type': 'm.room.message', 'sender': '@evan:localhost', 'content': {'msgtype': 'm.text', 'body': 'test', 'm.mentions': {}}, 'origin_server_ts': 1736060641189, 'unsigned': {'membership': 'join', 'age': 11}, 'event_id': '$5rQuASsUeKyY_BSTUA3qu7fHMna-WMNyxjUoiwXQXpc'}
2025-01-05 02:04:01,203 [INFO] src.luna_functions: Received message in !ZhsKXLoMEydpudauIE:localhost from @evan:localhost: test
2025-01-05 02:04:01,203 [INFO] root: Pretending to prompt GPT!
2025-01-05 02:04:01,203 [DEBUG] src.luna_functions: Sending response: Hello @evan:localhost, you said 'test' (auto-respond).
2025-01-05 02:04:01,215 [DEBUG] __main__: sync() returned a response.
2025-01-05 02:04:01,216 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 02:04:01,245 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:04:01,245 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:04:01,245 [DEBUG] __main__: sync() returned a response.
2025-01-05 02:04:01,245 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 02:04:01,452 [DEBUG] __main__: sync() returned a response.
2025-01-05 02:04:01,453 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 02:04:01,537 [DEBUG] __main__: sync() returned a response.
2025-01-05 02:04:01,539 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 02:04:01,898 [DEBUG] __main__: sync() returned a response.
2025-01-05 02:04:01,900 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 02:04:01,939 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:04:01,939 [DEBUG] src.luna_functions: Got an event of type: <class 'nio.events.room_events.RoomMessageText'>, content: {'type': 'm.room.message', 'sender': '@evan:localhost', 'content': {'msgtype': 'm.text', 'body': 'test', 'm.mentions': {}}, 'origin_server_ts': 1736060641921, 'unsigned': {'membership': 'join', 'age': 15}, 'event_id': '$G--BFiNJpgmpDzMHjw8-3w_0j6m3MIrC5JEhuVuTBVI'}
2025-01-05 02:04:01,939 [INFO] src.luna_functions: Received message in !ZhsKXLoMEydpudauIE:localhost from @evan:localhost: test
2025-01-05 02:04:01,940 [INFO] root: Pretending to prompt GPT!
2025-01-05 02:04:01,940 [DEBUG] src.luna_functions: Sending response: Hello @evan:localhost, you said 'test' (auto-respond).
2025-01-05 02:04:01,950 [DEBUG] __main__: sync() returned a response.
2025-01-05 02:04:01,950 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 02:04:01,956 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:04:01,956 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:04:01,956 [DEBUG] __main__: sync() returned a response.
2025-01-05 02:04:01,956 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 02:04:26,291 [DEBUG] __main__: sync() returned a response.
2025-01-05 02:04:26,292 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 02:04:56,311 [DEBUG] __main__: sync() returned a response.
2025-01-05 02:04:56,312 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 02:05:26,332 [DEBUG] __main__: sync() returned a response.
2025-01-05 02:05:26,333 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 02:05:56,338 [DEBUG] __main__: sync() returned a response.
2025-01-05 02:05:56,339 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 02:06:26,356 [DEBUG] __main__: sync() returned a response.
2025-01-05 02:06:26,357 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 02:06:26,372 [DEBUG] __main__: sync() returned a response.
2025-01-05 02:06:26,372 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 02:06:27,596 [WARNING] __main__: KeyboardInterrupt received. Shutting down Director.
2025-01-05 02:06:27,596 [DEBUG] __main__: Preparing to close the event loop.
2025-01-05 02:06:27,597 [INFO] __main__: Event loop closed. Exiting luna().
2025-01-05 02:06:38,674 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-05 02:06:38,674 [DEBUG] __main__: Exiting configure_logging function.
2025-01-05 02:06:38,674 [DEBUG] __main__: Logging configuration complete.
2025-01-05 02:06:38,674 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-05 02:06:38,674 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 02:06:38,674 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-05 02:06:38,674 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-05 02:06:38,674 [DEBUG] __main__: Entering start_console_thread function.
2025-01-05 02:06:38,674 [INFO] __main__: Console thread started successfully.
2025-01-05 02:06:38,674 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-05 02:06:38,675 [DEBUG] __main__: Console thread started. Returning to main thread.
2025-01-05 02:06:38,675 [INFO] __main__: Starting main_logic coroutine.
2025-01-05 02:06:38,675 [DEBUG] __main__: Entering main_logic function...
2025-01-05 02:06:38,675 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-05 02:06:38,675 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-05 02:06:38,675 [INFO] src.luna_functions: Using saved token for user @luna:localhost.
2025-01-05 02:06:38,675 [DEBUG] __main__: Callbacks registered successfully.
2025-01-05 02:06:38,675 [INFO] __main__: Starting manual sync loop (resume from token=s125_195_34_45_64_1_1_17_0_1).
2025-01-05 02:06:41,658 [INFO] src.console_functions: Console screen cleared.
2025-01-05 02:06:47,008 [INFO] nio.client.base_client: New joined room !ZhsKXLoMEydpudauIE:localhost
2025-01-05 02:06:47,008 [DEBUG] __main__: sync() returned a response.
2025-01-05 02:06:47,020 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 02:06:47,596 [DEBUG] __main__: sync() returned a response.
2025-01-05 02:06:47,603 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 02:06:47,628 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:06:47,628 [DEBUG] src.luna_functions: Got an event of type: <class 'nio.events.room_events.RoomMessageText'>, content: {'type': 'm.room.message', 'sender': '@evan:localhost', 'content': {'msgtype': 'm.text', 'body': 'test', 'm.mentions': {}}, 'origin_server_ts': 1736060807613, 'unsigned': {'membership': 'join', 'age': 14}, 'event_id': '$AkKt_f-Qd0mh7TRT1BFcFNGxnbvk03LPM_Ted83Mwhw'}
2025-01-05 02:06:47,628 [INFO] src.luna_functions: Received message in !ZhsKXLoMEydpudauIE:localhost from @evan:localhost: test
2025-01-05 02:06:47,628 [INFO] root: Pretending to prompt GPT! with API key: POOPYBUTTHOLE
2025-01-05 02:06:47,628 [DEBUG] src.luna_functions: Sending response: Hello @evan:localhost, you said 'test' (auto-respond).
2025-01-05 02:06:47,637 [DEBUG] __main__: sync() returned a response.
2025-01-05 02:06:47,637 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 02:06:47,641 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:06:47,641 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:06:47,641 [DEBUG] __main__: sync() returned a response.
2025-01-05 02:06:47,642 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 02:06:48,153 [DEBUG] __main__: sync() returned a response.
2025-01-05 02:06:48,154 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 02:07:18,174 [DEBUG] __main__: sync() returned a response.
2025-01-05 02:07:18,177 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 02:07:48,186 [DEBUG] __main__: sync() returned a response.
2025-01-05 02:07:48,187 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 02:08:18,196 [DEBUG] __main__: sync() returned a response.
2025-01-05 02:08:18,198 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 02:08:18,209 [DEBUG] __main__: sync() returned a response.
2025-01-05 02:08:18,210 [DEBUG] src.luna_functions: Sync token saved to sync_token.json.
2025-01-05 02:08:44,935 [WARNING] __main__: KeyboardInterrupt received. Shutting down Director.
2025-01-05 02:08:44,936 [DEBUG] __main__: Preparing to close the event loop.
2025-01-05 02:08:44,936 [INFO] __main__: Event loop closed. Exiting luna().
2025-01-05 02:10:09,811 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-05 02:10:09,811 [DEBUG] __main__: Exiting configure_logging function.
2025-01-05 02:10:09,811 [DEBUG] __main__: Logging configuration complete.
2025-01-05 02:10:09,811 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-05 02:10:09,811 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 02:10:09,811 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-05 02:10:09,811 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-05 02:10:09,811 [DEBUG] __main__: Entering start_console_thread function.
2025-01-05 02:10:09,811 [INFO] __main__: Console thread started successfully.
2025-01-05 02:10:09,811 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-05 02:10:09,811 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-05 02:10:09,811 [INFO] __main__: Starting main_logic coroutine.
2025-01-05 02:10:09,812 [DEBUG] __main__: Entering main_logic function...
2025-01-05 02:10:09,812 [DEBUG] __main__: Attempting to load or log in the client.
2025-01-05 02:10:09,812 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-05 02:10:09,812 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-05 02:10:09,812 [INFO] src.luna_functions: Using saved token for user @luna:localhost.
2025-01-05 02:10:09,812 [DEBUG] __main__: Client obtained. Storing reference to DIRECTOR_CLIENT in src.luna_functions.
2025-01-05 02:10:09,812 [DEBUG] __main__: Callbacks registered successfully.
2025-01-05 02:10:09,812 [DEBUG] __main__: Starting sync_forever loop. Awaiting new events with timeout=30000.
2025-01-05 02:10:09,853 [DEBUG] nio.responses: Validating response schema {'type': 'object', 'properties': {'device_one_time_keys_count': {'type': 'object', 'default': {}, 'properties': {'curve25519': {'type': 'integer'}, 'signed_curve25519': {'type': 'integer'}}}, 'device_lists': {'type': 'object', 'default': {}, 'properties': {'changed': {'type': 'array', 'items': {'type': 'string'}}, 'left': {'type': 'array', 'items': {'type': 'string'}}}}, 'next_batch': {'type': 'string'}, 'rooms': {'type': 'object', 'default': {}, 'properties': {'invite': {'type': 'object', 'default': {}, 'patternProperties': {'^!.+:.+$': {'type': 'object', 'properties': {'invite_state': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}}}}}, 'join': {'type': 'object', 'default': {}, 'patternProperties': {'^!.+:.+$': {'type': 'object', 'properties': {'timeline': {'type': 'object', 'properties': {'events': {'type': 'array'}, 'limited': {'type': 'boolean'}, 'prev_batch': {'type': 'string'}}, 'required': ['events']}, 'state': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'ephemeral': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'summary': {'type': 'object', 'properties': {'m.invited_member_count': {'type': 'integer'}, 'm.joined_member_count': {'type': 'integer'}, 'm.heroes': {'type': 'array', 'items': {'type': 'string'}}}}, 'account_data': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}}}}}, 'leave': {'type': 'object', 'default': {}, 'patternProperties': {'^!.+:.+$': {'type': 'object', 'properties': {'timeline': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'state': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}}}}}}}, 'to_device': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'presence': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}}, 'required': ['next_batch']}: {'next_batch': 's127_202_36_46_64_1_1_17_0_1', 'account_data': {'events': [{'type': 'm.push_rules', 'content': {'global': {'underride': [{'conditions': [{'kind': 'event_match', 'key': 'type', 'pattern': 'm.call.invite'}], 'actions': ['notify', {'set_tweak': 'sound', 'value': 'ring'}, {'set_tweak': 'highlight', 'value': False}], 'rule_id': '.m.rule.call', 'default': True, 'enabled': True}, {'conditions': [{'kind': 'event_match', 'key': 'type', 'pattern': 'm.room.encrypted'}, {'kind': 'room_member_count', 'is': '2'}], 'actions': ['notify', {'set_tweak': 'sound', 'value': 'default'}, {'set_tweak': 'highlight', 'value': False}], 'rule_id': '.m.rule.encrypted_room_one_to_one', 'default': True, 'enabled': True}, {'conditions': [{'kind': 'event_match', 'key': 'type', 'pattern': 'm.room.message'}, {'kind': 'room_member_count', 'is': '2'}], 'actions': ['notify', {'set_tweak': 'sound', 'value': 'default'}, {'set_tweak': 'highlight', 'value': False}], 'rule_id': '.m.rule.room_one_to_one', 'default': True, 'enabled': True}, {'conditions': [{'kind': 'event_match', 'key': 'type', 'pattern': 'm.room.message'}], 'actions': ['notify', {'set_tweak': 'highlight', 'value': False}], 'rule_id': '.m.rule.message', 'default': True, 'enabled': True}, {'conditions': [{'kind': 'event_match', 'key': 'type', 'pattern': 'm.room.encrypted'}], 'actions': ['notify', {'set_tweak': 'highlight', 'value': False}], 'rule_id': '.m.rule.encrypted', 'default': True, 'enabled': True}, {'conditions': [{'kind': 'event_match', 'key': 'type', 'pattern': 'im.vector.modular.widgets'}, {'kind': 'event_match', 'key': 'content.type', 'pattern': 'jitsi'}, {'kind': 'event_match', 'key': 'state_key', 'pattern': '*'}], 'actions': ['notify', {'set_tweak': 'highlight', 'value': False}], 'rule_id': '.im.vector.jitsi', 'default': True, 'enabled': True}], 'sender': [], 'room': [], 'content': [{'actions': ['notify', {'set_tweak': 'highlight'}, {'set_tweak': 'sound', 'value': 'default'}], 'rule_id': '.m.rule.contains_user_name', 'default': True, 'pattern': 'luna', 'enabled': True}], 'override': [{'conditions': [], 'actions': [], 'rule_id': '.m.rule.master', 'default': True, 'enabled': False}, {'conditions': [{'kind': 'event_match', 'key': 'content.msgtype', 'pattern': 'm.notice'}], 'actions': [], 'rule_id': '.m.rule.suppress_notices', 'default': True, 'enabled': True}, {'conditions': [{'kind': 'event_match', 'key': 'type', 'pattern': 'm.room.member'}, {'kind': 'event_match', 'key': 'content.membership', 'pattern': 'invite'}, {'kind': 'event_match', 'key': 'state_key', 'pattern': '@luna:localhost'}], 'actions': ['notify', {'set_tweak': 'highlight', 'value': False}, {'set_tweak': 'sound', 'value': 'default'}], 'rule_id': '.m.rule.invite_for_me', 'default': True, 'enabled': True}, {'conditions': [{'kind': 'event_match', 'key': 'type', 'pattern': 'm.room.member'}], 'actions': [], 'rule_id': '.m.rule.member_event', 'default': True, 'enabled': True}, {'conditions': [{'kind': 'event_property_contains', 'key': 'content.m\\.mentions.user_ids', 'value': '@luna:localhost'}], 'actions': ['notify', {'set_tweak': 'highlight'}, {'set_tweak': 'sound', 'value': 'default'}], 'rule_id': '.m.rule.is_user_mention', 'default': True, 'enabled': True}, {'conditions': [{'kind': 'contains_display_name'}], 'actions': ['notify', {'set_tweak': 'highlight'}, {'set_tweak': 'sound', 'value': 'default'}], 'rule_id': '.m.rule.contains_display_name', 'default': True, 'enabled': True}, {'conditions': [{'kind': 'event_property_is', 'key': 'content.m\\.mentions.room', 'value': True}, {'kind': 'sender_notification_permission', 'key': 'room'}], 'actions': ['notify', {'set_tweak': 'highlight'}], 'rule_id': '.m.rule.is_room_mention', 'default': True, 'enabled': True}, {'conditions': [{'kind': 'sender_notification_permission', 'key': 'room'}, {'kind': 'event_match', 'key': 'content.body', 'pattern': '@room'}], 'actions': ['notify', {'set_tweak': 'highlight'}], 'rule_id': '.m.rule.roomnotif', 'default': True, 'enabled': True}, {'conditions': [{'kind': 'event_match', 'key': 'type', 'pattern': 'm.room.tombstone'}, {'kind': 'event_match', 'key': 'state_key', 'pattern': ''}], 'actions': ['notify', {'set_tweak': 'highlight'}], 'rule_id': '.m.rule.tombstone', 'default': True, 'enabled': True}, {'conditions': [{'kind': 'event_match', 'key': 'type', 'pattern': 'm.reaction'}], 'actions': [], 'rule_id': '.m.rule.reaction', 'default': True, 'enabled': True}, {'conditions': [{'kind': 'event_match', 'key': 'type', 'pattern': 'm.room.server_acl'}, {'kind': 'event_match', 'key': 'state_key', 'pattern': ''}], 'actions': [], 'rule_id': '.m.rule.room.server_acl', 'default': True, 'enabled': True}, {'conditions': [{'kind': 'event_property_is', 'key': 'content.m\\.relates_to.rel_type', 'value': 'm.replace'}], 'actions': [], 'rule_id': '.m.rule.suppress_edits', 'default': True, 'enabled': True}]}}}]}, 'presence': {'events': [{'type': 'm.presence', 'sender': '@evan:localhost', 'content': {'presence': 'unavailable', 'last_active_ago': 51509}}, {'type': 'm.presence', 'sender': '@luna:localhost', 'content': {'presence': 'online', 'last_active_ago': 33, 'currently_active': True}}]}, 'device_one_time_keys_count': {'signed_curve25519': 0}, 'org.matrix.msc2732.device_unused_fallback_key_types': [], 'device_unused_fallback_key_types': [], 'rooms': {'join': {'!ZhsKXLoMEydpudauIE:localhost': {'timeline': {'events': [{'type': 'm.room.message', 'sender': '@evan:localhost', 'content': {'msgtype': 'm.text', 'body': 'test', 'm.mentions': {}}, 'origin_server_ts': 1736060562994, 'unsigned': {'membership': 'join', 'age': 446857}, 'event_id': '$A8Dhrt8h9fPbsAJYbpe0WM5QSW69P_JO7WLO_9Kn7gc'}, {'type': 'm.room.message', 'sender': '@luna:localhost', 'content': {'msgtype': 'm.text', 'body': "Hello @evan:localhost, you said 'test' (auto-respond)."}, 'origin_server_ts': 1736060563024, 'unsigned': {'membership': 'join', 'age': 446827, 'transaction_id': 'ed1ecb96-f115-430b-88ca-0685436a9ce5'}, 'event_id': '$gPXwON9diQ5iNtPIA5CTAwJnKN3If4C_5NUm9PzZGNw'}, {'type': 'm.room.message', 'sender': '@evan:localhost', 'content': {'msgtype': 'm.text', 'body': 'test', 'm.mentions': {}}, 'origin_server_ts': 1736060637036, 'unsigned': {'membership': 'join', 'age': 372815}, 'event_id': '$AOYmZ841VNVxuXMF_cfPhYtI4bGC43XHukLkGcGKpoY'}, {'type': 'm.room.message', 'sender': '@luna:localhost', 'content': {'msgtype': 'm.text', 'body': "Hello @evan:localhost, you said 'test' (auto-respond)."}, 'origin_server_ts': 1736060637061, 'unsigned': {'membership': 'join', 'age': 372790, 'transaction_id': '9a927019-a840-4979-bfa4-4bd9554589ef'}, 'event_id': '$vOwOs8tTguwTdBJ8ah-kB60pTcYr6vSCpk3L_r8dcxA'}, {'type': 'm.room.message', 'sender': '@evan:localhost', 'content': {'msgtype': 'm.text', 'body': 'test', 'm.mentions': {}}, 'origin_server_ts': 1736060641189, 'unsigned': {'membership': 'join', 'age': 368662}, 'event_id': '$5rQuASsUeKyY_BSTUA3qu7fHMna-WMNyxjUoiwXQXpc'}, {'type': 'm.room.message', 'sender': '@luna:localhost', 'content': {'msgtype': 'm.text', 'body': "Hello @evan:localhost, you said 'test' (auto-respond)."}, 'origin_server_ts': 1736060641205, 'unsigned': {'membership': 'join', 'age': 368646, 'transaction_id': 'b35e15b5-2bb6-4142-bbc0-7977b10ccd82'}, 'event_id': '$Gt-SjNxRghmxj35RU6w_LW5dccpQMMnXw5JRKRW4ajM'}, {'type': 'm.room.message', 'sender': '@evan:localhost', 'content': {'msgtype': 'm.text', 'body': 'test', 'm.mentions': {}}, 'origin_server_ts': 1736060641921, 'unsigned': {'membership': 'join', 'age': 367930}, 'event_id': '$G--BFiNJpgmpDzMHjw8-3w_0j6m3MIrC5JEhuVuTBVI'}, {'type': 'm.room.message', 'sender': '@luna:localhost', 'content': {'msgtype': 'm.text', 'body': "Hello @evan:localhost, you said 'test' (auto-respond)."}, 'origin_server_ts': 1736060641942, 'unsigned': {'membership': 'join', 'age': 367909, 'transaction_id': '71cd9cf4-c1c0-4a80-b4f9-c4c2703ff41c'}, 'event_id': '$qmw4HKfo8G3KXlEoN1QakDJObcYXC35RITckEjtk74M'}, {'type': 'm.room.message', 'sender': '@evan:localhost', 'content': {'msgtype': 'm.text', 'body': 'test', 'm.mentions': {}}, 'origin_server_ts': 1736060807613, 'unsigned': {'membership': 'join', 'age': 202238}, 'event_id': '$AkKt_f-Qd0mh7TRT1BFcFNGxnbvk03LPM_Ted83Mwhw'}, {'type': 'm.room.message', 'sender': '@luna:localhost', 'content': {'msgtype': 'm.text', 'body': "Hello @evan:localhost, you said 'test' (auto-respond)."}, 'origin_server_ts': 1736060807630, 'unsigned': {'membership': 'join', 'age': 202221, 'transaction_id': '2c296c02-8ffe-439f-93de-f6a2e599759f'}, 'event_id': '$kFF550EiAY_5aPxnrQNrMs54x7tX2U9nJc0r91c__gI'}], 'prev_batch': 's117_202_36_46_64_1_1_17_0_1', 'limited': True}, 'state': {'events': [{'type': 'm.room.canonical_alias', 'sender': '@evan:localhost', 'content': {'alias': '#123123:localhost'}, 'state_key': '', 'origin_server_ts': 1736060127134, 'unsigned': {'age': 882717}, 'event_id': '$Thp5i0vEWQFbgkkg9utYzBpIFRBM0gw2aPA5zyNmbgA'}, {'type': 'm.room.create', 'sender': '@evan:localhost', 'content': {'room_version': '10', 'creator': '@evan:localhost'}, 'state_key': '', 'origin_server_ts': 1736060127098, 'unsigned': {'age': 882753}, 'event_id': '$9OwFOSGamjguoSWah9UP4DCW8NnjB3JDf2p0M0PR9LQ'}, {'type': 'm.room.member', 'sender': '@evan:localhost', 'content': {'displayname': 'evan', 'membership': 'join'}, 'state_key': '@evan:localhost', 'origin_server_ts': 1736060127112, 'unsigned': {'age': 882739}, 'event_id': '$pxBvywYkahVEzaTnWyQztFGkS2hA16GX7ubzlM3I0JY'}, {'type': 'm.room.member', 'sender': '@luna:localhost', 'content': {'displayname': 'luna', 'membership': 'join'}, 'state_key': '@luna:localhost', 'origin_server_ts': 1736060145533, 'unsigned': {'replaces_state': '$CjRbJLXuYPIlnEKblHxFK8w6vLFZF-9FR_FPDhyaH_k', 'prev_content': {'displayname': 'luna', 'membership': 'invite'}, 'prev_sender': '@evan:localhost', 'age': 864318}, 'event_id': '$t4RqDe6QI0Do0LOP5q2CKATcbeXoj2UJz02XBY8wQo4'}, {'type': 'm.room.join_rules', 'sender': '@evan:localhost', 'content': {'join_rule': 'public'}, 'state_key': '', 'origin_server_ts': 1736060127134, 'unsigned': {'age': 882717}, 'event_id': '$9lvFYla3NmuV9MWmZ8B_QmWk8-K1nCeaWAXcJfXPmKI'}, {'type': 'm.room.history_visibility', 'sender': '@evan:localhost', 'content': {'history_visibility': 'shared'}, 'state_key': '', 'origin_server_ts': 1736060127134, 'unsigned': {'age': 882717}, 'event_id': '$DtQpt84J_J32r_fVYZe79JvXzySWEFI6Zg_vZSyomY8'}, {'type': 'm.room.power_levels', 'sender': '@evan:localhost', 'content': {'users': {'@evan:localhost': 100}, 'users_default': 0, 'events': {'m.room.name': 50, 'm.room.avatar': 50, 'm.room.power_levels': 100, 'm.room.history_visibility': 100, 'm.room.canonical_alias': 50, 'm.room.tombstone': 100, 'm.room.server_acl': 100, 'm.room.encryption': 100, 'org.matrix.msc3401.call.member': 0, 'org.matrix.msc3401.call': 100}, 'events_default': 0, 'state_default': 50, 'ban': 50, 'kick': 50, 'redact': 50, 'invite': 50, 'historical': 100, 'm.call.invite': 50}, 'state_key': '', 'origin_server_ts': 1736060127127, 'unsigned': {'age': 882724}, 'event_id': '$-3Eun5dq6BU1LOG92e4QKPF35u_ju_Kj64AzzlgyTXc'}, {'type': 'm.room.name', 'sender': '@evan:localhost', 'content': {'name': '123123'}, 'state_key': '', 'origin_server_ts': 1736060127135, 'unsigned': {'age': 882716}, 'event_id': '$uQIf4LOBm29otiePHJPyG_4CFJ2ApmdQZ8R_MfuwAiA'}]}, 'account_data': {'events': []}, 'ephemeral': {'events': [{'type': 'm.typing', 'content': {'user_ids': []}}, {'type': 'm.receipt', 'content': {'$kFF550EiAY_5aPxnrQNrMs54x7tX2U9nJc0r91c__gI': {'m.read': {'@evan:localhost': {'ts': 1736060808125, 'thread_id': 'main'}}}}}]}, 'unread_notifications': {'notification_count': 8, 'highlight_count': 0}, 'summary': {}}, '!vqsQaVVLtsvWxIoJwV:localhost': {'timeline': {'events': [{'type': 'm.room.join_rules', 'sender': '@evan:localhost', 'content': {'join_rule': 'invite'}, 'state_key': '', 'origin_server_ts': 1736059715004, 'unsigned': {'membership': 'leave', 'age': 1294847}, 'event_id': '$Zzokk8Q-0EAdZnp_EXOEZwQ7HwHwmV-G4s3HTPLbK3s'}, {'type': 'm.room.history_visibility', 'sender': '@evan:localhost', 'content': {'history_visibility': 'shared'}, 'state_key': '', 'origin_server_ts': 1736059715004, 'unsigned': {'membership': 'leave', 'age': 1294847}, 'event_id': '$WKfhxmul03vYCSvbCgj4ceWTqc2LXuXk9hdIn7hAK_g'}, {'type': 'm.room.guest_access', 'sender': '@evan:localhost', 'content': {'guest_access': 'can_join'}, 'state_key': '', 'origin_server_ts': 1736059715005, 'unsigned': {'membership': 'leave', 'age': 1294846}, 'event_id': '$zraCBvPQZ23vxBoKBF3jlyMGMuRoAtDdMWcjF2ziYCs'}, {'type': 'm.room.encryption', 'sender': '@evan:localhost', 'content': {'algorithm': 'm.megolm.v1.aes-sha2'}, 'state_key': '', 'origin_server_ts': 1736059715005, 'unsigned': {'membership': 'leave', 'age': 1294846}, 'event_id': '$MJr5zLGtSB8P-J9ETI6id4l59-1BJgtP3iprMN3uf58'}, {'type': 'm.room.name', 'sender': '@evan:localhost', 'content': {'name': '234'}, 'state_key': '', 'origin_server_ts': 1736059715005, 'unsigned': {'membership': 'leave', 'age': 1294846}, 'event_id': '$DuqwgcaNJbzn1Y_16a00Ha5eWYt3r-rhZeNI2LBvusU'}, {'type': 'm.room.member', 'sender': '@evan:localhost', 'content': {'displayname': 'luna', 'membership': 'invite'}, 'state_key': '@luna:localhost', 'origin_server_ts': 1736059725008, 'unsigned': {'membership': 'invite', 'age': 1284843}, 'event_id': '$K8jI7cIBdgn8m7CclbTl0PsCLad20Xjv1nr6y7XqSak'}, {'type': 'm.room.member', 'sender': '@luna:localhost', 'content': {'displayname': 'luna', 'membership': 'join'}, 'state_key': '@luna:localhost', 'origin_server_ts': 1736059725046, 'unsigned': {'replaces_state': '$K8jI7cIBdgn8m7CclbTl0PsCLad20Xjv1nr6y7XqSak', 'prev_content': {'displayname': 'luna', 'membership': 'invite'}, 'prev_sender': '@evan:localhost', 'membership': 'join', 'age': 1284805}, 'event_id': '$l2xAPBccK-on2a275MmQxiGpOWlJuK3Hc3v2g6A530k'}, {'type': 'm.room.encrypted', 'sender': '@evan:localhost', 'content': {'algorithm': 'm.megolm.v1.aes-sha2', 'ciphertext': 'AwgAEqABfCZTcKsroGWY5zRKa82fpLtB78cdZPbZkzAWIQYSMnq8ILSCcXe2ghXL6SAmkjg45EAW2QIrogN79nSNBuFchkpqfDnseZT1niBgW1EsB5+ZnDR/vKlIDQ3f4M0qV+NZGz00f5HItKYOujvWlaxpEboY2h3Ayb5X7wniHjNUHnFvshxAymHGKeL8MSbd5pe6E0C+UbcK2kYb/xMgCLsfcfQeqvUFi8ZXu2X4vdTPuYt4SQcZJbzOqNsOLnFYP8HMQdCh9CwsCqZzb1GR1ouS5osf9KA0hzYQBZL3z/QsYltFne3m0cJpDA', 'device_id': 'PULWHBXRQX', 'sender_key': 'Q9bL7OEfgVaLYj4UTR4aKA4ts7ECPDfd+XtrmMZ3aDg', 'session_id': 'BL46HGujkMSihs3/vZbyl328haNIKkex0R7819hBB30'}, 'origin_server_ts': 1736059776900, 'unsigned': {'membership': 'join', 'age': 1232951}, 'event_id': '$tEGoyKBHuotQdWQ7VMJf15zWfjk6V3fdwvi35BqDgNw'}, {'type': 'm.room.encrypted', 'sender': '@evan:localhost', 'content': {'algorithm': 'm.megolm.v1.aes-sha2', 'ciphertext': 'AwgBEpABuDA54YqWALxCmW95/i2KGpMGRmti2BM1eYuY7uEdqyMD+MrPK5jxhm9RzoxVJ94purunHCzuTN+9OBfApkILQq8REfX8w4TO6PkfGIsn9SqXc2bdoAttn3yO35uo6lzj2YCNlZYEexUreRnq9hqLzR//h5tpFq7DwssnWbk/135zd3j5fBG7Y8iyhumjTaGBQg8Z4mJcIZlLiuqMq2TXC2R34KnU0MT938zzWHm3j35/pIG2dxG2d4h0j/j3AVyFeTZPqQ0C/MpeNuUdM3/Jxytn4misE7cN', 'device_id': 'PULWHBXRQX', 'sender_key': 'Q9bL7OEfgVaLYj4UTR4aKA4ts7ECPDfd+XtrmMZ3aDg', 'session_id': 'BL46HGujkMSihs3/vZbyl328haNIKkex0R7819hBB30'}, 'origin_server_ts': 1736059936423, 'unsigned': {'membership': 'join', 'age': 1073428}, 'event_id': '$VV5tmcyvpSEqxQiVnj6S7cP0WCRgk8tLHzwqz01oHgY'}, {'type': 'm.room.member', 'sender': '@evan:localhost', 'content': {'membership': 'leave'}, 'state_key': '@evan:localhost', 'origin_server_ts': 1736060101699, 'unsigned': {'replaces_state': '$IH6Q_b9kIxReppkFPDRJBLs6Uu3OdFccL8p2-fZBEP0', 'prev_content': {'displayname': 'evan', 'membership': 'join'}, 'prev_sender': '@evan:localhost', 'membership': 'join', 'age': 908152}, 'event_id': '$OKteQeRiJQPiGddIgY34LVe04t9ecdoXmyRAxxlvJCM'}], 'prev_batch': 's90_202_36_46_64_1_1_17_0_1', 'limited': True}, 'state': {'events': [{'type': 'm.room.power_levels', 'sender': '@evan:localhost', 'content': {'users': {'@evan:localhost': 100}, 'users_default': 0, 'events': {'m.room.name': 50, 'm.room.avatar': 50, 'm.room.power_levels': 100, 'm.room.history_visibility': 100, 'm.room.canonical_alias': 50, 'm.room.tombstone': 100, 'm.room.server_acl': 100, 'm.room.encryption': 100, 'org.matrix.msc3401.call.member': 0, 'org.matrix.msc3401.call': 100}, 'events_default': 0, 'state_default': 50, 'ban': 50, 'kick': 50, 'redact': 50, 'invite': 0, 'historical': 100}, 'state_key': '', 'origin_server_ts': 1736059714999, 'unsigned': {'age': 1294852}, 'event_id': '$nsWwie6WpHl2sCixIeG8adK0I6Q62SStEjplkwi8xiA'}, {'type': 'm.room.create', 'sender': '@evan:localhost', 'content': {'room_version': '10', 'creator': '@evan:localhost'}, 'state_key': '', 'origin_server_ts': 1736059714970, 'unsigned': {'age': 1294881}, 'event_id': '$a_rFs6sbeit4siyKpbMGWnXm8lK_oJfJHXd1OWcnjKw'}, {'type': 'm.room.member', 'sender': '@evan:localhost', 'content': {'displayname': 'evan', 'membership': 'join'}, 'state_key': '@evan:localhost', 'origin_server_ts': 1736059714990, 'unsigned': {'age': 1294861}, 'event_id': '$IH6Q_b9kIxReppkFPDRJBLs6Uu3OdFccL8p2-fZBEP0'}]}, 'account_data': {'events': []}, 'ephemeral': {'events': [{'type': 'm.receipt', 'content': {'$l2xAPBccK-on2a275MmQxiGpOWlJuK3Hc3v2g6A530k': {'m.read': {'@evan:localhost': {'ts': 1736059725192, 'thread_id': 'main'}}}}}]}, 'unread_notifications': {'notification_count': 3, 'highlight_count': 0}, 'summary': {}}, '!IQTJHuSCcTLlkCZzzF:localhost': {'timeline': {'events': [{'type': 'm.room.message', 'sender': '@evan:localhost', 'content': {'msgtype': 'm.text', 'body': 'test', 'm.mentions': {}}, 'origin_server_ts': 1736059402451, 'unsigned': {'membership': 'join', 'age': 1607400}, 'event_id': '$-Y7R3HKfRa7i141j5ZZLnd7MTvBq4phdT6iEi6rfmYU'}, {'type': 'm.room.message', 'sender': '@evan:localhost', 'content': {'msgtype': 'm.text', 'body': 'test', 'm.mentions': {}}, 'origin_server_ts': 1736059408062, 'unsigned': {'membership': 'join', 'age': 1601789}, 'event_id': '$HpqOtqUT1e1RlTMfzVU-e0oPYAEN45tST8FVJPOXKXU'}, {'type': 'm.room.message', 'sender': '@luna:localhost', 'content': {'msgtype': 'm.text', 'body': "Hello @evan:localhost, you said 'test' (auto-respond)."}, 'origin_server_ts': 1736059413668, 'unsigned': {'membership': 'join', 'age': 1596183, 'transaction_id': 'c3e2c02a-e5d3-4c54-93c7-7dbfad414702'}, 'event_id': '$VEbuvR981117z5CDHY7OMxcRFAbudHQoRoXeALzTS0c'}, {'type': 'm.room.message', 'sender': '@luna:localhost', 'content': {'msgtype': 'm.text', 'body': "Hello @evan:localhost, you said 'test' (auto-respond)."}, 'origin_server_ts': 1736059413686, 'unsigned': {'membership': 'join', 'age': 1596165, 'transaction_id': 'e7e39487-128d-49f1-830d-c2f9dac09881'}, 'event_id': '$jy-i7H83-mmGJp6fLWMUDVjr3UZvGRAYP-Kh1x_tmwA'}, {'type': 'm.room.message', 'sender': '@evan:localhost', 'content': {'msgtype': 'm.text', 'body': 'hi', 'm.mentions': {}}, 'origin_server_ts': 1736059416557, 'unsigned': {'membership': 'join', 'age': 1593294}, 'event_id': '$k7ZdYE8zOoPbSBdg4r6BXYWliXgR7e5cmZwpnr8ouU8'}, {'type': 'm.room.message', 'sender': '@luna:localhost', 'content': {'msgtype': 'm.text', 'body': "Hello @evan:localhost, you said 'hi' (auto-respond)."}, 'origin_server_ts': 1736059416579, 'unsigned': {'membership': 'join', 'age': 1593272, 'transaction_id': 'dce9d371-8f14-4399-91e4-a4e0625c103b'}, 'event_id': '$6oEe80BIElNfhy3h_IOC6HjG0IL5F2V42HG_98Ha5OY'}, {'type': 'm.room.message', 'sender': '@evan:localhost', 'content': {'msgtype': 'm.text', 'body': 'test', 'm.mentions': {}}, 'origin_server_ts': 1736059616879, 'unsigned': {'membership': 'join', 'age': 1392972}, 'event_id': '$x9KWoqnHlDWrve07GtsqHSSzNPGfClKYDi03zJRen08'}, {'type': 'm.room.message', 'sender': '@luna:localhost', 'content': {'msgtype': 'm.text', 'body': "Hello @evan:localhost, you said 'test' (auto-respond)."}, 'origin_server_ts': 1736059616899, 'unsigned': {'membership': 'join', 'age': 1392952, 'transaction_id': 'fe1eced8-0799-48ad-923b-fd290eb27fde'}, 'event_id': '$aHjPMhs-_dNMDk4WanqPLjfSPVpvm2yykt_MzwTz-8k'}, {'type': 'm.room.message', 'sender': '@evan:localhost', 'content': {'msgtype': 'm.text', 'body': 'hi privately', 'm.mentions': {}}, 'origin_server_ts': 1736059945689, 'unsigned': {'membership': 'join', 'age': 1064162}, 'event_id': '$BNRZdQHwlHN-A-IrkZUQFuwhaJ5rMAjTW9YovngPJxs'}, {'type': 'm.room.message', 'sender': '@luna:localhost', 'content': {'msgtype': 'm.text', 'body': "Hello @evan:localhost, you said 'hi privately' (auto-respond)."}, 'origin_server_ts': 1736059945710, 'unsigned': {'membership': 'join', 'age': 1064141, 'transaction_id': 'bd60b144-5229-461d-b036-43646ec2f439'}, 'event_id': '$MnnA07DcqxMsDv_ta-viJL_HufGbB-Z1NtNuSpsrVCg'}], 'prev_batch': 's77_202_36_46_64_1_1_17_0_1', 'limited': True}, 'state': {'events': [{'type': 'm.room.history_visibility', 'sender': '@evan:localhost', 'content': {'history_visibility': 'shared'}, 'state_key': '', 'origin_server_ts': 1736052751821, 'unsigned': {'age': 8258030}, 'event_id': '$ykzg9hb0g4xCy9jC3mO2gMpbmOV6GYPlqgQ90qcalfg'}, {'type': 'm.room.create', 'sender': '@evan:localhost', 'content': {'room_version': '10', 'creator': '@evan:localhost'}, 'state_key': '', 'origin_server_ts': 1736052751773, 'unsigned': {'age': 8258078}, 'event_id': '$__sN0iTtcNYm1zFh_4r6pW-jPfL80ilncF-o9lktU5c'}, {'type': 'm.room.member', 'sender': '@luna:localhost', 'content': {'displayname': 'luna', 'membership': 'join'}, 'state_key': '@luna:localhost', 'origin_server_ts': 1736057380062, 'unsigned': {'replaces_state': '$Onu9WGZwyumCrQGoNUUpMOxPBwx5f9YhtmY0UnVfOQo', 'age': 3629789}, 'event_id': '$7lSfWVf-YQE1Te1nNseWF1aY1XyyoxensnEHKsHHds4'}, {'type': 'm.room.join_rules', 'sender': '@evan:localhost', 'content': {'join_rule': 'invite'}, 'state_key': '', 'origin_server_ts': 1736052751821, 'unsigned': {'age': 8258030}, 'event_id': '$7nojP32lKzL3033GBqeYjoiWf3uxQ4tESU16FgC_INA'}, {'type': 'm.room.member', 'sender': '@evan:localhost', 'content': {'displayname': 'evan', 'membership': 'join'}, 'state_key': '@evan:localhost', 'origin_server_ts': 1736052751801, 'unsigned': {'age': 8258050}, 'event_id': '$j7fAv2HEqY8V1DI17DT4zijOlajgG9GVg41Q41j06a4'}, {'type': 'm.room.guest_access', 'sender': '@evan:localhost', 'content': {'guest_access': 'can_join'}, 'state_key': '', 'origin_server_ts': 1736052751822, 'unsigned': {'age': 8258029}, 'event_id': '$ccGh4WQIGUj5hBbN5BxUh0YrYv6WNQ2A9DgNz1ozQ4E'}, {'type': 'm.room.power_levels', 'sender': '@evan:localhost', 'content': {'users': {'@evan:localhost': 100, '@luna:localhost': 100}, 'users_default': 0, 'events': {'m.room.name': 50, 'm.room.avatar': 50, 'm.room.power_levels': 100, 'm.room.history_visibility': 100, 'm.room.canonical_alias': 50, 'm.room.tombstone': 100, 'm.room.server_acl': 100, 'm.room.encryption': 100, 'org.matrix.msc3401.call.member': 0, 'org.matrix.msc3401.call': 100}, 'events_default': 0, 'state_default': 50, 'ban': 50, 'kick': 50, 'redact': 50, 'invite': 0, 'historical': 100}, 'state_key': '', 'origin_server_ts': 1736052751815, 'unsigned': {'age': 8258036}, 'event_id': '$ANVxwJ3XZdDykqPe_Z6FPtzGY2NlNA5HUTJ62kTnKos'}]}, 'account_data': {'events': []}, 'ephemeral': {'events': [{'type': 'm.receipt', 'content': {'$MnnA07DcqxMsDv_ta-viJL_HufGbB-Z1NtNuSpsrVCg': {'m.read': {'@evan:localhost': {'ts': 1736059946234, 'thread_id': 'main'}}}}}]}, 'unread_notifications': {'notification_count': 19, 'highlight_count': 0}, 'summary': {}}, '!roKWYbjbZOVUoYPFtD:localhost': {'timeline': {'events': [{'type': 'm.room.encryption', 'sender': '@evan:localhost', 'content': {'algorithm': 'm.megolm.v1.aes-sha2'}, 'state_key': '', 'origin_server_ts': 1736053515322, 'unsigned': {'membership': 'leave', 'age': 7494529}, 'event_id': '$slPmN266Llp3KKO2lg03rJBq5SE7VnEZjdBOdm3J9KI'}, {'type': 'm.room.name', 'sender': '@evan:localhost', 'content': {'name': '123'}, 'state_key': '', 'origin_server_ts': 1736053515323, 'unsigned': {'membership': 'leave', 'age': 7494528}, 'event_id': '$q8hWvvAF2jEjQT1zwOTdZB3LvayLvQXQLSYV3-EMYYs'}, {'type': 'm.room.member', 'sender': '@evan:localhost', 'content': {'displayname': 'luna', 'membership': 'invite'}, 'state_key': '@luna:localhost', 'origin_server_ts': 1736057837779, 'unsigned': {'membership': 'invite', 'age': 3172072}, 'event_id': '$MrmZk9Z8K5RI4fN6iUDu1x9N7FaV92O9zMvaaBdHPLU'}, {'type': 'm.room.member', 'sender': '@luna:localhost', 'content': {'displayname': 'luna', 'membership': 'join'}, 'state_key': '@luna:localhost', 'origin_server_ts': 1736057837817, 'unsigned': {'replaces_state': '$MrmZk9Z8K5RI4fN6iUDu1x9N7FaV92O9zMvaaBdHPLU', 'prev_content': {'displayname': 'luna', 'membership': 'invite'}, 'prev_sender': '@evan:localhost', 'membership': 'join', 'age': 3172034}, 'event_id': '$6xskpedlvGLDqgK59L6fYdtgwEYBV6GMrWhW5-ztLdI'}, {'type': 'm.room.encrypted', 'sender': '@evan:localhost', 'content': {'algorithm': 'm.megolm.v1.aes-sha2', 'ciphertext': 'AwgAEpABxGvswh7xkRefT0u7PWqpyxughJgoJhsMP0gkkDNr+BTYv3cAntkhClwsWw8Of3N0Oe/wl3BYWkQTnMrO9ih66kxskUvBiACvIEuGelFAq6eGubPXsJEVo21RWnndsXJf1aZhVvWis8KMvsyg2DGicU2sXOcmJLhmRwIUW9gGqtSRqPfWe1f8XgHTVALLA7d0CBhlFBanNGW+Ho841pkZzpebOUlkQvYOOcBUi48bVLLC18237NK6BdflrfpbGxSvtyvmMLURATznj4MySsgyQblXnQcr0NwI', 'device_id': 'PULWHBXRQX', 'sender_key': 'Q9bL7OEfgVaLYj4UTR4aKA4ts7ECPDfd+XtrmMZ3aDg', 'session_id': 'dYpc59bb0+AusgLd9Kqz48Fit5hcjsWLZ831JrXJMGg'}, 'origin_server_ts': 1736057843994, 'unsigned': {'membership': 'join', 'age': 3165857}, 'event_id': '$ZU2Hc9VEGiqg3wBYFpiPxL2yoVDIzF4PBdSafx2kft8'}, {'type': 'm.room.encrypted', 'sender': '@evan:localhost', 'content': {'algorithm': 'm.megolm.v1.aes-sha2', 'ciphertext': 'AwgBEqABYwaU9FK+EyB3+XGt5wEfvVLZmEMLftNbZ67IhdhOOSRkYvVXsCmEw63vmxCLf0MDyrX62C/hqRSTtfH/FFGg7UG2nPfpoBzuudTQskyCRVXK9BZ6piEjIOryKfCMwfNqn5rLXyinvdilUnIf7y61L79G9tIjDlWfinhNLFu8BNQZZ5BzJ4GG2CC0WLiF9R0Lm84Ea+CM9zZQluedN5dcZKgSn3TRxZSuslNdX0aJSGBNr+k2XtYIdQ5n1O3a4Y2TmVP0MMlcwkLgvWVS7QomiwGXmVF8puRo4LbYEkruBs0sQkVB2+p0Cw', 'device_id': 'PULWHBXRQX', 'sender_key': 'Q9bL7OEfgVaLYj4UTR4aKA4ts7ECPDfd+XtrmMZ3aDg', 'session_id': 'dYpc59bb0+AusgLd9Kqz48Fit5hcjsWLZ831JrXJMGg'}, 'origin_server_ts': 1736058913018, 'unsigned': {'membership': 'join', 'age': 2096833}, 'event_id': '$x9fEJ3lIqsFUAIl0MH8ic1HOb0mlBf_11dB6lG5ankA'}, {'type': 'm.room.encrypted', 'sender': '@evan:localhost', 'content': {'algorithm': 'm.megolm.v1.aes-sha2', 'ciphertext': 'AwgCEpABfTK99KvE7cHkUzCa1QWtuBllyIV9L6A+HfHXCf0bkvGJZakNLpZaQtuocmgD3nz9YELXqCk+F/31TdWii+eEfYnpgWSszga2GVGwUgWj1efR23Ll57zmK4BbywkLZkTGRa3Z01qi7GlOQOmugYJU8P1kfzJyYATt57Vsx44VRT3WwQ6QqdyZMJ0S5c+JRG4gpsSICu4PanvnpRrmkiU7K3epoZFvdl96PgYJE423t0DJe72iaYopqduhzdB3vUiBcARJcXrHIjZmWsS4Ag/GVZ5UV8+IfnQH', 'device_id': 'PULWHBXRQX', 'sender_key': 'Q9bL7OEfgVaLYj4UTR4aKA4ts7ECPDfd+XtrmMZ3aDg', 'session_id': 'dYpc59bb0+AusgLd9Kqz48Fit5hcjsWLZ831JrXJMGg'}, 'origin_server_ts': 1736059561485, 'unsigned': {'membership': 'join', 'age': 1448366}, 'event_id': '$zGwcIHGSebl6OV-6sg6ANuNdR4jZalTgO4tFs0Jxy6E'}, {'type': 'm.room.encrypted', 'sender': '@evan:localhost', 'content': {'algorithm': 'm.megolm.v1.aes-sha2', 'ciphertext': 'AwgDEpAB07912A61nHk6FyUrHheASDFqPTTSMXkANWmxGfkmnp5PEsKj1erHakX3FAt/CabwV47PvoJB7TWIblLrSPmC/FD+VMha6aCTRxu49/2DFx05T/XcQx8kr2MjUpD8BsLXjs0F7CZgN0FM2OfQ/c5Kya2J0bsGtSiTVLI927eGlxyvopXhIbXD8hPXmhhOkhbIIXN/MkFHaLoqOtIwYpBwz0C9hUS1r+bCGX7SRJQtJoL+Gwjm3Azv6OmLTiZiLKZoNjOLpktnUqxpywVCb0V8JaEOswf4oTQE', 'device_id': 'PULWHBXRQX', 'sender_key': 'Q9bL7OEfgVaLYj4UTR4aKA4ts7ECPDfd+XtrmMZ3aDg', 'session_id': 'dYpc59bb0+AusgLd9Kqz48Fit5hcjsWLZ831JrXJMGg'}, 'origin_server_ts': 1736059613140, 'unsigned': {'membership': 'join', 'age': 1396711}, 'event_id': '$3kbzXBSh1CKI7ODGycR7ENpqvQSD6iP8qxIG9iJl37Y'}, {'type': 'm.room.encrypted', 'sender': '@evan:localhost', 'content': {'algorithm': 'm.megolm.v1.aes-sha2', 'ciphertext': 'AwgEEpABsZ9TlknUeh0KnJ5fzBfT4lBPdDOTgK6/tFrK7I5Jh4AffzWKj1QABOT3DI5CvIdQXDwhiyPGMzFcdNPJIPT3dLOpLrE/MYJUW3LMcy8P05cwJZx1OJ0k5YD3iKHdh2x8zxZo57rreiB9M76KtNijo12F9N5+00uqrERi6h2NmajGZULyEYB0rxgvOjJMm0k+COV6bFetWJmnqt2zLUW0Wn+O1Qq4xDh/W/oif84jEyjT++RaYEURqhp/JUG1jJhTw+nLxmLSHa9RKk5U7+pYm4FnfzOW/hQD', 'device_id': 'PULWHBXRQX', 'sender_key': 'Q9bL7OEfgVaLYj4UTR4aKA4ts7ECPDfd+XtrmMZ3aDg', 'session_id': 'dYpc59bb0+AusgLd9Kqz48Fit5hcjsWLZ831JrXJMGg'}, 'origin_server_ts': 1736059940174, 'unsigned': {'membership': 'join', 'age': 1069677}, 'event_id': '$RU2Y-RYT1c-uqkTn8AntDw5yNgpzOqeL5Fx60bs6hc8'}, {'type': 'm.room.member', 'sender': '@evan:localhost', 'content': {'membership': 'leave'}, 'state_key': '@evan:localhost', 'origin_server_ts': 1736060098561, 'unsigned': {'replaces_state': '$NEBr5thdeWLJ4lk87FiH_u-eFWHvJhkAmfj7VpMJw3k', 'prev_content': {'displayname': 'evan', 'membership': 'join'}, 'prev_sender': '@evan:localhost', 'membership': 'join', 'age': 911290}, 'event_id': '$eZQI_iSx3J3Xf89XfvaJKJTDIMMjYXwc3PCv22PsWFQ'}], 'prev_batch': 's16_202_36_46_64_1_1_17_0_1', 'limited': True}, 'state': {'events': [{'type': 'm.room.history_visibility', 'sender': '@evan:localhost', 'content': {'history_visibility': 'shared'}, 'state_key': '', 'origin_server_ts': 1736053515322, 'unsigned': {'age': 7494529}, 'event_id': '$wTTK2Na2mInVBYG4ag1qSLjTHOqDyh1wy16ue-N2wXk'}, {'type': 'm.room.member', 'sender': '@evan:localhost', 'content': {'displayname': 'evan', 'membership': 'join'}, 'state_key': '@evan:localhost', 'origin_server_ts': 1736053515299, 'unsigned': {'age': 7494552}, 'event_id': '$NEBr5thdeWLJ4lk87FiH_u-eFWHvJhkAmfj7VpMJw3k'}, {'type': 'm.room.join_rules', 'sender': '@evan:localhost', 'content': {'join_rule': 'invite'}, 'state_key': '', 'origin_server_ts': 1736053515322, 'unsigned': {'age': 7494529}, 'event_id': '$P5aiLlSAUOXxBImpDNF3gDATGV61b6brjF5D_LMKhVA'}, {'type': 'm.room.create', 'sender': '@evan:localhost', 'content': {'room_version': '10', 'creator': '@evan:localhost'}, 'state_key': '', 'origin_server_ts': 1736053515270, 'unsigned': {'age': 7494581}, 'event_id': '$VPNVhyDIVe4I9BJJE4UBLHfQRlpaEuOSqJq--_KUb6A'}, {'type': 'm.room.power_levels', 'sender': '@evan:localhost', 'content': {'users': {'@evan:localhost': 100}, 'users_default': 0, 'events': {'m.room.name': 50, 'm.room.avatar': 50, 'm.room.power_levels': 100, 'm.room.history_visibility': 100, 'm.room.canonical_alias': 50, 'm.room.tombstone': 100, 'm.room.server_acl': 100, 'm.room.encryption': 100, 'org.matrix.msc3401.call.member': 0, 'org.matrix.msc3401.call': 100}, 'events_default': 0, 'state_default': 50, 'ban': 50, 'kick': 50, 'redact': 50, 'invite': 0, 'historical': 100}, 'state_key': '', 'origin_server_ts': 1736053515313, 'unsigned': {'age': 7494538}, 'event_id': '$Cr4-TnRYtloOopYJY4fUjVRHCOgVkahVqMSuKNaX7vo'}, {'type': 'm.room.guest_access', 'sender': '@evan:localhost', 'content': {'guest_access': 'can_join'}, 'state_key': '', 'origin_server_ts': 1736053515322, 'unsigned': {'age': 7494529}, 'event_id': '$pRJ816TPGDnlKnf_01Cn76hocngd5hRNW9PuFN_yfYE'}]}, 'account_data': {'events': []}, 'ephemeral': {'events': [{'type': 'm.receipt', 'content': {'$RU2Y-RYT1c-uqkTn8AntDw5yNgpzOqeL5Fx60bs6hc8': {'m.read': {'@evan:localhost': {'ts': 1736060005334, 'thread_id': 'main'}}}}}]}, 'unread_notifications': {'notification_count': 6, 'highlight_count': 0}, 'summary': {}}}}}
2025-01-05 02:10:09,860 [INFO] nio.client.base_client: New joined room !ZhsKXLoMEydpudauIE:localhost
2025-01-05 02:10:09,860 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomAliasEvent
2025-01-05 02:10:09,860 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomCreateEvent
2025-01-05 02:10:09,861 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomJoinRulesEvent
2025-01-05 02:10:09,861 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-05 02:10:09,861 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type PowerLevelsEvent
2025-01-05 02:10:09,861 [INFO] nio.rooms: Changing power level for user @evan:localhost from 0 to 100
2025-01-05 02:10:09,861 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomNameEvent
2025-01-05 02:10:09,861 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:10:09,861 [DEBUG] src.luna_functions: Got an event of type: <class 'nio.events.room_events.RoomMessageText'>, content: {'type': 'm.room.message', 'sender': '@evan:localhost', 'content': {'msgtype': 'm.text', 'body': 'test', 'm.mentions': {}}, 'origin_server_ts': 1736060562994, 'unsigned': {'membership': 'join', 'age': 446857}, 'event_id': '$A8Dhrt8h9fPbsAJYbpe0WM5QSW69P_JO7WLO_9Kn7gc'}
2025-01-05 02:10:09,861 [INFO] src.luna_functions: Received message in !ZhsKXLoMEydpudauIE:localhost from @evan:localhost: test
2025-01-05 02:10:09,861 [INFO] root: Pretending to prompt GPT! with API key: POOPYBUTTHOLE
2025-01-05 02:10:09,861 [DEBUG] src.luna_functions: Sending response: Hello @evan:localhost, you said 'test' (auto-respond).
2025-01-05 02:10:09,871 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:10:09,871 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:10:09,871 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:10:09,871 [DEBUG] src.luna_functions: Got an event of type: <class 'nio.events.room_events.RoomMessageText'>, content: {'type': 'm.room.message', 'sender': '@evan:localhost', 'content': {'msgtype': 'm.text', 'body': 'test', 'm.mentions': {}}, 'origin_server_ts': 1736060637036, 'unsigned': {'membership': 'join', 'age': 372815}, 'event_id': '$AOYmZ841VNVxuXMF_cfPhYtI4bGC43XHukLkGcGKpoY'}
2025-01-05 02:10:09,871 [INFO] src.luna_functions: Received message in !ZhsKXLoMEydpudauIE:localhost from @evan:localhost: test
2025-01-05 02:10:09,871 [INFO] root: Pretending to prompt GPT! with API key: POOPYBUTTHOLE
2025-01-05 02:10:09,871 [DEBUG] src.luna_functions: Sending response: Hello @evan:localhost, you said 'test' (auto-respond).
2025-01-05 02:10:09,885 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:10:09,885 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:10:09,885 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:10:09,885 [DEBUG] src.luna_functions: Got an event of type: <class 'nio.events.room_events.RoomMessageText'>, content: {'type': 'm.room.message', 'sender': '@evan:localhost', 'content': {'msgtype': 'm.text', 'body': 'test', 'm.mentions': {}}, 'origin_server_ts': 1736060641189, 'unsigned': {'membership': 'join', 'age': 368662}, 'event_id': '$5rQuASsUeKyY_BSTUA3qu7fHMna-WMNyxjUoiwXQXpc'}
2025-01-05 02:10:09,885 [INFO] src.luna_functions: Received message in !ZhsKXLoMEydpudauIE:localhost from @evan:localhost: test
2025-01-05 02:10:09,885 [INFO] root: Pretending to prompt GPT! with API key: POOPYBUTTHOLE
2025-01-05 02:10:09,885 [DEBUG] src.luna_functions: Sending response: Hello @evan:localhost, you said 'test' (auto-respond).
2025-01-05 02:10:09,895 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:10:09,896 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:10:09,896 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:10:09,896 [DEBUG] src.luna_functions: Got an event of type: <class 'nio.events.room_events.RoomMessageText'>, content: {'type': 'm.room.message', 'sender': '@evan:localhost', 'content': {'msgtype': 'm.text', 'body': 'test', 'm.mentions': {}}, 'origin_server_ts': 1736060641921, 'unsigned': {'membership': 'join', 'age': 367930}, 'event_id': '$G--BFiNJpgmpDzMHjw8-3w_0j6m3MIrC5JEhuVuTBVI'}
2025-01-05 02:10:09,896 [INFO] src.luna_functions: Received message in !ZhsKXLoMEydpudauIE:localhost from @evan:localhost: test
2025-01-05 02:10:09,896 [INFO] root: Pretending to prompt GPT! with API key: POOPYBUTTHOLE
2025-01-05 02:10:09,896 [DEBUG] src.luna_functions: Sending response: Hello @evan:localhost, you said 'test' (auto-respond).
2025-01-05 02:10:09,907 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:10:09,907 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:10:09,907 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:10:09,908 [DEBUG] src.luna_functions: Got an event of type: <class 'nio.events.room_events.RoomMessageText'>, content: {'type': 'm.room.message', 'sender': '@evan:localhost', 'content': {'msgtype': 'm.text', 'body': 'test', 'm.mentions': {}}, 'origin_server_ts': 1736060807613, 'unsigned': {'membership': 'join', 'age': 202238}, 'event_id': '$AkKt_f-Qd0mh7TRT1BFcFNGxnbvk03LPM_Ted83Mwhw'}
2025-01-05 02:10:09,908 [INFO] src.luna_functions: Received message in !ZhsKXLoMEydpudauIE:localhost from @evan:localhost: test
2025-01-05 02:10:09,908 [INFO] root: Pretending to prompt GPT! with API key: POOPYBUTTHOLE
2025-01-05 02:10:09,908 [DEBUG] src.luna_functions: Sending response: Hello @evan:localhost, you said 'test' (auto-respond).
2025-01-05 02:10:09,939 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:10:09,940 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:10:09,940 [INFO] nio.client.base_client: New joined room !vqsQaVVLtsvWxIoJwV:localhost
2025-01-05 02:10:09,940 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type PowerLevelsEvent
2025-01-05 02:10:09,940 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomCreateEvent
2025-01-05 02:10:09,940 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomJoinRulesEvent
2025-01-05 02:10:09,940 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-05 02:10:09,940 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomGuestAccessEvent
2025-01-05 02:10:09,940 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomEncryptionEvent
2025-01-05 02:10:09,940 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomNameEvent
2025-01-05 02:10:09,940 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type MegolmEvent
2025-01-05 02:10:09,940 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type MegolmEvent
2025-01-05 02:10:09,940 [INFO] nio.client.base_client: New joined room !IQTJHuSCcTLlkCZzzF:localhost
2025-01-05 02:10:09,940 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-05 02:10:09,940 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomCreateEvent
2025-01-05 02:10:09,940 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomJoinRulesEvent
2025-01-05 02:10:09,940 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomGuestAccessEvent
2025-01-05 02:10:09,940 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type PowerLevelsEvent
2025-01-05 02:10:09,940 [INFO] nio.rooms: Changing power level for user @evan:localhost from 0 to 100
2025-01-05 02:10:09,940 [INFO] nio.rooms: Changing power level for user @luna:localhost from 0 to 100
2025-01-05 02:10:09,940 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:10:09,940 [DEBUG] src.luna_functions: Got an event of type: <class 'nio.events.room_events.RoomMessageText'>, content: {'type': 'm.room.message', 'sender': '@evan:localhost', 'content': {'msgtype': 'm.text', 'body': 'test', 'm.mentions': {}}, 'origin_server_ts': 1736059402451, 'unsigned': {'membership': 'join', 'age': 1607400}, 'event_id': '$-Y7R3HKfRa7i141j5ZZLnd7MTvBq4phdT6iEi6rfmYU'}
2025-01-05 02:10:09,940 [INFO] src.luna_functions: Received message in !IQTJHuSCcTLlkCZzzF:localhost from @evan:localhost: test
2025-01-05 02:10:09,940 [INFO] root: Pretending to prompt GPT! with API key: POOPYBUTTHOLE
2025-01-05 02:10:09,940 [DEBUG] src.luna_functions: Sending response: Hello @evan:localhost, you said 'test' (auto-respond).
2025-01-05 02:10:09,950 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:10:09,950 [DEBUG] src.luna_functions: Got an event of type: <class 'nio.events.room_events.RoomMessageText'>, content: {'type': 'm.room.message', 'sender': '@evan:localhost', 'content': {'msgtype': 'm.text', 'body': 'test', 'm.mentions': {}}, 'origin_server_ts': 1736059408062, 'unsigned': {'membership': 'join', 'age': 1601789}, 'event_id': '$HpqOtqUT1e1RlTMfzVU-e0oPYAEN45tST8FVJPOXKXU'}
2025-01-05 02:10:09,950 [INFO] src.luna_functions: Received message in !IQTJHuSCcTLlkCZzzF:localhost from @evan:localhost: test
2025-01-05 02:10:09,950 [INFO] root: Pretending to prompt GPT! with API key: POOPYBUTTHOLE
2025-01-05 02:10:09,950 [DEBUG] src.luna_functions: Sending response: Hello @evan:localhost, you said 'test' (auto-respond).
2025-01-05 02:10:09,961 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:10:09,961 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:10:09,961 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:10:09,961 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:10:09,961 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:10:09,961 [DEBUG] src.luna_functions: Got an event of type: <class 'nio.events.room_events.RoomMessageText'>, content: {'type': 'm.room.message', 'sender': '@evan:localhost', 'content': {'msgtype': 'm.text', 'body': 'hi', 'm.mentions': {}}, 'origin_server_ts': 1736059416557, 'unsigned': {'membership': 'join', 'age': 1593294}, 'event_id': '$k7ZdYE8zOoPbSBdg4r6BXYWliXgR7e5cmZwpnr8ouU8'}
2025-01-05 02:10:09,961 [INFO] src.luna_functions: Received message in !IQTJHuSCcTLlkCZzzF:localhost from @evan:localhost: hi
2025-01-05 02:10:09,962 [INFO] root: Pretending to prompt GPT! with API key: POOPYBUTTHOLE
2025-01-05 02:10:09,962 [DEBUG] src.luna_functions: Sending response: Hello @evan:localhost, you said 'hi' (auto-respond).
2025-01-05 02:10:09,971 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:10:09,971 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:10:09,971 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:10:09,971 [DEBUG] src.luna_functions: Got an event of type: <class 'nio.events.room_events.RoomMessageText'>, content: {'type': 'm.room.message', 'sender': '@evan:localhost', 'content': {'msgtype': 'm.text', 'body': 'test', 'm.mentions': {}}, 'origin_server_ts': 1736059616879, 'unsigned': {'membership': 'join', 'age': 1392972}, 'event_id': '$x9KWoqnHlDWrve07GtsqHSSzNPGfClKYDi03zJRen08'}
2025-01-05 02:10:09,971 [INFO] src.luna_functions: Received message in !IQTJHuSCcTLlkCZzzF:localhost from @evan:localhost: test
2025-01-05 02:10:09,971 [INFO] root: Pretending to prompt GPT! with API key: POOPYBUTTHOLE
2025-01-05 02:10:09,971 [DEBUG] src.luna_functions: Sending response: Hello @evan:localhost, you said 'test' (auto-respond).
2025-01-05 02:10:09,985 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:10:09,985 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:10:09,985 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:10:09,985 [DEBUG] src.luna_functions: Got an event of type: <class 'nio.events.room_events.RoomMessageText'>, content: {'type': 'm.room.message', 'sender': '@evan:localhost', 'content': {'msgtype': 'm.text', 'body': 'hi privately', 'm.mentions': {}}, 'origin_server_ts': 1736059945689, 'unsigned': {'membership': 'join', 'age': 1064162}, 'event_id': '$BNRZdQHwlHN-A-IrkZUQFuwhaJ5rMAjTW9YovngPJxs'}
2025-01-05 02:10:09,985 [INFO] src.luna_functions: Received message in !IQTJHuSCcTLlkCZzzF:localhost from @evan:localhost: hi privately
2025-01-05 02:10:09,985 [INFO] root: Pretending to prompt GPT! with API key: POOPYBUTTHOLE
2025-01-05 02:10:09,985 [DEBUG] src.luna_functions: Sending response: Hello @evan:localhost, you said 'hi privately' (auto-respond).
2025-01-05 02:10:10,002 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:10:10,003 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:10:10,003 [INFO] nio.client.base_client: New joined room !roKWYbjbZOVUoYPFtD:localhost
2025-01-05 02:10:10,003 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-05 02:10:10,003 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type RoomJoinRulesEvent
2025-01-05 02:10:10,003 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type RoomCreateEvent
2025-01-05 02:10:10,003 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type PowerLevelsEvent
2025-01-05 02:10:10,003 [INFO] nio.rooms: Changing power level for user @evan:localhost from 0 to 100
2025-01-05 02:10:10,003 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type RoomGuestAccessEvent
2025-01-05 02:10:10,003 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type RoomEncryptionEvent
2025-01-05 02:10:10,003 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type RoomNameEvent
2025-01-05 02:10:10,003 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type MegolmEvent
2025-01-05 02:10:10,003 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type MegolmEvent
2025-01-05 02:10:10,003 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type MegolmEvent
2025-01-05 02:10:10,003 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type MegolmEvent
2025-01-05 02:10:10,003 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type MegolmEvent
2025-01-05 02:10:10,005 [DEBUG] nio.responses: Validating response schema {'type': 'object', 'properties': {'device_one_time_keys_count': {'type': 'object', 'default': {}, 'properties': {'curve25519': {'type': 'integer'}, 'signed_curve25519': {'type': 'integer'}}}, 'device_lists': {'type': 'object', 'default': {}, 'properties': {'changed': {'type': 'array', 'items': {'type': 'string'}}, 'left': {'type': 'array', 'items': {'type': 'string'}}}}, 'next_batch': {'type': 'string'}, 'rooms': {'type': 'object', 'default': {}, 'properties': {'invite': {'type': 'object', 'default': {}, 'patternProperties': {'^!.+:.+$': {'type': 'object', 'properties': {'invite_state': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}}}}}, 'join': {'type': 'object', 'default': {}, 'patternProperties': {'^!.+:.+$': {'type': 'object', 'properties': {'timeline': {'type': 'object', 'properties': {'events': {'type': 'array'}, 'limited': {'type': 'boolean'}, 'prev_batch': {'type': 'string'}}, 'required': ['events']}, 'state': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'ephemeral': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'summary': {'type': 'object', 'properties': {'m.invited_member_count': {'type': 'integer'}, 'm.joined_member_count': {'type': 'integer'}, 'm.heroes': {'type': 'array', 'items': {'type': 'string'}}}}, 'account_data': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}}}}}, 'leave': {'type': 'object', 'default': {}, 'patternProperties': {'^!.+:.+$': {'type': 'object', 'properties': {'timeline': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'state': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}}}}}}}, 'to_device': {'type': 'object', 'default': {'events': []}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'presence': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}}, 'required': ['next_batch']}: {'next_batch': 's128_202_36_46_64_1_1_17_0_1', 'device_one_time_keys_count': {'signed_curve25519': 0}, 'org.matrix.msc2732.device_unused_fallback_key_types': [], 'device_unused_fallback_key_types': [], 'rooms': {'join': {'!ZhsKXLoMEydpudauIE:localhost': {'timeline': {'events': [{'type': 'm.room.message', 'sender': '@luna:localhost', 'content': {'msgtype': 'm.text', 'body': "Hello @evan:localhost, you said 'test' (auto-respond)."}, 'origin_server_ts': 1736061009863, 'unsigned': {'membership': 'join', 'age': 141, 'transaction_id': '93f113b8-29ec-419d-9d84-fc4beafe230c'}, 'event_id': '$tA_upCdZmulS89Icjz0CeDMh1OtVokTLiQueEig6BnM'}], 'prev_batch': 's127_202_36_46_64_1_1_17_0_1', 'limited': False}, 'state': {'events': []}, 'account_data': {'events': []}, 'ephemeral': {'events': []}, 'unread_notifications': {'notification_count': 8, 'highlight_count': 0}, 'summary': {}}}}}
2025-01-05 02:10:10,005 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:10:10,005 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:10:10,012 [DEBUG] nio.responses: Validating response schema {'type': 'object', 'properties': {'device_one_time_keys_count': {'type': 'object', 'default': {}, 'properties': {'curve25519': {'type': 'integer'}, 'signed_curve25519': {'type': 'integer'}}}, 'device_lists': {'type': 'object', 'default': {}, 'properties': {'changed': {'type': 'array', 'items': {'type': 'string'}}, 'left': {'type': 'array', 'items': {'type': 'string'}}}}, 'next_batch': {'type': 'string'}, 'rooms': {'type': 'object', 'default': {}, 'properties': {'invite': {'type': 'object', 'default': {}, 'patternProperties': {'^!.+:.+$': {'type': 'object', 'properties': {'invite_state': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}}}}}, 'join': {'type': 'object', 'default': {}, 'patternProperties': {'^!.+:.+$': {'type': 'object', 'properties': {'timeline': {'type': 'object', 'properties': {'events': {'type': 'array'}, 'limited': {'type': 'boolean'}, 'prev_batch': {'type': 'string'}}, 'required': ['events']}, 'state': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'ephemeral': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'summary': {'type': 'object', 'properties': {'m.invited_member_count': {'type': 'integer'}, 'm.joined_member_count': {'type': 'integer'}, 'm.heroes': {'type': 'array', 'items': {'type': 'string'}}}}, 'account_data': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}}}}}, 'leave': {'type': 'object', 'default': {}, 'patternProperties': {'^!.+:.+$': {'type': 'object', 'properties': {'timeline': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'state': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}}}}}}}, 'to_device': {'type': 'object', 'default': {'events': []}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'presence': {'type': 'object', 'default': {'events': []}, 'properties': {'events': {'type': 'array', 'default': []}}}}, 'required': ['next_batch']}: {'next_batch': 's137_202_36_46_64_1_1_17_0_1', 'device_one_time_keys_count': {'signed_curve25519': 0}, 'org.matrix.msc2732.device_unused_fallback_key_types': [], 'device_unused_fallback_key_types': [], 'rooms': {'join': {'!IQTJHuSCcTLlkCZzzF:localhost': {'timeline': {'events': [{'type': 'm.room.message', 'sender': '@luna:localhost', 'content': {'msgtype': 'm.text', 'body': "Hello @evan:localhost, you said 'test' (auto-respond)."}, 'origin_server_ts': 1736061009943, 'unsigned': {'membership': 'join', 'age': 67, 'transaction_id': 'a553d130-cab5-4b8c-9a41-7982657f6936'}, 'event_id': '$u_U8zTnrJ3_aSFovbj23390ZxL8FqgVgVwG7iZamuzc'}, {'type': 'm.room.message', 'sender': '@luna:localhost', 'content': {'msgtype': 'm.text', 'body': "Hello @evan:localhost, you said 'test' (auto-respond)."}, 'origin_server_ts': 1736061009952, 'unsigned': {'membership': 'join', 'age': 58, 'transaction_id': '2084c7ce-ddb3-4cb8-9813-5fbe677b59bd'}, 'event_id': '$FNFVvPvSPAXHw80DsLIJbVSPBMOAzRgtzfgRFobU3-Y'}, {'type': 'm.room.message', 'sender': '@luna:localhost', 'content': {'msgtype': 'm.text', 'body': "Hello @evan:localhost, you said 'hi' (auto-respond)."}, 'origin_server_ts': 1736061009963, 'unsigned': {'membership': 'join', 'age': 47, 'transaction_id': '412135bb-446e-49de-8cd8-ef34408fc5bd'}, 'event_id': '$e1ukvyYrUB_T0FkmUhk1VAeNBtgJixPHbRfEY76EXhU'}, {'type': 'm.room.message', 'sender': '@luna:localhost', 'content': {'msgtype': 'm.text', 'body': "Hello @evan:localhost, you said 'test' (auto-respond)."}, 'origin_server_ts': 1736061009973, 'unsigned': {'membership': 'join', 'age': 37, 'transaction_id': 'd7598d88-724b-4014-a45e-8bebb8f2fe39'}, 'event_id': '$I8RunK2wCUOWN2MhQw341AfdlLY1OkR25GV13IAlY5c'}, {'type': 'm.room.message', 'sender': '@luna:localhost', 'content': {'msgtype': 'm.text', 'body': "Hello @evan:localhost, you said 'hi privately' (auto-respond)."}, 'origin_server_ts': 1736061009987, 'unsigned': {'membership': 'join', 'age': 23, 'transaction_id': '3b620c87-45a9-4ae9-a519-8a0088e76a28'}, 'event_id': '$jlhRxvKercHJ6KZnqVEdBpuZ6D6klSNJix5B3K9kpWk'}], 'prev_batch': 's132_202_36_46_64_1_1_17_0_1', 'limited': False}, 'state': {'events': []}, 'account_data': {'events': []}, 'ephemeral': {'events': []}, 'unread_notifications': {'notification_count': 19, 'highlight_count': 0}, 'summary': {}}, '!ZhsKXLoMEydpudauIE:localhost': {'timeline': {'events': [{'type': 'm.room.message', 'sender': '@luna:localhost', 'content': {'msgtype': 'm.text', 'body': "Hello @evan:localhost, you said 'test' (auto-respond)."}, 'origin_server_ts': 1736061009874, 'unsigned': {'membership': 'join', 'age': 136, 'transaction_id': '182ea093-7aa5-4cc1-aa68-67ff8328b70b'}, 'event_id': '$UFazohm-eF8uomr7FAAGFq7clchjsJTO0J7fsckVr6w'}, {'type': 'm.room.message', 'sender': '@luna:localhost', 'content': {'msgtype': 'm.text', 'body': "Hello @evan:localhost, you said 'test' (auto-respond)."}, 'origin_server_ts': 1736061009887, 'unsigned': {'membership': 'join', 'age': 123, 'transaction_id': '762fcbf3-926f-4598-9849-704ec657fde0'}, 'event_id': '$rOqIs76pD5LifVbEFQlRMCqbVdd9lheRW4aqEbt-YqQ'}, {'type': 'm.room.message', 'sender': '@luna:localhost', 'content': {'msgtype': 'm.text', 'body': "Hello @evan:localhost, you said 'test' (auto-respond)."}, 'origin_server_ts': 1736061009898, 'unsigned': {'membership': 'join', 'age': 112, 'transaction_id': '410a9b93-1eb6-4f68-b9cc-b336aa603911'}, 'event_id': '$gQIjA4eZwBdwUezipgAGRksLfPSQCeagjlLYoqJBy34'}, {'type': 'm.room.message', 'sender': '@luna:localhost', 'content': {'msgtype': 'm.text', 'body': "Hello @evan:localhost, you said 'test' (auto-respond)."}, 'origin_server_ts': 1736061009911, 'unsigned': {'membership': 'join', 'age': 99, 'transaction_id': 'd2eb45c6-6db2-4770-8413-08dd2ad6f7bc'}, 'event_id': '$oaNxofgwTalCjhfYUbc2subS8A5ei9p70fCXqTrZrz8'}], 'prev_batch': 's128_202_36_46_64_1_1_17_0_1', 'limited': False}, 'state': {'events': []}, 'account_data': {'events': []}, 'ephemeral': {'events': []}, 'unread_notifications': {'notification_count': 8, 'highlight_count': 0}, 'summary': {}}}}}
2025-01-05 02:10:10,015 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:10:10,015 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:10:10,015 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:10:10,015 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:10:10,015 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:10:10,015 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:10:10,016 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:10:10,016 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:10:10,016 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:10:10,016 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:10:10,016 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:10:10,016 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:10:10,017 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:10:10,017 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:10:10,017 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:10:10,017 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:10:10,017 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:10:10,017 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:10:40,034 [DEBUG] nio.responses: Validating response schema {'type': 'object', 'properties': {'device_one_time_keys_count': {'type': 'object', 'default': {}, 'properties': {'curve25519': {'type': 'integer'}, 'signed_curve25519': {'type': 'integer'}}}, 'device_lists': {'type': 'object', 'default': {}, 'properties': {'changed': {'type': 'array', 'items': {'type': 'string'}}, 'left': {'type': 'array', 'items': {'type': 'string'}}}}, 'next_batch': {'type': 'string'}, 'rooms': {'type': 'object', 'default': {}, 'properties': {'invite': {'type': 'object', 'default': {}, 'patternProperties': {'^!.+:.+$': {'type': 'object', 'properties': {'invite_state': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}}}}}, 'join': {'type': 'object', 'default': {}, 'patternProperties': {'^!.+:.+$': {'type': 'object', 'properties': {'timeline': {'type': 'object', 'properties': {'events': {'type': 'array'}, 'limited': {'type': 'boolean'}, 'prev_batch': {'type': 'string'}}, 'required': ['events']}, 'state': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'ephemeral': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'summary': {'type': 'object', 'properties': {'m.invited_member_count': {'type': 'integer'}, 'm.joined_member_count': {'type': 'integer'}, 'm.heroes': {'type': 'array', 'items': {'type': 'string'}}}}, 'account_data': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}}}}}, 'leave': {'type': 'object', 'default': {}, 'patternProperties': {'^!.+:.+$': {'type': 'object', 'properties': {'timeline': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'state': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}}}}}}}, 'to_device': {'type': 'object', 'default': {'events': []}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'presence': {'type': 'object', 'default': {'events': []}, 'properties': {'events': {'type': 'array', 'default': []}}}}, 'required': ['next_batch']}: {'next_batch': 's137_204_36_46_64_1_1_17_0_1', 'presence': {'events': [{'type': 'm.presence', 'sender': '@evan:localhost', 'content': {'presence': 'unavailable', 'last_active_ago': 81687}}, {'type': 'm.presence', 'sender': '@luna:localhost', 'content': {'presence': 'online', 'last_active_ago': 30007, 'currently_active': True}}]}, 'device_one_time_keys_count': {'signed_curve25519': 0}, 'org.matrix.msc2732.device_unused_fallback_key_types': [], 'device_unused_fallback_key_types': []}
2025-01-05 02:11:10,048 [DEBUG] nio.responses: Validating response schema {'type': 'object', 'properties': {'device_one_time_keys_count': {'type': 'object', 'default': {}, 'properties': {'curve25519': {'type': 'integer'}, 'signed_curve25519': {'type': 'integer'}}}, 'device_lists': {'type': 'object', 'default': {}, 'properties': {'changed': {'type': 'array', 'items': {'type': 'string'}}, 'left': {'type': 'array', 'items': {'type': 'string'}}}}, 'next_batch': {'type': 'string'}, 'rooms': {'type': 'object', 'default': {'invite': {}, 'join': {}, 'leave': {}}, 'properties': {'invite': {'type': 'object', 'default': {}, 'patternProperties': {'^!.+:.+$': {'type': 'object', 'properties': {'invite_state': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}}}}}, 'join': {'type': 'object', 'default': {}, 'patternProperties': {'^!.+:.+$': {'type': 'object', 'properties': {'timeline': {'type': 'object', 'properties': {'events': {'type': 'array'}, 'limited': {'type': 'boolean'}, 'prev_batch': {'type': 'string'}}, 'required': ['events']}, 'state': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'ephemeral': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'summary': {'type': 'object', 'properties': {'m.invited_member_count': {'type': 'integer'}, 'm.joined_member_count': {'type': 'integer'}, 'm.heroes': {'type': 'array', 'items': {'type': 'string'}}}}, 'account_data': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}}}}}, 'leave': {'type': 'object', 'default': {}, 'patternProperties': {'^!.+:.+$': {'type': 'object', 'properties': {'timeline': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'state': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}}}}}}}, 'to_device': {'type': 'object', 'default': {'events': []}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'presence': {'type': 'object', 'default': {'events': []}, 'properties': {'events': {'type': 'array', 'default': []}}}}, 'required': ['next_batch']}: {'next_batch': 's137_204_36_46_64_1_1_17_0_1', 'device_one_time_keys_count': {'signed_curve25519': 0}, 'org.matrix.msc2732.device_unused_fallback_key_types': [], 'device_unused_fallback_key_types': []}
2025-01-05 02:11:40,069 [DEBUG] nio.responses: Validating response schema {'type': 'object', 'properties': {'device_one_time_keys_count': {'type': 'object', 'default': {}, 'properties': {'curve25519': {'type': 'integer'}, 'signed_curve25519': {'type': 'integer'}}}, 'device_lists': {'type': 'object', 'default': {}, 'properties': {'changed': {'type': 'array', 'items': {'type': 'string'}}, 'left': {'type': 'array', 'items': {'type': 'string'}}}}, 'next_batch': {'type': 'string'}, 'rooms': {'type': 'object', 'default': {'invite': {}, 'join': {}, 'leave': {}}, 'properties': {'invite': {'type': 'object', 'default': {}, 'patternProperties': {'^!.+:.+$': {'type': 'object', 'properties': {'invite_state': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}}}}}, 'join': {'type': 'object', 'default': {}, 'patternProperties': {'^!.+:.+$': {'type': 'object', 'properties': {'timeline': {'type': 'object', 'properties': {'events': {'type': 'array'}, 'limited': {'type': 'boolean'}, 'prev_batch': {'type': 'string'}}, 'required': ['events']}, 'state': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'ephemeral': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'summary': {'type': 'object', 'properties': {'m.invited_member_count': {'type': 'integer'}, 'm.joined_member_count': {'type': 'integer'}, 'm.heroes': {'type': 'array', 'items': {'type': 'string'}}}}, 'account_data': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}}}}}, 'leave': {'type': 'object', 'default': {}, 'patternProperties': {'^!.+:.+$': {'type': 'object', 'properties': {'timeline': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'state': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}}}}}}}, 'to_device': {'type': 'object', 'default': {'events': []}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'presence': {'type': 'object', 'default': {'events': []}, 'properties': {'events': {'type': 'array', 'default': []}}}}, 'required': ['next_batch']}: {'next_batch': 's137_204_36_46_64_1_1_17_0_1', 'device_one_time_keys_count': {'signed_curve25519': 0}, 'org.matrix.msc2732.device_unused_fallback_key_types': [], 'device_unused_fallback_key_types': []}
2025-01-05 02:11:40,084 [DEBUG] nio.responses: Validating response schema {'type': 'object', 'properties': {'device_one_time_keys_count': {'type': 'object', 'default': {}, 'properties': {'curve25519': {'type': 'integer'}, 'signed_curve25519': {'type': 'integer'}}}, 'device_lists': {'type': 'object', 'default': {}, 'properties': {'changed': {'type': 'array', 'items': {'type': 'string'}}, 'left': {'type': 'array', 'items': {'type': 'string'}}}}, 'next_batch': {'type': 'string'}, 'rooms': {'type': 'object', 'default': {'invite': {}, 'join': {}, 'leave': {}}, 'properties': {'invite': {'type': 'object', 'default': {}, 'patternProperties': {'^!.+:.+$': {'type': 'object', 'properties': {'invite_state': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}}}}}, 'join': {'type': 'object', 'default': {}, 'patternProperties': {'^!.+:.+$': {'type': 'object', 'properties': {'timeline': {'type': 'object', 'properties': {'events': {'type': 'array'}, 'limited': {'type': 'boolean'}, 'prev_batch': {'type': 'string'}}, 'required': ['events']}, 'state': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'ephemeral': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'summary': {'type': 'object', 'properties': {'m.invited_member_count': {'type': 'integer'}, 'm.joined_member_count': {'type': 'integer'}, 'm.heroes': {'type': 'array', 'items': {'type': 'string'}}}}, 'account_data': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}}}}}, 'leave': {'type': 'object', 'default': {}, 'patternProperties': {'^!.+:.+$': {'type': 'object', 'properties': {'timeline': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'state': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}}}}}}}, 'to_device': {'type': 'object', 'default': {'events': []}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'presence': {'type': 'object', 'default': {'events': []}, 'properties': {'events': {'type': 'array', 'default': []}}}}, 'required': ['next_batch']}: {'next_batch': 's137_206_36_46_64_1_1_17_0_1', 'presence': {'events': [{'type': 'm.presence', 'sender': '@evan:localhost', 'content': {'presence': 'unavailable', 'last_active_ago': 141735}}, {'type': 'm.presence', 'sender': '@luna:localhost', 'content': {'presence': 'online', 'last_active_ago': 3, 'currently_active': True}}]}, 'device_one_time_keys_count': {'signed_curve25519': 0}, 'org.matrix.msc2732.device_unused_fallback_key_types': [], 'device_unused_fallback_key_types': []}
2025-01-05 02:11:55,902 [INFO] src.console_functions: Console screen cleared.
2025-01-05 02:12:05,023 [DEBUG] nio.responses: Validating response schema {'type': 'object', 'properties': {'device_one_time_keys_count': {'type': 'object', 'default': {}, 'properties': {'curve25519': {'type': 'integer'}, 'signed_curve25519': {'type': 'integer'}}}, 'device_lists': {'type': 'object', 'default': {}, 'properties': {'changed': {'type': 'array', 'items': {'type': 'string'}}, 'left': {'type': 'array', 'items': {'type': 'string'}}}}, 'next_batch': {'type': 'string'}, 'rooms': {'type': 'object', 'default': {'invite': {}, 'join': {}, 'leave': {}}, 'properties': {'invite': {'type': 'object', 'default': {}, 'patternProperties': {'^!.+:.+$': {'type': 'object', 'properties': {'invite_state': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}}}}}, 'join': {'type': 'object', 'default': {}, 'patternProperties': {'^!.+:.+$': {'type': 'object', 'properties': {'timeline': {'type': 'object', 'properties': {'events': {'type': 'array'}, 'limited': {'type': 'boolean'}, 'prev_batch': {'type': 'string'}}, 'required': ['events']}, 'state': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'ephemeral': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'summary': {'type': 'object', 'properties': {'m.invited_member_count': {'type': 'integer'}, 'm.joined_member_count': {'type': 'integer'}, 'm.heroes': {'type': 'array', 'items': {'type': 'string'}}}}, 'account_data': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}}}}}, 'leave': {'type': 'object', 'default': {}, 'patternProperties': {'^!.+:.+$': {'type': 'object', 'properties': {'timeline': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'state': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}}}}}}}, 'to_device': {'type': 'object', 'default': {'events': []}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'presence': {'type': 'object', 'default': {'events': []}, 'properties': {'events': {'type': 'array', 'default': []}}}}, 'required': ['next_batch']}: {'next_batch': 's137_207_36_46_64_1_1_17_0_1', 'presence': {'events': [{'type': 'm.presence', 'sender': '@evan:localhost', 'content': {'presence': 'online', 'last_active_ago': 13, 'currently_active': True}}]}, 'device_one_time_keys_count': {'signed_curve25519': 0}, 'org.matrix.msc2732.device_unused_fallback_key_types': [], 'device_unused_fallback_key_types': []}
2025-01-05 02:12:05,036 [DEBUG] nio.responses: Validating response schema {'type': 'object', 'properties': {'device_one_time_keys_count': {'type': 'object', 'default': {}, 'properties': {'curve25519': {'type': 'integer'}, 'signed_curve25519': {'type': 'integer'}}}, 'device_lists': {'type': 'object', 'default': {}, 'properties': {'changed': {'type': 'array', 'items': {'type': 'string'}}, 'left': {'type': 'array', 'items': {'type': 'string'}}}}, 'next_batch': {'type': 'string'}, 'rooms': {'type': 'object', 'default': {'invite': {}, 'join': {}, 'leave': {}}, 'properties': {'invite': {'type': 'object', 'default': {}, 'patternProperties': {'^!.+:.+$': {'type': 'object', 'properties': {'invite_state': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}}}}}, 'join': {'type': 'object', 'default': {}, 'patternProperties': {'^!.+:.+$': {'type': 'object', 'properties': {'timeline': {'type': 'object', 'properties': {'events': {'type': 'array'}, 'limited': {'type': 'boolean'}, 'prev_batch': {'type': 'string'}}, 'required': ['events']}, 'state': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'ephemeral': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'summary': {'type': 'object', 'properties': {'m.invited_member_count': {'type': 'integer'}, 'm.joined_member_count': {'type': 'integer'}, 'm.heroes': {'type': 'array', 'items': {'type': 'string'}}}}, 'account_data': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}}}}}, 'leave': {'type': 'object', 'default': {}, 'patternProperties': {'^!.+:.+$': {'type': 'object', 'properties': {'timeline': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'state': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}}}}}}}, 'to_device': {'type': 'object', 'default': {'events': []}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'presence': {'type': 'object', 'default': {'events': []}, 'properties': {'events': {'type': 'array', 'default': []}}}}, 'required': ['next_batch']}: {'next_batch': 's137_207_36_47_64_1_1_17_0_1', 'device_one_time_keys_count': {'signed_curve25519': 0}, 'org.matrix.msc2732.device_unused_fallback_key_types': [], 'device_unused_fallback_key_types': [], 'rooms': {'join': {'!ZhsKXLoMEydpudauIE:localhost': {'timeline': {'events': [], 'prev_batch': 's137_207_36_46_64_1_1_17_0_1', 'limited': False}, 'state': {'events': []}, 'account_data': {'events': []}, 'ephemeral': {'events': [{'type': 'm.receipt', 'content': {'$oaNxofgwTalCjhfYUbc2subS8A5ei9p70fCXqTrZrz8': {'m.read': {'@evan:localhost': {'ts': 1736061125021, 'thread_id': 'main'}}}}}]}, 'unread_notifications': {'notification_count': 8, 'highlight_count': 0}, 'summary': {}}}}}
2025-01-05 02:12:05,700 [DEBUG] nio.responses: Validating response schema {'type': 'object', 'properties': {'device_one_time_keys_count': {'type': 'object', 'default': {}, 'properties': {'curve25519': {'type': 'integer'}, 'signed_curve25519': {'type': 'integer'}}}, 'device_lists': {'type': 'object', 'default': {}, 'properties': {'changed': {'type': 'array', 'items': {'type': 'string'}}, 'left': {'type': 'array', 'items': {'type': 'string'}}}}, 'next_batch': {'type': 'string'}, 'rooms': {'type': 'object', 'default': {'invite': {}, 'join': {}, 'leave': {}}, 'properties': {'invite': {'type': 'object', 'default': {}, 'patternProperties': {'^!.+:.+$': {'type': 'object', 'properties': {'invite_state': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}}}}}, 'join': {'type': 'object', 'default': {}, 'patternProperties': {'^!.+:.+$': {'type': 'object', 'properties': {'timeline': {'type': 'object', 'properties': {'events': {'type': 'array'}, 'limited': {'type': 'boolean'}, 'prev_batch': {'type': 'string'}}, 'required': ['events']}, 'state': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'ephemeral': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'summary': {'type': 'object', 'properties': {'m.invited_member_count': {'type': 'integer'}, 'm.joined_member_count': {'type': 'integer'}, 'm.heroes': {'type': 'array', 'items': {'type': 'string'}}}}, 'account_data': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}}}}}, 'leave': {'type': 'object', 'default': {}, 'patternProperties': {'^!.+:.+$': {'type': 'object', 'properties': {'timeline': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'state': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}}}}}}}, 'to_device': {'type': 'object', 'default': {'events': []}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'presence': {'type': 'object', 'default': {'events': []}, 'properties': {'events': {'type': 'array', 'default': []}}}}, 'required': ['next_batch']}: {'next_batch': 's137_207_37_47_64_1_1_17_0_1', 'device_one_time_keys_count': {'signed_curve25519': 0}, 'org.matrix.msc2732.device_unused_fallback_key_types': [], 'device_unused_fallback_key_types': [], 'rooms': {'join': {'!ZhsKXLoMEydpudauIE:localhost': {'timeline': {'events': [], 'prev_batch': 's137_207_36_47_64_1_1_17_0_1', 'limited': False}, 'state': {'events': []}, 'account_data': {'events': []}, 'ephemeral': {'events': [{'type': 'm.typing', 'content': {'user_ids': ['@evan:localhost']}}]}, 'unread_notifications': {'notification_count': 8, 'highlight_count': 0}, 'summary': {}}}}}
2025-01-05 02:12:06,114 [DEBUG] nio.responses: Validating response schema {'type': 'object', 'properties': {'device_one_time_keys_count': {'type': 'object', 'default': {}, 'properties': {'curve25519': {'type': 'integer'}, 'signed_curve25519': {'type': 'integer'}}}, 'device_lists': {'type': 'object', 'default': {}, 'properties': {'changed': {'type': 'array', 'items': {'type': 'string'}}, 'left': {'type': 'array', 'items': {'type': 'string'}}}}, 'next_batch': {'type': 'string'}, 'rooms': {'type': 'object', 'default': {'invite': {}, 'join': {}, 'leave': {}}, 'properties': {'invite': {'type': 'object', 'default': {}, 'patternProperties': {'^!.+:.+$': {'type': 'object', 'properties': {'invite_state': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}}}}}, 'join': {'type': 'object', 'default': {}, 'patternProperties': {'^!.+:.+$': {'type': 'object', 'properties': {'timeline': {'type': 'object', 'properties': {'events': {'type': 'array'}, 'limited': {'type': 'boolean'}, 'prev_batch': {'type': 'string'}}, 'required': ['events']}, 'state': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'ephemeral': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'summary': {'type': 'object', 'properties': {'m.invited_member_count': {'type': 'integer'}, 'm.joined_member_count': {'type': 'integer'}, 'm.heroes': {'type': 'array', 'items': {'type': 'string'}}}}, 'account_data': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}}}}}, 'leave': {'type': 'object', 'default': {}, 'patternProperties': {'^!.+:.+$': {'type': 'object', 'properties': {'timeline': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'state': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}}}}}}}, 'to_device': {'type': 'object', 'default': {'events': []}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'presence': {'type': 'object', 'default': {'events': []}, 'properties': {'events': {'type': 'array', 'default': []}}}}, 'required': ['next_batch']}: {'next_batch': 's137_207_38_47_64_1_1_17_0_1', 'device_one_time_keys_count': {'signed_curve25519': 0}, 'org.matrix.msc2732.device_unused_fallback_key_types': [], 'device_unused_fallback_key_types': [], 'rooms': {'join': {'!ZhsKXLoMEydpudauIE:localhost': {'timeline': {'events': [], 'prev_batch': 's137_207_37_47_64_1_1_17_0_1', 'limited': False}, 'state': {'events': []}, 'account_data': {'events': []}, 'ephemeral': {'events': [{'type': 'm.typing', 'content': {'user_ids': []}}]}, 'unread_notifications': {'notification_count': 8, 'highlight_count': 0}, 'summary': {}}}}}
2025-01-05 02:12:06,172 [DEBUG] nio.responses: Validating response schema {'type': 'object', 'properties': {'device_one_time_keys_count': {'type': 'object', 'default': {}, 'properties': {'curve25519': {'type': 'integer'}, 'signed_curve25519': {'type': 'integer'}}}, 'device_lists': {'type': 'object', 'default': {}, 'properties': {'changed': {'type': 'array', 'items': {'type': 'string'}}, 'left': {'type': 'array', 'items': {'type': 'string'}}}}, 'next_batch': {'type': 'string'}, 'rooms': {'type': 'object', 'default': {'invite': {}, 'join': {}, 'leave': {}}, 'properties': {'invite': {'type': 'object', 'default': {}, 'patternProperties': {'^!.+:.+$': {'type': 'object', 'properties': {'invite_state': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}}}}}, 'join': {'type': 'object', 'default': {}, 'patternProperties': {'^!.+:.+$': {'type': 'object', 'properties': {'timeline': {'type': 'object', 'properties': {'events': {'type': 'array'}, 'limited': {'type': 'boolean'}, 'prev_batch': {'type': 'string'}}, 'required': ['events']}, 'state': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'ephemeral': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'summary': {'type': 'object', 'properties': {'m.invited_member_count': {'type': 'integer'}, 'm.joined_member_count': {'type': 'integer'}, 'm.heroes': {'type': 'array', 'items': {'type': 'string'}}}}, 'account_data': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}}}}}, 'leave': {'type': 'object', 'default': {}, 'patternProperties': {'^!.+:.+$': {'type': 'object', 'properties': {'timeline': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'state': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}}}}}}}, 'to_device': {'type': 'object', 'default': {'events': []}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'presence': {'type': 'object', 'default': {'events': []}, 'properties': {'events': {'type': 'array', 'default': []}}}}, 'required': ['next_batch']}: {'next_batch': 's138_207_38_47_64_1_1_17_0_1', 'device_one_time_keys_count': {'signed_curve25519': 0}, 'org.matrix.msc2732.device_unused_fallback_key_types': [], 'device_unused_fallback_key_types': [], 'rooms': {'join': {'!ZhsKXLoMEydpudauIE:localhost': {'timeline': {'events': [{'type': 'm.room.message', 'sender': '@evan:localhost', 'content': {'msgtype': 'm.text', 'body': 'test', 'm.mentions': {}}, 'origin_server_ts': 1736061126143, 'unsigned': {'membership': 'join', 'age': 27}, 'event_id': '$8HPUQ6c2hkh5V_1FAUucqkcw9DqKsg0OUmf4dT5Z72w'}], 'prev_batch': 's137_207_38_47_64_1_1_17_0_1', 'limited': False}, 'state': {'events': []}, 'account_data': {'events': []}, 'ephemeral': {'events': []}, 'unread_notifications': {'notification_count': 9, 'highlight_count': 0}, 'summary': {}}}}}
2025-01-05 02:12:06,173 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:12:06,173 [DEBUG] src.luna_functions: Got an event of type: <class 'nio.events.room_events.RoomMessageText'>, content: {'type': 'm.room.message', 'sender': '@evan:localhost', 'content': {'msgtype': 'm.text', 'body': 'test', 'm.mentions': {}}, 'origin_server_ts': 1736061126143, 'unsigned': {'membership': 'join', 'age': 27}, 'event_id': '$8HPUQ6c2hkh5V_1FAUucqkcw9DqKsg0OUmf4dT5Z72w'}
2025-01-05 02:12:06,173 [INFO] src.luna_functions: Received message in !ZhsKXLoMEydpudauIE:localhost from @evan:localhost: test
2025-01-05 02:12:06,173 [INFO] root: Pretending to prompt GPT! with API key: POOPYBUTTHOLE
2025-01-05 02:12:06,173 [DEBUG] src.luna_functions: Sending response: Hello @evan:localhost, you said 'test' (auto-respond).
2025-01-05 02:12:06,195 [DEBUG] nio.responses: Validating response schema {'type': 'object', 'properties': {'device_one_time_keys_count': {'type': 'object', 'default': {}, 'properties': {'curve25519': {'type': 'integer'}, 'signed_curve25519': {'type': 'integer'}}}, 'device_lists': {'type': 'object', 'default': {}, 'properties': {'changed': {'type': 'array', 'items': {'type': 'string'}}, 'left': {'type': 'array', 'items': {'type': 'string'}}}}, 'next_batch': {'type': 'string'}, 'rooms': {'type': 'object', 'default': {'invite': {}, 'join': {}, 'leave': {}}, 'properties': {'invite': {'type': 'object', 'default': {}, 'patternProperties': {'^!.+:.+$': {'type': 'object', 'properties': {'invite_state': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}}}}}, 'join': {'type': 'object', 'default': {}, 'patternProperties': {'^!.+:.+$': {'type': 'object', 'properties': {'timeline': {'type': 'object', 'properties': {'events': {'type': 'array'}, 'limited': {'type': 'boolean'}, 'prev_batch': {'type': 'string'}}, 'required': ['events']}, 'state': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'ephemeral': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'summary': {'type': 'object', 'properties': {'m.invited_member_count': {'type': 'integer'}, 'm.joined_member_count': {'type': 'integer'}, 'm.heroes': {'type': 'array', 'items': {'type': 'string'}}}}, 'account_data': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}}}}}, 'leave': {'type': 'object', 'default': {}, 'patternProperties': {'^!.+:.+$': {'type': 'object', 'properties': {'timeline': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'state': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}}}}}}}, 'to_device': {'type': 'object', 'default': {'events': []}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'presence': {'type': 'object', 'default': {'events': []}, 'properties': {'events': {'type': 'array', 'default': []}}}}, 'required': ['next_batch']}: {'next_batch': 's139_207_38_47_64_1_1_17_0_1', 'device_one_time_keys_count': {'signed_curve25519': 0}, 'org.matrix.msc2732.device_unused_fallback_key_types': [], 'device_unused_fallback_key_types': [], 'rooms': {'join': {'!ZhsKXLoMEydpudauIE:localhost': {'timeline': {'events': [{'type': 'm.room.message', 'sender': '@luna:localhost', 'content': {'msgtype': 'm.text', 'body': "Hello @evan:localhost, you said 'test' (auto-respond)."}, 'origin_server_ts': 1736061126176, 'unsigned': {'membership': 'join', 'age': 17, 'transaction_id': 'a571dd74-d0d1-4e62-b21d-80b44773f3b5'}, 'event_id': '$02gzWDzDBE3sl7xEO-WnjTBhUJLh_-06Yyb5RkpVBho'}], 'prev_batch': 's138_207_38_47_64_1_1_17_0_1', 'limited': False}, 'state': {'events': []}, 'account_data': {'events': []}, 'ephemeral': {'events': []}, 'unread_notifications': {'notification_count': 9, 'highlight_count': 0}, 'summary': {}}}}}
2025-01-05 02:12:06,196 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:12:06,196 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:12:06,725 [DEBUG] nio.responses: Validating response schema {'type': 'object', 'properties': {'device_one_time_keys_count': {'type': 'object', 'default': {}, 'properties': {'curve25519': {'type': 'integer'}, 'signed_curve25519': {'type': 'integer'}}}, 'device_lists': {'type': 'object', 'default': {}, 'properties': {'changed': {'type': 'array', 'items': {'type': 'string'}}, 'left': {'type': 'array', 'items': {'type': 'string'}}}}, 'next_batch': {'type': 'string'}, 'rooms': {'type': 'object', 'default': {'invite': {}, 'join': {}, 'leave': {}}, 'properties': {'invite': {'type': 'object', 'default': {}, 'patternProperties': {'^!.+:.+$': {'type': 'object', 'properties': {'invite_state': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}}}}}, 'join': {'type': 'object', 'default': {}, 'patternProperties': {'^!.+:.+$': {'type': 'object', 'properties': {'timeline': {'type': 'object', 'properties': {'events': {'type': 'array'}, 'limited': {'type': 'boolean'}, 'prev_batch': {'type': 'string'}}, 'required': ['events']}, 'state': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'ephemeral': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'summary': {'type': 'object', 'properties': {'m.invited_member_count': {'type': 'integer'}, 'm.joined_member_count': {'type': 'integer'}, 'm.heroes': {'type': 'array', 'items': {'type': 'string'}}}}, 'account_data': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}}}}}, 'leave': {'type': 'object', 'default': {}, 'patternProperties': {'^!.+:.+$': {'type': 'object', 'properties': {'timeline': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'state': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}}}}}}}, 'to_device': {'type': 'object', 'default': {'events': []}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'presence': {'type': 'object', 'default': {'events': []}, 'properties': {'events': {'type': 'array', 'default': []}}}}, 'required': ['next_batch']}: {'next_batch': 's139_207_38_48_64_1_1_17_0_1', 'device_one_time_keys_count': {'signed_curve25519': 0}, 'org.matrix.msc2732.device_unused_fallback_key_types': [], 'device_unused_fallback_key_types': [], 'rooms': {'join': {'!ZhsKXLoMEydpudauIE:localhost': {'timeline': {'events': [], 'prev_batch': 's139_207_38_47_64_1_1_17_0_1', 'limited': False}, 'state': {'events': []}, 'account_data': {'events': []}, 'ephemeral': {'events': [{'type': 'm.receipt', 'content': {'$02gzWDzDBE3sl7xEO-WnjTBhUJLh_-06Yyb5RkpVBho': {'m.read': {'@evan:localhost': {'ts': 1736061126700, 'thread_id': 'main'}}}}}]}, 'unread_notifications': {'notification_count': 9, 'highlight_count': 0}, 'summary': {}}}}}
2025-01-05 02:12:36,739 [DEBUG] nio.responses: Validating response schema {'type': 'object', 'properties': {'device_one_time_keys_count': {'type': 'object', 'default': {}, 'properties': {'curve25519': {'type': 'integer'}, 'signed_curve25519': {'type': 'integer'}}}, 'device_lists': {'type': 'object', 'default': {}, 'properties': {'changed': {'type': 'array', 'items': {'type': 'string'}}, 'left': {'type': 'array', 'items': {'type': 'string'}}}}, 'next_batch': {'type': 'string'}, 'rooms': {'type': 'object', 'default': {'invite': {}, 'join': {}, 'leave': {}}, 'properties': {'invite': {'type': 'object', 'default': {}, 'patternProperties': {'^!.+:.+$': {'type': 'object', 'properties': {'invite_state': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}}}}}, 'join': {'type': 'object', 'default': {}, 'patternProperties': {'^!.+:.+$': {'type': 'object', 'properties': {'timeline': {'type': 'object', 'properties': {'events': {'type': 'array'}, 'limited': {'type': 'boolean'}, 'prev_batch': {'type': 'string'}}, 'required': ['events']}, 'state': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'ephemeral': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'summary': {'type': 'object', 'properties': {'m.invited_member_count': {'type': 'integer'}, 'm.joined_member_count': {'type': 'integer'}, 'm.heroes': {'type': 'array', 'items': {'type': 'string'}}}}, 'account_data': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}}}}}, 'leave': {'type': 'object', 'default': {}, 'patternProperties': {'^!.+:.+$': {'type': 'object', 'properties': {'timeline': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'state': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}}}}}}}, 'to_device': {'type': 'object', 'default': {'events': []}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'presence': {'type': 'object', 'default': {'events': []}, 'properties': {'events': {'type': 'array', 'default': []}}}}, 'required': ['next_batch']}: {'next_batch': 's139_209_38_48_64_1_1_17_0_1', 'presence': {'events': [{'type': 'm.presence', 'sender': '@evan:localhost', 'content': {'presence': 'online', 'last_active_ago': 29990, 'currently_active': True}}, {'type': 'm.presence', 'sender': '@luna:localhost', 'content': {'presence': 'online', 'last_active_ago': 30007, 'currently_active': True}}]}, 'device_one_time_keys_count': {'signed_curve25519': 0}, 'org.matrix.msc2732.device_unused_fallback_key_types': [], 'device_unused_fallback_key_types': []}
2025-01-05 02:13:06,752 [DEBUG] nio.responses: Validating response schema {'type': 'object', 'properties': {'device_one_time_keys_count': {'type': 'object', 'default': {}, 'properties': {'curve25519': {'type': 'integer'}, 'signed_curve25519': {'type': 'integer'}}}, 'device_lists': {'type': 'object', 'default': {}, 'properties': {'changed': {'type': 'array', 'items': {'type': 'string'}}, 'left': {'type': 'array', 'items': {'type': 'string'}}}}, 'next_batch': {'type': 'string'}, 'rooms': {'type': 'object', 'default': {'invite': {}, 'join': {}, 'leave': {}}, 'properties': {'invite': {'type': 'object', 'default': {}, 'patternProperties': {'^!.+:.+$': {'type': 'object', 'properties': {'invite_state': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}}}}}, 'join': {'type': 'object', 'default': {}, 'patternProperties': {'^!.+:.+$': {'type': 'object', 'properties': {'timeline': {'type': 'object', 'properties': {'events': {'type': 'array'}, 'limited': {'type': 'boolean'}, 'prev_batch': {'type': 'string'}}, 'required': ['events']}, 'state': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'ephemeral': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'summary': {'type': 'object', 'properties': {'m.invited_member_count': {'type': 'integer'}, 'm.joined_member_count': {'type': 'integer'}, 'm.heroes': {'type': 'array', 'items': {'type': 'string'}}}}, 'account_data': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}}}}}, 'leave': {'type': 'object', 'default': {}, 'patternProperties': {'^!.+:.+$': {'type': 'object', 'properties': {'timeline': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'state': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}}}}}}}, 'to_device': {'type': 'object', 'default': {'events': []}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'presence': {'type': 'object', 'default': {'events': []}, 'properties': {'events': {'type': 'array', 'default': []}}}}, 'required': ['next_batch']}: {'next_batch': 's139_209_38_48_64_1_1_17_0_1', 'device_one_time_keys_count': {'signed_curve25519': 0}, 'org.matrix.msc2732.device_unused_fallback_key_types': [], 'device_unused_fallback_key_types': []}
2025-01-05 02:13:36,763 [DEBUG] nio.responses: Validating response schema {'type': 'object', 'properties': {'device_one_time_keys_count': {'type': 'object', 'default': {}, 'properties': {'curve25519': {'type': 'integer'}, 'signed_curve25519': {'type': 'integer'}}}, 'device_lists': {'type': 'object', 'default': {}, 'properties': {'changed': {'type': 'array', 'items': {'type': 'string'}}, 'left': {'type': 'array', 'items': {'type': 'string'}}}}, 'next_batch': {'type': 'string'}, 'rooms': {'type': 'object', 'default': {'invite': {}, 'join': {}, 'leave': {}}, 'properties': {'invite': {'type': 'object', 'default': {}, 'patternProperties': {'^!.+:.+$': {'type': 'object', 'properties': {'invite_state': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}}}}}, 'join': {'type': 'object', 'default': {}, 'patternProperties': {'^!.+:.+$': {'type': 'object', 'properties': {'timeline': {'type': 'object', 'properties': {'events': {'type': 'array'}, 'limited': {'type': 'boolean'}, 'prev_batch': {'type': 'string'}}, 'required': ['events']}, 'state': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'ephemeral': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'summary': {'type': 'object', 'properties': {'m.invited_member_count': {'type': 'integer'}, 'm.joined_member_count': {'type': 'integer'}, 'm.heroes': {'type': 'array', 'items': {'type': 'string'}}}}, 'account_data': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}}}}}, 'leave': {'type': 'object', 'default': {}, 'patternProperties': {'^!.+:.+$': {'type': 'object', 'properties': {'timeline': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'state': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}}}}}}}, 'to_device': {'type': 'object', 'default': {'events': []}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'presence': {'type': 'object', 'default': {'events': []}, 'properties': {'events': {'type': 'array', 'default': []}}}}, 'required': ['next_batch']}: {'next_batch': 's139_209_38_48_64_1_1_17_0_1', 'device_one_time_keys_count': {'signed_curve25519': 0}, 'org.matrix.msc2732.device_unused_fallback_key_types': [], 'device_unused_fallback_key_types': []}
2025-01-05 02:13:36,776 [DEBUG] nio.responses: Validating response schema {'type': 'object', 'properties': {'device_one_time_keys_count': {'type': 'object', 'default': {}, 'properties': {'curve25519': {'type': 'integer'}, 'signed_curve25519': {'type': 'integer'}}}, 'device_lists': {'type': 'object', 'default': {}, 'properties': {'changed': {'type': 'array', 'items': {'type': 'string'}}, 'left': {'type': 'array', 'items': {'type': 'string'}}}}, 'next_batch': {'type': 'string'}, 'rooms': {'type': 'object', 'default': {'invite': {}, 'join': {}, 'leave': {}}, 'properties': {'invite': {'type': 'object', 'default': {}, 'patternProperties': {'^!.+:.+$': {'type': 'object', 'properties': {'invite_state': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}}}}}, 'join': {'type': 'object', 'default': {}, 'patternProperties': {'^!.+:.+$': {'type': 'object', 'properties': {'timeline': {'type': 'object', 'properties': {'events': {'type': 'array'}, 'limited': {'type': 'boolean'}, 'prev_batch': {'type': 'string'}}, 'required': ['events']}, 'state': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'ephemeral': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'summary': {'type': 'object', 'properties': {'m.invited_member_count': {'type': 'integer'}, 'm.joined_member_count': {'type': 'integer'}, 'm.heroes': {'type': 'array', 'items': {'type': 'string'}}}}, 'account_data': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}}}}}, 'leave': {'type': 'object', 'default': {}, 'patternProperties': {'^!.+:.+$': {'type': 'object', 'properties': {'timeline': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'state': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}}}}}}}, 'to_device': {'type': 'object', 'default': {'events': []}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'presence': {'type': 'object', 'default': {'events': []}, 'properties': {'events': {'type': 'array', 'default': []}}}}, 'required': ['next_batch']}: {'next_batch': 's139_211_38_48_64_1_1_17_0_1', 'presence': {'events': [{'type': 'm.presence', 'sender': '@evan:localhost', 'content': {'presence': 'online', 'last_active_ago': 29974, 'currently_active': True}}, {'type': 'm.presence', 'sender': '@luna:localhost', 'content': {'presence': 'online', 'last_active_ago': 6, 'currently_active': True}}]}, 'device_one_time_keys_count': {'signed_curve25519': 0}, 'org.matrix.msc2732.device_unused_fallback_key_types': [], 'device_unused_fallback_key_types': []}
2025-01-05 02:14:06,783 [DEBUG] nio.responses: Validating response schema {'type': 'object', 'properties': {'device_one_time_keys_count': {'type': 'object', 'default': {}, 'properties': {'curve25519': {'type': 'integer'}, 'signed_curve25519': {'type': 'integer'}}}, 'device_lists': {'type': 'object', 'default': {}, 'properties': {'changed': {'type': 'array', 'items': {'type': 'string'}}, 'left': {'type': 'array', 'items': {'type': 'string'}}}}, 'next_batch': {'type': 'string'}, 'rooms': {'type': 'object', 'default': {'invite': {}, 'join': {}, 'leave': {}}, 'properties': {'invite': {'type': 'object', 'default': {}, 'patternProperties': {'^!.+:.+$': {'type': 'object', 'properties': {'invite_state': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}}}}}, 'join': {'type': 'object', 'default': {}, 'patternProperties': {'^!.+:.+$': {'type': 'object', 'properties': {'timeline': {'type': 'object', 'properties': {'events': {'type': 'array'}, 'limited': {'type': 'boolean'}, 'prev_batch': {'type': 'string'}}, 'required': ['events']}, 'state': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'ephemeral': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'summary': {'type': 'object', 'properties': {'m.invited_member_count': {'type': 'integer'}, 'm.joined_member_count': {'type': 'integer'}, 'm.heroes': {'type': 'array', 'items': {'type': 'string'}}}}, 'account_data': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}}}}}, 'leave': {'type': 'object', 'default': {}, 'patternProperties': {'^!.+:.+$': {'type': 'object', 'properties': {'timeline': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'state': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}}}}}}}, 'to_device': {'type': 'object', 'default': {'events': []}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'presence': {'type': 'object', 'default': {'events': []}, 'properties': {'events': {'type': 'array', 'default': []}}}}, 'required': ['next_batch']}: {'next_batch': 's139_211_38_48_64_1_1_17_0_1', 'device_one_time_keys_count': {'signed_curve25519': 0}, 'org.matrix.msc2732.device_unused_fallback_key_types': [], 'device_unused_fallback_key_types': []}
2025-01-05 02:14:36,792 [DEBUG] nio.responses: Validating response schema {'type': 'object', 'properties': {'device_one_time_keys_count': {'type': 'object', 'default': {}, 'properties': {'curve25519': {'type': 'integer'}, 'signed_curve25519': {'type': 'integer'}}}, 'device_lists': {'type': 'object', 'default': {}, 'properties': {'changed': {'type': 'array', 'items': {'type': 'string'}}, 'left': {'type': 'array', 'items': {'type': 'string'}}}}, 'next_batch': {'type': 'string'}, 'rooms': {'type': 'object', 'default': {'invite': {}, 'join': {}, 'leave': {}}, 'properties': {'invite': {'type': 'object', 'default': {}, 'patternProperties': {'^!.+:.+$': {'type': 'object', 'properties': {'invite_state': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}}}}}, 'join': {'type': 'object', 'default': {}, 'patternProperties': {'^!.+:.+$': {'type': 'object', 'properties': {'timeline': {'type': 'object', 'properties': {'events': {'type': 'array'}, 'limited': {'type': 'boolean'}, 'prev_batch': {'type': 'string'}}, 'required': ['events']}, 'state': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'ephemeral': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'summary': {'type': 'object', 'properties': {'m.invited_member_count': {'type': 'integer'}, 'm.joined_member_count': {'type': 'integer'}, 'm.heroes': {'type': 'array', 'items': {'type': 'string'}}}}, 'account_data': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}}}}}, 'leave': {'type': 'object', 'default': {}, 'patternProperties': {'^!.+:.+$': {'type': 'object', 'properties': {'timeline': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'state': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}}}}}}}, 'to_device': {'type': 'object', 'default': {'events': []}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'presence': {'type': 'object', 'default': {'events': []}, 'properties': {'events': {'type': 'array', 'default': []}}}}, 'required': ['next_batch']}: {'next_batch': 's139_211_38_48_64_1_1_17_0_1', 'device_one_time_keys_count': {'signed_curve25519': 0}, 'org.matrix.msc2732.device_unused_fallback_key_types': [], 'device_unused_fallback_key_types': []}
2025-01-05 02:14:36,804 [DEBUG] nio.responses: Validating response schema {'type': 'object', 'properties': {'device_one_time_keys_count': {'type': 'object', 'default': {}, 'properties': {'curve25519': {'type': 'integer'}, 'signed_curve25519': {'type': 'integer'}}}, 'device_lists': {'type': 'object', 'default': {}, 'properties': {'changed': {'type': 'array', 'items': {'type': 'string'}}, 'left': {'type': 'array', 'items': {'type': 'string'}}}}, 'next_batch': {'type': 'string'}, 'rooms': {'type': 'object', 'default': {'invite': {}, 'join': {}, 'leave': {}}, 'properties': {'invite': {'type': 'object', 'default': {}, 'patternProperties': {'^!.+:.+$': {'type': 'object', 'properties': {'invite_state': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}}}}}, 'join': {'type': 'object', 'default': {}, 'patternProperties': {'^!.+:.+$': {'type': 'object', 'properties': {'timeline': {'type': 'object', 'properties': {'events': {'type': 'array'}, 'limited': {'type': 'boolean'}, 'prev_batch': {'type': 'string'}}, 'required': ['events']}, 'state': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'ephemeral': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'summary': {'type': 'object', 'properties': {'m.invited_member_count': {'type': 'integer'}, 'm.joined_member_count': {'type': 'integer'}, 'm.heroes': {'type': 'array', 'items': {'type': 'string'}}}}, 'account_data': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}}}}}, 'leave': {'type': 'object', 'default': {}, 'patternProperties': {'^!.+:.+$': {'type': 'object', 'properties': {'timeline': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'state': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}}}}}}}, 'to_device': {'type': 'object', 'default': {'events': []}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'presence': {'type': 'object', 'default': {'events': []}, 'properties': {'events': {'type': 'array', 'default': []}}}}, 'required': ['next_batch']}: {'next_batch': 's139_213_38_48_64_1_1_17_0_1', 'presence': {'events': [{'type': 'm.presence', 'sender': '@evan:localhost', 'content': {'presence': 'online', 'last_active_ago': 29923, 'currently_active': True}}, {'type': 'm.presence', 'sender': '@luna:localhost', 'content': {'presence': 'online', 'last_active_ago': 4, 'currently_active': True}}]}, 'device_one_time_keys_count': {'signed_curve25519': 0}, 'org.matrix.msc2732.device_unused_fallback_key_types': [], 'device_unused_fallback_key_types': []}
2025-01-05 02:15:06,813 [DEBUG] nio.responses: Validating response schema {'type': 'object', 'properties': {'device_one_time_keys_count': {'type': 'object', 'default': {}, 'properties': {'curve25519': {'type': 'integer'}, 'signed_curve25519': {'type': 'integer'}}}, 'device_lists': {'type': 'object', 'default': {}, 'properties': {'changed': {'type': 'array', 'items': {'type': 'string'}}, 'left': {'type': 'array', 'items': {'type': 'string'}}}}, 'next_batch': {'type': 'string'}, 'rooms': {'type': 'object', 'default': {'invite': {}, 'join': {}, 'leave': {}}, 'properties': {'invite': {'type': 'object', 'default': {}, 'patternProperties': {'^!.+:.+$': {'type': 'object', 'properties': {'invite_state': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}}}}}, 'join': {'type': 'object', 'default': {}, 'patternProperties': {'^!.+:.+$': {'type': 'object', 'properties': {'timeline': {'type': 'object', 'properties': {'events': {'type': 'array'}, 'limited': {'type': 'boolean'}, 'prev_batch': {'type': 'string'}}, 'required': ['events']}, 'state': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'ephemeral': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'summary': {'type': 'object', 'properties': {'m.invited_member_count': {'type': 'integer'}, 'm.joined_member_count': {'type': 'integer'}, 'm.heroes': {'type': 'array', 'items': {'type': 'string'}}}}, 'account_data': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}}}}}, 'leave': {'type': 'object', 'default': {}, 'patternProperties': {'^!.+:.+$': {'type': 'object', 'properties': {'timeline': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'state': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}}}}}}}, 'to_device': {'type': 'object', 'default': {'events': []}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'presence': {'type': 'object', 'default': {'events': []}, 'properties': {'events': {'type': 'array', 'default': []}}}}, 'required': ['next_batch']}: {'next_batch': 's139_213_38_48_64_1_1_17_0_1', 'device_one_time_keys_count': {'signed_curve25519': 0}, 'org.matrix.msc2732.device_unused_fallback_key_types': [], 'device_unused_fallback_key_types': []}
2025-01-05 02:15:36,819 [DEBUG] nio.responses: Validating response schema {'type': 'object', 'properties': {'device_one_time_keys_count': {'type': 'object', 'default': {}, 'properties': {'curve25519': {'type': 'integer'}, 'signed_curve25519': {'type': 'integer'}}}, 'device_lists': {'type': 'object', 'default': {}, 'properties': {'changed': {'type': 'array', 'items': {'type': 'string'}}, 'left': {'type': 'array', 'items': {'type': 'string'}}}}, 'next_batch': {'type': 'string'}, 'rooms': {'type': 'object', 'default': {'invite': {}, 'join': {}, 'leave': {}}, 'properties': {'invite': {'type': 'object', 'default': {}, 'patternProperties': {'^!.+:.+$': {'type': 'object', 'properties': {'invite_state': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}}}}}, 'join': {'type': 'object', 'default': {}, 'patternProperties': {'^!.+:.+$': {'type': 'object', 'properties': {'timeline': {'type': 'object', 'properties': {'events': {'type': 'array'}, 'limited': {'type': 'boolean'}, 'prev_batch': {'type': 'string'}}, 'required': ['events']}, 'state': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'ephemeral': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'summary': {'type': 'object', 'properties': {'m.invited_member_count': {'type': 'integer'}, 'm.joined_member_count': {'type': 'integer'}, 'm.heroes': {'type': 'array', 'items': {'type': 'string'}}}}, 'account_data': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}}}}}, 'leave': {'type': 'object', 'default': {}, 'patternProperties': {'^!.+:.+$': {'type': 'object', 'properties': {'timeline': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'state': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}}}}}}}, 'to_device': {'type': 'object', 'default': {'events': []}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'presence': {'type': 'object', 'default': {'events': []}, 'properties': {'events': {'type': 'array', 'default': []}}}}, 'required': ['next_batch']}: {'next_batch': 's139_213_38_48_64_1_1_17_0_1', 'device_one_time_keys_count': {'signed_curve25519': 0}, 'org.matrix.msc2732.device_unused_fallback_key_types': [], 'device_unused_fallback_key_types': []}
2025-01-05 02:15:36,824 [DEBUG] nio.responses: Validating response schema {'type': 'object', 'properties': {'device_one_time_keys_count': {'type': 'object', 'default': {}, 'properties': {'curve25519': {'type': 'integer'}, 'signed_curve25519': {'type': 'integer'}}}, 'device_lists': {'type': 'object', 'default': {}, 'properties': {'changed': {'type': 'array', 'items': {'type': 'string'}}, 'left': {'type': 'array', 'items': {'type': 'string'}}}}, 'next_batch': {'type': 'string'}, 'rooms': {'type': 'object', 'default': {'invite': {}, 'join': {}, 'leave': {}}, 'properties': {'invite': {'type': 'object', 'default': {}, 'patternProperties': {'^!.+:.+$': {'type': 'object', 'properties': {'invite_state': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}}}}}, 'join': {'type': 'object', 'default': {}, 'patternProperties': {'^!.+:.+$': {'type': 'object', 'properties': {'timeline': {'type': 'object', 'properties': {'events': {'type': 'array'}, 'limited': {'type': 'boolean'}, 'prev_batch': {'type': 'string'}}, 'required': ['events']}, 'state': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'ephemeral': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'summary': {'type': 'object', 'properties': {'m.invited_member_count': {'type': 'integer'}, 'm.joined_member_count': {'type': 'integer'}, 'm.heroes': {'type': 'array', 'items': {'type': 'string'}}}}, 'account_data': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}}}}}, 'leave': {'type': 'object', 'default': {}, 'patternProperties': {'^!.+:.+$': {'type': 'object', 'properties': {'timeline': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'state': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}}}}}}}, 'to_device': {'type': 'object', 'default': {'events': []}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'presence': {'type': 'object', 'default': {'events': []}, 'properties': {'events': {'type': 'array', 'default': []}}}}, 'required': ['next_batch']}: {'next_batch': 's139_215_38_48_64_1_1_17_0_1', 'presence': {'events': [{'type': 'm.presence', 'sender': '@evan:localhost', 'content': {'presence': 'online', 'last_active_ago': 29859, 'currently_active': True}}, {'type': 'm.presence', 'sender': '@luna:localhost', 'content': {'presence': 'online', 'last_active_ago': 2, 'currently_active': True}}]}, 'device_one_time_keys_count': {'signed_curve25519': 0}, 'org.matrix.msc2732.device_unused_fallback_key_types': [], 'device_unused_fallback_key_types': []}
2025-01-05 02:15:37,013 [DEBUG] nio.responses: Validating response schema {'type': 'object', 'properties': {'device_one_time_keys_count': {'type': 'object', 'default': {}, 'properties': {'curve25519': {'type': 'integer'}, 'signed_curve25519': {'type': 'integer'}}}, 'device_lists': {'type': 'object', 'default': {}, 'properties': {'changed': {'type': 'array', 'items': {'type': 'string'}}, 'left': {'type': 'array', 'items': {'type': 'string'}}}}, 'next_batch': {'type': 'string'}, 'rooms': {'type': 'object', 'default': {'invite': {}, 'join': {}, 'leave': {}}, 'properties': {'invite': {'type': 'object', 'default': {}, 'patternProperties': {'^!.+:.+$': {'type': 'object', 'properties': {'invite_state': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}}}}}, 'join': {'type': 'object', 'default': {}, 'patternProperties': {'^!.+:.+$': {'type': 'object', 'properties': {'timeline': {'type': 'object', 'properties': {'events': {'type': 'array'}, 'limited': {'type': 'boolean'}, 'prev_batch': {'type': 'string'}}, 'required': ['events']}, 'state': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'ephemeral': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'summary': {'type': 'object', 'properties': {'m.invited_member_count': {'type': 'integer'}, 'm.joined_member_count': {'type': 'integer'}, 'm.heroes': {'type': 'array', 'items': {'type': 'string'}}}}, 'account_data': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}}}}}, 'leave': {'type': 'object', 'default': {}, 'patternProperties': {'^!.+:.+$': {'type': 'object', 'properties': {'timeline': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'state': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}}}}}}}, 'to_device': {'type': 'object', 'default': {'events': []}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'presence': {'type': 'object', 'default': {'events': []}, 'properties': {'events': {'type': 'array', 'default': []}}}}, 'required': ['next_batch']}: {'next_batch': 's139_216_38_48_64_1_1_17_0_1', 'presence': {'events': [{'type': 'm.presence', 'sender': '@evan:localhost', 'content': {'presence': 'unavailable', 'last_active_ago': 30047}}]}, 'device_one_time_keys_count': {'signed_curve25519': 0}, 'org.matrix.msc2732.device_unused_fallback_key_types': [], 'device_unused_fallback_key_types': []}
2025-01-05 02:16:07,039 [DEBUG] nio.responses: Validating response schema {'type': 'object', 'properties': {'device_one_time_keys_count': {'type': 'object', 'default': {}, 'properties': {'curve25519': {'type': 'integer'}, 'signed_curve25519': {'type': 'integer'}}}, 'device_lists': {'type': 'object', 'default': {}, 'properties': {'changed': {'type': 'array', 'items': {'type': 'string'}}, 'left': {'type': 'array', 'items': {'type': 'string'}}}}, 'next_batch': {'type': 'string'}, 'rooms': {'type': 'object', 'default': {'invite': {}, 'join': {}, 'leave': {}}, 'properties': {'invite': {'type': 'object', 'default': {}, 'patternProperties': {'^!.+:.+$': {'type': 'object', 'properties': {'invite_state': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}}}}}, 'join': {'type': 'object', 'default': {}, 'patternProperties': {'^!.+:.+$': {'type': 'object', 'properties': {'timeline': {'type': 'object', 'properties': {'events': {'type': 'array'}, 'limited': {'type': 'boolean'}, 'prev_batch': {'type': 'string'}}, 'required': ['events']}, 'state': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'ephemeral': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'summary': {'type': 'object', 'properties': {'m.invited_member_count': {'type': 'integer'}, 'm.joined_member_count': {'type': 'integer'}, 'm.heroes': {'type': 'array', 'items': {'type': 'string'}}}}, 'account_data': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}}}}}, 'leave': {'type': 'object', 'default': {}, 'patternProperties': {'^!.+:.+$': {'type': 'object', 'properties': {'timeline': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'state': {'type': 'object', 'default': {}, 'properties': {'events': {'type': 'array', 'default': []}}}}}}}}}, 'to_device': {'type': 'object', 'default': {'events': []}, 'properties': {'events': {'type': 'array', 'default': []}}}, 'presence': {'type': 'object', 'default': {'events': []}, 'properties': {'events': {'type': 'array', 'default': []}}}}, 'required': ['next_batch']}: {'next_batch': 's139_216_38_48_64_1_1_17_0_1', 'device_one_time_keys_count': {'signed_curve25519': 0}, 'org.matrix.msc2732.device_unused_fallback_key_types': [], 'device_unused_fallback_key_types': []}
2025-01-05 02:16:10,638 [WARNING] __main__: KeyboardInterrupt received. Shutting down Director.
2025-01-05 02:16:10,638 [DEBUG] __main__: Preparing to close the event loop.
2025-01-05 02:16:10,638 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-05 02:16:15,082 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-05 02:16:15,082 [DEBUG] __main__: Exiting configure_logging function.
2025-01-05 02:16:15,082 [DEBUG] __main__: Logging configuration complete.
2025-01-05 02:16:15,082 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-05 02:16:15,082 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 02:16:15,082 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-05 02:16:15,082 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-05 02:16:15,082 [DEBUG] __main__: Entering start_console_thread function.
2025-01-05 02:16:15,082 [INFO] __main__: Console thread started successfully.
2025-01-05 02:16:15,082 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-05 02:16:15,083 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-05 02:16:15,083 [INFO] __main__: Starting main_logic coroutine.
2025-01-05 02:16:15,083 [DEBUG] __main__: Entering main_logic function...
2025-01-05 02:16:15,083 [DEBUG] __main__: Attempting to load or log in the client.
2025-01-05 02:16:15,083 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-05 02:16:15,083 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-05 02:16:15,083 [INFO] src.luna_functions: Using saved token for user @luna:localhost.
2025-01-05 02:16:15,083 [DEBUG] __main__: Client obtained. Storing reference to DIRECTOR_CLIENT in src.luna_functions.
2025-01-05 02:16:15,083 [DEBUG] __main__: Callbacks registered successfully.
2025-01-05 02:16:15,083 [DEBUG] __main__: Starting sync_forever loop. Awaiting new events with timeout=30000.
2025-01-05 02:16:15,121 [INFO] nio.client.base_client: New joined room !roKWYbjbZOVUoYPFtD:localhost
2025-01-05 02:16:15,121 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-05 02:16:15,121 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type RoomJoinRulesEvent
2025-01-05 02:16:15,121 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type RoomCreateEvent
2025-01-05 02:16:15,121 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type PowerLevelsEvent
2025-01-05 02:16:15,121 [INFO] nio.rooms: Changing power level for user @evan:localhost from 0 to 100
2025-01-05 02:16:15,121 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type RoomGuestAccessEvent
2025-01-05 02:16:15,121 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type RoomEncryptionEvent
2025-01-05 02:16:15,121 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type RoomNameEvent
2025-01-05 02:16:15,121 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type MegolmEvent
2025-01-05 02:16:15,121 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type MegolmEvent
2025-01-05 02:16:15,121 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type MegolmEvent
2025-01-05 02:16:15,121 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type MegolmEvent
2025-01-05 02:16:15,121 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type MegolmEvent
2025-01-05 02:16:15,121 [INFO] nio.client.base_client: New joined room !vqsQaVVLtsvWxIoJwV:localhost
2025-01-05 02:16:15,121 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type PowerLevelsEvent
2025-01-05 02:16:15,121 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomCreateEvent
2025-01-05 02:16:15,121 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomJoinRulesEvent
2025-01-05 02:16:15,122 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-05 02:16:15,122 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomGuestAccessEvent
2025-01-05 02:16:15,122 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomEncryptionEvent
2025-01-05 02:16:15,122 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomNameEvent
2025-01-05 02:16:15,122 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type MegolmEvent
2025-01-05 02:16:15,122 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type MegolmEvent
2025-01-05 02:16:15,122 [INFO] nio.client.base_client: New joined room !IQTJHuSCcTLlkCZzzF:localhost
2025-01-05 02:16:15,122 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-05 02:16:15,122 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomCreateEvent
2025-01-05 02:16:15,122 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomJoinRulesEvent
2025-01-05 02:16:15,122 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomGuestAccessEvent
2025-01-05 02:16:15,122 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type PowerLevelsEvent
2025-01-05 02:16:15,122 [INFO] nio.rooms: Changing power level for user @evan:localhost from 0 to 100
2025-01-05 02:16:15,122 [INFO] nio.rooms: Changing power level for user @luna:localhost from 0 to 100
2025-01-05 02:16:15,122 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:16:15,122 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:16:15,122 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:16:15,122 [DEBUG] src.luna_functions: Got an event of type: <class 'nio.events.room_events.RoomMessageText'>, content: {'type': 'm.room.message', 'sender': '@evan:localhost', 'content': {'msgtype': 'm.text', 'body': 'test', 'm.mentions': {}}, 'origin_server_ts': 1736059616879, 'unsigned': {'membership': 'join', 'age': 1758235}, 'event_id': '$x9KWoqnHlDWrve07GtsqHSSzNPGfClKYDi03zJRen08'}
2025-01-05 02:16:15,122 [INFO] src.luna_functions: Received message in !IQTJHuSCcTLlkCZzzF:localhost from @evan:localhost: test
2025-01-05 02:16:15,122 [ERROR] __main__: An unexpected exception occurred in main_logic: module 'src.ai_functions' has no attribute 'run'
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 131, in luna
    loop.run_until_complete(main_logic())
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 720, in run_until_complete
    return future.result()
           ~~~~~~~~~~~~~^^
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 95, in main_logic
    await client.sync_forever(timeout=30000)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/base_client.py", line 116, in wrapper
    return await func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 1358, in sync_forever
    sync_response = await self.sync(
                    ^^^^^^^^^^^^^^^^
        use_timeout, use_filter, since, full_state, presence
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/base_client.py", line 116, in wrapper
    return await func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 1232, in sync
    response = await self._send(
               ^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 880, in _send
    await self.receive_response(resp)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 770, in receive_response
    await self._handle_sync(response)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 737, in _handle_sync
    await self._handle_joined_rooms(response)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 635, in _handle_joined_rooms
    await self._on_event(event, room)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 697, in _on_event
    await cb.async_execute(event, room)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/base_client.py", line 160, in async_execute
    await result
  File "/Users/evanrobinson/Documents/Luna2/luna/src/luna_functions.py", line 140, in on_room_message
    ai_functions.run()
    ^^^^^^^^^^^^^^^^
AttributeError: module 'src.ai_functions' has no attribute 'run'
2025-01-05 02:16:15,125 [DEBUG] __main__: Preparing to close the event loop.
2025-01-05 02:16:15,125 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-05 02:19:32,646 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-05 02:19:32,646 [DEBUG] __main__: Exiting configure_logging function.
2025-01-05 02:19:32,646 [DEBUG] __main__: Logging configuration complete.
2025-01-05 02:19:32,646 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-05 02:19:32,646 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 02:19:32,646 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-05 02:19:32,646 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-05 02:19:32,646 [DEBUG] __main__: Entering start_console_thread function.
2025-01-05 02:19:32,646 [INFO] __main__: Console thread started successfully.
2025-01-05 02:19:32,646 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-05 02:19:32,646 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-05 02:19:32,646 [INFO] __main__: Starting main_logic coroutine.
2025-01-05 02:19:32,646 [DEBUG] __main__: Entering main_logic function...
2025-01-05 02:19:32,646 [DEBUG] __main__: Attempting to load or log in the client.
2025-01-05 02:19:32,646 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-05 02:19:32,646 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-05 02:19:32,646 [INFO] src.luna_functions: Using saved token for user @luna:localhost.
2025-01-05 02:19:32,646 [DEBUG] __main__: Client obtained. Storing reference to DIRECTOR_CLIENT in src.luna_functions.
2025-01-05 02:19:32,646 [DEBUG] __main__: Callbacks registered successfully.
2025-01-05 02:19:32,646 [DEBUG] __main__: Starting sync_forever loop. Awaiting new events with timeout=30000.
2025-01-05 02:19:32,692 [INFO] nio.client.base_client: New joined room !IQTJHuSCcTLlkCZzzF:localhost
2025-01-05 02:19:32,693 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-05 02:19:32,693 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomCreateEvent
2025-01-05 02:19:32,693 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomJoinRulesEvent
2025-01-05 02:19:32,693 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomGuestAccessEvent
2025-01-05 02:19:32,693 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type PowerLevelsEvent
2025-01-05 02:19:32,693 [INFO] nio.rooms: Changing power level for user @evan:localhost from 0 to 100
2025-01-05 02:19:32,693 [INFO] nio.rooms: Changing power level for user @luna:localhost from 0 to 100
2025-01-05 02:19:32,693 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:19:32,693 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:19:32,693 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:19:32,693 [DEBUG] src.luna_functions: Got an event of type: <class 'nio.events.room_events.RoomMessageText'>, content: {'type': 'm.room.message', 'sender': '@evan:localhost', 'content': {'msgtype': 'm.text', 'body': 'test', 'm.mentions': {}}, 'origin_server_ts': 1736059616879, 'unsigned': {'membership': 'join', 'age': 1955806}, 'event_id': '$x9KWoqnHlDWrve07GtsqHSSzNPGfClKYDi03zJRen08'}
2025-01-05 02:19:32,693 [INFO] src.luna_functions: Received message in !IQTJHuSCcTLlkCZzzF:localhost from @evan:localhost: test
2025-01-05 02:19:32,693 [DEBUG] src.ai_functions: get_ai_response called with prompt: test
2025-01-05 02:19:32,693 [ERROR] __main__: An unexpected exception occurred in main_logic: name 'load_openai_api_key' is not defined
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 131, in luna
    loop.run_until_complete(main_logic())
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 720, in run_until_complete
    return future.result()
           ~~~~~~~~~~~~~^^
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 95, in main_logic
    await client.sync_forever(timeout=30000)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/base_client.py", line 116, in wrapper
    return await func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 1358, in sync_forever
    sync_response = await self.sync(
                    ^^^^^^^^^^^^^^^^
        use_timeout, use_filter, since, full_state, presence
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/base_client.py", line 116, in wrapper
    return await func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 1232, in sync
    response = await self._send(
               ^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 880, in _send
    await self.receive_response(resp)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 770, in receive_response
    await self._handle_sync(response)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 737, in _handle_sync
    await self._handle_joined_rooms(response)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 635, in _handle_joined_rooms
    await self._on_event(event, room)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 697, in _on_event
    await cb.async_execute(event, room)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/base_client.py", line 160, in async_execute
    await result
  File "/Users/evanrobinson/Documents/Luna2/luna/src/luna_functions.py", line 141, in on_room_message
    ai_functions.get_ai_response(f'{body}')
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "/Users/evanrobinson/Documents/Luna2/luna/src/ai_functions.py", line 40, in get_ai_response
    api_key = load_openai_api_key()
              ^^^^^^^^^^^^^^^^^^^
NameError: name 'load_openai_api_key' is not defined
2025-01-05 02:19:32,697 [DEBUG] __main__: Preparing to close the event loop.
2025-01-05 02:19:32,697 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-05 02:20:11,591 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-05 02:20:11,591 [DEBUG] __main__: Exiting configure_logging function.
2025-01-05 02:20:11,591 [DEBUG] __main__: Logging configuration complete.
2025-01-05 02:20:11,591 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-05 02:20:11,591 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 02:20:11,591 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-05 02:20:11,591 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-05 02:20:11,591 [DEBUG] __main__: Entering start_console_thread function.
2025-01-05 02:20:11,591 [INFO] __main__: Console thread started successfully.
2025-01-05 02:20:11,591 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-05 02:20:11,591 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-05 02:20:11,592 [INFO] __main__: Starting main_logic coroutine.
2025-01-05 02:20:11,592 [DEBUG] __main__: Entering main_logic function...
2025-01-05 02:20:11,592 [DEBUG] __main__: Attempting to load or log in the client.
2025-01-05 02:20:11,592 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-05 02:20:11,592 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-05 02:20:11,592 [INFO] src.luna_functions: Using saved token for user @luna:localhost.
2025-01-05 02:20:11,592 [DEBUG] __main__: Client obtained. Storing reference to DIRECTOR_CLIENT in src.luna_functions.
2025-01-05 02:20:11,592 [DEBUG] __main__: Callbacks registered successfully.
2025-01-05 02:20:11,592 [DEBUG] __main__: Starting sync_forever loop. Awaiting new events with timeout=30000.
2025-01-05 02:20:11,614 [INFO] nio.client.base_client: New joined room !IQTJHuSCcTLlkCZzzF:localhost
2025-01-05 02:20:11,614 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-05 02:20:11,614 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomCreateEvent
2025-01-05 02:20:11,614 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomJoinRulesEvent
2025-01-05 02:20:11,614 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomGuestAccessEvent
2025-01-05 02:20:11,614 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type PowerLevelsEvent
2025-01-05 02:20:11,614 [INFO] nio.rooms: Changing power level for user @evan:localhost from 0 to 100
2025-01-05 02:20:11,614 [INFO] nio.rooms: Changing power level for user @luna:localhost from 0 to 100
2025-01-05 02:20:11,614 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:20:11,614 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:20:11,614 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:20:11,614 [DEBUG] src.luna_functions: Got an event of type: <class 'nio.events.room_events.RoomMessageText'>, content: {'type': 'm.room.message', 'sender': '@evan:localhost', 'content': {'msgtype': 'm.text', 'body': 'test', 'm.mentions': {}}, 'origin_server_ts': 1736059616879, 'unsigned': {'membership': 'join', 'age': 1994725}, 'event_id': '$x9KWoqnHlDWrve07GtsqHSSzNPGfClKYDi03zJRen08'}
2025-01-05 02:20:11,614 [INFO] src.luna_functions: Received message in !IQTJHuSCcTLlkCZzzF:localhost from @evan:localhost: test
2025-01-05 02:20:11,614 [DEBUG] src.ai_functions: get_ai_response called with prompt: test
2025-01-05 02:20:11,615 [DEBUG] src.ai_functions: Sending prompt to OpenAI using model 'gpt-4o'.
2025-01-05 02:20:11,615 [ERROR] src.ai_functions: OpenAI call failed: 

You tried to access openai.ChatCompletion, but this is no longer supported in openai>=1.0.0 - see the README at https://github.com/openai/openai-python for the API.

You can run `openai migrate` to automatically upgrade your codebase to use the 1.0.0 interface. 

Alternatively, you can pin your installation to the old version, e.g. `pip install openai==0.28`

A detailed migration guide is available here: https://github.com/openai/openai-python/discussions/742
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/src/ai_functions.py", line 48, in get_ai_response
    response = openai.ChatCompletion.create(
        model=model,
    ...<2 lines>...
        temperature=0.7
    )
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/openai/lib/_old_api.py", line 39, in __call__
    raise APIRemovedInV1(symbol=self._symbol)
openai.lib._old_api.APIRemovedInV1: 

You tried to access openai.ChatCompletion, but this is no longer supported in openai>=1.0.0 - see the README at https://github.com/openai/openai-python for the API.

You can run `openai migrate` to automatically upgrade your codebase to use the 1.0.0 interface. 

Alternatively, you can pin your installation to the old version, e.g. `pip install openai==0.28`

A detailed migration guide is available here: https://github.com/openai/openai-python/discussions/742

2025-01-05 02:20:11,616 [DEBUG] src.luna_functions: Sending response: Hello @evan:localhost, you said 'test' (auto-respond).
2025-01-05 02:20:11,645 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:20:11,645 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:20:11,646 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:20:11,646 [DEBUG] src.luna_functions: Got an event of type: <class 'nio.events.room_events.RoomMessageText'>, content: {'type': 'm.room.message', 'sender': '@evan:localhost', 'content': {'msgtype': 'm.text', 'body': 'hi privately', 'm.mentions': {}}, 'origin_server_ts': 1736059945689, 'unsigned': {'membership': 'join', 'age': 1665915}, 'event_id': '$BNRZdQHwlHN-A-IrkZUQFuwhaJ5rMAjTW9YovngPJxs'}
2025-01-05 02:20:11,646 [INFO] src.luna_functions: Received message in !IQTJHuSCcTLlkCZzzF:localhost from @evan:localhost: hi privately
2025-01-05 02:20:11,646 [DEBUG] src.ai_functions: get_ai_response called with prompt: hi privately
2025-01-05 02:20:11,646 [DEBUG] src.ai_functions: Sending prompt to OpenAI using model 'gpt-4o'.
2025-01-05 02:20:11,646 [ERROR] src.ai_functions: OpenAI call failed: 

You tried to access openai.ChatCompletion, but this is no longer supported in openai>=1.0.0 - see the README at https://github.com/openai/openai-python for the API.

You can run `openai migrate` to automatically upgrade your codebase to use the 1.0.0 interface. 

Alternatively, you can pin your installation to the old version, e.g. `pip install openai==0.28`

A detailed migration guide is available here: https://github.com/openai/openai-python/discussions/742
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/src/ai_functions.py", line 48, in get_ai_response
    response = openai.ChatCompletion.create(
        model=model,
    ...<2 lines>...
        temperature=0.7
    )
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/openai/lib/_old_api.py", line 39, in __call__
    raise APIRemovedInV1(symbol=self._symbol)
openai.lib._old_api.APIRemovedInV1: 

You tried to access openai.ChatCompletion, but this is no longer supported in openai>=1.0.0 - see the README at https://github.com/openai/openai-python for the API.

You can run `openai migrate` to automatically upgrade your codebase to use the 1.0.0 interface. 

Alternatively, you can pin your installation to the old version, e.g. `pip install openai==0.28`

A detailed migration guide is available here: https://github.com/openai/openai-python/discussions/742

2025-01-05 02:20:11,646 [DEBUG] src.luna_functions: Sending response: Hello @evan:localhost, you said 'hi privately' (auto-respond).
2025-01-05 02:20:11,663 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:20:11,663 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:20:11,663 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:20:11,663 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:20:11,663 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:20:11,664 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:20:11,664 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:20:11,664 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:20:11,664 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:20:11,664 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:20:11,664 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:20:11,664 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:20:11,664 [INFO] nio.client.base_client: New joined room !ZhsKXLoMEydpudauIE:localhost
2025-01-05 02:20:11,664 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomAliasEvent
2025-01-05 02:20:11,664 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomCreateEvent
2025-01-05 02:20:11,664 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomJoinRulesEvent
2025-01-05 02:20:11,664 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-05 02:20:11,664 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type PowerLevelsEvent
2025-01-05 02:20:11,664 [INFO] nio.rooms: Changing power level for user @evan:localhost from 0 to 100
2025-01-05 02:20:11,664 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomNameEvent
2025-01-05 02:20:11,664 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:20:11,664 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:20:11,664 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:20:11,664 [DEBUG] src.luna_functions: Got an event of type: <class 'nio.events.room_events.RoomMessageText'>, content: {'type': 'm.room.message', 'sender': '@evan:localhost', 'content': {'msgtype': 'm.text', 'body': 'test', 'm.mentions': {}}, 'origin_server_ts': 1736060807613, 'unsigned': {'membership': 'join', 'age': 803991}, 'event_id': '$AkKt_f-Qd0mh7TRT1BFcFNGxnbvk03LPM_Ted83Mwhw'}
2025-01-05 02:20:11,664 [INFO] src.luna_functions: Received message in !ZhsKXLoMEydpudauIE:localhost from @evan:localhost: test
2025-01-05 02:20:11,664 [DEBUG] src.ai_functions: get_ai_response called with prompt: test
2025-01-05 02:20:11,664 [DEBUG] src.ai_functions: Sending prompt to OpenAI using model 'gpt-4o'.
2025-01-05 02:20:11,664 [ERROR] src.ai_functions: OpenAI call failed: 

You tried to access openai.ChatCompletion, but this is no longer supported in openai>=1.0.0 - see the README at https://github.com/openai/openai-python for the API.

You can run `openai migrate` to automatically upgrade your codebase to use the 1.0.0 interface. 

Alternatively, you can pin your installation to the old version, e.g. `pip install openai==0.28`

A detailed migration guide is available here: https://github.com/openai/openai-python/discussions/742
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/src/ai_functions.py", line 48, in get_ai_response
    response = openai.ChatCompletion.create(
        model=model,
    ...<2 lines>...
        temperature=0.7
    )
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/openai/lib/_old_api.py", line 39, in __call__
    raise APIRemovedInV1(symbol=self._symbol)
openai.lib._old_api.APIRemovedInV1: 

You tried to access openai.ChatCompletion, but this is no longer supported in openai>=1.0.0 - see the README at https://github.com/openai/openai-python for the API.

You can run `openai migrate` to automatically upgrade your codebase to use the 1.0.0 interface. 

Alternatively, you can pin your installation to the old version, e.g. `pip install openai==0.28`

A detailed migration guide is available here: https://github.com/openai/openai-python/discussions/742

2025-01-05 02:20:11,665 [DEBUG] src.luna_functions: Sending response: Hello @evan:localhost, you said 'test' (auto-respond).
2025-01-05 02:20:11,702 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:20:11,703 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:20:11,703 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:20:11,703 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:20:11,703 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:20:11,703 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:20:11,703 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:20:11,703 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:20:11,703 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:20:11,703 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:20:11,703 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:20:11,703 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:20:11,703 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:20:11,703 [DEBUG] src.luna_functions: Got an event of type: <class 'nio.events.room_events.RoomMessageText'>, content: {'type': 'm.room.message', 'sender': '@evan:localhost', 'content': {'msgtype': 'm.text', 'body': 'test', 'm.mentions': {}}, 'origin_server_ts': 1736061126143, 'unsigned': {'membership': 'join', 'age': 485461}, 'event_id': '$8HPUQ6c2hkh5V_1FAUucqkcw9DqKsg0OUmf4dT5Z72w'}
2025-01-05 02:20:11,703 [INFO] src.luna_functions: Received message in !ZhsKXLoMEydpudauIE:localhost from @evan:localhost: test
2025-01-05 02:20:11,703 [DEBUG] src.ai_functions: get_ai_response called with prompt: test
2025-01-05 02:20:11,703 [DEBUG] src.ai_functions: Sending prompt to OpenAI using model 'gpt-4o'.
2025-01-05 02:20:11,703 [ERROR] src.ai_functions: OpenAI call failed: 

You tried to access openai.ChatCompletion, but this is no longer supported in openai>=1.0.0 - see the README at https://github.com/openai/openai-python for the API.

You can run `openai migrate` to automatically upgrade your codebase to use the 1.0.0 interface. 

Alternatively, you can pin your installation to the old version, e.g. `pip install openai==0.28`

A detailed migration guide is available here: https://github.com/openai/openai-python/discussions/742
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/src/ai_functions.py", line 48, in get_ai_response
    response = openai.ChatCompletion.create(
        model=model,
    ...<2 lines>...
        temperature=0.7
    )
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/openai/lib/_old_api.py", line 39, in __call__
    raise APIRemovedInV1(symbol=self._symbol)
openai.lib._old_api.APIRemovedInV1: 

You tried to access openai.ChatCompletion, but this is no longer supported in openai>=1.0.0 - see the README at https://github.com/openai/openai-python for the API.

You can run `openai migrate` to automatically upgrade your codebase to use the 1.0.0 interface. 

Alternatively, you can pin your installation to the old version, e.g. `pip install openai==0.28`

A detailed migration guide is available here: https://github.com/openai/openai-python/discussions/742

2025-01-05 02:20:11,704 [DEBUG] src.luna_functions: Sending response: Hello @evan:localhost, you said 'test' (auto-respond).
2025-01-05 02:20:11,717 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:20:11,717 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:20:11,717 [INFO] nio.client.base_client: New joined room !roKWYbjbZOVUoYPFtD:localhost
2025-01-05 02:20:11,717 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-05 02:20:11,717 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type RoomJoinRulesEvent
2025-01-05 02:20:11,718 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type RoomCreateEvent
2025-01-05 02:20:11,718 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type PowerLevelsEvent
2025-01-05 02:20:11,718 [INFO] nio.rooms: Changing power level for user @evan:localhost from 0 to 100
2025-01-05 02:20:11,718 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type RoomGuestAccessEvent
2025-01-05 02:20:11,718 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type RoomEncryptionEvent
2025-01-05 02:20:11,718 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type RoomNameEvent
2025-01-05 02:20:11,718 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type MegolmEvent
2025-01-05 02:20:11,718 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type MegolmEvent
2025-01-05 02:20:11,718 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type MegolmEvent
2025-01-05 02:20:11,718 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type MegolmEvent
2025-01-05 02:20:11,718 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type MegolmEvent
2025-01-05 02:20:11,718 [INFO] nio.client.base_client: New joined room !vqsQaVVLtsvWxIoJwV:localhost
2025-01-05 02:20:11,718 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type PowerLevelsEvent
2025-01-05 02:20:11,718 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomCreateEvent
2025-01-05 02:20:11,718 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomJoinRulesEvent
2025-01-05 02:20:11,718 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-05 02:20:11,718 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomGuestAccessEvent
2025-01-05 02:20:11,718 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomEncryptionEvent
2025-01-05 02:20:11,718 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomNameEvent
2025-01-05 02:20:11,718 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type MegolmEvent
2025-01-05 02:20:11,718 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type MegolmEvent
2025-01-05 02:20:11,723 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:20:11,723 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:20:11,723 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:20:11,723 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:20:11,723 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:20:11,723 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:20:11,723 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:20:11,723 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:20:48,327 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:20:48,328 [DEBUG] src.luna_functions: Got an event of type: <class 'nio.events.room_events.RoomMessageText'>, content: {'type': 'm.room.message', 'sender': '@evan:localhost', 'content': {'msgtype': 'm.text', 'body': 'test', 'm.mentions': {}}, 'origin_server_ts': 1736061648313, 'unsigned': {'membership': 'join', 'age': 13}, 'event_id': '$I7LeE2N2EmTe6qXPJTd2irpGGHNQDhr72Qv8bGMyYA8'}
2025-01-05 02:20:48,328 [INFO] src.luna_functions: Received message in !ZhsKXLoMEydpudauIE:localhost from @evan:localhost: test
2025-01-05 02:20:48,328 [DEBUG] src.ai_functions: get_ai_response called with prompt: test
2025-01-05 02:20:48,328 [DEBUG] src.ai_functions: Sending prompt to OpenAI using model 'gpt-4o'.
2025-01-05 02:20:48,329 [ERROR] src.ai_functions: OpenAI call failed: 

You tried to access openai.ChatCompletion, but this is no longer supported in openai>=1.0.0 - see the README at https://github.com/openai/openai-python for the API.

You can run `openai migrate` to automatically upgrade your codebase to use the 1.0.0 interface. 

Alternatively, you can pin your installation to the old version, e.g. `pip install openai==0.28`

A detailed migration guide is available here: https://github.com/openai/openai-python/discussions/742
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/src/ai_functions.py", line 48, in get_ai_response
    response = openai.ChatCompletion.create(
        model=model,
    ...<2 lines>...
        temperature=0.7
    )
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/openai/lib/_old_api.py", line 39, in __call__
    raise APIRemovedInV1(symbol=self._symbol)
openai.lib._old_api.APIRemovedInV1: 

You tried to access openai.ChatCompletion, but this is no longer supported in openai>=1.0.0 - see the README at https://github.com/openai/openai-python for the API.

You can run `openai migrate` to automatically upgrade your codebase to use the 1.0.0 interface. 

Alternatively, you can pin your installation to the old version, e.g. `pip install openai==0.28`

A detailed migration guide is available here: https://github.com/openai/openai-python/discussions/742

2025-01-05 02:20:48,330 [DEBUG] src.luna_functions: Sending response: Hello @evan:localhost, you said 'test' (auto-respond).
2025-01-05 02:20:48,350 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:20:48,350 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:21:50,179 [WARNING] __main__: KeyboardInterrupt received. Shutting down Director.
2025-01-05 02:21:50,180 [DEBUG] __main__: Preparing to close the event loop.
2025-01-05 02:21:50,180 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-05 02:21:51,880 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-05 02:21:51,880 [DEBUG] __main__: Exiting configure_logging function.
2025-01-05 02:21:51,881 [DEBUG] __main__: Logging configuration complete.
2025-01-05 02:21:51,881 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-05 02:21:51,881 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 02:21:51,881 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-05 02:21:51,881 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-05 02:21:51,881 [DEBUG] __main__: Entering start_console_thread function.
2025-01-05 02:21:51,881 [INFO] __main__: Console thread started successfully.
2025-01-05 02:21:51,881 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-05 02:21:51,881 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-05 02:21:51,881 [INFO] __main__: Starting main_logic coroutine.
2025-01-05 02:21:51,881 [DEBUG] __main__: Entering main_logic function...
2025-01-05 02:21:51,881 [DEBUG] __main__: Attempting to load or log in the client.
2025-01-05 02:21:51,881 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-05 02:21:51,881 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-05 02:21:51,881 [INFO] src.luna_functions: Using saved token for user @luna:localhost.
2025-01-05 02:21:51,881 [DEBUG] __main__: Client obtained. Storing reference to DIRECTOR_CLIENT in src.luna_functions.
2025-01-05 02:21:51,881 [DEBUG] __main__: Callbacks registered successfully.
2025-01-05 02:21:51,881 [DEBUG] __main__: Starting sync_forever loop. Awaiting new events with timeout=30000.
2025-01-05 02:21:51,917 [INFO] nio.client.base_client: New joined room !roKWYbjbZOVUoYPFtD:localhost
2025-01-05 02:21:51,917 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-05 02:21:51,917 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type RoomJoinRulesEvent
2025-01-05 02:21:51,917 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type RoomCreateEvent
2025-01-05 02:21:51,917 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type PowerLevelsEvent
2025-01-05 02:21:51,917 [INFO] nio.rooms: Changing power level for user @evan:localhost from 0 to 100
2025-01-05 02:21:51,917 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type RoomGuestAccessEvent
2025-01-05 02:21:51,917 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type RoomEncryptionEvent
2025-01-05 02:21:51,917 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type RoomNameEvent
2025-01-05 02:21:51,917 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type MegolmEvent
2025-01-05 02:21:51,917 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type MegolmEvent
2025-01-05 02:21:51,918 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type MegolmEvent
2025-01-05 02:21:51,918 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type MegolmEvent
2025-01-05 02:21:51,918 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type MegolmEvent
2025-01-05 02:21:51,918 [INFO] nio.client.base_client: New joined room !vqsQaVVLtsvWxIoJwV:localhost
2025-01-05 02:21:51,918 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type PowerLevelsEvent
2025-01-05 02:21:51,918 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomCreateEvent
2025-01-05 02:21:51,918 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomJoinRulesEvent
2025-01-05 02:21:51,918 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-05 02:21:51,918 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomGuestAccessEvent
2025-01-05 02:21:51,918 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomEncryptionEvent
2025-01-05 02:21:51,918 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomNameEvent
2025-01-05 02:21:51,918 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type MegolmEvent
2025-01-05 02:21:51,918 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type MegolmEvent
2025-01-05 02:21:51,918 [INFO] nio.client.base_client: New joined room !IQTJHuSCcTLlkCZzzF:localhost
2025-01-05 02:21:51,918 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-05 02:21:51,918 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomCreateEvent
2025-01-05 02:21:51,918 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomJoinRulesEvent
2025-01-05 02:21:51,918 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomGuestAccessEvent
2025-01-05 02:21:51,918 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type PowerLevelsEvent
2025-01-05 02:21:51,918 [INFO] nio.rooms: Changing power level for user @evan:localhost from 0 to 100
2025-01-05 02:21:51,918 [INFO] nio.rooms: Changing power level for user @luna:localhost from 0 to 100
2025-01-05 02:21:51,918 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:21:51,918 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:21:51,918 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:21:51,918 [DEBUG] src.luna_functions: Got an event of type: <class 'nio.events.room_events.RoomMessageText'>, content: {'type': 'm.room.message', 'sender': '@evan:localhost', 'content': {'msgtype': 'm.text', 'body': 'hi privately', 'm.mentions': {}}, 'origin_server_ts': 1736059945689, 'unsigned': {'membership': 'join', 'age': 1766221}, 'event_id': '$BNRZdQHwlHN-A-IrkZUQFuwhaJ5rMAjTW9YovngPJxs'}
2025-01-05 02:21:51,918 [INFO] src.luna_functions: Received message in !IQTJHuSCcTLlkCZzzF:localhost from @evan:localhost: hi privately
2025-01-05 02:21:51,918 [DEBUG] src.ai_functions: get_ai_response called with prompt: hi privately
2025-01-05 02:21:51,918 [DEBUG] src.ai_functions: Sending prompt to OpenAI using model 'gpt-4o'.
2025-01-05 02:21:51,918 [ERROR] src.ai_functions: OpenAI call failed: 

You tried to access openai.ChatCompletion, but this is no longer supported in openai>=1.0.0 - see the README at https://github.com/openai/openai-python for the API.

You can run `openai migrate` to automatically upgrade your codebase to use the 1.0.0 interface. 

Alternatively, you can pin your installation to the old version, e.g. `pip install openai==0.28`

A detailed migration guide is available here: https://github.com/openai/openai-python/discussions/742
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/src/ai_functions.py", line 48, in get_ai_response
    response = openai.ChatCompletion.create(
        model=model,
    ...<2 lines>...
        temperature=0.7
    )
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/openai/lib/_old_api.py", line 39, in __call__
    raise APIRemovedInV1(symbol=self._symbol)
openai.lib._old_api.APIRemovedInV1: 

You tried to access openai.ChatCompletion, but this is no longer supported in openai>=1.0.0 - see the README at https://github.com/openai/openai-python for the API.

You can run `openai migrate` to automatically upgrade your codebase to use the 1.0.0 interface. 

Alternatively, you can pin your installation to the old version, e.g. `pip install openai==0.28`

A detailed migration guide is available here: https://github.com/openai/openai-python/discussions/742

2025-01-05 02:21:51,919 [ERROR] __main__: An unexpected exception occurred in main_logic: name 'debug' is not defined
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 131, in luna
    loop.run_until_complete(main_logic())
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 720, in run_until_complete
    return future.result()
           ~~~~~~~~~~~~~^^
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 95, in main_logic
    await client.sync_forever(timeout=30000)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/base_client.py", line 116, in wrapper
    return await func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 1358, in sync_forever
    sync_response = await self.sync(
                    ^^^^^^^^^^^^^^^^
        use_timeout, use_filter, since, full_state, presence
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/base_client.py", line 116, in wrapper
    return await func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 1232, in sync
    response = await self._send(
               ^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 880, in _send
    await self.receive_response(resp)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 770, in receive_response
    await self._handle_sync(response)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 737, in _handle_sync
    await self._handle_joined_rooms(response)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 635, in _handle_joined_rooms
    await self._on_event(event, room)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 697, in _on_event
    await cb.async_execute(event, room)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/base_client.py", line 160, in async_execute
    await result
  File "/Users/evanrobinson/Documents/Luna2/luna/src/luna_functions.py", line 142, in on_room_message
    debug.info(f"GPT Response: {ai_functions.get_ai_response(f'{body}')}")
    ^^^^^
NameError: name 'debug' is not defined
2025-01-05 02:21:51,922 [DEBUG] __main__: Preparing to close the event loop.
2025-01-05 02:21:51,922 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-05 02:21:54,873 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-05 02:21:54,873 [DEBUG] __main__: Exiting configure_logging function.
2025-01-05 02:21:54,874 [DEBUG] __main__: Logging configuration complete.
2025-01-05 02:21:54,874 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-05 02:21:54,874 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 02:21:54,874 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-05 02:21:54,874 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-05 02:21:54,874 [DEBUG] __main__: Entering start_console_thread function.
2025-01-05 02:21:54,874 [INFO] __main__: Console thread started successfully.
2025-01-05 02:21:54,874 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-05 02:21:54,874 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-05 02:21:54,874 [INFO] __main__: Starting main_logic coroutine.
2025-01-05 02:21:54,874 [DEBUG] __main__: Entering main_logic function...
2025-01-05 02:21:54,874 [DEBUG] __main__: Attempting to load or log in the client.
2025-01-05 02:21:54,874 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-05 02:21:54,874 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-05 02:21:54,874 [INFO] src.luna_functions: Using saved token for user @luna:localhost.
2025-01-05 02:21:54,874 [DEBUG] __main__: Client obtained. Storing reference to DIRECTOR_CLIENT in src.luna_functions.
2025-01-05 02:21:54,874 [DEBUG] __main__: Callbacks registered successfully.
2025-01-05 02:21:54,874 [DEBUG] __main__: Starting sync_forever loop. Awaiting new events with timeout=30000.
2025-01-05 02:21:54,891 [INFO] nio.client.base_client: New joined room !roKWYbjbZOVUoYPFtD:localhost
2025-01-05 02:21:54,891 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-05 02:21:54,891 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type RoomJoinRulesEvent
2025-01-05 02:21:54,891 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type RoomCreateEvent
2025-01-05 02:21:54,892 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type PowerLevelsEvent
2025-01-05 02:21:54,892 [INFO] nio.rooms: Changing power level for user @evan:localhost from 0 to 100
2025-01-05 02:21:54,892 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type RoomGuestAccessEvent
2025-01-05 02:21:54,892 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type RoomEncryptionEvent
2025-01-05 02:21:54,892 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type RoomNameEvent
2025-01-05 02:21:54,892 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type MegolmEvent
2025-01-05 02:21:54,892 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type MegolmEvent
2025-01-05 02:21:54,892 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type MegolmEvent
2025-01-05 02:21:54,892 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type MegolmEvent
2025-01-05 02:21:54,892 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type MegolmEvent
2025-01-05 02:21:54,892 [INFO] nio.client.base_client: New joined room !vqsQaVVLtsvWxIoJwV:localhost
2025-01-05 02:21:54,892 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type PowerLevelsEvent
2025-01-05 02:21:54,892 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomCreateEvent
2025-01-05 02:21:54,892 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomJoinRulesEvent
2025-01-05 02:21:54,892 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-05 02:21:54,892 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomGuestAccessEvent
2025-01-05 02:21:54,892 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomEncryptionEvent
2025-01-05 02:21:54,892 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomNameEvent
2025-01-05 02:21:54,892 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type MegolmEvent
2025-01-05 02:21:54,892 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type MegolmEvent
2025-01-05 02:21:54,892 [INFO] nio.client.base_client: New joined room !IQTJHuSCcTLlkCZzzF:localhost
2025-01-05 02:21:54,892 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-05 02:21:54,892 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomCreateEvent
2025-01-05 02:21:54,892 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomJoinRulesEvent
2025-01-05 02:21:54,892 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomGuestAccessEvent
2025-01-05 02:21:54,892 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type PowerLevelsEvent
2025-01-05 02:21:54,892 [INFO] nio.rooms: Changing power level for user @evan:localhost from 0 to 100
2025-01-05 02:21:54,892 [INFO] nio.rooms: Changing power level for user @luna:localhost from 0 to 100
2025-01-05 02:21:54,892 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:21:54,892 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:21:54,892 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:21:54,892 [DEBUG] src.luna_functions: Got an event of type: <class 'nio.events.room_events.RoomMessageText'>, content: {'type': 'm.room.message', 'sender': '@evan:localhost', 'content': {'msgtype': 'm.text', 'body': 'hi privately', 'm.mentions': {}}, 'origin_server_ts': 1736059945689, 'unsigned': {'membership': 'join', 'age': 1769192}, 'event_id': '$BNRZdQHwlHN-A-IrkZUQFuwhaJ5rMAjTW9YovngPJxs'}
2025-01-05 02:21:54,892 [INFO] src.luna_functions: Received message in !IQTJHuSCcTLlkCZzzF:localhost from @evan:localhost: hi privately
2025-01-05 02:21:54,892 [DEBUG] src.ai_functions: get_ai_response called with prompt: hi privately
2025-01-05 02:21:54,893 [DEBUG] src.ai_functions: Sending prompt to OpenAI using model 'gpt-4o'.
2025-01-05 02:21:54,893 [ERROR] src.ai_functions: OpenAI call failed: 

You tried to access openai.ChatCompletion, but this is no longer supported in openai>=1.0.0 - see the README at https://github.com/openai/openai-python for the API.

You can run `openai migrate` to automatically upgrade your codebase to use the 1.0.0 interface. 

Alternatively, you can pin your installation to the old version, e.g. `pip install openai==0.28`

A detailed migration guide is available here: https://github.com/openai/openai-python/discussions/742
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/src/ai_functions.py", line 48, in get_ai_response
    response = openai.ChatCompletion.create(
        model=model,
    ...<2 lines>...
        temperature=0.7
    )
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/openai/lib/_old_api.py", line 39, in __call__
    raise APIRemovedInV1(symbol=self._symbol)
openai.lib._old_api.APIRemovedInV1: 

You tried to access openai.ChatCompletion, but this is no longer supported in openai>=1.0.0 - see the README at https://github.com/openai/openai-python for the API.

You can run `openai migrate` to automatically upgrade your codebase to use the 1.0.0 interface. 

Alternatively, you can pin your installation to the old version, e.g. `pip install openai==0.28`

A detailed migration guide is available here: https://github.com/openai/openai-python/discussions/742

2025-01-05 02:21:54,893 [ERROR] __main__: An unexpected exception occurred in main_logic: name 'debug' is not defined
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 131, in luna
    loop.run_until_complete(main_logic())
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 720, in run_until_complete
    return future.result()
           ~~~~~~~~~~~~~^^
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 95, in main_logic
    await client.sync_forever(timeout=30000)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/base_client.py", line 116, in wrapper
    return await func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 1358, in sync_forever
    sync_response = await self.sync(
                    ^^^^^^^^^^^^^^^^
        use_timeout, use_filter, since, full_state, presence
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/base_client.py", line 116, in wrapper
    return await func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 1232, in sync
    response = await self._send(
               ^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 880, in _send
    await self.receive_response(resp)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 770, in receive_response
    await self._handle_sync(response)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 737, in _handle_sync
    await self._handle_joined_rooms(response)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 635, in _handle_joined_rooms
    await self._on_event(event, room)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 697, in _on_event
    await cb.async_execute(event, room)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/base_client.py", line 160, in async_execute
    await result
  File "/Users/evanrobinson/Documents/Luna2/luna/src/luna_functions.py", line 142, in on_room_message
    debug.info(f"GPT Response: {ai_functions.get_ai_response(f'{body}')}")
    ^^^^^
NameError: name 'debug' is not defined
2025-01-05 02:21:54,895 [DEBUG] __main__: Preparing to close the event loop.
2025-01-05 02:21:54,895 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-05 02:22:04,168 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-05 02:22:04,168 [DEBUG] __main__: Exiting configure_logging function.
2025-01-05 02:22:04,168 [DEBUG] __main__: Logging configuration complete.
2025-01-05 02:22:04,168 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-05 02:22:04,168 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 02:22:04,168 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-05 02:22:04,168 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-05 02:22:04,168 [DEBUG] __main__: Entering start_console_thread function.
2025-01-05 02:22:04,168 [INFO] __main__: Console thread started successfully.
2025-01-05 02:22:04,168 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-05 02:22:04,169 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-05 02:22:04,169 [INFO] __main__: Starting main_logic coroutine.
2025-01-05 02:22:04,169 [DEBUG] __main__: Entering main_logic function...
2025-01-05 02:22:04,169 [DEBUG] __main__: Attempting to load or log in the client.
2025-01-05 02:22:04,169 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-05 02:22:04,169 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-05 02:22:04,169 [INFO] src.luna_functions: Using saved token for user @luna:localhost.
2025-01-05 02:22:04,169 [DEBUG] __main__: Client obtained. Storing reference to DIRECTOR_CLIENT in src.luna_functions.
2025-01-05 02:22:04,169 [DEBUG] __main__: Callbacks registered successfully.
2025-01-05 02:22:04,169 [DEBUG] __main__: Starting sync_forever loop. Awaiting new events with timeout=30000.
2025-01-05 02:22:04,186 [INFO] nio.client.base_client: New joined room !roKWYbjbZOVUoYPFtD:localhost
2025-01-05 02:22:04,186 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-05 02:22:04,186 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type RoomJoinRulesEvent
2025-01-05 02:22:04,186 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type RoomCreateEvent
2025-01-05 02:22:04,186 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type PowerLevelsEvent
2025-01-05 02:22:04,186 [INFO] nio.rooms: Changing power level for user @evan:localhost from 0 to 100
2025-01-05 02:22:04,186 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type RoomGuestAccessEvent
2025-01-05 02:22:04,187 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type RoomEncryptionEvent
2025-01-05 02:22:04,187 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type RoomNameEvent
2025-01-05 02:22:04,187 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type MegolmEvent
2025-01-05 02:22:04,187 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type MegolmEvent
2025-01-05 02:22:04,187 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type MegolmEvent
2025-01-05 02:22:04,187 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type MegolmEvent
2025-01-05 02:22:04,187 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type MegolmEvent
2025-01-05 02:22:04,187 [INFO] nio.client.base_client: New joined room !vqsQaVVLtsvWxIoJwV:localhost
2025-01-05 02:22:04,187 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type PowerLevelsEvent
2025-01-05 02:22:04,187 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomCreateEvent
2025-01-05 02:22:04,187 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomJoinRulesEvent
2025-01-05 02:22:04,187 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-05 02:22:04,187 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomGuestAccessEvent
2025-01-05 02:22:04,187 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomEncryptionEvent
2025-01-05 02:22:04,187 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomNameEvent
2025-01-05 02:22:04,187 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type MegolmEvent
2025-01-05 02:22:04,187 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type MegolmEvent
2025-01-05 02:22:04,187 [INFO] nio.client.base_client: New joined room !IQTJHuSCcTLlkCZzzF:localhost
2025-01-05 02:22:04,187 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-05 02:22:04,187 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomCreateEvent
2025-01-05 02:22:04,187 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomJoinRulesEvent
2025-01-05 02:22:04,187 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomGuestAccessEvent
2025-01-05 02:22:04,187 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type PowerLevelsEvent
2025-01-05 02:22:04,187 [INFO] nio.rooms: Changing power level for user @evan:localhost from 0 to 100
2025-01-05 02:22:04,187 [INFO] nio.rooms: Changing power level for user @luna:localhost from 0 to 100
2025-01-05 02:22:04,187 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:22:04,187 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:22:04,187 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:22:04,187 [DEBUG] src.luna_functions: Got an event of type: <class 'nio.events.room_events.RoomMessageText'>, content: {'type': 'm.room.message', 'sender': '@evan:localhost', 'content': {'msgtype': 'm.text', 'body': 'hi privately', 'm.mentions': {}}, 'origin_server_ts': 1736059945689, 'unsigned': {'membership': 'join', 'age': 1778486}, 'event_id': '$BNRZdQHwlHN-A-IrkZUQFuwhaJ5rMAjTW9YovngPJxs'}
2025-01-05 02:22:04,187 [INFO] src.luna_functions: Received message in !IQTJHuSCcTLlkCZzzF:localhost from @evan:localhost: hi privately
2025-01-05 02:22:04,187 [DEBUG] src.ai_functions: get_ai_response called with prompt: hi privately
2025-01-05 02:22:04,188 [DEBUG] src.ai_functions: Sending prompt to OpenAI using model 'gpt-4o'.
2025-01-05 02:22:04,188 [ERROR] src.ai_functions: OpenAI call failed: 

You tried to access openai.ChatCompletion, but this is no longer supported in openai>=1.0.0 - see the README at https://github.com/openai/openai-python for the API.

You can run `openai migrate` to automatically upgrade your codebase to use the 1.0.0 interface. 

Alternatively, you can pin your installation to the old version, e.g. `pip install openai==0.28`

A detailed migration guide is available here: https://github.com/openai/openai-python/discussions/742
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/src/ai_functions.py", line 48, in get_ai_response
    response = openai.ChatCompletion.create(
        model=model,
    ...<2 lines>...
        temperature=0.7
    )
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/openai/lib/_old_api.py", line 39, in __call__
    raise APIRemovedInV1(symbol=self._symbol)
openai.lib._old_api.APIRemovedInV1: 

You tried to access openai.ChatCompletion, but this is no longer supported in openai>=1.0.0 - see the README at https://github.com/openai/openai-python for the API.

You can run `openai migrate` to automatically upgrade your codebase to use the 1.0.0 interface. 

Alternatively, you can pin your installation to the old version, e.g. `pip install openai==0.28`

A detailed migration guide is available here: https://github.com/openai/openai-python/discussions/742

2025-01-05 02:22:04,188 [DEBUG] src.ai_functions: get_ai_response called with prompt: hi privately
2025-01-05 02:22:04,188 [DEBUG] src.ai_functions: Sending prompt to OpenAI using model 'gpt-4o'.
2025-01-05 02:22:04,188 [ERROR] src.ai_functions: OpenAI call failed: 

You tried to access openai.ChatCompletion, but this is no longer supported in openai>=1.0.0 - see the README at https://github.com/openai/openai-python for the API.

You can run `openai migrate` to automatically upgrade your codebase to use the 1.0.0 interface. 

Alternatively, you can pin your installation to the old version, e.g. `pip install openai==0.28`

A detailed migration guide is available here: https://github.com/openai/openai-python/discussions/742
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/src/ai_functions.py", line 48, in get_ai_response
    response = openai.ChatCompletion.create(
        model=model,
    ...<2 lines>...
        temperature=0.7
    )
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/openai/lib/_old_api.py", line 39, in __call__
    raise APIRemovedInV1(symbol=self._symbol)
openai.lib._old_api.APIRemovedInV1: 

You tried to access openai.ChatCompletion, but this is no longer supported in openai>=1.0.0 - see the README at https://github.com/openai/openai-python for the API.

You can run `openai migrate` to automatically upgrade your codebase to use the 1.0.0 interface. 

Alternatively, you can pin your installation to the old version, e.g. `pip install openai==0.28`

A detailed migration guide is available here: https://github.com/openai/openai-python/discussions/742

2025-01-05 02:22:04,189 [INFO] root: GPT Response: ERROR: OpenAI call failed.
2025-01-05 02:22:04,189 [DEBUG] src.luna_functions: Sending response: Hello @evan:localhost, you said 'hi privately' (auto-respond).
2025-01-05 02:22:04,214 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:22:04,214 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:22:04,214 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:22:04,214 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:22:04,214 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:22:04,214 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:22:04,214 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:22:04,214 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:22:04,215 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:22:04,215 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:22:04,215 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:22:04,215 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:22:04,215 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:22:04,215 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:22:04,215 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:22:04,215 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:22:04,215 [INFO] nio.client.base_client: New joined room !ZhsKXLoMEydpudauIE:localhost
2025-01-05 02:22:04,215 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomAliasEvent
2025-01-05 02:22:04,215 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomCreateEvent
2025-01-05 02:22:04,215 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomJoinRulesEvent
2025-01-05 02:22:04,215 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-05 02:22:04,215 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type PowerLevelsEvent
2025-01-05 02:22:04,215 [INFO] nio.rooms: Changing power level for user @evan:localhost from 0 to 100
2025-01-05 02:22:04,215 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomNameEvent
2025-01-05 02:22:04,215 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:22:04,215 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:22:04,215 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:22:04,215 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:22:04,215 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:22:04,215 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:22:04,215 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:22:04,215 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:22:04,215 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:22:04,215 [DEBUG] src.luna_functions: Got an event of type: <class 'nio.events.room_events.RoomMessageText'>, content: {'type': 'm.room.message', 'sender': '@evan:localhost', 'content': {'msgtype': 'm.text', 'body': 'test', 'm.mentions': {}}, 'origin_server_ts': 1736061126143, 'unsigned': {'membership': 'join', 'age': 598032}, 'event_id': '$8HPUQ6c2hkh5V_1FAUucqkcw9DqKsg0OUmf4dT5Z72w'}
2025-01-05 02:22:04,215 [INFO] src.luna_functions: Received message in !ZhsKXLoMEydpudauIE:localhost from @evan:localhost: test
2025-01-05 02:22:04,215 [DEBUG] src.ai_functions: get_ai_response called with prompt: test
2025-01-05 02:22:04,215 [DEBUG] src.ai_functions: Sending prompt to OpenAI using model 'gpt-4o'.
2025-01-05 02:22:04,215 [ERROR] src.ai_functions: OpenAI call failed: 

You tried to access openai.ChatCompletion, but this is no longer supported in openai>=1.0.0 - see the README at https://github.com/openai/openai-python for the API.

You can run `openai migrate` to automatically upgrade your codebase to use the 1.0.0 interface. 

Alternatively, you can pin your installation to the old version, e.g. `pip install openai==0.28`

A detailed migration guide is available here: https://github.com/openai/openai-python/discussions/742
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/src/ai_functions.py", line 48, in get_ai_response
    response = openai.ChatCompletion.create(
        model=model,
    ...<2 lines>...
        temperature=0.7
    )
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/openai/lib/_old_api.py", line 39, in __call__
    raise APIRemovedInV1(symbol=self._symbol)
openai.lib._old_api.APIRemovedInV1: 

You tried to access openai.ChatCompletion, but this is no longer supported in openai>=1.0.0 - see the README at https://github.com/openai/openai-python for the API.

You can run `openai migrate` to automatically upgrade your codebase to use the 1.0.0 interface. 

Alternatively, you can pin your installation to the old version, e.g. `pip install openai==0.28`

A detailed migration guide is available here: https://github.com/openai/openai-python/discussions/742

2025-01-05 02:22:04,216 [DEBUG] src.ai_functions: get_ai_response called with prompt: test
2025-01-05 02:22:04,216 [DEBUG] src.ai_functions: Sending prompt to OpenAI using model 'gpt-4o'.
2025-01-05 02:22:04,216 [ERROR] src.ai_functions: OpenAI call failed: 

You tried to access openai.ChatCompletion, but this is no longer supported in openai>=1.0.0 - see the README at https://github.com/openai/openai-python for the API.

You can run `openai migrate` to automatically upgrade your codebase to use the 1.0.0 interface. 

Alternatively, you can pin your installation to the old version, e.g. `pip install openai==0.28`

A detailed migration guide is available here: https://github.com/openai/openai-python/discussions/742
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/src/ai_functions.py", line 48, in get_ai_response
    response = openai.ChatCompletion.create(
        model=model,
    ...<2 lines>...
        temperature=0.7
    )
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/openai/lib/_old_api.py", line 39, in __call__
    raise APIRemovedInV1(symbol=self._symbol)
openai.lib._old_api.APIRemovedInV1: 

You tried to access openai.ChatCompletion, but this is no longer supported in openai>=1.0.0 - see the README at https://github.com/openai/openai-python for the API.

You can run `openai migrate` to automatically upgrade your codebase to use the 1.0.0 interface. 

Alternatively, you can pin your installation to the old version, e.g. `pip install openai==0.28`

A detailed migration guide is available here: https://github.com/openai/openai-python/discussions/742

2025-01-05 02:22:04,216 [INFO] root: GPT Response: ERROR: OpenAI call failed.
2025-01-05 02:22:04,216 [DEBUG] src.luna_functions: Sending response: Hello @evan:localhost, you said 'test' (auto-respond).
2025-01-05 02:22:04,228 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:22:04,228 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:22:04,228 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:22:04,228 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:22:04,228 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:22:04,228 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:22:04,228 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:22:04,228 [DEBUG] src.luna_functions: Got an event of type: <class 'nio.events.room_events.RoomMessageText'>, content: {'type': 'm.room.message', 'sender': '@evan:localhost', 'content': {'msgtype': 'm.text', 'body': 'test', 'm.mentions': {}}, 'origin_server_ts': 1736061648313, 'unsigned': {'membership': 'join', 'age': 75862}, 'event_id': '$I7LeE2N2EmTe6qXPJTd2irpGGHNQDhr72Qv8bGMyYA8'}
2025-01-05 02:22:04,228 [INFO] src.luna_functions: Received message in !ZhsKXLoMEydpudauIE:localhost from @evan:localhost: test
2025-01-05 02:22:04,228 [DEBUG] src.ai_functions: get_ai_response called with prompt: test
2025-01-05 02:22:04,228 [DEBUG] src.ai_functions: Sending prompt to OpenAI using model 'gpt-4o'.
2025-01-05 02:22:04,228 [ERROR] src.ai_functions: OpenAI call failed: 

You tried to access openai.ChatCompletion, but this is no longer supported in openai>=1.0.0 - see the README at https://github.com/openai/openai-python for the API.

You can run `openai migrate` to automatically upgrade your codebase to use the 1.0.0 interface. 

Alternatively, you can pin your installation to the old version, e.g. `pip install openai==0.28`

A detailed migration guide is available here: https://github.com/openai/openai-python/discussions/742
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/src/ai_functions.py", line 48, in get_ai_response
    response = openai.ChatCompletion.create(
        model=model,
    ...<2 lines>...
        temperature=0.7
    )
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/openai/lib/_old_api.py", line 39, in __call__
    raise APIRemovedInV1(symbol=self._symbol)
openai.lib._old_api.APIRemovedInV1: 

You tried to access openai.ChatCompletion, but this is no longer supported in openai>=1.0.0 - see the README at https://github.com/openai/openai-python for the API.

You can run `openai migrate` to automatically upgrade your codebase to use the 1.0.0 interface. 

Alternatively, you can pin your installation to the old version, e.g. `pip install openai==0.28`

A detailed migration guide is available here: https://github.com/openai/openai-python/discussions/742

2025-01-05 02:22:04,229 [DEBUG] src.ai_functions: get_ai_response called with prompt: test
2025-01-05 02:22:04,229 [DEBUG] src.ai_functions: Sending prompt to OpenAI using model 'gpt-4o'.
2025-01-05 02:22:04,229 [ERROR] src.ai_functions: OpenAI call failed: 

You tried to access openai.ChatCompletion, but this is no longer supported in openai>=1.0.0 - see the README at https://github.com/openai/openai-python for the API.

You can run `openai migrate` to automatically upgrade your codebase to use the 1.0.0 interface. 

Alternatively, you can pin your installation to the old version, e.g. `pip install openai==0.28`

A detailed migration guide is available here: https://github.com/openai/openai-python/discussions/742
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/src/ai_functions.py", line 48, in get_ai_response
    response = openai.ChatCompletion.create(
        model=model,
    ...<2 lines>...
        temperature=0.7
    )
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/openai/lib/_old_api.py", line 39, in __call__
    raise APIRemovedInV1(symbol=self._symbol)
openai.lib._old_api.APIRemovedInV1: 

You tried to access openai.ChatCompletion, but this is no longer supported in openai>=1.0.0 - see the README at https://github.com/openai/openai-python for the API.

You can run `openai migrate` to automatically upgrade your codebase to use the 1.0.0 interface. 

Alternatively, you can pin your installation to the old version, e.g. `pip install openai==0.28`

A detailed migration guide is available here: https://github.com/openai/openai-python/discussions/742

2025-01-05 02:22:04,229 [INFO] root: GPT Response: ERROR: OpenAI call failed.
2025-01-05 02:22:04,229 [DEBUG] src.luna_functions: Sending response: Hello @evan:localhost, you said 'test' (auto-respond).
2025-01-05 02:22:04,244 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:22:04,244 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:22:04,247 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:22:04,248 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:22:04,253 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:22:04,253 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:22:04,253 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:22:04,253 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:22:11,828 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:22:11,829 [DEBUG] src.luna_functions: Got an event of type: <class 'nio.events.room_events.RoomMessageText'>, content: {'type': 'm.room.message', 'sender': '@evan:localhost', 'content': {'msgtype': 'm.text', 'body': 'hi', 'm.mentions': {}}, 'origin_server_ts': 1736061731809, 'unsigned': {'membership': 'join', 'age': 17}, 'event_id': '$-h8f9o2y0R2aZaDCLpLxdT6OslMrDLk9C-Fs5vGxfI4'}
2025-01-05 02:22:11,829 [INFO] src.luna_functions: Received message in !ZhsKXLoMEydpudauIE:localhost from @evan:localhost: hi
2025-01-05 02:22:11,829 [DEBUG] src.ai_functions: get_ai_response called with prompt: hi
2025-01-05 02:22:11,829 [DEBUG] src.ai_functions: Sending prompt to OpenAI using model 'gpt-4o'.
2025-01-05 02:22:11,830 [ERROR] src.ai_functions: OpenAI call failed: 

You tried to access openai.ChatCompletion, but this is no longer supported in openai>=1.0.0 - see the README at https://github.com/openai/openai-python for the API.

You can run `openai migrate` to automatically upgrade your codebase to use the 1.0.0 interface. 

Alternatively, you can pin your installation to the old version, e.g. `pip install openai==0.28`

A detailed migration guide is available here: https://github.com/openai/openai-python/discussions/742
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/src/ai_functions.py", line 48, in get_ai_response
    response = openai.ChatCompletion.create(
        model=model,
    ...<2 lines>...
        temperature=0.7
    )
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/openai/lib/_old_api.py", line 39, in __call__
    raise APIRemovedInV1(symbol=self._symbol)
openai.lib._old_api.APIRemovedInV1: 

You tried to access openai.ChatCompletion, but this is no longer supported in openai>=1.0.0 - see the README at https://github.com/openai/openai-python for the API.

You can run `openai migrate` to automatically upgrade your codebase to use the 1.0.0 interface. 

Alternatively, you can pin your installation to the old version, e.g. `pip install openai==0.28`

A detailed migration guide is available here: https://github.com/openai/openai-python/discussions/742

2025-01-05 02:22:11,831 [DEBUG] src.ai_functions: get_ai_response called with prompt: hi
2025-01-05 02:22:11,831 [DEBUG] src.ai_functions: Sending prompt to OpenAI using model 'gpt-4o'.
2025-01-05 02:22:11,831 [ERROR] src.ai_functions: OpenAI call failed: 

You tried to access openai.ChatCompletion, but this is no longer supported in openai>=1.0.0 - see the README at https://github.com/openai/openai-python for the API.

You can run `openai migrate` to automatically upgrade your codebase to use the 1.0.0 interface. 

Alternatively, you can pin your installation to the old version, e.g. `pip install openai==0.28`

A detailed migration guide is available here: https://github.com/openai/openai-python/discussions/742
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/src/ai_functions.py", line 48, in get_ai_response
    response = openai.ChatCompletion.create(
        model=model,
    ...<2 lines>...
        temperature=0.7
    )
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/openai/lib/_old_api.py", line 39, in __call__
    raise APIRemovedInV1(symbol=self._symbol)
openai.lib._old_api.APIRemovedInV1: 

You tried to access openai.ChatCompletion, but this is no longer supported in openai>=1.0.0 - see the README at https://github.com/openai/openai-python for the API.

You can run `openai migrate` to automatically upgrade your codebase to use the 1.0.0 interface. 

Alternatively, you can pin your installation to the old version, e.g. `pip install openai==0.28`

A detailed migration guide is available here: https://github.com/openai/openai-python/discussions/742

2025-01-05 02:22:11,832 [INFO] root: GPT Response: ERROR: OpenAI call failed.
2025-01-05 02:22:11,832 [DEBUG] src.luna_functions: Sending response: Hello @evan:localhost, you said 'hi' (auto-respond).
2025-01-05 02:22:11,849 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:22:11,849 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:23:54,812 [WARNING] __main__: KeyboardInterrupt received. Shutting down Director.
2025-01-05 02:23:54,815 [DEBUG] __main__: Preparing to close the event loop.
2025-01-05 02:23:54,816 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-05 02:23:56,807 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-05 02:23:56,807 [DEBUG] __main__: Exiting configure_logging function.
2025-01-05 02:23:56,807 [DEBUG] __main__: Logging configuration complete.
2025-01-05 02:23:56,807 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-05 02:23:56,807 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 02:23:56,807 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-05 02:23:56,807 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-05 02:23:56,807 [DEBUG] __main__: Entering start_console_thread function.
2025-01-05 02:23:56,807 [INFO] __main__: Console thread started successfully.
2025-01-05 02:23:56,807 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-05 02:23:56,807 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-05 02:23:56,807 [INFO] __main__: Starting main_logic coroutine.
2025-01-05 02:23:56,807 [DEBUG] __main__: Entering main_logic function...
2025-01-05 02:23:56,807 [DEBUG] __main__: Attempting to load or log in the client.
2025-01-05 02:23:56,807 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-05 02:23:56,807 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-05 02:23:56,807 [INFO] src.luna_functions: Using saved token for user @luna:localhost.
2025-01-05 02:23:56,807 [DEBUG] __main__: Client obtained. Storing reference to DIRECTOR_CLIENT in src.luna_functions.
2025-01-05 02:23:56,807 [DEBUG] __main__: Callbacks registered successfully.
2025-01-05 02:23:56,807 [DEBUG] __main__: Starting sync_forever loop. Awaiting new events with timeout=30000.
2025-01-05 02:23:56,849 [INFO] nio.client.base_client: New joined room !roKWYbjbZOVUoYPFtD:localhost
2025-01-05 02:23:56,849 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-05 02:23:56,849 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type RoomJoinRulesEvent
2025-01-05 02:23:56,849 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type RoomCreateEvent
2025-01-05 02:23:56,849 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type PowerLevelsEvent
2025-01-05 02:23:56,849 [INFO] nio.rooms: Changing power level for user @evan:localhost from 0 to 100
2025-01-05 02:23:56,849 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type RoomGuestAccessEvent
2025-01-05 02:23:56,849 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type RoomEncryptionEvent
2025-01-05 02:23:56,849 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type RoomNameEvent
2025-01-05 02:23:56,849 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type MegolmEvent
2025-01-05 02:23:56,849 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type MegolmEvent
2025-01-05 02:23:56,849 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type MegolmEvent
2025-01-05 02:23:56,849 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type MegolmEvent
2025-01-05 02:23:56,849 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type MegolmEvent
2025-01-05 02:23:56,849 [INFO] nio.client.base_client: New joined room !vqsQaVVLtsvWxIoJwV:localhost
2025-01-05 02:23:56,849 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type PowerLevelsEvent
2025-01-05 02:23:56,849 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomCreateEvent
2025-01-05 02:23:56,849 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomJoinRulesEvent
2025-01-05 02:23:56,849 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-05 02:23:56,849 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomGuestAccessEvent
2025-01-05 02:23:56,849 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomEncryptionEvent
2025-01-05 02:23:56,849 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomNameEvent
2025-01-05 02:23:56,849 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type MegolmEvent
2025-01-05 02:23:56,849 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type MegolmEvent
2025-01-05 02:23:56,849 [INFO] nio.client.base_client: New joined room !ZhsKXLoMEydpudauIE:localhost
2025-01-05 02:23:56,849 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomAliasEvent
2025-01-05 02:23:56,849 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomCreateEvent
2025-01-05 02:23:56,849 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomJoinRulesEvent
2025-01-05 02:23:56,849 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-05 02:23:56,849 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type PowerLevelsEvent
2025-01-05 02:23:56,849 [INFO] nio.rooms: Changing power level for user @evan:localhost from 0 to 100
2025-01-05 02:23:56,849 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomNameEvent
2025-01-05 02:23:56,849 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:23:56,849 [DEBUG] src.luna_functions: Got an event of type: <class 'nio.events.room_events.RoomMessageText'>, content: {'type': 'm.room.message', 'sender': '@evan:localhost', 'content': {'msgtype': 'm.text', 'body': 'test', 'm.mentions': {}}, 'origin_server_ts': 1736061126143, 'unsigned': {'membership': 'join', 'age': 710698}, 'event_id': '$8HPUQ6c2hkh5V_1FAUucqkcw9DqKsg0OUmf4dT5Z72w'}
2025-01-05 02:23:56,849 [INFO] src.luna_functions: Received message in !ZhsKXLoMEydpudauIE:localhost from @evan:localhost: test
2025-01-05 02:23:56,849 [DEBUG] src.ai_functions: get_ai_response called with prompt: test
2025-01-05 02:23:56,849 [INFO] src.ai_functions: Sending prompt to OpenAI using model 'gpt-4'.
2025-01-05 02:23:56,849 [ERROR] __main__: An unexpected exception occurred in main_logic: module 'openai' has no attribute 'error'
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/src/ai_functions.py", line 51, in get_ai_response
    response = openai.ChatCompletion.create(
        model=model,
    ...<2 lines>...
        temperature=0.7
    )
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/openai/lib/_old_api.py", line 39, in __call__
    raise APIRemovedInV1(symbol=self._symbol)
openai.lib._old_api.APIRemovedInV1: 

You tried to access openai.ChatCompletion, but this is no longer supported in openai>=1.0.0 - see the README at https://github.com/openai/openai-python for the API.

You can run `openai migrate` to automatically upgrade your codebase to use the 1.0.0 interface. 

Alternatively, you can pin your installation to the old version, e.g. `pip install openai==0.28`

A detailed migration guide is available here: https://github.com/openai/openai-python/discussions/742


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 131, in luna
    loop.run_until_complete(main_logic())
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 720, in run_until_complete
    return future.result()
           ~~~~~~~~~~~~~^^
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 95, in main_logic
    await client.sync_forever(timeout=30000)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/base_client.py", line 116, in wrapper
    return await func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 1358, in sync_forever
    sync_response = await self.sync(
                    ^^^^^^^^^^^^^^^^
        use_timeout, use_filter, since, full_state, presence
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/base_client.py", line 116, in wrapper
    return await func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 1232, in sync
    response = await self._send(
               ^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 880, in _send
    await self.receive_response(resp)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 770, in receive_response
    await self._handle_sync(response)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 737, in _handle_sync
    await self._handle_joined_rooms(response)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 635, in _handle_joined_rooms
    await self._on_event(event, room)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 697, in _on_event
    await cb.async_execute(event, room)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/base_client.py", line 160, in async_execute
    await result
  File "/Users/evanrobinson/Documents/Luna2/luna/src/luna_functions.py", line 141, in on_room_message
    ai_functions.get_ai_response(f'{body}')
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "/Users/evanrobinson/Documents/Luna2/luna/src/ai_functions.py", line 62, in get_ai_response
    except openai.error.OpenAIError as e:
           ^^^^^^^^^^^^
AttributeError: module 'openai' has no attribute 'error'
2025-01-05 02:23:56,853 [DEBUG] __main__: Preparing to close the event loop.
2025-01-05 02:23:56,853 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-05 02:24:12,213 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-05 02:24:12,213 [DEBUG] __main__: Exiting configure_logging function.
2025-01-05 02:24:12,213 [DEBUG] __main__: Logging configuration complete.
2025-01-05 02:24:12,213 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-05 02:24:12,213 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 02:24:12,213 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-05 02:24:12,213 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-05 02:24:12,213 [DEBUG] __main__: Entering start_console_thread function.
2025-01-05 02:24:12,214 [INFO] __main__: Console thread started successfully.
2025-01-05 02:24:12,214 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-05 02:24:12,214 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-05 02:24:12,214 [INFO] __main__: Starting main_logic coroutine.
2025-01-05 02:24:12,214 [DEBUG] __main__: Entering main_logic function...
2025-01-05 02:24:12,214 [DEBUG] __main__: Attempting to load or log in the client.
2025-01-05 02:24:12,214 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-05 02:24:12,214 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-05 02:24:12,214 [INFO] src.luna_functions: Using saved token for user @luna:localhost.
2025-01-05 02:24:12,214 [DEBUG] __main__: Client obtained. Storing reference to DIRECTOR_CLIENT in src.luna_functions.
2025-01-05 02:24:12,214 [DEBUG] __main__: Callbacks registered successfully.
2025-01-05 02:24:12,214 [DEBUG] __main__: Starting sync_forever loop. Awaiting new events with timeout=30000.
2025-01-05 02:24:12,231 [INFO] nio.client.base_client: New joined room !roKWYbjbZOVUoYPFtD:localhost
2025-01-05 02:24:12,231 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-05 02:24:12,231 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type RoomJoinRulesEvent
2025-01-05 02:24:12,231 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type RoomCreateEvent
2025-01-05 02:24:12,231 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type PowerLevelsEvent
2025-01-05 02:24:12,231 [INFO] nio.rooms: Changing power level for user @evan:localhost from 0 to 100
2025-01-05 02:24:12,231 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type RoomGuestAccessEvent
2025-01-05 02:24:12,231 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type RoomEncryptionEvent
2025-01-05 02:24:12,231 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type RoomNameEvent
2025-01-05 02:24:12,231 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type MegolmEvent
2025-01-05 02:24:12,231 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type MegolmEvent
2025-01-05 02:24:12,231 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type MegolmEvent
2025-01-05 02:24:12,231 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type MegolmEvent
2025-01-05 02:24:12,231 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type MegolmEvent
2025-01-05 02:24:12,231 [INFO] nio.client.base_client: New joined room !vqsQaVVLtsvWxIoJwV:localhost
2025-01-05 02:24:12,231 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type PowerLevelsEvent
2025-01-05 02:24:12,231 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomCreateEvent
2025-01-05 02:24:12,231 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomJoinRulesEvent
2025-01-05 02:24:12,231 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-05 02:24:12,231 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomGuestAccessEvent
2025-01-05 02:24:12,231 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomEncryptionEvent
2025-01-05 02:24:12,231 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomNameEvent
2025-01-05 02:24:12,231 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type MegolmEvent
2025-01-05 02:24:12,231 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type MegolmEvent
2025-01-05 02:24:12,231 [INFO] nio.client.base_client: New joined room !ZhsKXLoMEydpudauIE:localhost
2025-01-05 02:24:12,231 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomAliasEvent
2025-01-05 02:24:12,231 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomCreateEvent
2025-01-05 02:24:12,231 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomJoinRulesEvent
2025-01-05 02:24:12,231 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-05 02:24:12,231 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type PowerLevelsEvent
2025-01-05 02:24:12,231 [INFO] nio.rooms: Changing power level for user @evan:localhost from 0 to 100
2025-01-05 02:24:12,231 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomNameEvent
2025-01-05 02:24:12,231 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:24:12,232 [DEBUG] src.luna_functions: Got an event of type: <class 'nio.events.room_events.RoomMessageText'>, content: {'type': 'm.room.message', 'sender': '@evan:localhost', 'content': {'msgtype': 'm.text', 'body': 'test', 'm.mentions': {}}, 'origin_server_ts': 1736061126143, 'unsigned': {'membership': 'join', 'age': 726077}, 'event_id': '$8HPUQ6c2hkh5V_1FAUucqkcw9DqKsg0OUmf4dT5Z72w'}
2025-01-05 02:24:12,232 [INFO] src.luna_functions: Received message in !ZhsKXLoMEydpudauIE:localhost from @evan:localhost: test
2025-01-05 02:24:12,232 [DEBUG] src.ai_functions: get_ai_response called with prompt: test
2025-01-05 02:24:12,232 [INFO] src.ai_functions: Sending prompt to OpenAI using model 'gpt-4'.
2025-01-05 02:24:12,232 [ERROR] __main__: An unexpected exception occurred in main_logic: module 'openai' has no attribute 'error'
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/src/ai_functions.py", line 51, in get_ai_response
    response = openai.ChatCompletion.create(
        model=model,
    ...<2 lines>...
        temperature=0.7
    )
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/openai/lib/_old_api.py", line 39, in __call__
    raise APIRemovedInV1(symbol=self._symbol)
openai.lib._old_api.APIRemovedInV1: 

You tried to access openai.ChatCompletion, but this is no longer supported in openai>=1.0.0 - see the README at https://github.com/openai/openai-python for the API.

You can run `openai migrate` to automatically upgrade your codebase to use the 1.0.0 interface. 

Alternatively, you can pin your installation to the old version, e.g. `pip install openai==0.28`

A detailed migration guide is available here: https://github.com/openai/openai-python/discussions/742


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 131, in luna
    loop.run_until_complete(main_logic())
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 720, in run_until_complete
    return future.result()
           ~~~~~~~~~~~~~^^
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 95, in main_logic
    await client.sync_forever(timeout=30000)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/base_client.py", line 116, in wrapper
    return await func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 1358, in sync_forever
    sync_response = await self.sync(
                    ^^^^^^^^^^^^^^^^
        use_timeout, use_filter, since, full_state, presence
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/base_client.py", line 116, in wrapper
    return await func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 1232, in sync
    response = await self._send(
               ^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 880, in _send
    await self.receive_response(resp)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 770, in receive_response
    await self._handle_sync(response)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 737, in _handle_sync
    await self._handle_joined_rooms(response)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 635, in _handle_joined_rooms
    await self._on_event(event, room)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 697, in _on_event
    await cb.async_execute(event, room)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/base_client.py", line 160, in async_execute
    await result
  File "/Users/evanrobinson/Documents/Luna2/luna/src/luna_functions.py", line 141, in on_room_message
    ai_functions.get_ai_response(f'{body}')
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "/Users/evanrobinson/Documents/Luna2/luna/src/ai_functions.py", line 62, in get_ai_response
    except openai.error.OpenAIError as e:
           ^^^^^^^^^^^^
AttributeError: module 'openai' has no attribute 'error'
2025-01-05 02:24:12,234 [DEBUG] __main__: Preparing to close the event loop.
2025-01-05 02:24:12,234 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-05 02:24:20,663 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-05 02:24:20,663 [DEBUG] __main__: Exiting configure_logging function.
2025-01-05 02:24:20,663 [DEBUG] __main__: Logging configuration complete.
2025-01-05 02:24:20,663 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-05 02:24:20,663 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 02:24:20,663 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-05 02:24:20,663 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-05 02:24:20,663 [DEBUG] __main__: Entering start_console_thread function.
2025-01-05 02:24:20,663 [INFO] __main__: Console thread started successfully.
2025-01-05 02:24:20,663 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-05 02:24:20,663 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-05 02:24:20,663 [INFO] __main__: Starting main_logic coroutine.
2025-01-05 02:24:20,663 [DEBUG] __main__: Entering main_logic function...
2025-01-05 02:24:20,663 [DEBUG] __main__: Attempting to load or log in the client.
2025-01-05 02:24:20,664 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-05 02:24:20,664 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-05 02:24:20,664 [INFO] src.luna_functions: Using saved token for user @luna:localhost.
2025-01-05 02:24:20,664 [DEBUG] __main__: Client obtained. Storing reference to DIRECTOR_CLIENT in src.luna_functions.
2025-01-05 02:24:20,664 [DEBUG] __main__: Callbacks registered successfully.
2025-01-05 02:24:20,664 [DEBUG] __main__: Starting sync_forever loop. Awaiting new events with timeout=30000.
2025-01-05 02:24:20,680 [INFO] nio.client.base_client: New joined room !roKWYbjbZOVUoYPFtD:localhost
2025-01-05 02:24:20,680 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-05 02:24:20,680 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type RoomJoinRulesEvent
2025-01-05 02:24:20,680 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type RoomCreateEvent
2025-01-05 02:24:20,680 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type PowerLevelsEvent
2025-01-05 02:24:20,680 [INFO] nio.rooms: Changing power level for user @evan:localhost from 0 to 100
2025-01-05 02:24:20,680 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type RoomGuestAccessEvent
2025-01-05 02:24:20,680 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type RoomEncryptionEvent
2025-01-05 02:24:20,680 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type RoomNameEvent
2025-01-05 02:24:20,680 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type MegolmEvent
2025-01-05 02:24:20,680 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type MegolmEvent
2025-01-05 02:24:20,680 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type MegolmEvent
2025-01-05 02:24:20,680 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type MegolmEvent
2025-01-05 02:24:20,680 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type MegolmEvent
2025-01-05 02:24:20,680 [INFO] nio.client.base_client: New joined room !vqsQaVVLtsvWxIoJwV:localhost
2025-01-05 02:24:20,680 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type PowerLevelsEvent
2025-01-05 02:24:20,680 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomCreateEvent
2025-01-05 02:24:20,680 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomJoinRulesEvent
2025-01-05 02:24:20,680 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-05 02:24:20,680 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomGuestAccessEvent
2025-01-05 02:24:20,680 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomEncryptionEvent
2025-01-05 02:24:20,680 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomNameEvent
2025-01-05 02:24:20,680 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type MegolmEvent
2025-01-05 02:24:20,680 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type MegolmEvent
2025-01-05 02:24:20,680 [INFO] nio.client.base_client: New joined room !ZhsKXLoMEydpudauIE:localhost
2025-01-05 02:24:20,681 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomAliasEvent
2025-01-05 02:24:20,681 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomCreateEvent
2025-01-05 02:24:20,681 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomJoinRulesEvent
2025-01-05 02:24:20,681 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-05 02:24:20,681 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type PowerLevelsEvent
2025-01-05 02:24:20,681 [INFO] nio.rooms: Changing power level for user @evan:localhost from 0 to 100
2025-01-05 02:24:20,681 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomNameEvent
2025-01-05 02:24:20,681 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:24:20,681 [DEBUG] src.luna_functions: Got an event of type: <class 'nio.events.room_events.RoomMessageText'>, content: {'type': 'm.room.message', 'sender': '@evan:localhost', 'content': {'msgtype': 'm.text', 'body': 'test', 'm.mentions': {}}, 'origin_server_ts': 1736061126143, 'unsigned': {'membership': 'join', 'age': 734527}, 'event_id': '$8HPUQ6c2hkh5V_1FAUucqkcw9DqKsg0OUmf4dT5Z72w'}
2025-01-05 02:24:20,681 [INFO] src.luna_functions: Received message in !ZhsKXLoMEydpudauIE:localhost from @evan:localhost: test
2025-01-05 02:24:20,681 [DEBUG] src.ai_functions: get_ai_response called with prompt: test
2025-01-05 02:24:20,681 [INFO] src.ai_functions: Sending prompt to OpenAI using model 'gpt-4'.
2025-01-05 02:24:20,681 [ERROR] __main__: An unexpected exception occurred in main_logic: module 'openai' has no attribute 'error'
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/src/ai_functions.py", line 51, in get_ai_response
    response = openai.ChatCompletion.create(
        model=model,
    ...<2 lines>...
        temperature=0.7
    )
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/openai/lib/_old_api.py", line 39, in __call__
    raise APIRemovedInV1(symbol=self._symbol)
openai.lib._old_api.APIRemovedInV1: 

You tried to access openai.ChatCompletion, but this is no longer supported in openai>=1.0.0 - see the README at https://github.com/openai/openai-python for the API.

You can run `openai migrate` to automatically upgrade your codebase to use the 1.0.0 interface. 

Alternatively, you can pin your installation to the old version, e.g. `pip install openai==0.28`

A detailed migration guide is available here: https://github.com/openai/openai-python/discussions/742


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 131, in luna
    loop.run_until_complete(main_logic())
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 720, in run_until_complete
    return future.result()
           ~~~~~~~~~~~~~^^
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 95, in main_logic
    await client.sync_forever(timeout=30000)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/base_client.py", line 116, in wrapper
    return await func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 1358, in sync_forever
    sync_response = await self.sync(
                    ^^^^^^^^^^^^^^^^
        use_timeout, use_filter, since, full_state, presence
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/base_client.py", line 116, in wrapper
    return await func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 1232, in sync
    response = await self._send(
               ^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 880, in _send
    await self.receive_response(resp)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 770, in receive_response
    await self._handle_sync(response)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 737, in _handle_sync
    await self._handle_joined_rooms(response)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 635, in _handle_joined_rooms
    await self._on_event(event, room)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 697, in _on_event
    await cb.async_execute(event, room)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/base_client.py", line 160, in async_execute
    await result
  File "/Users/evanrobinson/Documents/Luna2/luna/src/luna_functions.py", line 141, in on_room_message
    ai_functions.get_ai_response(f'{body}')
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "/Users/evanrobinson/Documents/Luna2/luna/src/ai_functions.py", line 62, in get_ai_response
    except openai.error.OpenAIError as e:
           ^^^^^^^^^^^^
AttributeError: module 'openai' has no attribute 'error'
2025-01-05 02:24:20,683 [DEBUG] __main__: Preparing to close the event loop.
2025-01-05 02:24:20,683 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-05 02:29:22,082 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-05 02:29:22,083 [DEBUG] __main__: Exiting configure_logging function.
2025-01-05 02:29:22,083 [DEBUG] __main__: Logging configuration complete.
2025-01-05 02:29:22,083 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-05 02:29:22,083 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 02:29:22,083 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-05 02:29:22,083 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-05 02:29:22,083 [DEBUG] __main__: Entering start_console_thread function.
2025-01-05 02:29:22,083 [INFO] __main__: Console thread started successfully.
2025-01-05 02:29:22,083 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-05 02:29:22,083 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-05 02:29:22,083 [INFO] __main__: Starting main_logic coroutine.
2025-01-05 02:29:22,083 [DEBUG] __main__: Entering main_logic function...
2025-01-05 02:29:22,083 [DEBUG] __main__: Attempting to load or log in the client.
2025-01-05 02:29:22,083 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-05 02:29:22,084 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-05 02:29:22,084 [INFO] src.luna_functions: Using saved token for user @luna:localhost.
2025-01-05 02:29:22,084 [DEBUG] __main__: Client obtained. Storing reference to DIRECTOR_CLIENT in src.luna_functions.
2025-01-05 02:29:22,084 [DEBUG] __main__: Callbacks registered successfully.
2025-01-05 02:29:22,084 [DEBUG] __main__: Starting sync_forever loop. Awaiting new events with timeout=30000.
2025-01-05 02:29:22,128 [INFO] nio.client.base_client: New joined room !IQTJHuSCcTLlkCZzzF:localhost
2025-01-05 02:29:22,128 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-05 02:29:22,128 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomCreateEvent
2025-01-05 02:29:22,128 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomJoinRulesEvent
2025-01-05 02:29:22,128 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomGuestAccessEvent
2025-01-05 02:29:22,128 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type PowerLevelsEvent
2025-01-05 02:29:22,128 [INFO] nio.rooms: Changing power level for user @evan:localhost from 0 to 100
2025-01-05 02:29:22,128 [INFO] nio.rooms: Changing power level for user @luna:localhost from 0 to 100
2025-01-05 02:29:22,128 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:29:22,128 [INFO] src.luna_functions: Received message in !IQTJHuSCcTLlkCZzzF:localhost from @evan:localhost: hi privately
2025-01-05 02:29:22,129 [ERROR] __main__: An unexpected exception occurred in main_logic: name 'gpt_response' is not defined
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 131, in luna
    loop.run_until_complete(main_logic())
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 720, in run_until_complete
    return future.result()
           ~~~~~~~~~~~~~^^
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 95, in main_logic
    await client.sync_forever(timeout=30000)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/base_client.py", line 116, in wrapper
    return await func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 1358, in sync_forever
    sync_response = await self.sync(
                    ^^^^^^^^^^^^^^^^
        use_timeout, use_filter, since, full_state, presence
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/base_client.py", line 116, in wrapper
    return await func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 1232, in sync
    response = await self._send(
               ^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 880, in _send
    await self.receive_response(resp)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 770, in receive_response
    await self._handle_sync(response)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 737, in _handle_sync
    await self._handle_joined_rooms(response)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 635, in _handle_joined_rooms
    await self._on_event(event, room)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 697, in _on_event
    await cb.async_execute(event, room)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/base_client.py", line 160, in async_execute
    await result
  File "/Users/evanrobinson/Documents/Luna2/luna/src/luna_functions.py", line 139, in on_room_message
    gpt_reply = await gpt_response(user_message)
                      ^^^^^^^^^^^^
NameError: name 'gpt_response' is not defined
2025-01-05 02:29:22,132 [DEBUG] __main__: Preparing to close the event loop.
2025-01-05 02:29:22,132 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-05 02:29:25,046 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-05 02:29:25,046 [DEBUG] __main__: Exiting configure_logging function.
2025-01-05 02:29:25,046 [DEBUG] __main__: Logging configuration complete.
2025-01-05 02:29:25,046 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-05 02:29:25,046 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 02:29:25,047 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-05 02:29:25,047 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-05 02:29:25,047 [DEBUG] __main__: Entering start_console_thread function.
2025-01-05 02:29:25,047 [INFO] __main__: Console thread started successfully.
2025-01-05 02:29:25,047 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-05 02:29:25,047 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-05 02:29:25,047 [INFO] __main__: Starting main_logic coroutine.
2025-01-05 02:29:25,047 [DEBUG] __main__: Entering main_logic function...
2025-01-05 02:29:25,047 [DEBUG] __main__: Attempting to load or log in the client.
2025-01-05 02:29:25,047 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-05 02:29:25,047 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-05 02:29:25,047 [INFO] src.luna_functions: Using saved token for user @luna:localhost.
2025-01-05 02:29:25,047 [DEBUG] __main__: Client obtained. Storing reference to DIRECTOR_CLIENT in src.luna_functions.
2025-01-05 02:29:25,047 [DEBUG] __main__: Callbacks registered successfully.
2025-01-05 02:29:25,047 [DEBUG] __main__: Starting sync_forever loop. Awaiting new events with timeout=30000.
2025-01-05 02:29:25,063 [INFO] nio.client.base_client: New joined room !IQTJHuSCcTLlkCZzzF:localhost
2025-01-05 02:29:25,064 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-05 02:29:25,064 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomCreateEvent
2025-01-05 02:29:25,064 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomJoinRulesEvent
2025-01-05 02:29:25,064 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomGuestAccessEvent
2025-01-05 02:29:25,064 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type PowerLevelsEvent
2025-01-05 02:29:25,064 [INFO] nio.rooms: Changing power level for user @evan:localhost from 0 to 100
2025-01-05 02:29:25,064 [INFO] nio.rooms: Changing power level for user @luna:localhost from 0 to 100
2025-01-05 02:29:25,064 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:29:25,064 [INFO] src.luna_functions: Received message in !IQTJHuSCcTLlkCZzzF:localhost from @evan:localhost: hi privately
2025-01-05 02:29:25,064 [ERROR] __main__: An unexpected exception occurred in main_logic: name 'gpt_response' is not defined
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 131, in luna
    loop.run_until_complete(main_logic())
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 720, in run_until_complete
    return future.result()
           ~~~~~~~~~~~~~^^
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 95, in main_logic
    await client.sync_forever(timeout=30000)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/base_client.py", line 116, in wrapper
    return await func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 1358, in sync_forever
    sync_response = await self.sync(
                    ^^^^^^^^^^^^^^^^
        use_timeout, use_filter, since, full_state, presence
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/base_client.py", line 116, in wrapper
    return await func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 1232, in sync
    response = await self._send(
               ^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 880, in _send
    await self.receive_response(resp)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 770, in receive_response
    await self._handle_sync(response)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 737, in _handle_sync
    await self._handle_joined_rooms(response)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 635, in _handle_joined_rooms
    await self._on_event(event, room)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 697, in _on_event
    await cb.async_execute(event, room)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/base_client.py", line 160, in async_execute
    await result
  File "/Users/evanrobinson/Documents/Luna2/luna/src/luna_functions.py", line 139, in on_room_message
    gpt_reply = await gpt_response(user_message)
                      ^^^^^^^^^^^^
NameError: name 'gpt_response' is not defined
2025-01-05 02:29:25,065 [DEBUG] __main__: Preparing to close the event loop.
2025-01-05 02:29:25,066 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-05 02:32:34,230 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-05 02:32:34,230 [DEBUG] __main__: Exiting configure_logging function.
2025-01-05 02:32:34,230 [DEBUG] __main__: Logging configuration complete.
2025-01-05 02:32:34,230 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-05 02:32:34,230 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 02:32:34,230 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-05 02:32:34,230 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-05 02:32:34,230 [DEBUG] __main__: Entering start_console_thread function.
2025-01-05 02:32:34,230 [INFO] __main__: Console thread started successfully.
2025-01-05 02:32:34,230 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-05 02:32:34,230 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-05 02:32:34,230 [INFO] __main__: Starting main_logic coroutine.
2025-01-05 02:32:34,230 [DEBUG] __main__: Entering main_logic function...
2025-01-05 02:32:34,230 [DEBUG] __main__: Attempting to load or log in the client.
2025-01-05 02:32:34,230 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-05 02:32:34,230 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-05 02:32:34,230 [INFO] src.luna_functions: Using saved token for user @luna:localhost.
2025-01-05 02:32:34,230 [DEBUG] __main__: Client obtained. Storing reference to DIRECTOR_CLIENT in src.luna_functions.
2025-01-05 02:32:34,230 [DEBUG] __main__: Callbacks registered successfully.
2025-01-05 02:32:34,230 [DEBUG] __main__: Starting sync_forever loop. Awaiting new events with timeout=30000.
2025-01-05 02:32:34,273 [INFO] nio.client.base_client: New joined room !IQTJHuSCcTLlkCZzzF:localhost
2025-01-05 02:32:34,274 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-05 02:32:34,274 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomCreateEvent
2025-01-05 02:32:34,274 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomJoinRulesEvent
2025-01-05 02:32:34,274 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomGuestAccessEvent
2025-01-05 02:32:34,274 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type PowerLevelsEvent
2025-01-05 02:32:34,274 [INFO] nio.rooms: Changing power level for user @evan:localhost from 0 to 100
2025-01-05 02:32:34,274 [INFO] nio.rooms: Changing power level for user @luna:localhost from 0 to 100
2025-01-05 02:32:34,274 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:32:34,274 [INFO] src.luna_functions: Received message in !IQTJHuSCcTLlkCZzzF:localhost from @evan:localhost: hi privately
2025-01-05 02:32:34,274 [DEBUG] src.ai_functions: get_ai_response called with prompt: hi privately
2025-01-05 02:32:34,274 [INFO] src.ai_functions: Sending prompt to OpenAI using model 'gpt-4' with max_tokens=150 and temperature=0.7.
2025-01-05 02:32:34,274 [ERROR] __main__: An unexpected exception occurred in main_logic: module 'openai' has no attribute 'error'
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/src/ai_functions.py", line 53, in gpt_response
    response = openai.ChatCompletion.create(
        model=model,
    ...<2 lines>...
        temperature=temperature
    )
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/openai/lib/_old_api.py", line 39, in __call__
    raise APIRemovedInV1(symbol=self._symbol)
openai.lib._old_api.APIRemovedInV1: 

You tried to access openai.ChatCompletion, but this is no longer supported in openai>=1.0.0 - see the README at https://github.com/openai/openai-python for the API.

You can run `openai migrate` to automatically upgrade your codebase to use the 1.0.0 interface. 

Alternatively, you can pin your installation to the old version, e.g. `pip install openai==0.28`

A detailed migration guide is available here: https://github.com/openai/openai-python/discussions/742


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 131, in luna
    loop.run_until_complete(main_logic())
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 720, in run_until_complete
    return future.result()
           ~~~~~~~~~~~~~^^
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 95, in main_logic
    await client.sync_forever(timeout=30000)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/base_client.py", line 116, in wrapper
    return await func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 1358, in sync_forever
    sync_response = await self.sync(
                    ^^^^^^^^^^^^^^^^
        use_timeout, use_filter, since, full_state, presence
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/base_client.py", line 116, in wrapper
    return await func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 1232, in sync
    response = await self._send(
               ^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 880, in _send
    await self.receive_response(resp)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 770, in receive_response
    await self._handle_sync(response)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 737, in _handle_sync
    await self._handle_joined_rooms(response)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 635, in _handle_joined_rooms
    await self._on_event(event, room)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 697, in _on_event
    await cb.async_execute(event, room)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/base_client.py", line 160, in async_execute
    await result
  File "/Users/evanrobinson/Documents/Luna2/luna/src/luna_functions.py", line 139, in on_room_message
    gpt_reply = await ai_functions.gpt_response(user_message)
                      ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/Users/evanrobinson/Documents/Luna2/luna/src/ai_functions.py", line 64, in gpt_response
    except openai.error.OpenAIError as e:
           ^^^^^^^^^^^^
AttributeError: module 'openai' has no attribute 'error'
2025-01-05 02:32:34,277 [DEBUG] __main__: Preparing to close the event loop.
2025-01-05 02:32:34,277 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-05 02:35:26,818 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-05 02:35:26,818 [DEBUG] __main__: Exiting configure_logging function.
2025-01-05 02:35:26,818 [DEBUG] __main__: Logging configuration complete.
2025-01-05 02:35:26,818 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-05 02:35:26,818 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 02:35:26,818 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-05 02:35:26,818 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-05 02:35:26,819 [DEBUG] __main__: Entering start_console_thread function.
2025-01-05 02:35:26,819 [INFO] __main__: Console thread started successfully.
2025-01-05 02:35:26,819 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-05 02:35:26,819 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-05 02:35:26,819 [INFO] __main__: Starting main_logic coroutine.
2025-01-05 02:35:26,819 [DEBUG] __main__: Entering main_logic function...
2025-01-05 02:35:26,819 [DEBUG] __main__: Attempting to load or log in the client.
2025-01-05 02:35:26,819 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-05 02:35:26,819 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-05 02:35:26,819 [INFO] src.luna_functions: Using saved token for user @luna:localhost.
2025-01-05 02:35:26,819 [DEBUG] __main__: Client obtained. Storing reference to DIRECTOR_CLIENT in src.luna_functions.
2025-01-05 02:35:26,819 [DEBUG] __main__: Callbacks registered successfully.
2025-01-05 02:35:26,819 [DEBUG] __main__: Starting sync_forever loop. Awaiting new events with timeout=30000.
2025-01-05 02:35:26,859 [INFO] nio.client.base_client: New joined room !IQTJHuSCcTLlkCZzzF:localhost
2025-01-05 02:35:26,859 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-05 02:35:26,859 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomCreateEvent
2025-01-05 02:35:26,859 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomJoinRulesEvent
2025-01-05 02:35:26,859 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomGuestAccessEvent
2025-01-05 02:35:26,859 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type PowerLevelsEvent
2025-01-05 02:35:26,859 [INFO] nio.rooms: Changing power level for user @evan:localhost from 0 to 100
2025-01-05 02:35:26,859 [INFO] nio.rooms: Changing power level for user @luna:localhost from 0 to 100
2025-01-05 02:35:26,859 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:35:26,859 [INFO] src.luna_functions: Received message in !IQTJHuSCcTLlkCZzzF:localhost from @evan:localhost: hi privately
2025-01-05 02:35:26,859 [DEBUG] src.ai_functions: gpt_response called with user_input: hi privately
2025-01-05 02:35:26,860 [INFO] src.ai_functions: Sending user_input to OpenAI using model 'gpt-4' with max_tokens=150 and temperature=0.7.
2025-01-05 02:35:26,860 [ERROR] src.ai_functions: OpenAI API call failed: 

You tried to access openai.ChatCompletion, but this is no longer supported in openai>=1.0.0 - see the README at https://github.com/openai/openai-python for the API.

You can run `openai migrate` to automatically upgrade your codebase to use the 1.0.0 interface. 

Alternatively, you can pin your installation to the old version, e.g. `pip install openai==0.28`

A detailed migration guide is available here: https://github.com/openai/openai-python/discussions/742
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/src/ai_functions.py", line 52, in gpt_response
    response = openai.ChatCompletion.create(
        model=model,
    ...<2 lines>...
        max_tokens=max_tokens
    )
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/openai/lib/_old_api.py", line 39, in __call__
    raise APIRemovedInV1(symbol=self._symbol)
openai.lib._old_api.APIRemovedInV1: 

You tried to access openai.ChatCompletion, but this is no longer supported in openai>=1.0.0 - see the README at https://github.com/openai/openai-python for the API.

You can run `openai migrate` to automatically upgrade your codebase to use the 1.0.0 interface. 

Alternatively, you can pin your installation to the old version, e.g. `pip install openai==0.28`

A detailed migration guide is available here: https://github.com/openai/openai-python/discussions/742

2025-01-05 02:35:26,860 [INFO] src.luna_functions: GPT replied: [Error: OpenAI API call failed.]
2025-01-05 02:35:26,869 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:35:26,869 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:35:26,869 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:35:26,869 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:35:26,869 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:35:26,869 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:35:26,869 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:35:26,869 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:35:26,869 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:35:26,869 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:35:26,869 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:35:26,869 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:35:26,869 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:35:26,869 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:35:26,869 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:35:26,869 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:35:26,869 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:35:26,869 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:35:26,869 [INFO] nio.client.base_client: New joined room !ZhsKXLoMEydpudauIE:localhost
2025-01-05 02:35:26,869 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomAliasEvent
2025-01-05 02:35:26,869 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomCreateEvent
2025-01-05 02:35:26,869 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomJoinRulesEvent
2025-01-05 02:35:26,869 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-05 02:35:26,869 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type PowerLevelsEvent
2025-01-05 02:35:26,869 [INFO] nio.rooms: Changing power level for user @evan:localhost from 0 to 100
2025-01-05 02:35:26,870 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomNameEvent
2025-01-05 02:35:26,870 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:35:26,870 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:35:26,870 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:35:26,870 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:35:26,870 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:35:26,870 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:35:26,870 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:35:26,870 [INFO] src.luna_functions: Received message in !ZhsKXLoMEydpudauIE:localhost from @evan:localhost: test
2025-01-05 02:35:26,870 [DEBUG] src.ai_functions: gpt_response called with user_input: test
2025-01-05 02:35:26,870 [INFO] src.ai_functions: Sending user_input to OpenAI using model 'gpt-4' with max_tokens=150 and temperature=0.7.
2025-01-05 02:35:26,870 [ERROR] src.ai_functions: OpenAI API call failed: 

You tried to access openai.ChatCompletion, but this is no longer supported in openai>=1.0.0 - see the README at https://github.com/openai/openai-python for the API.

You can run `openai migrate` to automatically upgrade your codebase to use the 1.0.0 interface. 

Alternatively, you can pin your installation to the old version, e.g. `pip install openai==0.28`

A detailed migration guide is available here: https://github.com/openai/openai-python/discussions/742
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/src/ai_functions.py", line 52, in gpt_response
    response = openai.ChatCompletion.create(
        model=model,
    ...<2 lines>...
        max_tokens=max_tokens
    )
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/openai/lib/_old_api.py", line 39, in __call__
    raise APIRemovedInV1(symbol=self._symbol)
openai.lib._old_api.APIRemovedInV1: 

You tried to access openai.ChatCompletion, but this is no longer supported in openai>=1.0.0 - see the README at https://github.com/openai/openai-python for the API.

You can run `openai migrate` to automatically upgrade your codebase to use the 1.0.0 interface. 

Alternatively, you can pin your installation to the old version, e.g. `pip install openai==0.28`

A detailed migration guide is available here: https://github.com/openai/openai-python/discussions/742

2025-01-05 02:35:26,870 [INFO] src.luna_functions: GPT replied: [Error: OpenAI API call failed.]
2025-01-05 02:35:26,881 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:35:26,881 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:35:26,881 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:35:26,881 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:35:26,881 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:35:26,882 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:35:26,882 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:35:26,882 [INFO] src.luna_functions: Received message in !ZhsKXLoMEydpudauIE:localhost from @evan:localhost: hi
2025-01-05 02:35:26,882 [DEBUG] src.ai_functions: gpt_response called with user_input: hi
2025-01-05 02:35:26,882 [INFO] src.ai_functions: Sending user_input to OpenAI using model 'gpt-4' with max_tokens=150 and temperature=0.7.
2025-01-05 02:35:26,882 [ERROR] src.ai_functions: OpenAI API call failed: 

You tried to access openai.ChatCompletion, but this is no longer supported in openai>=1.0.0 - see the README at https://github.com/openai/openai-python for the API.

You can run `openai migrate` to automatically upgrade your codebase to use the 1.0.0 interface. 

Alternatively, you can pin your installation to the old version, e.g. `pip install openai==0.28`

A detailed migration guide is available here: https://github.com/openai/openai-python/discussions/742
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/src/ai_functions.py", line 52, in gpt_response
    response = openai.ChatCompletion.create(
        model=model,
    ...<2 lines>...
        max_tokens=max_tokens
    )
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/openai/lib/_old_api.py", line 39, in __call__
    raise APIRemovedInV1(symbol=self._symbol)
openai.lib._old_api.APIRemovedInV1: 

You tried to access openai.ChatCompletion, but this is no longer supported in openai>=1.0.0 - see the README at https://github.com/openai/openai-python for the API.

You can run `openai migrate` to automatically upgrade your codebase to use the 1.0.0 interface. 

Alternatively, you can pin your installation to the old version, e.g. `pip install openai==0.28`

A detailed migration guide is available here: https://github.com/openai/openai-python/discussions/742

2025-01-05 02:35:26,882 [INFO] src.luna_functions: GPT replied: [Error: OpenAI API call failed.]
2025-01-05 02:35:26,903 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:35:26,903 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:35:26,903 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:35:26,903 [INFO] src.luna_functions: Received message in !ZhsKXLoMEydpudauIE:localhost from @evan:localhost: test
2025-01-05 02:35:26,903 [DEBUG] src.ai_functions: gpt_response called with user_input: test
2025-01-05 02:35:26,903 [INFO] src.ai_functions: Sending user_input to OpenAI using model 'gpt-4' with max_tokens=150 and temperature=0.7.
2025-01-05 02:35:26,903 [ERROR] src.ai_functions: OpenAI API call failed: 

You tried to access openai.ChatCompletion, but this is no longer supported in openai>=1.0.0 - see the README at https://github.com/openai/openai-python for the API.

You can run `openai migrate` to automatically upgrade your codebase to use the 1.0.0 interface. 

Alternatively, you can pin your installation to the old version, e.g. `pip install openai==0.28`

A detailed migration guide is available here: https://github.com/openai/openai-python/discussions/742
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/src/ai_functions.py", line 52, in gpt_response
    response = openai.ChatCompletion.create(
        model=model,
    ...<2 lines>...
        max_tokens=max_tokens
    )
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/openai/lib/_old_api.py", line 39, in __call__
    raise APIRemovedInV1(symbol=self._symbol)
openai.lib._old_api.APIRemovedInV1: 

You tried to access openai.ChatCompletion, but this is no longer supported in openai>=1.0.0 - see the README at https://github.com/openai/openai-python for the API.

You can run `openai migrate` to automatically upgrade your codebase to use the 1.0.0 interface. 

Alternatively, you can pin your installation to the old version, e.g. `pip install openai==0.28`

A detailed migration guide is available here: https://github.com/openai/openai-python/discussions/742

2025-01-05 02:35:26,908 [INFO] src.luna_functions: GPT replied: [Error: OpenAI API call failed.]
2025-01-05 02:35:26,929 [INFO] nio.client.base_client: New joined room !roKWYbjbZOVUoYPFtD:localhost
2025-01-05 02:35:26,930 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-05 02:35:26,930 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type RoomJoinRulesEvent
2025-01-05 02:35:26,930 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type RoomCreateEvent
2025-01-05 02:35:26,930 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type PowerLevelsEvent
2025-01-05 02:35:26,930 [INFO] nio.rooms: Changing power level for user @evan:localhost from 0 to 100
2025-01-05 02:35:26,930 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type RoomGuestAccessEvent
2025-01-05 02:35:26,930 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type RoomEncryptionEvent
2025-01-05 02:35:26,930 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type RoomNameEvent
2025-01-05 02:35:26,930 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type MegolmEvent
2025-01-05 02:35:26,930 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type MegolmEvent
2025-01-05 02:35:26,930 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type MegolmEvent
2025-01-05 02:35:26,930 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type MegolmEvent
2025-01-05 02:35:26,930 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type MegolmEvent
2025-01-05 02:35:26,930 [INFO] nio.client.base_client: New joined room !vqsQaVVLtsvWxIoJwV:localhost
2025-01-05 02:35:26,930 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type PowerLevelsEvent
2025-01-05 02:35:26,930 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomCreateEvent
2025-01-05 02:35:26,930 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomJoinRulesEvent
2025-01-05 02:35:26,930 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-05 02:35:26,930 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomGuestAccessEvent
2025-01-05 02:35:26,930 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomEncryptionEvent
2025-01-05 02:35:26,930 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomNameEvent
2025-01-05 02:35:26,930 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type MegolmEvent
2025-01-05 02:35:26,930 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type MegolmEvent
2025-01-05 02:35:26,936 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:35:26,936 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:35:26,936 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:35:26,936 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:35:26,936 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:35:26,936 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:35:26,936 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:35:26,936 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:35:33,149 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:35:33,149 [INFO] src.luna_functions: Received message in !ZhsKXLoMEydpudauIE:localhost from @evan:localhost: test
2025-01-05 02:35:33,149 [DEBUG] src.ai_functions: gpt_response called with user_input: test
2025-01-05 02:35:33,149 [INFO] src.ai_functions: Sending user_input to OpenAI using model 'gpt-4' with max_tokens=150 and temperature=0.7.
2025-01-05 02:35:33,149 [ERROR] src.ai_functions: OpenAI API call failed: 

You tried to access openai.ChatCompletion, but this is no longer supported in openai>=1.0.0 - see the README at https://github.com/openai/openai-python for the API.

You can run `openai migrate` to automatically upgrade your codebase to use the 1.0.0 interface. 

Alternatively, you can pin your installation to the old version, e.g. `pip install openai==0.28`

A detailed migration guide is available here: https://github.com/openai/openai-python/discussions/742
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/src/ai_functions.py", line 52, in gpt_response
    response = openai.ChatCompletion.create(
        model=model,
    ...<2 lines>...
        max_tokens=max_tokens
    )
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/openai/lib/_old_api.py", line 39, in __call__
    raise APIRemovedInV1(symbol=self._symbol)
openai.lib._old_api.APIRemovedInV1: 

You tried to access openai.ChatCompletion, but this is no longer supported in openai>=1.0.0 - see the README at https://github.com/openai/openai-python for the API.

You can run `openai migrate` to automatically upgrade your codebase to use the 1.0.0 interface. 

Alternatively, you can pin your installation to the old version, e.g. `pip install openai==0.28`

A detailed migration guide is available here: https://github.com/openai/openai-python/discussions/742

2025-01-05 02:35:33,151 [INFO] src.luna_functions: GPT replied: [Error: OpenAI API call failed.]
2025-01-05 02:35:33,179 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:35:33,179 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:36:10,738 [WARNING] __main__: KeyboardInterrupt received. Shutting down Director.
2025-01-05 02:36:10,738 [DEBUG] __main__: Preparing to close the event loop.
2025-01-05 02:36:10,738 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-05 02:39:32,514 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-05 02:39:32,514 [DEBUG] __main__: Exiting configure_logging function.
2025-01-05 02:39:32,514 [DEBUG] __main__: Logging configuration complete.
2025-01-05 02:39:32,514 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-05 02:39:32,515 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 02:39:32,515 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-05 02:39:32,515 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-05 02:39:32,515 [DEBUG] __main__: Entering start_console_thread function.
2025-01-05 02:39:32,515 [INFO] __main__: Console thread started successfully.
2025-01-05 02:39:32,515 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-05 02:39:32,515 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-05 02:39:32,515 [INFO] __main__: Starting main_logic coroutine.
2025-01-05 02:39:32,515 [DEBUG] __main__: Entering main_logic function...
2025-01-05 02:39:32,515 [DEBUG] __main__: Attempting to load or log in the client.
2025-01-05 02:39:32,515 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-05 02:39:32,515 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-05 02:39:32,515 [INFO] src.luna_functions: Using saved token for user @luna:localhost.
2025-01-05 02:39:32,515 [DEBUG] __main__: Client obtained. Storing reference to DIRECTOR_CLIENT in src.luna_functions.
2025-01-05 02:39:32,515 [DEBUG] __main__: Callbacks registered successfully.
2025-01-05 02:39:32,515 [DEBUG] __main__: Starting sync_forever loop. Awaiting new events with timeout=30000.
2025-01-05 02:39:32,568 [INFO] nio.client.base_client: New joined room !roKWYbjbZOVUoYPFtD:localhost
2025-01-05 02:39:32,568 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-05 02:39:32,568 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type RoomJoinRulesEvent
2025-01-05 02:39:32,568 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type RoomCreateEvent
2025-01-05 02:39:32,568 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type PowerLevelsEvent
2025-01-05 02:39:32,568 [INFO] nio.rooms: Changing power level for user @evan:localhost from 0 to 100
2025-01-05 02:39:32,568 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type RoomGuestAccessEvent
2025-01-05 02:39:32,568 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type RoomEncryptionEvent
2025-01-05 02:39:32,568 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type RoomNameEvent
2025-01-05 02:39:32,568 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type MegolmEvent
2025-01-05 02:39:32,568 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type MegolmEvent
2025-01-05 02:39:32,568 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type MegolmEvent
2025-01-05 02:39:32,568 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type MegolmEvent
2025-01-05 02:39:32,568 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type MegolmEvent
2025-01-05 02:39:32,568 [INFO] nio.client.base_client: New joined room !vqsQaVVLtsvWxIoJwV:localhost
2025-01-05 02:39:32,568 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type PowerLevelsEvent
2025-01-05 02:39:32,568 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomCreateEvent
2025-01-05 02:39:32,568 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomJoinRulesEvent
2025-01-05 02:39:32,568 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-05 02:39:32,568 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomGuestAccessEvent
2025-01-05 02:39:32,568 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomEncryptionEvent
2025-01-05 02:39:32,568 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomNameEvent
2025-01-05 02:39:32,568 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type MegolmEvent
2025-01-05 02:39:32,568 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type MegolmEvent
2025-01-05 02:39:32,568 [INFO] nio.client.base_client: New joined room !IQTJHuSCcTLlkCZzzF:localhost
2025-01-05 02:39:32,568 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-05 02:39:32,568 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomCreateEvent
2025-01-05 02:39:32,568 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomJoinRulesEvent
2025-01-05 02:39:32,568 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomGuestAccessEvent
2025-01-05 02:39:32,568 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type PowerLevelsEvent
2025-01-05 02:39:32,568 [INFO] nio.rooms: Changing power level for user @evan:localhost from 0 to 100
2025-01-05 02:39:32,568 [INFO] nio.rooms: Changing power level for user @luna:localhost from 0 to 100
2025-01-05 02:39:32,568 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:39:32,568 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:39:32,568 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:39:32,568 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:39:32,568 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:39:32,568 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:39:32,569 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:39:32,569 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:39:32,569 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:39:32,569 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:39:32,569 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:39:32,569 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:39:32,569 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:39:32,569 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:39:32,569 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:39:32,569 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:39:32,569 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:39:32,569 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:39:32,569 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:39:32,569 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:39:32,569 [INFO] nio.client.base_client: New joined room !ZhsKXLoMEydpudauIE:localhost
2025-01-05 02:39:32,569 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomAliasEvent
2025-01-05 02:39:32,569 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomCreateEvent
2025-01-05 02:39:32,569 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomJoinRulesEvent
2025-01-05 02:39:32,569 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-05 02:39:32,569 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type PowerLevelsEvent
2025-01-05 02:39:32,569 [INFO] nio.rooms: Changing power level for user @evan:localhost from 0 to 100
2025-01-05 02:39:32,569 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomNameEvent
2025-01-05 02:39:32,569 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:39:32,569 [INFO] src.luna_functions: Received message in !ZhsKXLoMEydpudauIE:localhost from @evan:localhost: hi
2025-01-05 02:39:32,569 [DEBUG] src.ai_functions: gpt_response called with user_input: hi
2025-01-05 02:39:32,569 [INFO] src.ai_functions: Sending user_input to OpenAI using model 'gpt-4' with max_tokens=150 and temperature=0.7.
2025-01-05 02:39:32,569 [ERROR] src.ai_functions: OpenAI API call failed: 

You tried to access openai.ChatCompletion, but this is no longer supported in openai>=1.0.0 - see the README at https://github.com/openai/openai-python for the API.

You can run `openai migrate` to automatically upgrade your codebase to use the 1.0.0 interface. 

Alternatively, you can pin your installation to the old version, e.g. `pip install openai==0.28`

A detailed migration guide is available here: https://github.com/openai/openai-python/discussions/742
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/src/ai_functions.py", line 52, in gpt_response
    response = openai.ChatCompletion.create(
        model=model,
    ...<2 lines>...
        max_tokens=max_tokens
    )
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/openai/lib/_old_api.py", line 39, in __call__
    raise APIRemovedInV1(symbol=self._symbol)
openai.lib._old_api.APIRemovedInV1: 

You tried to access openai.ChatCompletion, but this is no longer supported in openai>=1.0.0 - see the README at https://github.com/openai/openai-python for the API.

You can run `openai migrate` to automatically upgrade your codebase to use the 1.0.0 interface. 

Alternatively, you can pin your installation to the old version, e.g. `pip install openai==0.28`

A detailed migration guide is available here: https://github.com/openai/openai-python/discussions/742

2025-01-05 02:39:32,570 [INFO] src.luna_functions: GPT replied: [Error: OpenAI API call failed.]
2025-01-05 02:39:32,578 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:39:32,578 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:39:32,578 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:39:32,578 [INFO] src.luna_functions: Received message in !ZhsKXLoMEydpudauIE:localhost from @evan:localhost: test
2025-01-05 02:39:32,578 [DEBUG] src.ai_functions: gpt_response called with user_input: test
2025-01-05 02:39:32,578 [INFO] src.ai_functions: Sending user_input to OpenAI using model 'gpt-4' with max_tokens=150 and temperature=0.7.
2025-01-05 02:39:32,578 [ERROR] src.ai_functions: OpenAI API call failed: 

You tried to access openai.ChatCompletion, but this is no longer supported in openai>=1.0.0 - see the README at https://github.com/openai/openai-python for the API.

You can run `openai migrate` to automatically upgrade your codebase to use the 1.0.0 interface. 

Alternatively, you can pin your installation to the old version, e.g. `pip install openai==0.28`

A detailed migration guide is available here: https://github.com/openai/openai-python/discussions/742
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/src/ai_functions.py", line 52, in gpt_response
    response = openai.ChatCompletion.create(
        model=model,
    ...<2 lines>...
        max_tokens=max_tokens
    )
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/openai/lib/_old_api.py", line 39, in __call__
    raise APIRemovedInV1(symbol=self._symbol)
openai.lib._old_api.APIRemovedInV1: 

You tried to access openai.ChatCompletion, but this is no longer supported in openai>=1.0.0 - see the README at https://github.com/openai/openai-python for the API.

You can run `openai migrate` to automatically upgrade your codebase to use the 1.0.0 interface. 

Alternatively, you can pin your installation to the old version, e.g. `pip install openai==0.28`

A detailed migration guide is available here: https://github.com/openai/openai-python/discussions/742

2025-01-05 02:39:32,579 [INFO] src.luna_functions: GPT replied: [Error: OpenAI API call failed.]
2025-01-05 02:39:32,589 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:39:32,589 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:39:32,589 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:39:32,589 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:39:32,589 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:39:32,589 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:39:32,589 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:39:32,589 [INFO] src.luna_functions: Received message in !ZhsKXLoMEydpudauIE:localhost from @evan:localhost: test
2025-01-05 02:39:32,589 [DEBUG] src.ai_functions: gpt_response called with user_input: test
2025-01-05 02:39:32,589 [INFO] src.ai_functions: Sending user_input to OpenAI using model 'gpt-4' with max_tokens=150 and temperature=0.7.
2025-01-05 02:39:32,589 [ERROR] src.ai_functions: OpenAI API call failed: 

You tried to access openai.ChatCompletion, but this is no longer supported in openai>=1.0.0 - see the README at https://github.com/openai/openai-python for the API.

You can run `openai migrate` to automatically upgrade your codebase to use the 1.0.0 interface. 

Alternatively, you can pin your installation to the old version, e.g. `pip install openai==0.28`

A detailed migration guide is available here: https://github.com/openai/openai-python/discussions/742
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/src/ai_functions.py", line 52, in gpt_response
    response = openai.ChatCompletion.create(
        model=model,
    ...<2 lines>...
        max_tokens=max_tokens
    )
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/openai/lib/_old_api.py", line 39, in __call__
    raise APIRemovedInV1(symbol=self._symbol)
openai.lib._old_api.APIRemovedInV1: 

You tried to access openai.ChatCompletion, but this is no longer supported in openai>=1.0.0 - see the README at https://github.com/openai/openai-python for the API.

You can run `openai migrate` to automatically upgrade your codebase to use the 1.0.0 interface. 

Alternatively, you can pin your installation to the old version, e.g. `pip install openai==0.28`

A detailed migration guide is available here: https://github.com/openai/openai-python/discussions/742

2025-01-05 02:39:32,590 [INFO] src.luna_functions: GPT replied: [Error: OpenAI API call failed.]
2025-01-05 02:39:32,598 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:39:32,598 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:39:32,598 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:39:32,598 [INFO] src.luna_functions: Received message in !ZhsKXLoMEydpudauIE:localhost from @evan:localhost: test
2025-01-05 02:39:32,598 [DEBUG] src.ai_functions: gpt_response called with user_input: test
2025-01-05 02:39:32,598 [INFO] src.ai_functions: Sending user_input to OpenAI using model 'gpt-4' with max_tokens=150 and temperature=0.7.
2025-01-05 02:39:32,599 [ERROR] src.ai_functions: OpenAI API call failed: 

You tried to access openai.ChatCompletion, but this is no longer supported in openai>=1.0.0 - see the README at https://github.com/openai/openai-python for the API.

You can run `openai migrate` to automatically upgrade your codebase to use the 1.0.0 interface. 

Alternatively, you can pin your installation to the old version, e.g. `pip install openai==0.28`

A detailed migration guide is available here: https://github.com/openai/openai-python/discussions/742
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/src/ai_functions.py", line 52, in gpt_response
    response = openai.ChatCompletion.create(
        model=model,
    ...<2 lines>...
        max_tokens=max_tokens
    )
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/openai/lib/_old_api.py", line 39, in __call__
    raise APIRemovedInV1(symbol=self._symbol)
openai.lib._old_api.APIRemovedInV1: 

You tried to access openai.ChatCompletion, but this is no longer supported in openai>=1.0.0 - see the README at https://github.com/openai/openai-python for the API.

You can run `openai migrate` to automatically upgrade your codebase to use the 1.0.0 interface. 

Alternatively, you can pin your installation to the old version, e.g. `pip install openai==0.28`

A detailed migration guide is available here: https://github.com/openai/openai-python/discussions/742

2025-01-05 02:39:32,599 [INFO] src.luna_functions: GPT replied: [Error: OpenAI API call failed.]
2025-01-05 02:39:32,608 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:39:32,608 [INFO] src.luna_functions: Received message in !ZhsKXLoMEydpudauIE:localhost from @evan:localhost: test
2025-01-05 02:39:32,608 [DEBUG] src.ai_functions: gpt_response called with user_input: test
2025-01-05 02:39:32,608 [INFO] src.ai_functions: Sending user_input to OpenAI using model 'gpt-4' with max_tokens=150 and temperature=0.7.
2025-01-05 02:39:32,608 [ERROR] src.ai_functions: OpenAI API call failed: 

You tried to access openai.ChatCompletion, but this is no longer supported in openai>=1.0.0 - see the README at https://github.com/openai/openai-python for the API.

You can run `openai migrate` to automatically upgrade your codebase to use the 1.0.0 interface. 

Alternatively, you can pin your installation to the old version, e.g. `pip install openai==0.28`

A detailed migration guide is available here: https://github.com/openai/openai-python/discussions/742
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/src/ai_functions.py", line 52, in gpt_response
    response = openai.ChatCompletion.create(
        model=model,
    ...<2 lines>...
        max_tokens=max_tokens
    )
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/openai/lib/_old_api.py", line 39, in __call__
    raise APIRemovedInV1(symbol=self._symbol)
openai.lib._old_api.APIRemovedInV1: 

You tried to access openai.ChatCompletion, but this is no longer supported in openai>=1.0.0 - see the README at https://github.com/openai/openai-python for the API.

You can run `openai migrate` to automatically upgrade your codebase to use the 1.0.0 interface. 

Alternatively, you can pin your installation to the old version, e.g. `pip install openai==0.28`

A detailed migration guide is available here: https://github.com/openai/openai-python/discussions/742

2025-01-05 02:39:32,608 [INFO] src.luna_functions: GPT replied: [Error: OpenAI API call failed.]
2025-01-05 02:39:32,627 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:39:32,627 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:39:32,628 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:39:32,628 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:39:32,628 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:39:32,628 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:39:32,628 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:39:32,628 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:39:32,628 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:39:32,628 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:39:37,451 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:39:37,451 [INFO] src.luna_functions: Received message in !ZhsKXLoMEydpudauIE:localhost from @evan:localhost: tst
2025-01-05 02:39:37,451 [DEBUG] src.ai_functions: gpt_response called with user_input: tst
2025-01-05 02:39:37,451 [INFO] src.ai_functions: Sending user_input to OpenAI using model 'gpt-4' with max_tokens=150 and temperature=0.7.
2025-01-05 02:39:37,451 [ERROR] src.ai_functions: OpenAI API call failed: 

You tried to access openai.ChatCompletion, but this is no longer supported in openai>=1.0.0 - see the README at https://github.com/openai/openai-python for the API.

You can run `openai migrate` to automatically upgrade your codebase to use the 1.0.0 interface. 

Alternatively, you can pin your installation to the old version, e.g. `pip install openai==0.28`

A detailed migration guide is available here: https://github.com/openai/openai-python/discussions/742
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/src/ai_functions.py", line 52, in gpt_response
    response = openai.ChatCompletion.create(
        model=model,
    ...<2 lines>...
        max_tokens=max_tokens
    )
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/openai/lib/_old_api.py", line 39, in __call__
    raise APIRemovedInV1(symbol=self._symbol)
openai.lib._old_api.APIRemovedInV1: 

You tried to access openai.ChatCompletion, but this is no longer supported in openai>=1.0.0 - see the README at https://github.com/openai/openai-python for the API.

You can run `openai migrate` to automatically upgrade your codebase to use the 1.0.0 interface. 

Alternatively, you can pin your installation to the old version, e.g. `pip install openai==0.28`

A detailed migration guide is available here: https://github.com/openai/openai-python/discussions/742

2025-01-05 02:39:37,461 [INFO] src.luna_functions: GPT replied: [Error: OpenAI API call failed.]
2025-01-05 02:39:37,477 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:39:37,477 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:43:31,477 [INFO] src.console_functions: Console received 'restart' command; restarting now.
2025-01-05 02:43:32,116 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-05 02:43:32,116 [DEBUG] __main__: Exiting configure_logging function.
2025-01-05 02:43:32,116 [DEBUG] __main__: Logging configuration complete.
2025-01-05 02:43:32,116 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-05 02:43:32,116 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 02:43:32,116 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-05 02:43:32,116 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-05 02:43:32,116 [DEBUG] __main__: Entering start_console_thread function.
2025-01-05 02:43:32,116 [INFO] __main__: Console thread started successfully.
2025-01-05 02:43:32,116 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-05 02:43:32,116 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-05 02:43:32,116 [INFO] __main__: Starting main_logic coroutine.
2025-01-05 02:43:32,116 [DEBUG] __main__: Entering main_logic function...
2025-01-05 02:43:32,116 [DEBUG] __main__: Attempting to load or log in the client.
2025-01-05 02:43:32,116 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-05 02:43:32,117 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-05 02:43:32,117 [INFO] src.luna_functions: Using saved token for user @luna:localhost.
2025-01-05 02:43:32,117 [DEBUG] __main__: Client obtained. Storing reference to DIRECTOR_CLIENT in src.luna_functions.
2025-01-05 02:43:32,117 [DEBUG] __main__: Callbacks registered successfully.
2025-01-05 02:43:32,117 [DEBUG] __main__: Starting sync_forever loop. Awaiting new events with timeout=30000.
2025-01-05 02:43:32,151 [INFO] nio.client.base_client: New joined room !IQTJHuSCcTLlkCZzzF:localhost
2025-01-05 02:43:32,151 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-05 02:43:32,151 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomCreateEvent
2025-01-05 02:43:32,151 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomJoinRulesEvent
2025-01-05 02:43:32,151 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomGuestAccessEvent
2025-01-05 02:43:32,151 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type PowerLevelsEvent
2025-01-05 02:43:32,151 [INFO] nio.rooms: Changing power level for user @evan:localhost from 0 to 100
2025-01-05 02:43:32,151 [INFO] nio.rooms: Changing power level for user @luna:localhost from 0 to 100
2025-01-05 02:43:32,151 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:43:32,151 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:43:32,151 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:43:32,151 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:43:32,151 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:43:32,151 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:43:32,151 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:43:32,151 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:43:32,151 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:43:32,151 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:43:32,151 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:43:32,151 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:43:32,151 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:43:32,151 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:43:32,151 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:43:32,151 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:43:32,151 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:43:32,151 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:43:32,151 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:43:32,151 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:43:32,151 [INFO] nio.client.base_client: New joined room !roKWYbjbZOVUoYPFtD:localhost
2025-01-05 02:43:32,151 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-05 02:43:32,151 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type RoomJoinRulesEvent
2025-01-05 02:43:32,151 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type RoomCreateEvent
2025-01-05 02:43:32,151 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type PowerLevelsEvent
2025-01-05 02:43:32,151 [INFO] nio.rooms: Changing power level for user @evan:localhost from 0 to 100
2025-01-05 02:43:32,151 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type RoomGuestAccessEvent
2025-01-05 02:43:32,151 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type RoomEncryptionEvent
2025-01-05 02:43:32,151 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type RoomNameEvent
2025-01-05 02:43:32,151 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type MegolmEvent
2025-01-05 02:43:32,151 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type MegolmEvent
2025-01-05 02:43:32,151 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type MegolmEvent
2025-01-05 02:43:32,151 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type MegolmEvent
2025-01-05 02:43:32,151 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type MegolmEvent
2025-01-05 02:43:32,151 [INFO] nio.client.base_client: New joined room !vqsQaVVLtsvWxIoJwV:localhost
2025-01-05 02:43:32,151 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type PowerLevelsEvent
2025-01-05 02:43:32,151 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomCreateEvent
2025-01-05 02:43:32,151 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomJoinRulesEvent
2025-01-05 02:43:32,151 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-05 02:43:32,151 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomGuestAccessEvent
2025-01-05 02:43:32,151 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomEncryptionEvent
2025-01-05 02:43:32,151 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomNameEvent
2025-01-05 02:43:32,151 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type MegolmEvent
2025-01-05 02:43:32,151 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type MegolmEvent
2025-01-05 02:43:32,151 [INFO] nio.client.base_client: New joined room !ZhsKXLoMEydpudauIE:localhost
2025-01-05 02:43:32,152 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomAliasEvent
2025-01-05 02:43:32,152 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomCreateEvent
2025-01-05 02:43:32,152 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomJoinRulesEvent
2025-01-05 02:43:32,152 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-05 02:43:32,152 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type PowerLevelsEvent
2025-01-05 02:43:32,152 [INFO] nio.rooms: Changing power level for user @evan:localhost from 0 to 100
2025-01-05 02:43:32,152 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomNameEvent
2025-01-05 02:43:32,152 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:43:32,152 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:43:32,152 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:43:32,152 [INFO] src.luna_functions: Received message in !ZhsKXLoMEydpudauIE:localhost from @evan:localhost: test
2025-01-05 02:43:32,152 [ERROR] __main__: An unexpected exception occurred in main_logic: module 'openai' has no attribute 'error'
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/src/ai_functions.py", line 45, in gpt_response
    response = openai.ChatCompletion.create(
        model=model,
    ...<2 lines>...
        max_tokens=max_tokens
    )
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/openai/lib/_old_api.py", line 39, in __call__
    raise APIRemovedInV1(symbol=self._symbol)
openai.lib._old_api.APIRemovedInV1: 

You tried to access openai.ChatCompletion, but this is no longer supported in openai>=1.0.0 - see the README at https://github.com/openai/openai-python for the API.

You can run `openai migrate` to automatically upgrade your codebase to use the 1.0.0 interface. 

Alternatively, you can pin your installation to the old version, e.g. `pip install openai==0.28`

A detailed migration guide is available here: https://github.com/openai/openai-python/discussions/742


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 131, in luna
    loop.run_until_complete(main_logic())
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 720, in run_until_complete
    return future.result()
           ~~~~~~~~~~~~~^^
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 95, in main_logic
    await client.sync_forever(timeout=30000)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/base_client.py", line 116, in wrapper
    return await func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 1358, in sync_forever
    sync_response = await self.sync(
                    ^^^^^^^^^^^^^^^^
        use_timeout, use_filter, since, full_state, presence
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/base_client.py", line 116, in wrapper
    return await func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 1232, in sync
    response = await self._send(
               ^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 880, in _send
    await self.receive_response(resp)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 770, in receive_response
    await self._handle_sync(response)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 737, in _handle_sync
    await self._handle_joined_rooms(response)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 635, in _handle_joined_rooms
    await self._on_event(event, room)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 697, in _on_event
    await cb.async_execute(event, room)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/base_client.py", line 160, in async_execute
    await result
  File "/Users/evanrobinson/Documents/Luna2/luna/src/luna_functions.py", line 139, in on_room_message
    gpt_reply = await ai_functions.gpt_response(user_message)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/evanrobinson/Documents/Luna2/luna/src/ai_functions.py", line 54, in gpt_response
    except openai.error.InvalidRequestError as e:
           ^^^^^^^^^^^^
AttributeError: module 'openai' has no attribute 'error'
2025-01-05 02:43:32,156 [DEBUG] __main__: Preparing to close the event loop.
2025-01-05 02:43:32,156 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-05 02:46:02,454 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-05 02:46:02,454 [DEBUG] __main__: Exiting configure_logging function.
2025-01-05 02:46:02,454 [DEBUG] __main__: Logging configuration complete.
2025-01-05 02:46:02,454 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-05 02:46:02,454 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 02:46:02,455 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-05 02:46:02,455 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-05 02:46:02,455 [DEBUG] __main__: Entering start_console_thread function.
2025-01-05 02:46:02,455 [INFO] __main__: Console thread started successfully.
2025-01-05 02:46:02,455 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-05 02:46:02,455 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-05 02:46:02,455 [INFO] __main__: Starting main_logic coroutine.
2025-01-05 02:46:02,455 [DEBUG] __main__: Entering main_logic function...
2025-01-05 02:46:02,455 [DEBUG] __main__: Attempting to load or log in the client.
2025-01-05 02:46:02,455 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-05 02:46:02,455 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-05 02:46:02,455 [INFO] src.luna_functions: Using saved token for user @luna:localhost.
2025-01-05 02:46:02,455 [DEBUG] __main__: Client obtained. Storing reference to DIRECTOR_CLIENT in src.luna_functions.
2025-01-05 02:46:02,455 [DEBUG] __main__: Callbacks registered successfully.
2025-01-05 02:46:02,455 [DEBUG] __main__: Starting sync_forever loop. Awaiting new events with timeout=30000.
2025-01-05 02:46:02,511 [INFO] nio.client.base_client: New joined room !IQTJHuSCcTLlkCZzzF:localhost
2025-01-05 02:46:02,511 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-05 02:46:02,511 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomCreateEvent
2025-01-05 02:46:02,511 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomJoinRulesEvent
2025-01-05 02:46:02,511 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomGuestAccessEvent
2025-01-05 02:46:02,511 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type PowerLevelsEvent
2025-01-05 02:46:02,511 [INFO] nio.rooms: Changing power level for user @evan:localhost from 0 to 100
2025-01-05 02:46:02,511 [INFO] nio.rooms: Changing power level for user @luna:localhost from 0 to 100
2025-01-05 02:46:02,511 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:46:02,511 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:46:02,511 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:46:02,511 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:46:02,511 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:46:02,511 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:46:02,511 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:46:02,511 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:46:02,511 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:46:02,511 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:46:02,511 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:46:02,511 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:46:02,511 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:46:02,511 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:46:02,511 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:46:02,511 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:46:02,511 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:46:02,511 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:46:02,511 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:46:02,511 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:46:02,511 [INFO] nio.client.base_client: New joined room !roKWYbjbZOVUoYPFtD:localhost
2025-01-05 02:46:02,511 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-05 02:46:02,511 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type RoomJoinRulesEvent
2025-01-05 02:46:02,511 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type RoomCreateEvent
2025-01-05 02:46:02,511 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type PowerLevelsEvent
2025-01-05 02:46:02,511 [INFO] nio.rooms: Changing power level for user @evan:localhost from 0 to 100
2025-01-05 02:46:02,511 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type RoomGuestAccessEvent
2025-01-05 02:46:02,511 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type RoomEncryptionEvent
2025-01-05 02:46:02,511 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type RoomNameEvent
2025-01-05 02:46:02,511 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type MegolmEvent
2025-01-05 02:46:02,511 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type MegolmEvent
2025-01-05 02:46:02,511 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type MegolmEvent
2025-01-05 02:46:02,512 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type MegolmEvent
2025-01-05 02:46:02,512 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type MegolmEvent
2025-01-05 02:46:02,512 [INFO] nio.client.base_client: New joined room !vqsQaVVLtsvWxIoJwV:localhost
2025-01-05 02:46:02,512 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type PowerLevelsEvent
2025-01-05 02:46:02,512 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomCreateEvent
2025-01-05 02:46:02,512 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomJoinRulesEvent
2025-01-05 02:46:02,512 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-05 02:46:02,512 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomGuestAccessEvent
2025-01-05 02:46:02,512 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomEncryptionEvent
2025-01-05 02:46:02,512 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomNameEvent
2025-01-05 02:46:02,512 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type MegolmEvent
2025-01-05 02:46:02,512 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type MegolmEvent
2025-01-05 02:46:02,512 [INFO] nio.client.base_client: New joined room !ZhsKXLoMEydpudauIE:localhost
2025-01-05 02:46:02,512 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomAliasEvent
2025-01-05 02:46:02,512 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomCreateEvent
2025-01-05 02:46:02,512 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomJoinRulesEvent
2025-01-05 02:46:02,512 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-05 02:46:02,512 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type PowerLevelsEvent
2025-01-05 02:46:02,512 [INFO] nio.rooms: Changing power level for user @evan:localhost from 0 to 100
2025-01-05 02:46:02,512 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomNameEvent
2025-01-05 02:46:02,512 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:46:02,512 [INFO] src.luna_functions: Received message in !ZhsKXLoMEydpudauIE:localhost from @evan:localhost: test
2025-01-05 02:46:02,512 [ERROR] __main__: An unexpected exception occurred in main_logic: module 'src.ai_functions' has no attribute 'gpt_response'
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 131, in luna
    loop.run_until_complete(main_logic())
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 720, in run_until_complete
    return future.result()
           ~~~~~~~~~~~~~^^
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 95, in main_logic
    await client.sync_forever(timeout=30000)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/base_client.py", line 116, in wrapper
    return await func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 1358, in sync_forever
    sync_response = await self.sync(
                    ^^^^^^^^^^^^^^^^
        use_timeout, use_filter, since, full_state, presence
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/base_client.py", line 116, in wrapper
    return await func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 1232, in sync
    response = await self._send(
               ^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 880, in _send
    await self.receive_response(resp)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 770, in receive_response
    await self._handle_sync(response)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 737, in _handle_sync
    await self._handle_joined_rooms(response)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 635, in _handle_joined_rooms
    await self._on_event(event, room)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 697, in _on_event
    await cb.async_execute(event, room)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/base_client.py", line 160, in async_execute
    await result
  File "/Users/evanrobinson/Documents/Luna2/luna/src/luna_functions.py", line 139, in on_room_message
    gpt_reply = await ai_functions.gpt_response(user_message)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: module 'src.ai_functions' has no attribute 'gpt_response'. Did you mean: 'get_gpt_response'?
2025-01-05 02:46:02,516 [DEBUG] __main__: Preparing to close the event loop.
2025-01-05 02:46:02,516 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-05 02:46:05,072 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-05 02:46:05,072 [DEBUG] __main__: Exiting configure_logging function.
2025-01-05 02:46:05,072 [DEBUG] __main__: Logging configuration complete.
2025-01-05 02:46:05,072 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-05 02:46:05,072 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 02:46:05,072 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-05 02:46:05,072 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-05 02:46:05,072 [DEBUG] __main__: Entering start_console_thread function.
2025-01-05 02:46:05,073 [INFO] __main__: Console thread started successfully.
2025-01-05 02:46:05,073 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-05 02:46:05,073 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-05 02:46:05,073 [INFO] __main__: Starting main_logic coroutine.
2025-01-05 02:46:05,073 [DEBUG] __main__: Entering main_logic function...
2025-01-05 02:46:05,073 [DEBUG] __main__: Attempting to load or log in the client.
2025-01-05 02:46:05,073 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-05 02:46:05,073 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-05 02:46:05,073 [INFO] src.luna_functions: Using saved token for user @luna:localhost.
2025-01-05 02:46:05,073 [DEBUG] __main__: Client obtained. Storing reference to DIRECTOR_CLIENT in src.luna_functions.
2025-01-05 02:46:05,073 [DEBUG] __main__: Callbacks registered successfully.
2025-01-05 02:46:05,073 [DEBUG] __main__: Starting sync_forever loop. Awaiting new events with timeout=30000.
2025-01-05 02:46:05,096 [INFO] nio.client.base_client: New joined room !IQTJHuSCcTLlkCZzzF:localhost
2025-01-05 02:46:05,096 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-05 02:46:05,096 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomCreateEvent
2025-01-05 02:46:05,096 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomJoinRulesEvent
2025-01-05 02:46:05,096 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomGuestAccessEvent
2025-01-05 02:46:05,096 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type PowerLevelsEvent
2025-01-05 02:46:05,096 [INFO] nio.rooms: Changing power level for user @evan:localhost from 0 to 100
2025-01-05 02:46:05,096 [INFO] nio.rooms: Changing power level for user @luna:localhost from 0 to 100
2025-01-05 02:46:05,096 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:46:05,096 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:46:05,096 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:46:05,096 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:46:05,096 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:46:05,096 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:46:05,096 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:46:05,096 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:46:05,096 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:46:05,096 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:46:05,096 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:46:05,096 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:46:05,096 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:46:05,096 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:46:05,096 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:46:05,096 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:46:05,096 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:46:05,096 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:46:05,097 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:46:05,097 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:46:05,097 [INFO] nio.client.base_client: New joined room !roKWYbjbZOVUoYPFtD:localhost
2025-01-05 02:46:05,097 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-05 02:46:05,097 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type RoomJoinRulesEvent
2025-01-05 02:46:05,097 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type RoomCreateEvent
2025-01-05 02:46:05,097 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type PowerLevelsEvent
2025-01-05 02:46:05,097 [INFO] nio.rooms: Changing power level for user @evan:localhost from 0 to 100
2025-01-05 02:46:05,097 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type RoomGuestAccessEvent
2025-01-05 02:46:05,097 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type RoomEncryptionEvent
2025-01-05 02:46:05,097 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type RoomNameEvent
2025-01-05 02:46:05,097 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type MegolmEvent
2025-01-05 02:46:05,097 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type MegolmEvent
2025-01-05 02:46:05,097 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type MegolmEvent
2025-01-05 02:46:05,097 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type MegolmEvent
2025-01-05 02:46:05,097 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type MegolmEvent
2025-01-05 02:46:05,097 [INFO] nio.client.base_client: New joined room !vqsQaVVLtsvWxIoJwV:localhost
2025-01-05 02:46:05,097 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type PowerLevelsEvent
2025-01-05 02:46:05,097 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomCreateEvent
2025-01-05 02:46:05,097 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomJoinRulesEvent
2025-01-05 02:46:05,097 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-05 02:46:05,097 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomGuestAccessEvent
2025-01-05 02:46:05,097 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomEncryptionEvent
2025-01-05 02:46:05,097 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomNameEvent
2025-01-05 02:46:05,097 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type MegolmEvent
2025-01-05 02:46:05,097 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type MegolmEvent
2025-01-05 02:46:05,097 [INFO] nio.client.base_client: New joined room !ZhsKXLoMEydpudauIE:localhost
2025-01-05 02:46:05,097 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomAliasEvent
2025-01-05 02:46:05,097 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomCreateEvent
2025-01-05 02:46:05,097 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomJoinRulesEvent
2025-01-05 02:46:05,097 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-05 02:46:05,097 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type PowerLevelsEvent
2025-01-05 02:46:05,097 [INFO] nio.rooms: Changing power level for user @evan:localhost from 0 to 100
2025-01-05 02:46:05,097 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomNameEvent
2025-01-05 02:46:05,097 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:46:05,097 [INFO] src.luna_functions: Received message in !ZhsKXLoMEydpudauIE:localhost from @evan:localhost: test
2025-01-05 02:46:05,097 [ERROR] __main__: An unexpected exception occurred in main_logic: module 'src.ai_functions' has no attribute 'gpt_response'
Traceback (most recent call last):
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 131, in luna
    loop.run_until_complete(main_logic())
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 720, in run_until_complete
    return future.result()
           ~~~~~~~~~~~~~^^
  File "/Users/evanrobinson/Documents/Luna2/luna/luna.py", line 95, in main_logic
    await client.sync_forever(timeout=30000)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/base_client.py", line 116, in wrapper
    return await func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 1358, in sync_forever
    sync_response = await self.sync(
                    ^^^^^^^^^^^^^^^^
        use_timeout, use_filter, since, full_state, presence
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/base_client.py", line 116, in wrapper
    return await func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 1232, in sync
    response = await self._send(
               ^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 880, in _send
    await self.receive_response(resp)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 770, in receive_response
    await self._handle_sync(response)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 737, in _handle_sync
    await self._handle_joined_rooms(response)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 635, in _handle_joined_rooms
    await self._on_event(event, room)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/async_client.py", line 697, in _on_event
    await cb.async_execute(event, room)
  File "/Users/evanrobinson/Documents/Luna2/luna/.venv/lib/python3.13/site-packages/nio/client/base_client.py", line 160, in async_execute
    await result
  File "/Users/evanrobinson/Documents/Luna2/luna/src/luna_functions.py", line 139, in on_room_message
    gpt_reply = await ai_functions.gpt_response(user_message)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: module 'src.ai_functions' has no attribute 'gpt_response'. Did you mean: 'get_gpt_response'?
2025-01-05 02:46:05,099 [DEBUG] __main__: Preparing to close the event loop.
2025-01-05 02:46:05,099 [INFO] __main__: Event loop closed. Exiting main function.
2025-01-05 02:48:31,619 [DEBUG] __main__: Added file handler to root logger. Logging to 'server.log' at DEBUG level.
2025-01-05 02:48:31,619 [DEBUG] __main__: Exiting configure_logging function.
2025-01-05 02:48:31,619 [DEBUG] __main__: Logging configuration complete.
2025-01-05 02:48:31,619 [DEBUG] __main__: Creating a new asyncio event loop.
2025-01-05 02:48:31,619 [DEBUG] asyncio: Using selector: KqueueSelector
2025-01-05 02:48:31,620 [DEBUG] __main__: Set this new loop as the default event loop for the current thread.
2025-01-05 02:48:31,620 [DEBUG] __main__: Stored reference to the new loop in MAIN_LOOP.
2025-01-05 02:48:31,620 [DEBUG] __main__: Entering start_console_thread function.
2025-01-05 02:48:31,620 [INFO] __main__: Console thread started successfully.
2025-01-05 02:48:31,620 [DEBUG] __main__: Exiting start_console_thread function.
2025-01-05 02:48:31,620 [DEBUG] __main__: Console thread has been initiated. Returning to main thread.
2025-01-05 02:48:31,620 [INFO] __main__: Starting main_logic coroutine.
2025-01-05 02:48:31,620 [DEBUG] __main__: Entering main_logic function...
2025-01-05 02:48:31,620 [DEBUG] __main__: Attempting to load or log in the client.
2025-01-05 02:48:31,620 [DEBUG] src.luna_functions: Found director_token.json, attempting token-based login.
2025-01-05 02:48:31,620 [DEBUG] src.luna_functions: Loading client with saved token credentials.
2025-01-05 02:48:31,620 [INFO] src.luna_functions: Using saved token for user @luna:localhost.
2025-01-05 02:48:31,620 [DEBUG] __main__: Client obtained. Storing reference to DIRECTOR_CLIENT in src.luna_functions.
2025-01-05 02:48:31,620 [DEBUG] __main__: Callbacks registered successfully.
2025-01-05 02:48:31,620 [DEBUG] __main__: Starting sync_forever loop. Awaiting new events with timeout=30000.
2025-01-05 02:48:31,666 [INFO] nio.client.base_client: New joined room !IQTJHuSCcTLlkCZzzF:localhost
2025-01-05 02:48:31,666 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-05 02:48:31,666 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomCreateEvent
2025-01-05 02:48:31,666 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomJoinRulesEvent
2025-01-05 02:48:31,666 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomGuestAccessEvent
2025-01-05 02:48:31,666 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type PowerLevelsEvent
2025-01-05 02:48:31,666 [INFO] nio.rooms: Changing power level for user @evan:localhost from 0 to 100
2025-01-05 02:48:31,666 [INFO] nio.rooms: Changing power level for user @luna:localhost from 0 to 100
2025-01-05 02:48:31,666 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:48:31,666 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:48:31,666 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:48:31,666 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:48:31,666 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:48:31,666 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:48:31,666 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:48:31,666 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:48:31,666 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:48:31,666 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:48:31,666 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:48:31,666 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:48:31,666 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:48:31,666 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:48:31,666 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:48:31,666 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:48:31,666 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:48:31,666 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:48:31,666 [INFO] nio.rooms: Room !IQTJHuSCcTLlkCZzzF:localhost handling event of type RoomMessageText
2025-01-05 02:48:31,666 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:48:31,666 [INFO] nio.client.base_client: New joined room !ZhsKXLoMEydpudauIE:localhost
2025-01-05 02:48:31,666 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomAliasEvent
2025-01-05 02:48:31,666 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomCreateEvent
2025-01-05 02:48:31,666 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomJoinRulesEvent
2025-01-05 02:48:31,666 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-05 02:48:31,666 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type PowerLevelsEvent
2025-01-05 02:48:31,667 [INFO] nio.rooms: Changing power level for user @evan:localhost from 0 to 100
2025-01-05 02:48:31,667 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomNameEvent
2025-01-05 02:48:31,667 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:48:31,667 [INFO] src.luna_functions: Received message in !ZhsKXLoMEydpudauIE:localhost from @evan:localhost: test
2025-01-05 02:48:31,667 [DEBUG] src.ai_functions: get_gpt_response called with prompt: test
2025-01-05 02:48:31,667 [INFO] src.ai_functions: Sending user_input to OpenAI using model 'gpt-4', max_tokens=150, temperature=0.7.
2025-01-05 02:48:31,706 [DEBUG] openai._base_client: Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'user', 'content': 'test'}], 'model': 'gpt-4', 'max_tokens': 150, 'temperature': 0.7}}
2025-01-05 02:48:31,710 [DEBUG] httpcore.connection: connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2025-01-05 02:48:31,764 [DEBUG] httpcore.connection: connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10454c440>
2025-01-05 02:48:31,764 [DEBUG] httpcore.connection: start_tls.started ssl_context=<ssl.SSLContext object at 0x104459490> server_hostname='api.openai.com' timeout=5.0
2025-01-05 02:48:31,792 [DEBUG] httpcore.connection: start_tls.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x1044c79d0>
2025-01-05 02:48:31,792 [DEBUG] httpcore.http11: send_request_headers.started request=<Request [b'POST']>
2025-01-05 02:48:31,792 [DEBUG] httpcore.http11: send_request_headers.complete
2025-01-05 02:48:31,792 [DEBUG] httpcore.http11: send_request_body.started request=<Request [b'POST']>
2025-01-05 02:48:31,793 [DEBUG] httpcore.http11: send_request_body.complete
2025-01-05 02:48:31,793 [DEBUG] httpcore.http11: receive_response_headers.started request=<Request [b'POST']>
2025-01-05 02:48:32,931 [DEBUG] httpcore.http11: receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Sun, 05 Jan 2025 07:48:32 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-yzbp3micnvwwjimbcblinra3'), (b'openai-processing-ms', b'610'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'5000'), (b'x-ratelimit-limit-tokens', b'80000'), (b'x-ratelimit-remaining-requests', b'4999'), (b'x-ratelimit-remaining-tokens', b'79848'), (b'x-ratelimit-reset-requests', b'12ms'), (b'x-ratelimit-reset-tokens', b'114ms'), (b'x-request-id', b'req_9f65a57aa8a7dbcb7fb3c73cd38faba9'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=ItITG4.ob_vafawm2QNx5Tx8XHe0RJTdLQOSG9auSJ8-1736063312-1.0.1.1-lLd9oE_cRKWUgz1gWvmuPe85FD1AJ8B16nFhYOyyw55WXTZNp1CfS.66OnPRZ.Z0myBqTleIEh_YG6vKuqh09w; path=/; expires=Sun, 05-Jan-25 08:18:32 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=tHn7FcPo9cVuwxBFlenoranj.IeweTV7A9KdYiZZXEc-1736063312891-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8fd1ddd2dd498c8f-EWR'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2025-01-05 02:48:32,934 [INFO] httpx: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-05 02:48:32,934 [DEBUG] httpcore.http11: receive_response_body.started request=<Request [b'POST']>
2025-01-05 02:48:32,935 [DEBUG] httpcore.http11: receive_response_body.complete
2025-01-05 02:48:32,935 [DEBUG] httpcore.http11: response_closed.started
2025-01-05 02:48:32,935 [DEBUG] httpcore.http11: response_closed.complete
2025-01-05 02:48:32,936 [DEBUG] openai._base_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "200 OK"
2025-01-05 02:48:32,943 [INFO] src.ai_functions: OpenAI responded successfully: Hello! How can I assist you today?
2025-01-05 02:48:32,943 [INFO] src.luna_functions: GPT replied: Hello! How can I assist you today?
2025-01-05 02:48:32,993 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:48:32,993 [INFO] src.luna_functions: Received message in !ZhsKXLoMEydpudauIE:localhost from @evan:localhost: test
2025-01-05 02:48:32,993 [DEBUG] src.ai_functions: get_gpt_response called with prompt: test
2025-01-05 02:48:32,993 [INFO] src.ai_functions: Sending user_input to OpenAI using model 'gpt-4', max_tokens=150, temperature=0.7.
2025-01-05 02:48:32,997 [DEBUG] openai._base_client: Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'user', 'content': 'test'}], 'model': 'gpt-4', 'max_tokens': 150, 'temperature': 0.7}}
2025-01-05 02:48:32,998 [DEBUG] httpcore.http11: send_request_headers.started request=<Request [b'POST']>
2025-01-05 02:48:32,998 [DEBUG] httpcore.http11: send_request_headers.complete
2025-01-05 02:48:32,998 [DEBUG] httpcore.http11: send_request_body.started request=<Request [b'POST']>
2025-01-05 02:48:32,998 [DEBUG] httpcore.http11: send_request_body.complete
2025-01-05 02:48:32,998 [DEBUG] httpcore.http11: receive_response_headers.started request=<Request [b'POST']>
2025-01-05 02:48:34,260 [DEBUG] httpcore.http11: receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Sun, 05 Jan 2025 07:48:34 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-yzbp3micnvwwjimbcblinra3'), (b'openai-processing-ms', b'1144'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'5000'), (b'x-ratelimit-limit-tokens', b'80000'), (b'x-ratelimit-remaining-requests', b'4999'), (b'x-ratelimit-remaining-tokens', b'79848'), (b'x-ratelimit-reset-requests', b'12ms'), (b'x-ratelimit-reset-tokens', b'114ms'), (b'x-request-id', b'req_d63243bf338948092b05e045a7ff0963'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8fd1ddda5ad58c8f-EWR'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2025-01-05 02:48:34,261 [INFO] httpx: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-05 02:48:34,262 [DEBUG] httpcore.http11: receive_response_body.started request=<Request [b'POST']>
2025-01-05 02:48:34,262 [DEBUG] httpcore.http11: receive_response_body.complete
2025-01-05 02:48:34,262 [DEBUG] httpcore.http11: response_closed.started
2025-01-05 02:48:34,263 [DEBUG] httpcore.http11: response_closed.complete
2025-01-05 02:48:34,263 [DEBUG] openai._base_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "200 OK"
2025-01-05 02:48:34,263 [INFO] src.ai_functions: OpenAI responded successfully: Hello! How can I assist you today?
2025-01-05 02:48:34,263 [INFO] src.luna_functions: GPT replied: Hello! How can I assist you today?
2025-01-05 02:48:34,301 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:48:34,303 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:48:34,304 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:48:34,304 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:48:34,304 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:48:34,304 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:48:34,304 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:48:34,304 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:48:34,304 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:48:34,304 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:48:34,304 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:48:34,304 [INFO] src.luna_functions: Received message in !ZhsKXLoMEydpudauIE:localhost from @evan:localhost: tst
2025-01-05 02:48:34,304 [DEBUG] src.ai_functions: get_gpt_response called with prompt: tst
2025-01-05 02:48:34,304 [INFO] src.ai_functions: Sending user_input to OpenAI using model 'gpt-4', max_tokens=150, temperature=0.7.
2025-01-05 02:48:34,308 [DEBUG] openai._base_client: Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'user', 'content': 'tst'}], 'model': 'gpt-4', 'max_tokens': 150, 'temperature': 0.7}}
2025-01-05 02:48:34,309 [DEBUG] httpcore.http11: send_request_headers.started request=<Request [b'POST']>
2025-01-05 02:48:34,309 [DEBUG] httpcore.http11: send_request_headers.complete
2025-01-05 02:48:34,309 [DEBUG] httpcore.http11: send_request_body.started request=<Request [b'POST']>
2025-01-05 02:48:34,310 [DEBUG] httpcore.http11: send_request_body.complete
2025-01-05 02:48:34,310 [DEBUG] httpcore.http11: receive_response_headers.started request=<Request [b'POST']>
2025-01-05 02:48:34,680 [DEBUG] httpcore.http11: receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Sun, 05 Jan 2025 07:48:34 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-yzbp3micnvwwjimbcblinra3'), (b'openai-processing-ms', b'309'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'5000'), (b'x-ratelimit-limit-tokens', b'80000'), (b'x-ratelimit-remaining-requests', b'4999'), (b'x-ratelimit-remaining-tokens', b'79848'), (b'x-ratelimit-reset-requests', b'12ms'), (b'x-ratelimit-reset-tokens', b'114ms'), (b'x-request-id', b'req_f7c2473873332409f868545d07b699af'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8fd1dde28fd58c8f-EWR'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2025-01-05 02:48:34,682 [INFO] httpx: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-05 02:48:34,682 [DEBUG] httpcore.http11: receive_response_body.started request=<Request [b'POST']>
2025-01-05 02:48:34,684 [DEBUG] httpcore.http11: receive_response_body.complete
2025-01-05 02:48:34,684 [DEBUG] httpcore.http11: response_closed.started
2025-01-05 02:48:34,684 [DEBUG] httpcore.http11: response_closed.complete
2025-01-05 02:48:34,684 [DEBUG] openai._base_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "200 OK"
2025-01-05 02:48:34,685 [INFO] src.ai_functions: OpenAI responded successfully: Hello! How can I assist you today?
2025-01-05 02:48:34,685 [INFO] src.luna_functions: GPT replied: Hello! How can I assist you today?
2025-01-05 02:48:34,734 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:48:34,734 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:48:34,734 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:48:34,734 [INFO] src.luna_functions: Received message in !ZhsKXLoMEydpudauIE:localhost from @evan:localhost: test
2025-01-05 02:48:34,734 [DEBUG] src.ai_functions: get_gpt_response called with prompt: test
2025-01-05 02:48:34,734 [INFO] src.ai_functions: Sending user_input to OpenAI using model 'gpt-4', max_tokens=150, temperature=0.7.
2025-01-05 02:48:34,736 [DEBUG] openai._base_client: Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'user', 'content': 'test'}], 'model': 'gpt-4', 'max_tokens': 150, 'temperature': 0.7}}
2025-01-05 02:48:34,737 [DEBUG] httpcore.http11: send_request_headers.started request=<Request [b'POST']>
2025-01-05 02:48:34,738 [DEBUG] httpcore.http11: send_request_headers.complete
2025-01-05 02:48:34,738 [DEBUG] httpcore.http11: send_request_body.started request=<Request [b'POST']>
2025-01-05 02:48:34,738 [DEBUG] httpcore.http11: send_request_body.complete
2025-01-05 02:48:34,738 [DEBUG] httpcore.http11: receive_response_headers.started request=<Request [b'POST']>
2025-01-05 02:48:35,592 [DEBUG] httpcore.http11: receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Sun, 05 Jan 2025 07:48:35 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-yzbp3micnvwwjimbcblinra3'), (b'openai-processing-ms', b'689'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'5000'), (b'x-ratelimit-limit-tokens', b'80000'), (b'x-ratelimit-remaining-requests', b'4999'), (b'x-ratelimit-remaining-tokens', b'79848'), (b'x-ratelimit-reset-requests', b'12ms'), (b'x-ratelimit-reset-tokens', b'114ms'), (b'x-request-id', b'req_27141f81726bedb9fe877d9aac115e1f'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8fd1dde549608c8f-EWR'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2025-01-05 02:48:35,594 [INFO] httpx: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-05 02:48:35,594 [DEBUG] httpcore.http11: receive_response_body.started request=<Request [b'POST']>
2025-01-05 02:48:35,595 [DEBUG] httpcore.http11: receive_response_body.complete
2025-01-05 02:48:35,595 [DEBUG] httpcore.http11: response_closed.started
2025-01-05 02:48:35,595 [DEBUG] httpcore.http11: response_closed.complete
2025-01-05 02:48:35,596 [DEBUG] openai._base_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "200 OK"
2025-01-05 02:48:35,596 [INFO] src.ai_functions: OpenAI responded successfully: Hello! How can I assist you today?
2025-01-05 02:48:35,597 [INFO] src.luna_functions: GPT replied: Hello! How can I assist you today?
2025-01-05 02:48:35,627 [INFO] nio.client.base_client: New joined room !roKWYbjbZOVUoYPFtD:localhost
2025-01-05 02:48:35,627 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-05 02:48:35,627 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type RoomJoinRulesEvent
2025-01-05 02:48:35,628 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type RoomCreateEvent
2025-01-05 02:48:35,632 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type PowerLevelsEvent
2025-01-05 02:48:35,632 [INFO] nio.rooms: Changing power level for user @evan:localhost from 0 to 100
2025-01-05 02:48:35,632 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type RoomGuestAccessEvent
2025-01-05 02:48:35,632 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type RoomEncryptionEvent
2025-01-05 02:48:35,632 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type RoomNameEvent
2025-01-05 02:48:35,632 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type MegolmEvent
2025-01-05 02:48:35,632 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type MegolmEvent
2025-01-05 02:48:35,632 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type MegolmEvent
2025-01-05 02:48:35,632 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type MegolmEvent
2025-01-05 02:48:35,632 [INFO] nio.rooms: Room !roKWYbjbZOVUoYPFtD:localhost handling event of type MegolmEvent
2025-01-05 02:48:35,632 [INFO] nio.client.base_client: New joined room !vqsQaVVLtsvWxIoJwV:localhost
2025-01-05 02:48:35,633 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type PowerLevelsEvent
2025-01-05 02:48:35,633 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomCreateEvent
2025-01-05 02:48:35,633 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomJoinRulesEvent
2025-01-05 02:48:35,633 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomHistoryVisibilityEvent
2025-01-05 02:48:35,633 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomGuestAccessEvent
2025-01-05 02:48:35,633 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomEncryptionEvent
2025-01-05 02:48:35,633 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type RoomNameEvent
2025-01-05 02:48:35,633 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type MegolmEvent
2025-01-05 02:48:35,633 [INFO] nio.rooms: Room !vqsQaVVLtsvWxIoJwV:localhost handling event of type MegolmEvent
2025-01-05 02:48:35,643 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:48:35,643 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:48:35,643 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:48:35,643 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:48:35,643 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:48:35,643 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:48:35,643 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:48:35,643 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:48:38,295 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:48:38,295 [INFO] src.luna_functions: Received message in !ZhsKXLoMEydpudauIE:localhost from @evan:localhost: test
2025-01-05 02:48:38,295 [DEBUG] src.ai_functions: get_gpt_response called with prompt: test
2025-01-05 02:48:38,295 [INFO] src.ai_functions: Sending user_input to OpenAI using model 'gpt-4', max_tokens=150, temperature=0.7.
2025-01-05 02:48:38,300 [DEBUG] openai._base_client: Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'user', 'content': 'test'}], 'model': 'gpt-4', 'max_tokens': 150, 'temperature': 0.7}}
2025-01-05 02:48:38,301 [DEBUG] httpcore.http11: send_request_headers.started request=<Request [b'POST']>
2025-01-05 02:48:38,301 [DEBUG] httpcore.http11: send_request_headers.complete
2025-01-05 02:48:38,301 [DEBUG] httpcore.http11: send_request_body.started request=<Request [b'POST']>
2025-01-05 02:48:38,301 [DEBUG] httpcore.http11: send_request_body.complete
2025-01-05 02:48:38,301 [DEBUG] httpcore.http11: receive_response_headers.started request=<Request [b'POST']>
2025-01-05 02:48:39,320 [DEBUG] httpcore.http11: receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Sun, 05 Jan 2025 07:48:39 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-yzbp3micnvwwjimbcblinra3'), (b'openai-processing-ms', b'953'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'5000'), (b'x-ratelimit-limit-tokens', b'80000'), (b'x-ratelimit-remaining-requests', b'4999'), (b'x-ratelimit-remaining-tokens', b'79848'), (b'x-ratelimit-reset-requests', b'12ms'), (b'x-ratelimit-reset-tokens', b'114ms'), (b'x-request-id', b'req_bded3d6e310ed74646d7fd99b69f7f93'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8fd1ddfb8fa38c8f-EWR'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2025-01-05 02:48:39,321 [INFO] httpx: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-05 02:48:39,321 [DEBUG] httpcore.http11: receive_response_body.started request=<Request [b'POST']>
2025-01-05 02:48:39,326 [DEBUG] httpcore.http11: receive_response_body.complete
2025-01-05 02:48:39,326 [DEBUG] httpcore.http11: response_closed.started
2025-01-05 02:48:39,327 [DEBUG] httpcore.http11: response_closed.complete
2025-01-05 02:48:39,327 [DEBUG] openai._base_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "200 OK"
2025-01-05 02:48:39,328 [INFO] src.ai_functions: OpenAI responded successfully: Hello! How can I assist you today?
2025-01-05 02:48:39,328 [INFO] src.luna_functions: GPT replied: Hello! How can I assist you today?
2025-01-05 02:48:39,373 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:48:39,374 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:48:58,921 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:48:58,921 [INFO] src.luna_functions: Received message in !ZhsKXLoMEydpudauIE:localhost from @evan:localhost: the secret passcode is A
2025-01-05 02:48:58,921 [DEBUG] src.ai_functions: get_gpt_response called with prompt: the secret passcode is A
2025-01-05 02:48:58,921 [INFO] src.ai_functions: Sending user_input to OpenAI using model 'gpt-4', max_tokens=150, temperature=0.7.
2025-01-05 02:48:58,925 [DEBUG] openai._base_client: Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'user', 'content': 'the secret passcode is A'}], 'model': 'gpt-4', 'max_tokens': 150, 'temperature': 0.7}}
2025-01-05 02:48:58,925 [DEBUG] httpcore.connection: close.started
2025-01-05 02:48:58,925 [DEBUG] httpcore.connection: close.complete
2025-01-05 02:48:58,926 [DEBUG] httpcore.connection: connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2025-01-05 02:48:58,948 [DEBUG] httpcore.connection: connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x104510e10>
2025-01-05 02:48:58,949 [DEBUG] httpcore.connection: start_tls.started ssl_context=<ssl.SSLContext object at 0x104459490> server_hostname='api.openai.com' timeout=5.0
2025-01-05 02:48:58,974 [DEBUG] httpcore.connection: start_tls.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x1045802b0>
2025-01-05 02:48:58,975 [DEBUG] httpcore.http11: send_request_headers.started request=<Request [b'POST']>
2025-01-05 02:48:58,975 [DEBUG] httpcore.http11: send_request_headers.complete
2025-01-05 02:48:58,975 [DEBUG] httpcore.http11: send_request_body.started request=<Request [b'POST']>
2025-01-05 02:48:58,975 [DEBUG] httpcore.http11: send_request_body.complete
2025-01-05 02:48:58,975 [DEBUG] httpcore.http11: receive_response_headers.started request=<Request [b'POST']>
2025-01-05 02:48:59,496 [DEBUG] httpcore.http11: receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Sun, 05 Jan 2025 07:48:59 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-yzbp3micnvwwjimbcblinra3'), (b'openai-processing-ms', b'451'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'5000'), (b'x-ratelimit-limit-tokens', b'80000'), (b'x-ratelimit-remaining-requests', b'4999'), (b'x-ratelimit-remaining-tokens', b'79843'), (b'x-ratelimit-reset-requests', b'12ms'), (b'x-ratelimit-reset-tokens', b'117ms'), (b'x-request-id', b'req_087dabbe099c5645913ae27deee793dd'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8fd1de7cbf7defa9-EWR'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2025-01-05 02:48:59,498 [INFO] httpx: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-05 02:48:59,498 [DEBUG] httpcore.http11: receive_response_body.started request=<Request [b'POST']>
2025-01-05 02:48:59,499 [DEBUG] httpcore.http11: receive_response_body.complete
2025-01-05 02:48:59,499 [DEBUG] httpcore.http11: response_closed.started
2025-01-05 02:48:59,499 [DEBUG] httpcore.http11: response_closed.complete
2025-01-05 02:48:59,500 [DEBUG] openai._base_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "200 OK"
2025-01-05 02:48:59,500 [INFO] src.ai_functions: OpenAI responded successfully: 1234B5678C.
2025-01-05 02:48:59,501 [INFO] src.luna_functions: GPT replied: 1234B5678C.
2025-01-05 02:48:59,543 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:48:59,543 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
2025-01-05 02:49:06,989 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:49:06,989 [INFO] src.luna_functions: Received message in !ZhsKXLoMEydpudauIE:localhost from @evan:localhost: what's the secret passcode
2025-01-05 02:49:06,989 [DEBUG] src.ai_functions: get_gpt_response called with prompt: what's the secret passcode
2025-01-05 02:49:06,991 [INFO] src.ai_functions: Sending user_input to OpenAI using model 'gpt-4', max_tokens=150, temperature=0.7.
2025-01-05 02:49:06,994 [DEBUG] openai._base_client: Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'user', 'content': "what's the secret passcode"}], 'model': 'gpt-4', 'max_tokens': 150, 'temperature': 0.7}}
2025-01-05 02:49:06,995 [DEBUG] httpcore.connection: close.started
2025-01-05 02:49:06,995 [DEBUG] httpcore.connection: close.complete
2025-01-05 02:49:06,995 [DEBUG] httpcore.connection: connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2025-01-05 02:49:07,019 [DEBUG] httpcore.connection: connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x104581350>
2025-01-05 02:49:07,019 [DEBUG] httpcore.connection: start_tls.started ssl_context=<ssl.SSLContext object at 0x104459490> server_hostname='api.openai.com' timeout=5.0
2025-01-05 02:49:07,043 [DEBUG] httpcore.connection: start_tls.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x1044d4830>
2025-01-05 02:49:07,043 [DEBUG] httpcore.http11: send_request_headers.started request=<Request [b'POST']>
2025-01-05 02:49:07,043 [DEBUG] httpcore.http11: send_request_headers.complete
2025-01-05 02:49:07,044 [DEBUG] httpcore.http11: send_request_body.started request=<Request [b'POST']>
2025-01-05 02:49:07,044 [DEBUG] httpcore.http11: send_request_body.complete
2025-01-05 02:49:07,044 [DEBUG] httpcore.http11: receive_response_headers.started request=<Request [b'POST']>
2025-01-05 02:49:07,644 [DEBUG] httpcore.http11: receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Sun, 05 Jan 2025 07:49:07 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-yzbp3micnvwwjimbcblinra3'), (b'openai-processing-ms', b'441'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'5000'), (b'x-ratelimit-limit-tokens', b'80000'), (b'x-ratelimit-remaining-requests', b'4999'), (b'x-ratelimit-remaining-tokens', b'79842'), (b'x-ratelimit-reset-requests', b'12ms'), (b'x-ratelimit-reset-tokens', b'118ms'), (b'x-request-id', b'req_bfccf9d3d0051c5aecaa69098b45dc7a'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8fd1deaf2e7542d3-EWR'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2025-01-05 02:49:07,647 [INFO] httpx: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-05 02:49:07,648 [DEBUG] httpcore.http11: receive_response_body.started request=<Request [b'POST']>
2025-01-05 02:49:07,648 [DEBUG] httpcore.http11: receive_response_body.complete
2025-01-05 02:49:07,648 [DEBUG] httpcore.http11: response_closed.started
2025-01-05 02:49:07,648 [DEBUG] httpcore.http11: response_closed.complete
2025-01-05 02:49:07,649 [DEBUG] openai._base_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "200 OK"
2025-01-05 02:49:07,649 [INFO] src.ai_functions: OpenAI responded successfully: Sorry, but I can't assist with that.
2025-01-05 02:49:07,649 [INFO] src.luna_functions: GPT replied: Sorry, but I can't assist with that.
2025-01-05 02:49:07,695 [INFO] nio.rooms: Room !ZhsKXLoMEydpudauIE:localhost handling event of type RoomMessageText
2025-01-05 02:49:07,695 [DEBUG] src.luna_functions: Received message from ourselves; ignoring.
